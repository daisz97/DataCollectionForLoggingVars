List Range String column Range List Range rowIds ArrayList Range Scanner scan String col colMap get column col
LOG debug indexTable column indexRange Connector conn getConnector scan conn createScanner indexTable auths scan setRange indexRange Text cf Text col LOG debug toString scan fetchColumnFamily cf entry scan rowIds add Range entry getKey getColumnQualifier rowIds rowIds LOG debug
scan conn createScanner indexTable auths scan setRange indexRange Text cf Text col LOG debug toString scan fetchColumnFamily cf entry scan rowIds add Range entry getKey getColumnQualifier rowIds size rowIds LOG debug LOG debug rowIds size rowIds
IllegalArgumentException AccumuloSerDeParameters ITERATOR_PUSHDOWN_KEY jobProperties put AccumuloSerDeParameters ITERATOR_PUSHDOWN_KEY useIterators String storageType props getProperty AccumuloSerDeParameters DEFAULT_STORAGE_TYPE storageType jobProperties put AccumuloSerDeParameters DEFAULT_STORAGE_TYPE storageType String authValue props getProperty AccumuloSerDeParameters AUTHORIZATIONS_KEY authValue jobProperties put AccumuloSerDeParameters AUTHORIZATIONS_KEY authValue LOG info jobProperties Configuration conf getConf helper loadDependentJars conf connectionParams Connector conn connectionParams getConnector Token TokenIdentifier accumuloToken helper setConnectorInfoForInputAndOutput connectionParams conn conf
user jobConf checkNotNull user checkNotNull jobConf Token accumuloToken getAccumuloToken user accumuloToken
getFieldInited id ColumnMapping columnMapping columnMappings get id LazyObjectBase field getFields id columnMapping HiveAccumuloMapColumnMapping HiveAccumuloMapColumnMapping mapColumnMapping HiveAccumuloMapColumnMapping columnMapping LazyAccumuloMap map LazyAccumuloMap field map init row mapColumnMapping value columnMapping value row getRowId getBytes columnMapping HiveAccumuloColumnMapping HiveAccumuloColumnMapping accumuloColumnMapping HiveAccumuloColumnMapping columnMapping value row getValue Text accumuloColumnMapping getColumnFamilyBytes Text accumuloColumnMapping getColumnQualifierBytes
index index
AccumuloConnectionParameters accumuloParams AccumuloConnectionParameters jobConf Instance instance accumuloParams getInstance ColumnMapper columnMapper columnMapper getColumnMapper jobConf e IOException e JobContext context ShimLoader getHadoopShims newJobContext Job getInstance jobConf Path tablePaths FileInputFormat getInputPaths context Connector connector accumuloParams log info UserGroupInformation getCurrentUser AuthenticationToken token ConfiguratorBase getAuthenticationToken AccumuloInputFormat jobConf token jobConf
columnMapper getColumnMapper jobConf e IOException e JobContext context ShimLoader getHadoopShims newJobContext Job getInstance jobConf Path tablePaths FileInputFormat getInputPaths context Connector connector log info UserGroupInformation getCurrentUser AuthenticationToken token ConfiguratorBase getAuthenticationToken AccumuloInputFormat jobConf token jobConf getCredentials getAllTokens log info token log info jobConf getCredentials getAllTokens AuthenticationToken unwrappedToken ConfiguratorBase unwrapAuthenticationToken jobConf token
instance getHelper setInputFormatMockInstance conf instance getInstanceName getHelper setInputFormatZooKeeperInstance conf instance getInstanceName instance getZooKeepers accumuloParams useSasl accumuloParams useSasl getHelper updateInputFormatConfWithAccumuloToken conf UserGroupInformation getCurrentUser accumuloParams getHelper setInputFormatConnectorInfo conf accumuloParams getAccumuloUserName PasswordToken accumuloParams getAccumuloPassword setInputTableName conf accumuloParams getAccumuloTableName Authorizations auths AccumuloSerDeParameters getAuthorizationsFromConf conf auths auths connector securityOperations getUserAuthorizations accumuloParams getAccumuloUserName setScanAuthorizations conf auths addIterators conf iterators
getHelper setOutputFormatZooKeeperInstance job cnxnParams getAccumuloInstanceName cnxnParams getZooKeepers cnxnParams useSasl cnxnParams useSasl getHelper updateOutputFormatConfWithAccumuloToken job getCurrentUser cnxnParams getHelper setOutputFormatConnectorInfo job cnxnParams getAccumuloUserName PasswordToken cnxnParams getAccumuloPassword setDefaultAccumuloTableName job tableName String indexTableName job get AccumuloIndexParameters INDEXTABLE_NAME String indexedColumns job get AccumuloIndexParameters INDEXED_COLUMNS String columnTypes job get serdeConstants LIST_COLUMN_TYPES binaryEncoding ColumnEncoding BINARY getName equalsIgnoreCase job get AccumuloSerDeParameters DEFAULT_STORAGE_TYPE setAccumuloIndexTableName job indexTableName setAccumuloIndexColumns job indexedColumns setAccumuloStringEncoding job binaryEncoding
columnMapper TOTAL_RANGE rowIdOffset columnMapper getRowIdOffset String hiveColumnNamesArr conf getStrings serdeConstants LIST_COLUMNS hiveColumnNamesArr IllegalArgumentException String hiveRowIdColumnName hiveColumnNamesArr rowIdOffset ExprNodeDesc root getExpression conf root TOTAL_RANGE Object result generateRanges conf columnMapper hiveRowIdColumnName root result LOG info TOTAL_RANGE result
rowIdOffset columnMapper getRowIdOffset String hiveColumnNamesArr conf getStrings serdeConstants LIST_COLUMNS hiveColumnNamesArr IllegalArgumentException String hiveRowIdColumnName hiveColumnNamesArr rowIdOffset ExprNodeDesc root getExpression conf root TOTAL_RANGE Object result generateRanges conf columnMapper hiveRowIdColumnName root result LOG info TOTAL_RANGE result Range LOG info result Collections singletonList Range result
binaryEncodedRow ColumnEncoding BINARY getName equalsIgnoreCase conf get AccumuloSerDeParameters DEFAULT_STORAGE_TYPE rowIdOffset columnMapper getRowIdOffset String hiveColumnNamesArr conf getStrings serdeConstants LIST_COLUMNS hiveColumnNamesArr IllegalArgumentException String hiveRowIdColumnName rowIdOffset rowIdOffset hiveColumnNamesArr hiveRowIdColumnName hiveColumnNamesArr rowIdOffset List String hiveColumnNames Arrays asList hiveColumnNamesArr sc conf String col sc getColumnDesc getColumn hiveRowIdColumnName hiveRowIdColumnName col HiveAccumuloColumnMapping mapping HiveAccumuloColumnMapping columnMapper getColumnMappingForHiveColumn hiveColumnNames col itrs add toSetting mapping sc binaryEncodedRow
Range andRange andRanges Range intersectedRange andRange clip childRange intersectedRange newRanges add intersectedRange andRanges newRanges nodeOutput List SuppressWarnings List Range childRanges List Range nodeOutput andRanges andRanges addAll childRanges List Range newRanges ArrayList Range Range andRange andRanges Range childRange childRanges Range intersectedRange andRange clip childRange intersectedRange
tbl String factoryClassName tbl getProperty COMPOSITE_ROWID_FACTORY factoryClassName
addRow writer addRow writer addRow writer addRow writer addRow writer addRow writer addRow writer addRow writer writer close AccumuloConnectionParameters connectionParams Mockito mock AccumuloConnectionParameters AccumuloStorageHandler storageHandler Mockito mock AccumuloStorageHandler Mockito when connectionParams getConnector thenReturn conn handler setConnectParams connectionParams handler
LazyObjectBase inspector LazyObjectBase lazyObj LazyFactory createLazyObject inspector ColumnEncoding BINARY rowIdMapping getEncoding
String bytesAsString String bytes getData start length
String bytesAsString String bytes getData start length log info bytesAsString Arrays toString bytes getData separator oi getSeparator
String bytesAsString String bytes getData start length log info bytesAsString Arrays toString bytes getData separator oi getSeparator log info String format separator String fieldBytes StringUtils split bytesAsString separator
keywords beeLine getDatabaseConnection getDatabaseMetaData getSQLKeywords e LOG debug e e keywords beeLine getDatabaseConnection getDatabaseMetaData getStringFunctions e LOG debug e e keywords beeLine getDatabaseConnection getDatabaseMetaData getNumericFunctions e LOG debug e e keywords beeLine getDatabaseConnection getDatabaseMetaData getSystemFunctions e
LOG debug e e keywords beeLine getDatabaseConnection getDatabaseMetaData getStringFunctions e LOG debug e e keywords beeLine getDatabaseConnection getDatabaseMetaData getNumericFunctions e LOG debug e e keywords beeLine getDatabaseConnection getDatabaseMetaData getSystemFunctions e LOG debug e e keywords beeLine getDatabaseConnection getDatabaseMetaData getTimeDateFunctions
String CMD String os String options retCode executeCMD options CMD retCode String output os toString
is GzipCompressorInputStream FileInputStream inputFile is FileInputStream inputFile TarArchiveInputStream debInputStream TarArchiveInputStream ArchiveStreamFactory createArchiveInputStream is TarArchiveEntry entry entry TarArchiveEntry debInputStream File outputFile File outputDir entry getName outputFile outputDir IOException entry LOG debug String format outputFile getAbsolutePath outputFile
outputFile outputDir IOException LOG debug String format outputFile getAbsolutePath outputFile LOG debug String format outputFile getAbsolutePath outputFile IllegalStateException String format outputFile getAbsolutePath OutputStream outputFileStream File flatOutputFile File outputDir outputFile getName LOG debug String format flatOutputFile getAbsolutePath
LOG debug String format outputFile getAbsolutePath outputFile LOG debug String format outputFile getAbsolutePath outputFile IllegalStateException String format outputFile getAbsolutePath OutputStream outputFileStream File flatOutputFile File outputDir outputFile getName LOG debug String format flatOutputFile getAbsolutePath outputFileStream FileOutputStream flatOutputFile outputFile getParentFile LOG debug String format outputFile getParentFile getAbsoluteFile
srcFS src copied triedDistcp srcFS ContentSummary srcContentSummary srcFS getContentSummary src srcContentSummary srcContentSummary
srcFS src HiveConf conf copied triedDistcp srcFS ContentSummary srcContentSummary srcFS getContentSummary src srcContentSummary conf getLongVar HiveConf ConfVars srcContentSummary getLength conf getLongVar HiveConf ConfVars HIVE_EXEC_COPYFILE_MAXSIZE LOG info srcContentSummary getLength conf getLongVar HiveConf ConfVars HIVE_EXEC_COPYFILE_MAXSIZE
f LOG debug f result
fs f conf LOG debug f result LOG debug f result Trash moveToAppropriateTrash fs f conf result LOG trace f ioe LOG warn ioe getMessage result fs delete f result
String localDirs StringUtils getTrimmedStrings localDirList localDirs length createFileInTmp prefix suffix isDirectory String path localDirs random nextInt localDirs length path path createFileInTmp prefix suffix isDirectory File targetDir File path targetDir targetDir createFileInTmp prefix suffix targetDir isDirectory File file File createTempFile prefix suffix targetDir isDirectory file file createFileInTmp prefix suffix file isDirectory file deleteOnExit file
Collections emptySet Set String result HashSet String paths pathString split String path paths Path p Path getURI path FileSystem fs p getFileSystem conf FileStatus fileStatus fs getFileStatus p fileStatus FileStatus files fs listStatus p GlobFilter FileStatus file files result add file getPath toUri toString result add p toUri toString
Set String result HashSet String paths pathString split String path paths Path p Path getURI path FileSystem fs p getFileSystem conf FileStatus fileStatus fs getFileStatus p fileStatus FileStatus files fs listStatus p GlobFilter FileStatus file files result add file getPath toUri toString result add p toUri toString LOG error path
pool memoryThreshold Math floor pool getUsage getMax threshold isTenured isTenured pool isTenured isCollectionUsageThresholdSupported pool isCollectionUsageThresholdSupported isCollectionUsageThresholdSupported LOG info memoryThreshold pool setCollectionUsageThreshold memoryThreshold isUsageThresholdSupported pool isUsageThresholdSupported isUsageThresholdSupported
conf Exception numBitVectors percentageError HiveConf getFloatVar conf HiveConf ConfVars HIVE_STATS_NDV_ERROR percentageError Exception percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors
Exception percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors
LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError
numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info
percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError
percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError
LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors
LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError
numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info percentageError numBitVectors LOG info percentageError LOG info
HiveConf hiveConf hiveConf HiveConf ConfVars String hiveScratchDir hiveConf get HiveConf ConfVars SCRATCHDIR varname Path jobScratchDir Path hiveScratchDir
params setKeyStore keyStorePath keyStorePassWord KeyManagerFactory getDefaultAlgorithm KeyStore getDefaultType InetSocketAddress serverAddress hiveHost hiveHost serverAddress InetSocketAddress portNum serverAddress InetSocketAddress hiveHost portNum TServerSocket thriftServerSocket TSSLTransportFactory getServerSocket portNum serverAddress getAddress params thriftServerSocket getServerSocket SSLServerSocket List String sslVersionBlacklistLocal ArrayList String String sslVersion sslVersionBlacklistLocal add sslVersion trim toLowerCase SSLServerSocket sslServerSocket SSLServerSocket thriftServerSocket getServerSocket List String enabledProtocols ArrayList String String sslServerSocket sslVersionBlacklistLocal toLowerCase
serverAddress InetSocketAddress hiveHost portNum TServerSocket thriftServerSocket TSSLTransportFactory getServerSocket portNum serverAddress getAddress params thriftServerSocket getServerSocket SSLServerSocket List String sslVersionBlacklistLocal ArrayList String String sslVersion sslVersionBlacklistLocal add sslVersion trim toLowerCase SSLServerSocket sslServerSocket SSLServerSocket thriftServerSocket getServerSocket List String enabledProtocols ArrayList String String protocol sslServerSocket sslVersionBlacklistLocal protocol toLowerCase LOG debug protocol enabledProtocols add protocol sslServerSocket setEnabledProtocols enabledProtocols toArray String
String line line
reporterClass Class name name conf getClassByName reporterClass e LOGGER error reporterClass e IllegalArgumentException e Constructor constructor name getConstructor MetricRegistry HiveConf CodahaleReporter reporter CodahaleReporter constructor newInstance metricRegistry conf reporter start reporters add reporter e
Path tmpFile String json json jsonWriter writeValueAsString metricRegistry e LOGGER error e tmpFile Files createTempFile metricsDir FILE_ATTRS e LOGGER error e e
String json json jsonWriter writeValueAsString metricRegistry e LOGGER error e tmpFile Files createTempFile metricsDir FILE_ATTRS e LOGGER error e e LOGGER error e e
LOGGER error e tmpFile Files createTempFile metricsDir FILE_ATTRS e LOGGER error e e LOGGER error e e LOGGER error e bw Files tmpFile bw write json
e LOGGER error e e LOGGER error e e LOGGER error e bw tmpFile bw write json e LOGGER error tmpFile e
e LOGGER error e e LOGGER error e e LOGGER error e bw tmpFile bw write json e LOGGER error tmpFile e
e LOGGER error e bw Files tmpFile bw write json e LOGGER error tmpFile e Files move tmpFile path StandardCopyOption ATOMIC_MOVE e LOGGER error tmpFile path LOGGER error e t LOGGER error t
result String confPath System getenv result checkConfigFile File confPath name result String homePath System getenv String nameInConf File separator name result checkConfigFile File homePath nameInConf result URL sourceUrl HiveConf getProtectionDomain getCodeSource getLocation URI jarUri sourceUrl getProtocol equalsIgnoreCase URI sourceUrl getPath sourceUrl toURI File parent File jarUri getParentFile parent result checkConfigFile File parent getParentFile nameInConf
result String homePath System getenv String nameInConf File separator name result checkConfigFile File homePath nameInConf result URL sourceUrl HiveConf getProtectionDomain getCodeSource getLocation URI jarUri sourceUrl getProtocol equalsIgnoreCase URI sourceUrl getPath sourceUrl toURI File parent File jarUri getParentFile parent result checkConfigFile File parent getParentFile nameInConf e LOG info e System err println e getMessage
String String String retval getVar ConfVars HIVE_LOG_TRACE_ID retval
String Set String engines HashSet ConfVars HIVE_EXECUTION_ENGINE getValidStringValues engines remove String validNonMrEngines String join engines
method startTime System currentTimeMillis startTimes put method Long valueOf startTime
Long startTime startTimes get method endTime System currentTimeMillis endTimes put method Long valueOf endTime duration startTime endTime startTime longValue StringBuilder sb StringBuilder append method startTime sb append append startTime sb append append endTime startTime sb append append duration sb append append callerName additionalInfo sb append append additionalInfo sb append
clazz String String hostname getHostname String classname clazz getSimpleName
clazz String args LOG String hostname getHostname String classname clazz getSimpleName LOG info toStartupShutdownString String classname hostname Arrays asList args HiveVersionInfo getVersion System getProperty HiveVersionInfo getUrl HiveVersionInfo getRevision HiveVersionInfo getUser HiveVersionInfo getDate
listBeans jg ObjectName splitStrings splitStrings response String qry request getParameter qry qry listBeans jg ObjectName qry response jg jg close writer writer close e LOG error e response setStatus HttpServletResponse SC_INTERNAL_SERVER_ERROR
MBeanInfo minfo String code Object attributeinfo minfo mBeanServer getMBeanInfo oname code minfo getClassName String prs code prs code String mBeanServer getAttribute oname prs attribute prs attribute attributeinfo mBeanServer getAttribute oname prs
Object attributeinfo minfo mBeanServer getMBeanInfo oname code minfo getClassName String prs code prs code String mBeanServer getAttribute oname prs attribute prs attribute attributeinfo mBeanServer getAttribute oname prs e LOG error prs oname e e
minfo mBeanServer getMBeanInfo oname code minfo getClassName String prs code prs code String mBeanServer getAttribute oname prs attribute prs attribute attributeinfo mBeanServer getAttribute oname prs e LOG error prs oname e e LOG error prs oname e e
String prs code prs code String mBeanServer getAttribute oname prs attribute prs attribute attributeinfo mBeanServer getAttribute oname prs e LOG error prs oname e e LOG error prs oname e e LOG error prs oname e e
code String mBeanServer getAttribute oname prs attribute prs attribute attributeinfo mBeanServer getAttribute oname prs e LOG error prs oname e e LOG error prs oname e e LOG error prs oname e e LOG error prs oname e e e
prs attribute attributeinfo mBeanServer getAttribute oname prs e LOG error prs oname e e LOG error prs oname e e LOG error prs oname e e LOG error prs oname e e e LOG error qry oname e
oname attr attr String attName attr getName attName attName attName attName Object value value mBeanServer getAttribute oname attName LOG debug attName oname
String attName attr getName attName attName attName attName Object value value mBeanServer getAttribute oname attName e e LOG debug attName oname LOG error attName oname e e
attName attName attName Object value value mBeanServer getAttribute oname attName e e LOG debug attName oname LOG error attName oname e e LOG debug attName oname e e
Object value value mBeanServer getAttribute oname attName e e LOG debug attName oname LOG error attName oname e e LOG debug attName oname e e e
e e LOG debug attName oname LOG error attName oname e e LOG debug attName oname e e e LOG error attName oname e e
logger String loggerName logger getLogger Level logLevel Level getLevel logger getLevel logLevel LOG warn loggerName logger getLevel LoggerConfig loggerConfig conf getLoggerConfig loggerName loggerName loggerConfig LOG LOG debug loggerName logLevel conf addLogger loggerName LoggerConfig loggerName logLevel LOG
req String absoluteDiskPath getServletContext getRealPath req getPathInfo File requestedFile File absoluteDiskPath requestedFile
user users remove user getUserPrincipal getName
String jarFileName1 tmpDir getAbsolutePath File separator String jarFileName2 tmpDir getAbsolutePath File separator File jarFile1 File jarFileName1 org apache commons io FileUtils touch jarFile1 Set String jars FileUtils getJarFilesByPath tmpDir getAbsolutePath conf Assert assertEquals Sets newHashSet jarFileName1 jars jars FileUtils getJarFilesByPath conf Assert assertTrue jars isEmpty File jarFile2 File jarFileName2 org apache commons io FileUtils touch jarFile2 String newPath jarFileName1 jarFileName2 jars FileUtils getJarFilesByPath newPath conf Assert assertEquals Sets newHashSet jarFileName1 jarFileName2 jars
connection DriverManager getConnection url user pass ex LOG error ex result set connection PreparedStatement ps connection prepareStatement StringObjectInspector argumentOI getPrimitiveJavaObject arguments get i i arguments i PrimitiveObjectInspector poi PrimitiveObjectInspector argumentOI i ps setObject i poi getPrimitiveJavaObject arguments i get ps execute ps close result set
String spec String task JSON_MAPPER writeValueAsString spec CONSOLE printInfo task
String overlordAddress spec String task JSON_MAPPER writeValueAsString spec CONSOLE printInfo task LOG info task StringFullResponseHolder response DruidStorageHandlerUtils getResponseFromCurrentLeader DruidStorageHandler getHttpClient Request HttpMethod POST URL String format overlordAddress setContent JSON_MAPPER writeValueAsBytes spec StringFullResponseHandler Charset forName response String msg String format spec getDataSchema getDataSource
MetaException table MetaException table MetaException String dataSourceName table getParameters get Constants DRUID_DATA_SOURCE dataSourceName dataSourceName TableName getDbTable table getDbName table getTableName getConnector createSegmentTable e LOG error e MetaException e getMessage Collection String existingDataSources DruidStorageHandlerUtils getAllDataSourceNames getConnector getDruidMetadataStorageTablesConfig
List DataSegment table List DataSegment String dataSourceName table getParameters get Constants DRUID_DATA_SOURCE String segmentDirectory table getParameters get DruidConstants DRUID_SEGMENT_DIRECTORY table getParameters get DruidConstants DRUID_SEGMENT_DIRECTORY HiveConf getVar getConf HiveConf ConfVars DRUID_SEGMENT_DIRECTORY HdfsDataSegmentPusherConfig hdfsSegmentPusherConfig HdfsDataSegmentPusherConfig List DataSegment publishedDataSegmentList
String coordinatorAddress HiveConf getVar getConf HiveConf ConfVars HIVE_DRUID_COORDINATOR_DEFAULT_ADDRESS maxTries getMaxRetryCount
CONSOLE printInfo CONSOLE printInfo String format segments size passiveWaitTimeMs HiveConf getLongVar getConf HiveConf ConfVars HIVE_DRUID_PASSIVE_WAIT_TIME URL segments dataSegment URL String format coordinatorAddress dataSegment getDataSource dataSegment getId toString e Throwables propagate e numRetries numRetries
CONSOLE printInfo String format segments size passiveWaitTimeMs HiveConf getLongVar getConf HiveConf ConfVars HIVE_DRUID_PASSIVE_WAIT_TIME URL segments dataSegment URL String format coordinatorAddress dataSegment getDataSource dataSegment getId toString e Throwables propagate e numRetries numRetries input String result DruidStorageHandlerUtils getResponseFromCurrentLeader getHttpClient Request HttpMethod GET input StringFullResponseHandler Charset forName getContent LOG debug input result
segment Path path DruidStorageHandlerUtils getPath segment
table String overlordAddress Preconditions checkNotNull HiveConf getVar getConf HiveConf ConfVars HIVE_DRUID_OVERLORD_DEFAULT_ADDRESS String dataSourceName Preconditions checkNotNull DruidStorageHandlerUtils getTableProperty table Constants DRUID_DATA_SOURCE stopKafkaIngestion overlordAddress dataSourceName String dataSourceName Preconditions checkNotNull table getParameters get Constants DRUID_DATA_SOURCE table LOG info dataSourceName List DataSegment dataSegmentList DruidStorageHandlerUtils getDataSegmentList getConnector getDruidMetadataStorageTablesConfig dataSourceName dataSegmentList LOG info dataSourceName DataSegment dataSegment dataSegmentList deleteSegment dataSegment
String dataSourceName Preconditions checkNotNull DruidStorageHandlerUtils getTableProperty table Constants DRUID_DATA_SOURCE stopKafkaIngestion overlordAddress dataSourceName String dataSourceName Preconditions checkNotNull table getParameters get Constants DRUID_DATA_SOURCE table LOG info dataSourceName List DataSegment dataSegmentList DruidStorageHandlerUtils getDataSegmentList getConnector getDruidMetadataStorageTablesConfig dataSourceName dataSegmentList LOG info dataSourceName DataSegment dataSegment dataSegmentList deleteSegment dataSegment e LOG error String format dataSegment getId toString e DruidStorageHandlerUtils getConnector getDruidMetadataStorageTablesConfig dataSourceName
numConnection HiveConf getIntVar SessionState getSessionConf HiveConf ConfVars HIVE_DRUID_NUM_HTTP_CONNECTION Period readTimeout Period HiveConf getVar SessionState getSessionConf HiveConf ConfVars HIVE_DRUID_HTTP_READ_TIMEOUT
StringFullResponseHolder client request fullResponseHandler StringFullResponseHolder responseHolder client go request fullResponseHandler get responseHolder String redirectUrlStr responseHolder getResponse headers get
columnNames DruidConstants DEFAULT_TIMESTAMP_COLUMN IllegalStateException DruidConstants DEFAULT_TIMESTAMP_COLUMN tableProperties getProperty serdeConstants LIST_COLUMNS ArrayList TypeInfo columnTypes TypeInfoUtils getTypeInfosFromTypeString columnTypeProperty Pair List DimensionSchema AggregatorFactory dimensionsAndAggregates DruidStorageHandlerUtils getDimensionsAndAggregates columnNames columnTypes InputRowParser inputRowParser MapInputRowParser TimeAndDimsParseSpec TimestampSpec DruidConstants DEFAULT_TIMESTAMP_COLUMN DimensionsSpec dimensionsAndAggregates lhs Lists newArrayList Constants DRUID_TIMESTAMP_GRANULARITY_COL_NAME Constants DRUID_SHARD_KEY_COL_NAME String inputParser DruidStorageHandlerUtils JSON_MAPPER inputRowParser String DataSchema dataSchema DataSchema Preconditions checkNotNull dataSource inputParser dimensionsAndAggregates rhs granularitySpec DruidStorageHandlerUtils JSON_MAPPER String workingPath jc get DruidConstants DRUID_JOB_WORKING_DIRECTORY String version jc get DruidConstants DRUID_SEGMENT_VERSION String basePersistDirectory HiveConf getVar jc HiveConf ConfVars HIVE_DRUID_BASE_PERSIST_DIRECTORY basePersistDirectory basePersistDirectory System getProperty Integer maxRowInMemory HiveConf getIntVar jc HiveConf ConfVars HIVE_DRUID_MAX_ROW_IN_MEMORY IndexSpec indexSpec DruidStorageHandlerUtils getIndexSpec jc
String address query String intervals StringUtils join query getIntervals String request String format address query getDataSource getNames get URLEncoder encode intervals
SegmentIdWithShardSpec truncatedTime DateTime truncatedDateTime segmentGranularity bucketStart DateTimes utc truncatedTime Interval interval Interval truncatedDateTime segmentGranularity increment truncatedDateTime SegmentIdWithShardSpec retVal currentOpenSegment currentOpenSegment SegmentIdWithShardSpec dataSchema getDataSource interval tuningConfig getVersioningPolicy getVersion interval LinearShardSpec currentOpenSegment currentOpenSegment interval retVal currentOpenSegment rowCount appenderator getRowCount retVal rowCount retVal retVal SegmentIdWithShardSpec dataSchema getDataSource interval tuningConfig getVersioningPolicy getVersion interval LinearShardSpec currentOpenSegment getShardSpec getPartitionNum pushSegments Lists newArrayList currentOpenSegment
currentOpenSegment currentOpenSegment interval retVal currentOpenSegment rowCount appenderator getRowCount retVal rowCount retVal retVal SegmentIdWithShardSpec dataSchema getDataSource interval tuningConfig getVersioningPolicy getVersion interval LinearShardSpec currentOpenSegment getShardSpec getPartitionNum pushSegments Lists newArrayList currentOpenSegment LOG info retVal toString retVal getShardSpec getPartitionNum currentOpenSegment retVal retVal retVal SegmentIdWithShardSpec dataSchema getDataSource interval tuningConfig getVersioningPolicy getVersion interval LinearShardSpec pushSegments Lists newArrayList currentOpenSegment
SegmentIdWithShardSpec segmentsToPush SegmentsAndMetadata segmentsAndMetadata appenderator push segmentsToPush committerSupplier get get Set String pushedSegmentIdentifierHashSet HashSet pushedSegment segmentsAndMetadata pushedSegmentIdentifierHashSet add SegmentIdWithShardSpec fromDataSegment pushedSegment toString Path segmentDescriptorOutputPath DruidStorageHandlerUtils makeSegmentDescriptorOutputPath pushedSegment segmentsDescriptorDir DruidStorageHandlerUtils writeSegmentDescriptor fileSystem pushedSegment segmentDescriptorOutputPath
SegmentsAndMetadata segmentsAndMetadata appenderator push segmentsToPush committerSupplier get get Set String pushedSegmentIdentifierHashSet HashSet pushedSegment segmentsAndMetadata pushedSegmentIdentifierHashSet add SegmentIdWithShardSpec fromDataSegment pushedSegment toString Path segmentDescriptorOutputPath DruidStorageHandlerUtils makeSegmentDescriptorOutputPath pushedSegment segmentsDescriptorDir DruidStorageHandlerUtils writeSegmentDescriptor fileSystem pushedSegment segmentDescriptorOutputPath LOG info String format pushedSegment segmentDescriptorOutputPath Set String toPushSegmentsHashSet segmentsToPush stream map SegmentIdWithShardSpec toString collect Collectors toCollection HashSet pushedSegmentIdentifierHashSet toPushSegmentsHashSet IllegalStateException String format Joiner on join toPushSegmentsHashSet Joiner on join pushedSegmentIdentifierHashSet SegmentIdWithShardSpec dataSegmentId segmentsToPush LOG info dataSegmentId toString appenderator drop dataSegmentId get LOG info String format segmentsToPush size
pushedSegmentIdentifierHashSet add SegmentIdWithShardSpec fromDataSegment pushedSegment toString Path segmentDescriptorOutputPath DruidStorageHandlerUtils makeSegmentDescriptorOutputPath pushedSegment segmentsDescriptorDir DruidStorageHandlerUtils writeSegmentDescriptor fileSystem pushedSegment segmentDescriptorOutputPath LOG info String format pushedSegment segmentDescriptorOutputPath Set String toPushSegmentsHashSet segmentsToPush stream map SegmentIdWithShardSpec toString collect Collectors toCollection HashSet pushedSegmentIdentifierHashSet toPushSegmentsHashSet IllegalStateException String format Joiner on join toPushSegmentsHashSet Joiner on join pushedSegmentIdentifierHashSet SegmentIdWithShardSpec dataSegmentId segmentsToPush LOG info dataSegmentId toString appenderator drop dataSegmentId get LOG info String format segmentsToPush size e LOG error String format segmentsToPush size e Thread currentThread interrupt e
server KERBEROS_LOCK lock Oid mechOid KerberosUtil getOidInstance GSSManager manager GSSManager getInstance GSSName serverName manager createName server GSSName NT_HOSTBASED_SERVICE GSSContext gssContext manager createContext serverName canonicalize mechOid mechOid GSSContext DEFAULT_LIFETIME gssContext requestMutualAuth gssContext requestCredDeleg inToken outToken gssContext initSecContext inToken inToken length gssContext dispose
String host request getUrl getHost URI uri request getUrl toURI Map String List String cookieMap cookieManager get uri Collections emptyMap Map String List String entry cookieMap request addHeaderValues entry getKey entry getValue shouldRetryOnUnauthorizedResponse DruidKerberosUtil cookieManager getCookieStore uri LOG debug uri cookieManager getCookieStore getCookies UserGroupInformation currentUser UserGroupInformation getCurrentUser currentUser checkTGTAndReloginFromKeytab LOG debug currentUser String challenge currentUser doAs PrivilegedExceptionAction String DruidKerberosUtil kerberosChallenge host request setHeader HttpHeaders Names AUTHORIZATION challenge shouldRetryOnUnauthorizedResponse
shouldRetryOnUnauthorizedResponse DruidKerberosUtil cookieManager getCookieStore uri LOG debug uri cookieManager getCookieStore getCookies UserGroupInformation currentUser UserGroupInformation getCurrentUser currentUser checkTGTAndReloginFromKeytab LOG debug currentUser String challenge currentUser doAs PrivilegedExceptionAction String DruidKerberosUtil kerberosChallenge host request setHeader HttpHeaders Names AUTHORIZATION challenge shouldRetryOnUnauthorizedResponse LOG debug uri DruidKerberosUtil getAuthCookie cookieManager getCookieStore uri toString shouldRetryOnUnauthorizedResponse SuppressWarnings ListenableFuture RetryResponseHolder Final internalFuture delegate go request RetryIfUnauthorizedResponseHandler Intermediate Final ResponseCookieHandler request getUrl toURI cookieManager httpResponseHandler duration RetryResponseHolder Final responseHolder internalFuture get shouldRetryOnUnauthorizedResponse responseHolder
Exception ex initialized currentLocationIndex locations String address locations currentLocationIndex address RE LOG debug address query Request request DruidStorageHandlerUtils createSmileRequest address query Future InputStream inputStreamFuture httpClient go request InputStreamResponseHandler iterator JsonParserIterator smileMapper resultsType inputStreamFuture request getUrl toString query iterator init initialized Exception iterator CloseQuietly close iterator
tbl String tableName getHBaseTableName tbl isPurge MetaStoreUtils isExternalTable tbl MetaStoreUtils isExternalTablePurge tbl isPurge
conf tbl serdeParams HBaseSerDeParameters conf tbl getClass getName cachedObjectInspector HBaseLazyObjectFactory createLazyHBaseStructInspector serdeParams tbl cachedHBaseRow LazyHBaseRow LazySimpleStructObjectInspector cachedObjectInspector serdeParams serializer HBaseRowSerializer serdeParams
sb IllegalArgumentException i i columnsMapping i ColumnMapping colMap columnsMapping get i colMap sb append append StringUtils COMMA_STR colMap qualifierName colMap qualifierPrefix sb append filter colMap familyName append append filter colMap qualifierPrefix i append StringUtils COMMA_STR sb append filter colMap familyName append append i append StringUtils COMMA_STR sb append filter colMap familyName append append filter colMap qualifierName append StringUtils COMMA_STR trim sb
SerDeException AvroTableProperties SCHEMA_LITERAL getPropName serdeConstants SERIALIZATION_CLASS schemaUrl schemaLiteral getSchemaFromFS schemaUrl conf toString SerDeException serdeConstants SERIALIZATION_CLASS colMap familyName StringBuilder generatedStruct StringBuilder generateColumnStruct serType serClassName schemaLiteral colMap generatedStruct sb append serdeConstants MAP_TYPE_NAME serdeConstants STRING_TYPE_NAME generatedStruct String qualifierName colMap qualifierName colMap qualifierName qualifierName colMap qualifierName substring colMap qualifierName length String serType tbl getProperty colMap familyName qualifierName HBaseSerDe SERIALIZATION_TYPE serType SerDeException HBaseSerDe SERIALIZATION_TYPE colMap familyName qualifierName
constantVal getConstantVal writable objInspector isBinary String comparisonOp sc getComparisonOp comparisonOp startRow constantVal stopRow getNextBA constantVal comparisonOp stopRow constantVal comparisonOp startRow constantVal comparisonOp startRow getNextBA constantVal comparisonOp stopRow getNextBA constantVal IOException comparisonOp
String filterExprSerialized jobConf get TableScanDesc FILTER_EXPR_CONF_STR filterExprSerialized scan ExprNodeGenericFuncDesc filterExpr SerializationUtilities deserializeExpression filterExprSerialized String keyColName jobConf get serdeConstants LIST_COLUMNS split iKey ArrayList TypeInfo cols TypeInfoUtils getTypeInfosFromTypeString jobConf get serdeConstants LIST_COLUMN_TYPES String colType cols get iKey getTypeName isKeyComparable isKeyBinary equalsIgnoreCase colType String tsColName iTimestamp tsColName jobConf get serdeConstants LIST_COLUMNS split iTimestamp IndexPredicateAnalyzer analyzer newIndexPredicateAnalyzer keyColName isKeyComparable tsColName List IndexSearchCondition conditions ArrayList IndexSearchCondition ExprNodeDesc residualPredicate analyzer analyzePredicate filterExpr conditions residualPredicate
regionFile fs fs rename regionFile getPath Path columnFamilyPath regionFile getPath getName ex IOException ex text IOException String s text toString String fields s split assert fields length columnMap size rowKeyBytes Bytes toBytes fields entry columnMap columnNameBytes entry getKey iColumn entry getValue String val iColumn fields length val
LOG LoggerFactory getLogger HCatCli CliSessionState ss CliSessionState HiveConf SessionState ss in System in ss out SessionStream System out ss err SessionStream System err System exit HiveConf conf ss getConf HiveConf setVar conf ConfVars SEMANTIC_ANALYZER_HOOK HCatSemanticAnalyzer getName String engine HiveConf getVar conf ConfVars HIVE_EXECUTION_ENGINE String MR_ENGINE MR_ENGINE engine HiveConf setVar conf ConfVars HIVE_EXECUTION_ENGINE MR_ENGINE
HiveConf conf HiveConf hiveConf HiveConf conf HCatUtil conf
conf Properties properties conf get HCatConstants HCAT_KEY_HIVE_CONF properties Properties HCatUtil deserialize conf get HCatConstants HCAT_KEY_HIVE_CONF
ICacheableMetaStoreClient ICacheableMetaStoreClient ICacheableMetaStoreClient ICacheableMetaStoreClient notification ICacheableMetaStoreClient hiveMetaStoreClient notification getValue hiveMetaStoreClient
hiveCache cleanUp
HCatRecordObjectInspector typeInfo HCatRecordObjectInspector oi cachedHCatRecordObjectInspectors getIfPresent typeInfo oi
ObjectInspector typeInfo ObjectInspector oi cachedObjectInspectors getIfPresent typeInfo oi
LOG debug
tbl LOG debug LOG debug tbl entrySet String columnNameProperty tbl getProperty serdeConstants LIST_COLUMNS String columnTypeProperty tbl getProperty serdeConstants LIST_COLUMN_TYPES String columnNameDelimiter tbl containsKey serdeConstants COLUMN_NAME_DELIMITER tbl getProperty serdeConstants COLUMN_NAME_DELIMITER String valueOf SerDeUtils COMMA columnNameProperty columnNames ArrayList String columnNames Arrays asList columnNameProperty split columnNameDelimiter columnTypeProperty columnTypes ArrayList TypeInfo columnTypes TypeInfoUtils getTypeInfosFromTypeString columnTypeProperty LOG debug columnNameProperty columnNames
initialize conf tbl jsonSerde initialize conf tbl StructTypeInfo rowTypeInfo jsonSerde getTypeInfo cachedObjectInspector HCatRecordObjectInspectorFactory getHCatRecordObjectInspector rowTypeInfo schema HCatSchemaUtils getHCatSchema rowTypeInfo get getStructSubSchema
initialize conf tbl jsonSerde initialize conf tbl StructTypeInfo rowTypeInfo jsonSerde getTypeInfo cachedObjectInspector HCatRecordObjectInspectorFactory getHCatRecordObjectInspector rowTypeInfo schema HCatSchemaUtils getHCatSchema rowTypeInfo get getStructSubSchema LOG debug schema
close context Reporter reporter InternalUtil createReporter context bwriter bwriter close reporter context abortTask context String OutputJobInfo outputJobInfoEntry String dynKey outputJobInfoEntry getKey OutputJobInfo outputJobInfo outputJobInfoEntry getValue LOG info outputJobInfo getLocation baseDynamicCommitters get dynKey abortTask dynamicContexts get dynKey context String OutputJobInfo outputJobInfoEntry String dynKey outputJobInfoEntry getKey OutputJobInfo outputJobInfo outputJobInfoEntry getValue
abortTask TaskAttemptContext String OutputJobInfo outputJobInfoEntry String dynKey outputJobInfoEntry getKey OutputJobInfo outputJobInfo outputJobInfoEntry getValue LOG info outputJobInfo getLocation baseDynamicCommitters get dynKey abortTask dynamicContexts get dynKey commitTask TaskAttemptContext String OutputJobInfo outputJobInfoEntry String dynKey outputJobInfoEntry getKey OutputJobInfo outputJobInfo outputJobInfoEntry getValue LOG info outputJobInfo getLocation TaskAttemptContext dynContext dynamicContexts get dynKey OutputCommitter dynCommitter baseDynamicCommitters get dynKey dynCommitter dynContext dynCommitter commitTask dynContext
currContext JobConf currContext getConfiguration getOutputCommitter abortJob currContext state e IOException e Path src OutputJobInfo jobInfo HCatOutputFormat getJobInfo jobContext getConfiguration Path tblPath Path jobInfo getTableInfo getTableLocation src Path getPartitionRootLocation jobInfo getLocation jobInfo getTableInfo getTable getPartitionKeysSize src Path getCustomPartitionRootLocation jobInfo jobContext getConfiguration
immutable file file file Path finalOutputPath getFinalPath fs file srcDir destDir immutable FileStatus fileStatus fs getFileStatus file fileStatus immutable LOG LOG debug file finalOutputPath fs finalOutputPath HCatException ErrorType ERROR_MOVE_FAILED finalOutputPath LOG
fs file finalOutputPath HCatException ErrorType ERROR_MOVE_FAILED finalOutputPath FileStatus children fs listStatus file FileStatus firstChild children index index children children index getPath children index getPath children index getPath firstChild children index index firstChild firstChild FileStatus child children moveTaskOutputs fs child getPath srcDir destDir dryRun immutable
String name relativePath getPath String filetype index name lastIndexOf index filetype name substring index name name substring index filetype counter itemDest counter counter itemDest Path dest name APPEND_SUFFIX counter filetype counter HCatException ErrorType ERROR_MOVE_FAILED file src dest counter APPEND_COUNTER_WARN_THRESHOLD LOG warn counter APPEND_COUNTER_WARN_THRESHOLD
partitionsToAdd add constructPartition context jobInfo tblPath toString jobInfo getPartitionValues jobInfo getOutputSchema getStorerParameterMap storer table fs hiveConf status String Map String String entry partitionsToAdd add constructPartition context jobInfo getPartitionRootLocation entry getKey entry getValue size entry getKey entry getValue jobInfo getOutputSchema getStorerParameterMap storer table fs hiveConf status ArrayList Map String String ptnInfos ArrayList Map String String ptn partitionsToAdd ptnInfos add InternalUtil createPtnKeyValueMap Table tableInfo getTable ptn partitionsToAdd Path src Path ptnRootLocation moveTaskOutputs fs src src tblPath moveTaskOutputs fs src src tblPath src tblPath fs delete src
partitionsToAdd Path src Path ptnRootLocation moveTaskOutputs fs src src tblPath moveTaskOutputs fs src src tblPath src tblPath fs delete src moveCustomLocationTaskOutputs fs table hiveConf updateTableSchema client table jobInfo getOutputSchema LOG info table getTableName ptnInfos client add_partitions partitionsToAdd partitionsAdded partitionsToAdd
context LOG info IMetaStoreClient client HiveConf hiveConf HCatUtil getHiveConf context getConfiguration client HCatUtil getHiveMetastoreClient hiveConf String tokenStrForm client getTokenStrForm String hCatKeyTokenSignature context getConfiguration get HCatConstants HCAT_KEY_TOKEN_SIGNATURE tokenStrForm hCatKeyTokenSignature
info schema Properties props getSerdeProperties info schema
credentials outputJobInfo client conf UserGroupInformation UserGroupInformation ugi UserGroupInformation getCurrentUser TokenSelector TokenIdentifier hiveTokenSelector DelegationTokenSelector Token TokenIdentifier hiveToken hiveTokenSelector selectToken Text ugi getTokens LOG info hiveToken hiveToken String tokenSignature getTokenSignature outputJobInfo hiveToken HCatUtil extractThriftToken client getDelegationToken ugi getUserName ugi getUserName tokenSignature TokenSelector TokenIdentifier jtTokenSelector org apache hadoop mapreduce security token delegation DelegationTokenSelector Token jtToken jtTokenSelector selectToken org apache hadoop security SecurityUtil buildTokenService ShimLoader getHadoopShims getHCatShim getResourceManagerAddress conf ugi getTokens jtToken credentials addToken Text HCatUtil getJobTrackerDelegationToken conf ugi getUserName credentials addToken Text ugi getUserName tokenSignature hiveToken
context String key generateKey context
context String key generateKey context
assertTrue e NoSuchObjectException assertEquals e getMessage hcatConf set HCatConstants HCAT_PERMS hcatConf set HCatConstants HCAT_GROUP ret callHCatCli String assertFalse ret msc getTable dbName tblName fail e assertTrue e NoSuchObjectException assertEquals e getMessage dfsPath getFileSystem hcatConf getFileStatus dfsPath fail
ArrayList String driver String String selectCmd driver run selectCmd ArrayList String src_values ArrayList String driver getResults src_values
Configuration conf Configuration Properties HCatRecord e Properties tblProps e getKey HCatRecord r e getValue HCatRecordSerDe hrsd HCatRecordSerDe SerDeUtils initializeSerDe hrsd conf tblProps
Configuration conf Configuration Properties HCatRecord e Properties tblProps e getKey HCatRecord r e getValue HCatRecordSerDe hrsd HCatRecordSerDe SerDeUtils initializeSerDe hrsd conf tblProps LOG info r Writable s hrsd serialize r hrsd getObjectInspector
Configuration conf Configuration Properties HCatRecord e Properties tblProps e getKey HCatRecord r e getValue HCatRecordSerDe hrsd HCatRecordSerDe SerDeUtils initializeSerDe hrsd conf tblProps LOG info r Writable s hrsd serialize r hrsd getObjectInspector LOG info s HCatRecord r2 HCatRecord hrsd deserialize s Assert assertTrue HCatDataCheckUtil recordsEqual r r2 Writable s2 hrsd serialize s hrsd getObjectInspector
HCatRecord r e getValue HCatRecordSerDe hrsd HCatRecordSerDe SerDeUtils initializeSerDe hrsd conf tblProps LOG info r Writable s hrsd serialize r hrsd getObjectInspector LOG info s HCatRecord r2 HCatRecord hrsd deserialize s Assert assertTrue HCatDataCheckUtil recordsEqual r r2 Writable s2 hrsd serialize s hrsd getObjectInspector LOG info s2 Assert assertTrue HCatDataCheckUtil recordsEqual r HCatRecord s Assert assertTrue HCatDataCheckUtil recordsEqual r HCatRecord s2 LazySimpleSerDe testSD LazySimpleSerDe SerDeUtils initializeSerDe testSD conf tblProps Writable s3 testSD serialize s hrsd getObjectInspector
Writable s hrsd serialize r hrsd getObjectInspector LOG info s HCatRecord r2 HCatRecord hrsd deserialize s Assert assertTrue HCatDataCheckUtil recordsEqual r r2 Writable s2 hrsd serialize s hrsd getObjectInspector LOG info s2 Assert assertTrue HCatDataCheckUtil recordsEqual r HCatRecord s Assert assertTrue HCatDataCheckUtil recordsEqual r HCatRecord s2 LazySimpleSerDe testSD LazySimpleSerDe SerDeUtils initializeSerDe testSD conf tblProps Writable s3 testSD serialize s hrsd getObjectInspector LOG info s3 Object o3 testSD deserialize s3 Assert assertFalse r getClass equals o3 getClass HCatRecord s4 HCatRecord hrsd serialize o3 testSD getObjectInspector
HCatRecord r2 HCatRecord hrsd deserialize s Assert assertTrue HCatDataCheckUtil recordsEqual r r2 Writable s2 hrsd serialize s hrsd getObjectInspector LOG info s2 Assert assertTrue HCatDataCheckUtil recordsEqual r HCatRecord s Assert assertTrue HCatDataCheckUtil recordsEqual r HCatRecord s2 LazySimpleSerDe testSD LazySimpleSerDe SerDeUtils initializeSerDe testSD conf tblProps Writable s3 testSD serialize s hrsd getObjectInspector LOG info s3 Object o3 testSD deserialize s3 Assert assertFalse r getClass equals o3 getClass HCatRecord s4 HCatRecord hrsd serialize o3 testSD getObjectInspector LOG info s4 LazyHCatRecord s5 LazyHCatRecord o3 testSD getObjectInspector
Writable s2 hrsd serialize s hrsd getObjectInspector LOG info s2 Assert assertTrue HCatDataCheckUtil recordsEqual r HCatRecord s Assert assertTrue HCatDataCheckUtil recordsEqual r HCatRecord s2 LazySimpleSerDe testSD LazySimpleSerDe SerDeUtils initializeSerDe testSD conf tblProps Writable s3 testSD serialize s hrsd getObjectInspector LOG info s3 Object o3 testSD deserialize s3 Assert assertFalse r getClass equals o3 getClass HCatRecord s4 HCatRecord hrsd serialize o3 testSD getObjectInspector LOG info s4 LazyHCatRecord s5 LazyHCatRecord o3 testSD getObjectInspector LOG info s5 LazyHCatRecord s6 LazyHCatRecord s4 hrsd getObjectInspector
Configuration conf Configuration Properties HCatRecord e Properties tblProps e first HCatRecord r e second HCatRecordSerDe hrsd HCatRecordSerDe SerDeUtils initializeSerDe hrsd conf tblProps JsonSerDe jsde JsonSerDe SerDeUtils initializeSerDe jsde conf tblProps
Configuration conf Configuration Properties HCatRecord e Properties tblProps e first HCatRecord r e second HCatRecordSerDe hrsd HCatRecordSerDe SerDeUtils initializeSerDe hrsd conf tblProps JsonSerDe jsde JsonSerDe SerDeUtils initializeSerDe jsde conf tblProps LOG info r Writable s hrsd serialize r hrsd getObjectInspector
Properties HCatRecord e Properties tblProps e first HCatRecord r e second HCatRecordSerDe hrsd HCatRecordSerDe SerDeUtils initializeSerDe hrsd conf tblProps JsonSerDe jsde JsonSerDe SerDeUtils initializeSerDe jsde conf tblProps LOG info r Writable s hrsd serialize r hrsd getObjectInspector LOG info s HCatRecord o1 HCatRecord hrsd deserialize s StringBuilder msg StringBuilder isEqual HCatDataCheckUtil recordsEqual r o1 assertTrue msg toString isEqual Writable s2 jsde serialize o1 hrsd getObjectInspector
HCatRecord r e second HCatRecordSerDe hrsd HCatRecordSerDe SerDeUtils initializeSerDe hrsd conf tblProps JsonSerDe jsde JsonSerDe SerDeUtils initializeSerDe jsde conf tblProps LOG info r Writable s hrsd serialize r hrsd getObjectInspector LOG info s HCatRecord o1 HCatRecord hrsd deserialize s StringBuilder msg StringBuilder isEqual HCatDataCheckUtil recordsEqual r o1 assertTrue msg toString isEqual Writable s2 jsde serialize o1 hrsd getObjectInspector LOG info s2 HCatRecord o2 HCatRecord jsde deserialize s2
Properties HCatRecord e Properties tblProps e first HCatRecord r e second Properties internalTblProps Properties pe tblProps pe getKey internalTblProps put pe getKey pe getValue internalTblProps put pe getKey getInternalNames String pe getValue LOG info tblProps LOG info internalTblProps JsonSerDe wjsd JsonSerDe SerDeUtils initializeSerDe wjsd conf internalTblProps JsonSerDe rjsd JsonSerDe SerDeUtils initializeSerDe rjsd conf tblProps
HCatRecord r e second Properties internalTblProps Properties pe tblProps pe getKey internalTblProps put pe getKey pe getValue internalTblProps put pe getKey getInternalNames String pe getValue LOG info tblProps LOG info internalTblProps JsonSerDe wjsd JsonSerDe SerDeUtils initializeSerDe wjsd conf internalTblProps JsonSerDe rjsd JsonSerDe SerDeUtils initializeSerDe rjsd conf tblProps LOG info r Writable s wjsd serialize r wjsd getObjectInspector
pe tblProps pe getKey internalTblProps put pe getKey pe getValue internalTblProps put pe getKey getInternalNames String pe getValue LOG info tblProps LOG info internalTblProps JsonSerDe wjsd JsonSerDe SerDeUtils initializeSerDe wjsd conf internalTblProps JsonSerDe rjsd JsonSerDe SerDeUtils initializeSerDe rjsd conf tblProps LOG info r Writable s wjsd serialize r wjsd getObjectInspector LOG info s Object o1 wjsd deserialize s
internalTblProps put pe getKey pe getValue internalTblProps put pe getKey getInternalNames String pe getValue LOG info tblProps LOG info internalTblProps JsonSerDe wjsd JsonSerDe SerDeUtils initializeSerDe wjsd conf internalTblProps JsonSerDe rjsd JsonSerDe SerDeUtils initializeSerDe rjsd conf tblProps LOG info r Writable s wjsd serialize r wjsd getObjectInspector LOG info s Object o1 wjsd deserialize s LOG info o1 Object o2 rjsd deserialize s
String typeString TypeInfo ti TypeInfoUtils getTypeInfoFromTypeString typeString HCatSchema hsch HCatSchemaUtils getHCatSchemaFromTypeString typeString
String typeString TypeInfo ti TypeInfoUtils getTypeInfoFromTypeString typeString HCatSchema hsch HCatSchemaUtils getHCatSchemaFromTypeString typeString LOG info ti getTypeName
HiveConf hc HiveConf getClass maxParts hiveConf getIntVar HiveConf ConfVars DYNAMICPARTITIONMAXPARTS
hiveConf setIntVar HiveConf ConfVars METASTORETHRIFTFAILURERETRIES hiveConf set HiveConf ConfVars SEMANTIC_ANALYZER_HOOK varname HCatSemanticAnalyzer getName hiveConf set HiveConf ConfVars PREEXECHOOKS varname hiveConf set HiveConf ConfVars POSTEXECHOOKS varname hiveConf set HiveConf ConfVars HIVE_SUPPORT_CONCURRENCY varname System setProperty HiveConf ConfVars PREEXECHOOKS varname System setProperty HiveConf ConfVars POSTEXECHOOKS varname System setProperty HiveConf ConfVars METASTOREWAREHOUSE varname MetastoreConf getVar hiveConf MetastoreConf ConfVars WAREHOUSE System setProperty HiveConf ConfVars METASTORECONNECTURLKEY varname MetastoreConf getVar hiveConf MetastoreConf ConfVars CONNECT_URL_KEY System setProperty HiveConf ConfVars METASTOREURIS varname MetastoreConf getVar hiveConf MetastoreConf ConfVars THRIFT_URIS hiveConf set HiveConf ConfVars METASTOREWAREHOUSE varname warehousedir toString hmsc HiveMetaStoreClient hiveConf initalizeTables
String count create String usage
count create String usage args LOG error usage System exit i i args i args i args i count Integer parseInt args i file Path args i file
LOG error usage System exit i i args i args i args i count Integer parseInt args i file Path args i file LOG error usage System exit LOG info count LOG info create
requiredFieldsInfo ArrayList Integer list ArrayList Integer requiredFieldsInfo getFields size rf requiredFieldsInfo getFields list add rf getIndex ColumnProjectionUtils setReadColumns job getConfiguration list outputSchema phutil getHCatSchema requiredFieldsInfo getFields signature getClass HCatInputFormat setOutputSchema job outputSchema e IOException e ColumnProjectionUtils setReadAllColumns job getConfiguration job HCatSchema hcatTableSchema HCatSchema udfProps get HCatConstants HCAT_TABLE_SCHEMA
String tblName String hiveType String String inputValue String String AbstractHCatLoaderTest dropTable tblName driver String field AbstractHCatLoaderTest createTableDefaultDB tblName field hiveType driver storageFormat HcatTestUtils createTestDataFile INPUT_FILE_NAME String inputValue
FrontendException fe logAndRegister server tblName HCatStorer getName HCatStorer ON_OOR_VALUE_OPT goal queryNumber FrontendException e fe e goal fe assertEquals fe getMessage goal logAndRegister server tblName HCatLoader getName queryNumber driver run tblName
logAndRegister server tblName HCatStorer getName HCatStorer ON_OOR_VALUE_OPT goal queryNumber e fe e goal fe assertEquals fe getMessage goal logAndRegister server tblName HCatLoader getName queryNumber driver run tblName e LOG debug e getResponseCode e getMessage tblName List l ArrayList
AbstractHCatLoaderTest createTableDefaultDB tblName driver storageFormat NUM_ROWS String rows String NUM_ROWS i i NUM_ROWS i rows i i HcatTestUtils createTestDataFile INPUT_FILE_NAME rows LOG debug INPUT_FILE_NAME PigServer server createPigServer queryNumber logAndRegister server INPUT_FILE_NAME queryNumber logAndRegister server tblName HCatStorer getName queryNumber logAndRegister server tblName HCatLoader getName queryNumber driver run tblName
i i i rows i i HcatTestUtils createTestDataFile INPUT_FILE_NAME rows LOG debug INPUT_FILE_NAME PigServer server createPigServer queryNumber logAndRegister server INPUT_FILE_NAME queryNumber logAndRegister server tblName HCatStorer getName queryNumber logAndRegister server tblName HCatLoader getName queryNumber driver run tblName e LOG debug e getResponseCode e getMessage List l ArrayList driver getResults l
String fileName File file File fileName BufferedReader reader BufferedReader FileReader file String line
String fileName File file File fileName BufferedReader reader BufferedReader FileReader file String line LOG debug fileName line reader
server setBatchOn server registerQuery tablename pigSchema Schema dumpedASchema server dumpSchema server registerQuery tablename provideSchemaToStorer pigSchema ExecJob execJob server executeBatch get execJob RuntimeException execJob getException server registerQuery tablename server dumpSchema Iterator Tuple it server openIterator i it Tuple input result get i Tuple output it next compareTuples input output
String tblName String tblName2 File dataDir File TEST_DATA_DIR File separator FileUtil fullyDelete dataDir Assert assertTrue dataDir mkdir String INPUT_FILE_NAME dataDir AbstractHCatLoaderTest dropTable tblName driver HcatTestUtils createTestDataFile INPUT_FILE_NAME String AbstractHCatLoaderTest executeStatementOnDriver tblName dataDir toURI getPath driver AbstractHCatLoaderTest dropTable tblName2 driver AbstractHCatLoaderTest createTableDefaultDB tblName2 driver
AbstractHCatLoaderTest executeStatementOnDriver tblName dataDir toURI getPath driver AbstractHCatLoaderTest dropTable tblName2 driver AbstractHCatLoaderTest createTableDefaultDB tblName2 driver LOG debug INPUT_FILE_NAME TestHCatStorer dumpFile INPUT_FILE_NAME PigServer server createPigServer queryNumber logAndRegister server tblName queryNumber logAndRegister server queryNumber logAndRegister server tblName2 queryNumber AbstractHCatLoaderTest executeStatementOnDriver tblName2 driver ArrayList l ArrayList driver getResults l l
sqlGenerator String sequence String s sqlGenerator addForUpdateClause quoteString sequence
PreparedStatement pst ResultSet rs String dbName acidWriteEvent getDatabase String tblName acidWriteEvent getTable String partition acidWriteEvent getPartition String tableObj msg getTableObjStr String partitionObj msg getPartitionObjStr String files ReplChangeManager joinWithSeparator msg getFiles stmt dbConn createStatement sqlGenerator stmt execute String s sqlGenerator addForUpdateClause Long toString acidWriteEvent getTxnId List String params Arrays asList dbName tblName partition pst sqlGenerator prepareStmtWithParameters dbConn s params
nextNLId getNextNLId stmt sqlGenerator s closeStmt pst currentTime now pst dbConn prepareStatement sqlGenerator addEscapeCharacters s pst setLong nextNLId pst setLong acidWriteEvent getTxnId pst setLong acidWriteEvent getWriteId pst setString dbName pst setString tblName pst setString partition pst setString tableObj pst setString partitionObj pst setString files
pst dbConn prepareStatement sqlGenerator addEscapeCharacters s pst setLong nextNLId pst setLong acidWriteEvent getTxnId pst setLong acidWriteEvent getWriteId pst setString dbName pst setString tblName pst setString partition pst setString tableObj pst setString partitionObj pst setString files pst setInt currentTime LOG info s replaceAll nextNLId acidWriteEvent getTxnId acidWriteEvent getWriteId quoteString dbName quoteString tblName quoteString partition quoteString tableObj quoteString partitionObj quoteString files currentTime pst execute String existingFiles rs getString
String existingFiles rs getString existingFiles sqlGenerator addEscapeCharacters files LOG info files nlId rs getLong currentTime now files ReplChangeManager joinWithSeparator Lists newArrayList files existingFiles s closeStmt pst pst dbConn prepareStatement sqlGenerator addEscapeCharacters s pst setString tableObj pst setString partitionObj pst setString files pst setInt currentTime
event event setMessageFormat msgEncoder getMessageFormat
JMSException Destination topic createTopic topicName Message msg session get createTextMessage hCatEventMessage toString msg setStringProperty HCatConstants HCAT_EVENT hCatEventMessage getEventType toString msg setStringProperty HCatConstants HCAT_MESSAGE_VERSION messageFactory getVersion msg setStringProperty HCatConstants HCAT_MESSAGE_FORMAT messageFactory getMessageFormat MessageProducer producer createProducer topic producer send msg session get commit e retries LOG error retries e testAndCreateConnection send hCatEventMessage topicName retries
Connection createConnection LOG info Context jndiCntxt Connection jmsConnection jndiCntxt InitialContext ConnectionFactory connFac ConnectionFactory jndiCntxt lookup jmsConnection connFac createConnection jmsConnection start jmsConnection
LOG info Context jndiCntxt Connection jmsConnection jndiCntxt InitialContext ConnectionFactory connFac ConnectionFactory jndiCntxt lookup jmsConnection connFac createConnection jmsConnection start jmsConnection jmse LOG error jmse e LOG error e e
Connection jmsConnection jndiCntxt InitialContext ConnectionFactory connFac ConnectionFactory jndiCntxt lookup jmsConnection connFac createConnection jmsConnection start jmsConnection jmse LOG error jmse e LOG error e e LOG error e
HCatClient client HCatClient create Configuration hcatConf String dbName String tableName client dropDatabase dbName HCatClient DropDBMode CASCADE client getDatabase dbName assertTrue exception LOG info exception assertTrue exception getClass exception ObjectNotFoundException client createDatabase HCatCreateDBDesc create dbName build client getTable dbName tableName assertTrue exception
client getTable dbName tableName assertTrue exception LOG info exception assertTrue exception getClass exception ObjectNotFoundException String partitionColumn List HCatFieldSchema columns Arrays asList HCatFieldSchema Type STRING ArrayList HCatFieldSchema partitionColumns ArrayList HCatFieldSchema Arrays asList HCatFieldSchema partitionColumn Type STRING HCatTable table HCatTable dbName tableName cols columns partCols partitionColumns client createTable HCatCreateTableDesc create table build HCatTable createdTable client getTable dbName tableName Map String String partitionSpec HashMap String String partitionSpec put partitionColumn client getPartition dbName tableName partitionSpec
ArrayList HCatFieldSchema partitionColumns ArrayList HCatFieldSchema Arrays asList HCatFieldSchema partitionColumn Type STRING HCatTable table HCatTable dbName tableName cols columns partCols partitionColumns client createTable HCatCreateTableDesc create table build HCatTable createdTable client getTable dbName tableName Map String String partitionSpec HashMap String String partitionSpec put partitionColumn client getPartition dbName tableName partitionSpec assertTrue exception LOG info exception assertTrue exception getClass exception ObjectNotFoundException client addPartition HCatAddPartitionDesc create HCatPartition createdTable partitionSpec makePartLocation createdTable partitionSpec build assertEquals client listPartitionsByFilter dbName tableName partitionColumn size
HCatClient client HCatClient create Configuration hcatConf String dbName String tableName client dropDatabase dbName HCatClient DropDBMode CASCADE client createDatabase HCatCreateDBDesc create dbName build String messageBusTopicName Map String String tableProperties HashMap String String tableProperties put HCatConstants HCAT_MSGBUS_TOPIC_NAME messageBusTopicName client createTable HCatCreateTableDesc create dbName tableName Arrays asList HCatFieldSchema Type STRING tblProps tableProperties build assertEquals messageBusTopicName client getMessageBusTopicName dbName tableName client dropDatabase dbName HCatClient DropDBMode CASCADE client close
HCatClient client HCatClient create Configuration hcatConf String dbName String tableName client dropDatabase dbName HCatClient DropDBMode CASCADE client createDatabase HCatCreateDBDesc create dbName build List HCatFieldSchema columnSchema Arrays asList HCatFieldSchema Type INT HCatFieldSchema Type STRING List HCatFieldSchema partitionSchema Arrays asList HCatFieldSchema Type STRING HCatFieldSchema Type STRING client createTable HCatCreateTableDesc create dbName tableName columnSchema partCols partitionSchema build HCatTable table client getTable dbName tableName List HCatFieldSchema partitionColumns table getPartCols assertArrayEquals partitionSchema toArray partitionColumns toArray client dropDatabase dbName HCatClient DropDBMode CASCADE
partitionSpec put partitionSpec put client addPartition HCatAddPartitionDesc create HCatPartition table partitionSpec makePartLocation table partitionSpec build partitionSpec put partitionSpec put client addPartition HCatAddPartitionDesc create HCatPartition table partitionSpec makePartLocation table partitionSpec build Map String String partialPartitionSpec HashMap String String partialPartitionSpec put List HCatPartition partitions client getPartitions dbName tableName partialPartitionSpec assertEquals partitions size assertArrayEquals String partitions get getValues toArray assertArrayEquals String partitions get getValues toArray assertArrayEquals String partitions get getValues toArray client dropDatabase dbName HCatClient DropDBMode CASCADE
partitionSpec put partitionSpec put client addPartition HCatAddPartitionDesc create HCatPartition table partitionSpec makePartLocation table partitionSpec build Map String String partialPartitionSpec HashMap String String partialPartitionSpec put client dropPartitions dbName tableName partialPartitionSpec List HCatPartition partitions client getPartitions dbName tableName assertEquals partitions size assertArrayEquals String partitions get getValues toArray List HCatFieldSchema partColumns partitions get getPartColumns assertEquals partColumns size assertEquals partColumns get getName assertEquals partColumns get getName client dropDatabase dbName HCatClient DropDBMode CASCADE
sourceMetastore addPartition HCatAddPartitionDesc create ptn build sourceMetastore dropPartitions dbName tblName2 ptnDesc sourceMetastore dropTable dbName tblName1 sourceMetastore dropTable dbName tblName2 currId sourceMetastore getCurrentNotificationEventId assertTrue currId baseId currId baseId sourceMetastore n LOG info n getEventId n getEventTime n getEventType n getDbName n getTableName Iterator ReplicationTask taskIter sourceMetastore getReplicationTasks dbName taskIter ReplicationTask task taskIter next
e printStackTrace RuntimeException e sb append command getClass getName sb append command getEventId String s command sb append s sb append sb append command isRetriable sb append command isUndoable command isUndoable String s command sb append s sb append List String locns command cleanupLocationsPerRetry sb append locns size
sb append command getClass getName sb append command getEventId String s command sb append s sb append sb append command isRetriable sb append command isUndoable command isUndoable String s command sb append s sb append List String locns command cleanupLocationsPerRetry sb append locns size String s locns sb append s
tableParams put sourceTable cols newColumnSchema fileFormat tblProps tableParams serdeParam serdeConstants FIELD_DELIM Character toString sourceMetaStore updateTableSchema dbName tableName sourceTable sourceTable sourceMetaStore getTable dbName tableName EnumSet HCatTable TableAttribute diff targetTable diff sourceTable assertTrue diff contains HCatTable TableAttribute COLUMNS assertTrue diff contains HCatTable TableAttribute INPUT_FORMAT assertTrue diff contains HCatTable TableAttribute OUTPUT_FORMAT assertTrue diff contains HCatTable TableAttribute SERDE assertTrue diff contains HCatTable TableAttribute SERDE_PROPERTIES assertTrue diff contains HCatTable TableAttribute TABLE_PROPERTIES targetMetaStore updateTableSchema dbName tableName targetTable resolve sourceTable diff targetTable targetMetaStore getTable dbName tableName assertEquals HCatTable NO_DIFF targetTable diff sourceTable
assertEquals sourcePartitions size List HCatAddPartitionDesc addPartitionDescs ArrayList HCatAddPartitionDesc sourcePartitions size HCatPartition partition sourcePartitions addPartitionDescs add HCatAddPartitionDesc create partition build targetMetaStore addPartitions addPartitionDescs List HCatPartition targetPartitions targetMetaStore getPartitions dbName tableName assertEquals sourcePartitions size targetPartitions size i i targetPartitions size i HCatPartition sourcePartition sourcePartitions get i targetPartition targetPartitions get i assertEquals sourcePartition getColumns targetPartition getColumns assertEquals sourcePartition getInputFormat targetPartition getInputFormat assertEquals sourcePartition getOutputFormat targetPartition getOutputFormat assertEquals sourcePartition getSerDe targetPartition getSerDe assertEquals sourcePartition getSerdeParams targetPartition getSerdeParams
assertEquals sourcePartitionSpec size targetMetaStore addPartitionSpec targetPartitionSpec targetPartitionSpec targetMetaStore getPartitionSpecs dbName tableName assertEquals sourcePartitionSpec size targetPartitionSpec size HCatPartitionSpec HCatPartitionIterator sourceIterator sourcePartitionSpec getPartitionIterator HCatPartitionSpec HCatPartitionIterator targetIterator targetPartitionSpec getPartitionIterator targetIterator hasNext assertTrue sourceIterator hasNext HCatPartition sourcePartition sourceIterator next HCatPartition targetPartition targetIterator next assertEquals sourcePartition getColumns targetPartition getColumns assertEquals sourcePartition getInputFormat targetPartition getInputFormat assertEquals sourcePartition getOutputFormat targetPartition getOutputFormat assertEquals sourcePartition getSerDe targetPartition getSerDe assertEquals sourcePartition getSerdeParams targetPartition getSerdeParams
timeBefore System currentTimeMillis Map NotificationEvent RuntimeException unhandledTasks LinkedHashMap Map NotificationEvent RuntimeException incompatibleTasks LinkedHashMap eventCount
HcatTestUtils createTestDataFile tempLocation data driver run tempLocation dbName tableName driver run dbName tableName List String values ArrayList String driver getResults values assertEquals values size assertEquals data values get assertEquals data values get ExportCommand exportCmd ExportCommand dbName tableName exportLocation evid LOG info exportCmd get get driver run exportCmd get get List String exportPaths exportCmd cleanupLocationsAfterEvent assertEquals exportPaths size String metadata getMetadataContents exportPaths get LOG info
HcatTestUtils createTestDataFile tempLocation data driver run tempLocation dbName tableName driver run dbName tableName List String values ArrayList String driver getResults values assertEquals values size assertEquals data values get assertEquals data values get ExportCommand exportMdCmd ExportCommand dbName tableName exportLocation evid LOG info exportMdCmd get get driver run exportMdCmd get get List String exportPaths exportMdCmd cleanupLocationsAfterEvent assertEquals exportPaths size String metadata getMetadataContents exportPaths get LOG info
evid String exportLocation TEST_PATH File separator String dbName System currentTimeMillis String tableName System currentTimeMillis ExportCommand noopExportCmd ExportCommand dbName tableName exportLocation evid LOG info noopExportCmd get get driver run noopExportCmd get get List String exportPaths noopExportCmd cleanupLocationsAfterEvent assertEquals exportPaths size String metadata getMetadataContents exportPaths get LOG info
dir fname dir File f File dir fname f addResource Path f getAbsolutePath
fname URL x getResource fname x addResource x
doCallback state getId callback cancelMetastoreToken e failed callback id e state setNotifiedTime System currentTimeMillis CompleteBean state close IMetaStoreClient client cancelMetastoreToken String metastoreTokenStrForm DelegationTokenCache getStringFormTokenCache getDelegationToken id metastoreTokenStrForm client HCatUtil getHiveMetastoreClient HiveConf
program args DefaultExecutor executor DefaultExecutor executor setExitValues nbytes appConf getInt AppConfig EXEC_MAX_BYTES_NAME ByteArrayOutputStream outStream MaxByteArrayOutputStream nbytes ByteArrayOutputStream errStream MaxByteArrayOutputStream nbytes executor setStreamHandler PumpStreamHandler outStream errStream timeout appConf getInt AppConfig EXEC_TIMEOUT_NAME ExecuteWatchdog watchdog ExecuteWatchdog timeout executor setWatchdog watchdog CommandLine cmd makeCommandLine program args
ByteArrayOutputStream errStream MaxByteArrayOutputStream nbytes executor setStreamHandler PumpStreamHandler outStream errStream timeout appConf getInt AppConfig EXEC_TIMEOUT_NAME ExecuteWatchdog watchdog ExecuteWatchdog timeout executor setWatchdog watchdog CommandLine cmd makeCommandLine program args LOG info cmd ExecBean res ExecBean res exitcode executor execute cmd execEnv env String enc appConf get AppConfig EXEC_ENCODING_NAME res stdout outStream toString enc res stderr errStream toString enc watchdog checkException
LOG info cmd ExecBean res ExecBean res exitcode executor execute cmd execEnv env String enc appConf get AppConfig EXEC_ENCODING_NAME res stdout outStream toString enc res stderr errStream toString enc watchdog checkException ex LOG error cmd res ex watchdog String msg timeout AppConfig EXEC_TIMEOUT_NAME LOG warn cmd msg res res stderr msg res exitcode
jobExecuteCallable assert jobExecuteCallable assert jobExecutePool String type requestType toString toLowerCase String retryMessageForConcurrentRequests concurrentRequestsConfigName
retryCount retryCount
String user String String String args controllerJob UserGroupInformation ugi ugi UgiFactory getUgi user startTime System nanoTime String id queueAsUser ugi args controllerJob elapsed System nanoTime startTime
currRecord currRecord job job currRecord JobItemBean jobItem JobItemBean jobItem id job StatusDelegator sd StatusDelegator appConf jobItem detail sd run user job
args initLogger conf loadConfig args conf startCleanup
port conf getInt AppConfig PORT DEFAULT_PORT checkEnv runServer port port ArrayUtils isEmpty server getConnectors ServerConnector server getConnectors getLocalPort System out println port
File pwd File pwd String msg System err println msg
String String confEnt confEnt getKey CONF_PROXYUSER_PREFIX confEnt getKey CONF_GROUPS_SUFFIX String proxyUser confEnt getKey substring CONF_PROXYUSER_PREFIX length confEnt getKey lastIndexOf CONF_GROUPS_SUFFIX Set String groups confEnt groups WILD_CARD
String String confEnt confEnt getKey CONF_PROXYUSER_PREFIX confEnt getKey CONF_GROUPS_SUFFIX String proxyUser confEnt getKey substring CONF_PROXYUSER_PREFIX length confEnt getKey lastIndexOf CONF_GROUPS_SUFFIX Set String groups confEnt getValue groups WILD_CARD LOG LOG debug proxyUser confEnt getValue confEnt getValue trim length groups HashSet String Arrays asList confEnt getValue trim split LOG LOG debug proxyUser confEnt getValue trim groups Collections emptySet LOG
confEnt getValue confEnt getValue trim length groups HashSet String Arrays asList confEnt getValue trim split LOG LOG debug proxyUser confEnt getValue trim groups Collections emptySet LOG LOG debug proxyUser proxyUserGroups put proxyUser groups confEnt getKey CONF_PROXYUSER_PREFIX confEnt getKey CONF_HOSTS_SUFFIX String proxyUser confEnt getKey substring CONF_PROXYUSER_PREFIX length confEnt getKey lastIndexOf CONF_HOSTS_SUFFIX Set String hosts confEnt getValue hosts WILD_CARD LOG
groups Collections emptySet LOG LOG debug proxyUser proxyUserGroups put proxyUser groups confEnt getKey CONF_PROXYUSER_PREFIX confEnt getKey CONF_HOSTS_SUFFIX String proxyUser confEnt getKey substring CONF_PROXYUSER_PREFIX length confEnt getKey lastIndexOf CONF_HOSTS_SUFFIX Set String hosts confEnt getValue hosts WILD_CARD LOG LOG debug proxyUser confEnt getValue confEnt getValue trim length String hostValues confEnt getValue trim split hosts HashSet String String hostValues
proxyUserGroups put proxyUser groups confEnt getKey CONF_PROXYUSER_PREFIX confEnt getKey CONF_HOSTS_SUFFIX String proxyUser confEnt getKey substring CONF_PROXYUSER_PREFIX length confEnt getKey lastIndexOf CONF_HOSTS_SUFFIX Set String hosts confEnt getValue hosts WILD_CARD LOG LOG debug proxyUser confEnt getValue confEnt getValue trim length String hostValues confEnt getValue trim split hosts HashSet String String hostname hostValues String nhn normalizeHostname hostname nhn hosts add nhn
proxyUser proxyHost doAsUser assertNotEmpty proxyUser CONF_PROXYUSER_PREFIX CONF_HOSTS_SUFFIX CONF_PROXYUSER_PREFIX CONF_GROUPS_SUFFIX assertNotEmpty proxyHost CONF_PROXYUSER_PREFIX proxyUser CONF_HOSTS_SUFFIX CONF_PROXYUSER_PREFIX proxyUser CONF_GROUPS_SUFFIX assertNotEmpty doAsUser Server DO_AS_PARAM
String user conf LOG info user UserGroupInformation getLoginUser getUserName UserGroupInformation ugi UgiFactory getUgi user TokenWrapper twrapper TokenWrapper ugi Credentials creds Credentials collectTokens FileSystem get conf twrapper creds ugi getShortUserName Collection String URIs conf getStringCollection String URIs
HiveConf c HiveConf IMetaStoreClient client HCatUtil getHiveMetastoreClient c
fs Path storage_root getFileSystem appConf checkFiles fs e LOG error e getMessage fs fs close e LOG error e getMessage sleepMillis Math random interval LOG info Date Date getTime sleepMillis Thread sleep sleepMillis e isRunning
type id key BufferedReader in Path p Path getPath type id key p
BufferedReader in Path p Path getPath type id key fs p LOG debug p in BufferedReader InputStreamReader fs open p String line String val line in val val val line val
conf startTime String launchTimeStr conf get JobSubmissionConstants TEMPLETON_JOB_LAUNCH_TIME_NAME
String var conf String filenames TempletonUtils decodeArray conf get var filenames String filename filenames Path src Path filename Path dst Path src getName FileSystem fs src getFileSystem conf
conf startTime getTempletonLaunchTime conf UserGroupInformation ugi UserGroupInformation getCurrentUser WebHCatJTShim tracker ShimLoader getHadoopShims getWebHCatShim conf ugi Set String childJobs tracker getJobs context getJobID toString startTime childJobs LOG info childJobs LOG warn String format Arrays toString childJobs toArray String childJobIdString childJobs iterator next org apache hadoop mapred JobID childJobId org apache hadoop mapred JobID forName childJobIdString
WebHCatJTShim tracker ShimLoader getHadoopShims getWebHCatShim conf ugi Set String childJobs tracker getJobs context getJobID toString startTime childJobs LOG info childJobs LOG warn String format Arrays toString childJobs toArray String childJobIdString childJobs iterator next org apache hadoop mapred JobID childJobId org apache hadoop mapred JobID forName childJobIdString LOG info String format childJobIdString updateJobStatePercentAndChildId conf context getJobID toString childJobIdString org apache hadoop mapred JobStatus jobStatus tracker getJobStatus childJobId
killLauncherChildJobs conf context getJobID toString Process proc startJob context context getJobID toString conf get conf get OVERRIDE_CLASSPATH jobType JobState state JobState context getJobID toString conf state setJobType jobType toString state close ExecutorService pool Executors newCachedThreadPool executeWatcher pool conf context getJobID proc getInputStream statusdir STDOUT_FNAME executeWatcher pool conf context getJobID proc getErrorStream statusdir STDERR_FNAME KeepAlive keepAlive startCounterKeepAlive pool context proc waitFor keepAlive sendReport pool shutdown pool pool shutdownNow
conf statusdir jobId exitCode writeExitValue conf exitCode statusdir JobState state JobState jobId conf state setExitValue exitCode state setCompleteStatus state close exitCode
conf statusdir statusdir Path p Path statusdir EXIT_FNAME FileSystem fs p getFileSystem conf OutputStream out fs create p
job setMapOutputValueClass Text job setInputFormatClass SingleInputFormat NullOutputFormat NullWritable NullWritable of NullOutputFormat NullWritable NullWritable job setOutputFormatClass of getClass job setNumReduceTasks JobClient jc JobClient JobConf job getConfiguration Token DelegationTokenIdentifier mrdt jc getDelegationToken Text job getCredentials addToken Text mrdt LauncherDelegator JobType jobType LauncherDelegator JobType valueOf conf get JOB_TYPE String tokenStrForm jobType LauncherDelegator JobType tokenStrForm addToken job user SecureProxySupport HIVE_SERVICE tokenStrForm addToken job user SecureProxySupport HCAT_SERVICE
HiveConf c HiveConf
HiveConf c HiveConf
LOG info
cmd LOG info LOG info cmd ProcessBuilder pb ProcessBuilder cmd pb
msg props StringBuilder sb TempletonUtils dumpPropMap msg props
CuratorFramework zk List String nodes isRunning zk ZooKeeperStorage zkOpen appConf nodes getChildList zk String node nodes deleted checkAndDelete node zk deleted zk close
nodes getChildList zk node nodes deleted checkAndDelete node zk deleted zk close e LOG error e getMessage zk zk close sleepMillis Math random interval LOG info Date Date getTime sleepMillis Thread sleep sleepMillis e isRunning
JobState state JobStateTracker tracker JobStateTracker node zk appConf get TempletonStorage STORAGE_ROOT ZooKeeperStorage TRACKINGDIR now Date getTime state JobState tracker getJobID appConf then state getCreated then state getCreated now then LOG info tracker getJobID state delete tracker delete
jobRunnable currentId jobRunnable threadStartCount incrementAndGet
jobRunnable currentId jobRunnable threadStartCount incrementAndGet LOG info currentId currentId
threadCount appConfig answer StatusDelegator delegator StatusDelegator appConfig StatusDelegator mockDelegator Mockito spy delegator doAnswer answer when mockDelegator getJobStatus any String any String threadId waitForAllThreadsToStart threadCount
threadCount config answer ListDelegator delegator ListDelegator config ListDelegator mockDelegator Mockito spy delegator doAnswer answer when mockDelegator listJobs any String any any String any any threadId waitForAllThreadsToStart threadCount
threadCount config responseAnswer timeoutResponseAnswer String jobIdResponse LauncherDelegator delegator LauncherDelegator config LauncherDelegator mockDelegator Mockito spy delegator List String listArgs ArrayList String TempletonControllerJob mockCtrl Mockito mock TempletonControllerJob doReturn jobIdResponse when mockCtrl getSubmittedId doReturn mockCtrl when mockDelegator getTempletonController doAnswer responseAnswer when mockDelegator runTempletonControllerJob any TempletonControllerJob any List doAnswer timeoutResponseAnswer when mockDelegator killJob any String any String doNothing when mockDelegator registerJob any String any String any String any threadId waitForAllThreadsToStart threadCount
MetaStoreTestUtils MetaStoreTestUtils webhcatPort LOG warn webhcatPort webhcatPort MetaStoreTestUtils findFreePort templetonBaseUrl templetonBaseUrl replace Integer toString webhcatPort templetonServer Main String AppConfig UNIT_TEST_MODE AppConfig PORT webhcatPort LOG info webhcatPort templetonServer run LOG info webhcatStarted
Map String Object props HashMap String Object props put Map String Object col HashMap String Object col put col put List Map String Object colList ArrayList Map String Object colList add col props put colList Map String Object format HashMap String Object format put props put format MethodCallRetVal createTbl doHttpCall templetonBaseUrl HTTP_METHOD_TYPE PUT props Assert assertEquals createTbl getAssertMsg HttpStatus OK_200 createTbl httpStatusCode
String msgBody JsonBuilder mapToJson data LOG info msgBody StringRequestEntity sre StringRequestEntity msgBody charSet PutMethod method setRequestEntity sre params method setQueryString NameValuePair NameValuePair username NameValuePair newParams NameValuePair params length System arraycopy params newParams params length newParams NameValuePair username method setQueryString newParams String actualUri
String dbName String basetblName Map String Object tProps HashMap buckets String tblName basetblName tProps put dbName tProps put tblName tProps put TableType EXTERNAL_TABLE tProps put buckets StringBuilder properties StringBuilder properties append append append tProps put properties toString Table tbl createTableWithCapabilities tProps Table tbl2 client getTable dbName tblName
resetHMSClient String dbName String basetblName Map String Object tProps HashMap String tblName basetblName tProps put dbName tProps put tblName tProps put TableType MANAGED_TABLE Table tbl createTableWithCapabilities tProps Table tbl2 client getTable dbName tblName
String dbName String basetblName Map String Object tProps HashMap String tblName basetblName tProps put dbName tProps put tblName tProps put TableType VIRTUAL_VIEW StringBuilder properties StringBuilder tProps put properties toString Table tbl createTableWithCapabilities tProps Table tbl2 client getTable dbName tblName
resetHMSClient String dbName String basetblName Map String Object tProps HashMap String tblName basetblName tProps put dbName tProps put tblName tProps put TableType MATERIALIZED_VIEW StringBuilder properties StringBuilder tProps put properties toString Table tbl createTableWithCapabilities tProps Table tbl2 client getTable dbName tblName
StringBuilder table_params StringBuilder List String capabilities ArrayList TableType type TableType EXTERNAL_TABLE capabilities add capabilities add capabilities add capabilities add capabilities add tProps put capabilities tProps put count tProps put type setHMSClient String capabilities toArray String List String tables createTables tProps requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields PROCESSOR_CAPABILITIES bitValue List ExtendedTableInfo extTables client getTablesExt dbName requestedFields
tProps put capabilities tProps put count tProps put type setHMSClient String capabilities toArray String List String tables createTables tProps requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields PROCESSOR_CAPABILITIES bitValue List ExtendedTableInfo extTables client getTablesExt dbName requestedFields LOG debug extTables size requestedFields assertEquals count extTables size ExtendedTableInfo tableInfo extTables assertNull tableInfo getRequiredReadCapabilities assertNull tableInfo getRequiredWriteCapabilities assertEquals tableInfo getAccessType requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields ACCESS_TYPE bitValue extTables client getTablesExt dbName requestedFields
assertEquals count extTables size tableInfo extTables assertNull tableInfo getRequiredReadCapabilities assertNull tableInfo getRequiredWriteCapabilities assertEquals tableInfo getAccessType requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields ACCESS_TYPE bitValue extTables client getTablesExt dbName requestedFields LOG debug extTables size requestedFields assertEquals count extTables size tableInfo extTables assertNull tableInfo getRequiredReadCapabilities assertNull tableInfo getRequiredWriteCapabilities assertTrue tableInfo getAccessType requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields ALL bitValue extTables client getTablesExt dbName requestedFields
requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields ACCESS_TYPE bitValue extTables client getTablesExt dbName requestedFields LOG debug extTables size requestedFields assertEquals count extTables size tableInfo extTables assertNull tableInfo getRequiredReadCapabilities assertNull tableInfo getRequiredWriteCapabilities assertTrue tableInfo getAccessType requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields ALL bitValue extTables client getTablesExt dbName requestedFields LOG debug extTables size requestedFields assertEquals count extTables size tableInfo extTables assertTrue tableInfo getAccessType extTables client getTablesExt dbName requestedFields count
tableInfo extTables assertNull tableInfo getRequiredReadCapabilities assertNull tableInfo getRequiredWriteCapabilities assertTrue tableInfo getAccessType requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields ALL bitValue extTables client getTablesExt dbName requestedFields LOG debug extTables size requestedFields assertEquals count extTables size tableInfo extTables assertTrue tableInfo getAccessType extTables client getTablesExt dbName requestedFields count LOG debug extTables size requestedFields assertEquals count extTables size tableInfo extTables assertTrue tableInfo getAccessType
i i pCount i partValues add i List Partition parts client getPartitionsByNames dbName tblName partValues assertEquals pCount parts size tblName StringBuilder properties StringBuilder properties append append append properties append properties append CAPABILITIES_KEY append append tProps put tblName tProps put TableType EXTERNAL_TABLE tProps put bucketCount tProps put properties toString table createTableWithCapabilities tProps parts client getPartitionsByNames dbName tblName partValues
table_params append table_params append tProps put table_params toString table createTableWithCapabilities tProps fail tblName LOG info capabilities ArrayList capabilities add setHMSClient String capabilities toArray String table createTableWithCapabilities tProps fail
table_params StringBuilder table_params append table_params append table_params append table_params append table_params append CAPABILITIES_KEY append append append tProps put table_params toString table createTableWithCapabilities tProps fail tblName LOG info tblName tProps put tblName capabilities ArrayList
fail tblName resetHMSClient tblName type TableType MANAGED_TABLE tProps put tblName tProps put type table_params StringBuilder table_params append table_params append table_params append table_params append table_params append tProps put table_params toString
capabilities add tProps put catalog tProps put sparkDbName tProps put tblName type TableType MANAGED_TABLE tProps put count tProps put type table_params StringBuilder table_params append table_params append tProps put table_params toString setHMSClient String capabilities toArray String List String tables createTables tProps requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields PROCESSOR_CAPABILITIES bitValue List ExtendedTableInfo extTables client getTablesExt catalog sparkDbName requestedFields
table_params append table_params append tProps put table_params toString setHMSClient String capabilities toArray String List String tables createTables tProps requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields PROCESSOR_CAPABILITIES bitValue List ExtendedTableInfo extTables client getTablesExt catalog sparkDbName requestedFields LOG debug extTables size requestedFields assertEquals count extTables size ExtendedTableInfo tableInfo extTables assertNull tableInfo getRequiredReadCapabilities assertNull tableInfo getRequiredWriteCapabilities assertEquals tableInfo getAccessType requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields ACCESS_TYPE bitValue extTables client getTablesExt catalog sparkDbName requestedFields
requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields PROCESSOR_CAPABILITIES bitValue List ExtendedTableInfo extTables client getTablesExt catalog sparkDbName requestedFields LOG debug extTables size requestedFields assertEquals count extTables size ExtendedTableInfo tableInfo extTables assertNull tableInfo getRequiredReadCapabilities assertNull tableInfo getRequiredWriteCapabilities assertEquals tableInfo getAccessType requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields ACCESS_TYPE bitValue extTables client getTablesExt catalog sparkDbName requestedFields LOG debug extTables size requestedFields assertEquals count extTables size ExtendedTableInfo tableInfo extTables assertNull tableInfo getRequiredReadCapabilities assertNull tableInfo getRequiredWriteCapabilities
assertNull tableInfo getRequiredReadCapabilities assertNull tableInfo getRequiredWriteCapabilities assertEquals tableInfo getAccessType requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields ACCESS_TYPE bitValue extTables client getTablesExt catalog sparkDbName requestedFields LOG debug extTables size requestedFields assertEquals count extTables size tableInfo extTables assertNull tableInfo getRequiredReadCapabilities assertNull tableInfo getRequiredWriteCapabilities assertTrue tableInfo getAccessType requestedFields GetTablesRequestBuilder with GetTablesExtRequestFields ALL bitValue extTables client getTablesExt catalog sparkDbName requestedFields LOG debug extTables size requestedFields assertEquals count extTables size
String propArray properties split String prop propArray String keyValue prop split table_params put keyValue keyValue Catalog cat cat client getCatalog catalog LOG info cat cat Catalog cat setName catalog toLowerCase Warehouse wh Warehouse conf cat setLocationUri wh getWhRootExternal toString File separator catalog
cat cat Catalog cat setName catalog toLowerCase Warehouse wh Warehouse conf cat setLocationUri wh getWhRootExternal toString File separator catalog cat setDescription client createCatalog cat LOG info catalog LOG warn catalog e LOG error e client dropTable dbName tblName
searchHousekeepingThreads
searchHousekeepingThreads
searchHousekeepingThreads
String propArray properties split String prop propArray String keyValue prop split table_params put keyValue keyValue Catalog cat cat client getCatalog catalog LOG debug cat cat Catalog cat setName catalog toLowerCase Warehouse wh Warehouse conf cat setLocationUri wh getWhRootExternal toString File separator catalog
cat cat Catalog cat setName catalog toLowerCase Warehouse wh Warehouse conf cat setLocationUri wh getWhRootExternal toString File separator catalog cat setDescription client createCatalog cat LOG debug catalog LOG warn catalog e LOG error e client dropTable dbName tblName
String Set String String replicaDbName replicaDbName replicaDbName toLowerCase String event Set String dbsForEvent replicatedDbsForEvents get event
Map String Set String eventsMap prepareBootstrapData primaryDbName primary run primaryDbName dump primaryDbName replica load replicatedDbName primaryDbName ReplMetaStoreEventListenerTestImpl checkEventSanity eventsMap replicatedDbName ReplMetaStoreEventListenerTestImpl clearSanityData eventsMap prepareIncData primaryDbName LOG info testName getMethodName WarehouseInstance Tuple incre primary run primaryDbName dump primaryDbName replica load replicatedDbName primaryDbName ReplMetaStoreEventListenerTestImpl checkEventSanity eventsMap replicatedDbName ReplMetaStoreEventListenerTestImpl clearSanityData eventsMap prepareInc2Data primaryDbName
String dbName String withClauseOptions String withClause getWithClause withClauseOptions advanceDumpDir String dumpCmd dbName withClause run dumpCmd driver String dumpLocation getResult driver String lastReplId getResult driver
String unptn_locn Path TEST_PATH name toUri getPath String ptn_locn_1 Path TEST_PATH name toUri getPath String ptn_locn_2 Path TEST_PATH name toUri getPath createTestDataFile unptn_locn unptn_data createTestDataFile ptn_locn_1 ptn_data_1 createTestDataFile ptn_locn_2 ptn_data_2 run unptn_locn dbName driver verifySetup dbName unptn_data driver run ptn_locn_1 dbName driver verifySetup dbName ptn_data_1 driver run ptn_locn_2 dbName driver verifySetup dbName ptn_data_2 driver advanceDumpDir
table injectionPathCalled nonInjectedPathCalled table InjectableBehaviourObjectStore setGetTableBehaviour ptnedTableNuller run dbName driver ptnedTableNuller assertInjectionsPerformed InjectableBehaviourObjectStore resetGetTableBehaviour String replDumpLocn getResult driver String replDumpId getResult driver
InjectableBehaviourObjectStore setGetTableBehaviour ptnedTableNuller run dbName driver ptnedTableNuller assertInjectionsPerformed InjectableBehaviourObjectStore resetGetTableBehaviour String replDumpLocn getResult driver String replDumpId getResult driver LOG info replDumpLocn replDumpId run dbName replDbName driverMirror verifyRun replDbName unptn_data driverMirror verifyFail replDbName driverMirror verifyIfTableNotExist replDbName metaStoreClient run dbName driver
verifySetup dbName ptn_data_2 driver advanceDumpDir String String listPartitionNamesNuller String String String String injectionPathCalled ArrayList String InjectableBehaviourObjectStore setListPartitionNamesBehaviour listPartitionNamesNuller run dbName driver listPartitionNamesNuller assertInjectionsPerformed InjectableBehaviourObjectStore resetListPartitionNamesBehaviour String replDumpLocn getResult driver String replDumpId getResult driver
listPartitionNamesNuller assertInjectionsPerformed InjectableBehaviourObjectStore resetListPartitionNamesBehaviour String replDumpLocn getResult driver String replDumpId getResult driver LOG info replDumpLocn replDumpId run dbName replDbName driverMirror verifyRun replDbName empty driverMirror verifyRun replDbName empty driverMirror verifyIfPartitionNotExist replDbName ArrayList Arrays asList metaStoreClientMirror verifyIfPartitionNotExist replDbName ArrayList Arrays asList metaStoreClientMirror run dbName driver run dbName driver advanceDumpDir run dbName driver
injectionPathCalled t run LOG info IDriver driver2 DriverFactory newDriver hconf SessionState start CliSessionState hconf driver2 run dbName driver2 run dbName dbName e RuntimeException e LOG info t start
nonInjectedPathCalled injectionPathCalled t run LOG info IDriver driver2 DriverFactory newDriver hconf SessionState start CliSessionState hconf driver2 run dbName e RuntimeException e LOG info t start
run dbName unptn_data driver Tuple incrementalDump replDumpDb dbName String incrementalDumpLocn incrementalDump dumpLocation Path dumpPath Path incrementalDumpLocn FileSystem fs dumpPath getFileSystem hconf FileStatus dirsInLoadPath fs listStatus dumpPath EximUtil getDirectoryFilter fs Arrays sort dirsInLoadPath EventDumpDirComparator nextEventId FileStatus dir dirsInLoadPath Path srcPath dir getPath nextEventId nextEventId Math pow srcPath getName length Path destPath Path srcPath getParent String valueOf nextEventId fs rename srcPath destPath
verifyRun replDbName ptn_data_2 driverMirror verifyRun replDbName ptn_data_1 driverMirror verifyRun replDbName ptn_data_2 driverMirror run dbName dbName driver run dbName dbName driver run dbName dbName driver verifySetup dbName unptn_data driver verifySetup dbName ptn_data_1 driver run dbName driver run dbName driver run dbName driver advanceDumpDir run dbName driver String postDropReplDumpLocn getResult driver String postDropReplDumpId getResult driver
String testName
String testName
run dbName replDbName driverMirror driverMirror close Path warehouse Path System getProperty FileSystem fs FileSystem get warehouse toUri hconf Path path Path warehouse replDbName Path SEPARATOR tableName fs path filter Path path path getName startsWith HiveConf getVar hconf HiveConf ConfVars STAGINGDIR FileStatus statuses fs listStatus path filter assertEquals statuses length
String testName String dbName createDB testName driver String replDbName dbName run dbName driver run dbName driver run dbName driver Tuple bootstrapDump replDumpDb dbName advanceDumpDir run dbName driver String replDumpLocn bootstrapDump dumpLocation String replDumpId bootstrapDump lastReplId run dbName driver
String myDriver List String results getOutput myDriver
String data myDriver List String results getOutput myDriver LOG info data
WarehouseInstance Tuple bootstrapDump prepareDataAndDump primaryDbName replica load replicatedDbName primaryDbName verifyLoadExecution replicatedDbName bootstrapDump lastReplicationId prepareIncNonAcidData primaryDbName prepareIncAcidData primaryDbName LOG info testName getMethodName WarehouseInstance Tuple incDump primary run primaryDbName dump primaryDbName replica load replicatedDbName primaryDbName verifyIncLoad replicatedDbName incDump lastReplicationId prepareInc2NonAcidData primaryDbName primary hiveConf prepareInc2AcidData primaryDbName primary hiveConf
nonInjectedPathCalled injectionPathCalled t run LOG info IDriver driver DriverFactory newDriver primaryConf SessionState start CliSessionState primaryConf driver run primaryDbName e RuntimeException e LOG info t start
injectionPathCalled t run LOG info IDriver driver DriverFactory newDriver primaryConf SessionState start CliSessionState primaryConf driver run primaryDbName driver run primaryDbName e RuntimeException e LOG info t start
WarehouseInstance Tuple bootstrapDump prepareDataAndDump primaryDbName dumpWithoutAcidClause LOG info testName getMethodName replica load replicatedDbName primaryDbName verifyLoadExecution replicatedDbName bootstrapDump lastReplicationId prepareIncAcidData primaryDbName prepareIncNonAcidData primaryDbName
WarehouseInstance Tuple bootstrapDump prepareDataAndDump primaryDbName dumpWithoutAcidClause LOG info testName getMethodName replica load replicatedDbName primaryDbName verifyLoadExecution replicatedDbName bootstrapDump lastReplicationId prepareIncAcidData primaryDbName prepareIncNonAcidData primaryDbName LOG info testName getMethodName WarehouseInstance Tuple incrementalDump primary run primaryDbName dump primaryDbName dumpWithAcidBootstrapClause replica load replicatedDbName primaryDbName verifyIncLoad replicatedDbName incrementalDump lastReplicationId String hiveDumpLocation incrementalDump dumpLocation File separator ReplUtils REPL_HIVE_BASE_DIR replica verifyIfCkptSetForTables replicatedDbName acidTableNames hiveDumpLocation prepareInc2AcidData primaryDbName primary hiveConf prepareInc2NonAcidData primaryDbName primary hiveConf
WarehouseInstance Tuple bootstrapDump prepareDataAndDump primaryDbName dumpWithoutAcidClause LOG info testName getMethodName replica load replicatedDbName primaryDbName verifyLoadExecution replicatedDbName bootstrapDump lastReplicationId prepareIncAcidData primaryDbName prepareIncNonAcidData primaryDbName
verifyLoadExecution replicatedDbName bootstrapDump lastReplicationId prepareIncAcidData primaryDbName prepareIncNonAcidData primaryDbName LOG info testName getMethodName WarehouseInstance Tuple incDump primary run primaryDbName dump primaryDbName dumpWithAcidBootstrapClause callerVerifier args args tblName args dbName replicatedDbName injectionPathCalled LOG warn args dbName args tblName InjectableBehaviourObjectStore setAlterTableModifier callerVerifier
LOG warn args dbName args tblName InjectableBehaviourObjectStore setAlterTableModifier callerVerifier LOG info testName getMethodName replica loadFailure replicatedDbName primaryDbName callerVerifier assertInjectionsPerformed InjectableBehaviourObjectStore resetAlterTableModifier replica load replicatedDbName primaryDbName verifyIncLoad replicatedDbName incDump lastReplicationId prepareInc2AcidData primaryDbName primary hiveConf prepareInc2NonAcidData primaryDbName primary hiveConf
InjectableBehaviourObjectStore setAlterTableModifier callerVerifier LOG info testName getMethodName replica loadFailure replicatedDbName primaryDbName callerVerifier assertInjectionsPerformed InjectableBehaviourObjectStore resetAlterTableModifier replica load replicatedDbName primaryDbName verifyIncLoad replicatedDbName incDump lastReplicationId prepareInc2AcidData primaryDbName primary hiveConf prepareInc2NonAcidData primaryDbName primary hiveConf LOG info testName getMethodName WarehouseInstance Tuple inc2Dump primary run primaryDbName dump primaryDbName dumpWithAcidClause
injectionPathCalled nonInjectedPathCalled injectionPathCalled t LOG info prepareInc2NonAcidData primaryDbName primary hiveConf prepareInc2AcidData primaryDbName primary hiveConf t Assert assertNull t LOG info t start
t start LOG info t getName t join e RuntimeException e input InjectableBehaviourObjectStore setGetCurrentNotificationEventIdBehaviour callerInjectedBehavior WarehouseInstance Tuple incDump incDump primary dump primaryDbName dumpWithAcidBootstrapClause callerInjectedBehavior assertInjectionsPerformed
t start LOG info t getName t join e RuntimeException e input InjectableBehaviourObjectStore setGetCurrentNotificationEventIdBehaviour callerInjectedBehavior WarehouseInstance Tuple incDump incDump primary dump primaryDbName dumpWithAcidBootstrapClause callerInjectedBehavior assertInjectionsPerformed InjectableBehaviourObjectStore resetGetCurrentNotificationEventIdBehaviour
InjectableBehaviourObjectStore setCallerVerifier callerVerifier List String withConfigs Arrays asList replica loadFailure replicatedDbName primaryDbName withConfigs callerVerifier assertInjectionsPerformed InjectableBehaviourObjectStore resetCallerVerifier replica run replicatedDbName run replicatedDbName verifyResult run replicatedDbName verifyResult replicatedDbName funcName1 callerVerifier args injectionPathCalled args dbName replicatedDbName LOG warn String valueOf args dbName
List String dumpWithClause ReplicationTestUtils externalTableWithClause ArrayList List String loadWithClause ReplicationTestUtils includeExternalTableClause WarehouseInstance Tuple tupleBootstrap primary run primaryDbName run run dump primaryDbName dumpWithClause replica load replicatedDbName primaryDbName loadWithClause primary run primaryDbName run run
List String dumpWithClause ReplicationTestUtils includeExternalTableClause List String loadWithClause ReplicationTestUtils includeExternalTableClause WarehouseInstance Tuple tupleBootstrap primary run primaryDbName run run dump primaryDbName dumpWithClause replica load replicatedDbName primaryDbName loadWithClause primary run primaryDbName run run
replicateAndVerify replPolicy replicatedTables ex LOG info ex getMessage Assert assertTrue ex ParseException failed Assert assertTrue failed String replPolicy primaryDbName WarehouseInstance Tuple tupleBootstrap primary run primaryDbName dump primaryDbName replica load replicatedDbName primaryDbName String lastReplId tupleBootstrap lastReplicationId String oldReplPolicy failed replicateAndVerify replPolicy oldReplPolicy lastReplId replicatedTables ex
WarehouseInstance Tuple tupleBootstrap primary run primaryDbName dump primaryDbName replica load replicatedDbName primaryDbName String lastReplId tupleBootstrap lastReplicationId String oldReplPolicy failed replicateAndVerify replPolicy oldReplPolicy lastReplId replicatedTables ex LOG info ex getMessage Assert assertTrue ex ParseException failed Assert assertTrue failed String oldReplPolicy replPolicy replPolicy primaryDbName failed
Assert assertTrue ex ParseException failed Assert assertTrue failed String oldReplPolicy replPolicy replPolicy primaryDbName failed replicateAndVerify replPolicy oldReplPolicy lastReplId replicatedTables ex LOG info ex getMessage Assert assertTrue ex SemanticException failed Assert assertTrue failed invalidReplPolicies String primaryDbName primaryDbName String invalidReplPolicies
String List String results getOutput
String data List String results getOutput logger info StringUtils join data
String List String results getOutput
String data List String results getOutput logger info StringUtils join data
List List String results getOutput
List data List String results getOutput logger info StringUtils join data
String YarnClient yarnClient YarnClient createYarnClient yarnClient init conf yarnClient start List ApplicationReport applicationReports yarnClient getApplications String diagnosticsMessage ApplicationReport applicationReports
reset mockedAuthorizer status driver compile acidTableName assertEquals status Pair List HivePrivilegeObject List HivePrivilegeObject io getHivePrivilegeObjectInputs List HivePrivilegeObject outputs io getRight HivePrivilegeObject tableObj outputs get
reset mockedAuthorizer status driver compile acidTableName assertEquals status Pair List HivePrivilegeObject List HivePrivilegeObject io getHivePrivilegeObjectInputs List HivePrivilegeObject outputs io getRight HivePrivilegeObject tableObj outputs get
String tblName String tblNameStg tblName List String colNames Arrays asList executeStatementOnDriver tblName driver executeStatementOnDriver tblNameStg driver executeStatementOnDriver tblName driver executeStatementOnDriver tblNameStg stagingFolder newFolder toURI getPath driver executeStatementOnDriver BASIC_FILE_NAME tblNameStg driver execSelectAndDumpData tblNameStg driver tblNameStg executeStatementOnDriver tblNameStg tblName driver executeStatementOnDriver tblNameStg tblName driver execSelectAndDumpData tblName driver tblName TxnStore txnHandler TxnUtils getTxnStore conf CompactionInfo ci CompactionInfo tblName CompactionType MAJOR
List String colNames Arrays asList executeStatementOnDriver tblName driver executeStatementOnDriver tblNameStg driver executeStatementOnDriver tblName driver executeStatementOnDriver tblNameStg stagingFolder newFolder toURI getPath driver executeStatementOnDriver BASIC_FILE_NAME tblNameStg driver execSelectAndDumpData tblNameStg driver tblNameStg executeStatementOnDriver tblNameStg tblName driver executeStatementOnDriver tblNameStg tblName driver execSelectAndDumpData tblName driver tblName TxnStore txnHandler TxnUtils getTxnStore conf CompactionInfo ci CompactionInfo tblName CompactionType MAJOR LOG debug txnHandler findColumnsWithStats ci Worker StatsUpdater su Worker StatsUpdater init ci colNames conf System getProperty su gatherStats
executeStatementOnDriver tblNameStg driver executeStatementOnDriver tblName driver executeStatementOnDriver tblNameStg stagingFolder newFolder toURI getPath driver executeStatementOnDriver BASIC_FILE_NAME tblNameStg driver execSelectAndDumpData tblNameStg driver tblNameStg executeStatementOnDriver tblNameStg tblName driver executeStatementOnDriver tblNameStg tblName driver execSelectAndDumpData tblName driver tblName TxnStore txnHandler TxnUtils getTxnStore conf CompactionInfo ci CompactionInfo tblName CompactionType MAJOR LOG debug txnHandler findColumnsWithStats ci Worker StatsUpdater su Worker StatsUpdater init ci colNames conf System getProperty su gatherStats LOG debug txnHandler findColumnsWithStats ci CompactionInfo ciPart2 CompactionInfo tblName CompactionType MAJOR
executeStatementOnDriver BASIC_FILE_NAME tblNameStg driver execSelectAndDumpData tblNameStg driver tblNameStg executeStatementOnDriver tblNameStg tblName driver executeStatementOnDriver tblNameStg tblName driver execSelectAndDumpData tblName driver tblName TxnStore txnHandler TxnUtils getTxnStore conf CompactionInfo ci CompactionInfo tblName CompactionType MAJOR LOG debug txnHandler findColumnsWithStats ci Worker StatsUpdater su Worker StatsUpdater init ci colNames conf System getProperty su gatherStats LOG debug txnHandler findColumnsWithStats ci CompactionInfo ciPart2 CompactionInfo tblName CompactionType MAJOR LOG debug txnHandler findColumnsWithStats ci su Worker StatsUpdater init ciPart2 colNames conf System getProperty su gatherStats
String String selectStmt driver String executeStatementOnDriver selectStmt driver ArrayList String valuesReadFromHiveDriver ArrayList String driver getResults valuesReadFromHiveDriver rowIdx
ByteArrayOutputStream os ByteArrayOutputStream PrintStream beelineOutputStream PrintStream os beeLine setOutputStream beelineOutputStream beeLine setErrorStream beelineOutputStream String args argList toArray String argList size prompt inputStream ByteArrayInputStream prompt getBytes Assert assertTrue beeLine begin args inputStream maxColumnWidth beeLine getOpts getMaxColumnWidth Assert assertTrue expectedMaxColumnWidth maxColumnWidth maxColumnWidth expectedMaxColumnWidth hiveConfKey String hiveConfValue beeLine getOpts getHiveConfVariables get hiveConfKey Assert assertTrue expectedHiveConfValue hiveConfValue hiveConfKey expectedHiveConfValue equalsIgnoreCase hiveConfValue String output os toString
String String String String testName getTestName start System currentTimeMillis
selStmt setQueryTimeout queryTimeoutSecs setCmd selStmt execute setCmd selStmt execute query SQLException e throwable e selStmt close expect assertNull throwable assertNotNull throwable assertEquals SQLException throwable getClass assertTrue expect throwable getMessage throwable getMessage contains expect end System currentTimeMillis
assertEquals count e String msg e LOG info msg e fail msg res stmt executeQuery dataTypeTableName count res res findColumn res findColumn count assertEquals count e String msg e
stmt executeQuery sql List String logs stmt getQueryLog stmt close verifyFetchedLog logs expectedLogs HiveStatement statement HiveStatement con createStatement assertNotNull statement statement setFetchSize List String incrementalLogs ArrayList String statement incrementalLogs addAll statement getQueryLog Thread sleep
verifyFetchedLog logs expectedLogs HiveStatement statement HiveStatement con createStatement assertNotNull statement statement setFetchSize List String incrementalLogs ArrayList String statement incrementalLogs addAll statement getQueryLog Thread sleep e LOG info e getMessage fail e
Connection con1 DriverManager getConnection miniHS2directUrl1 System getProperty ExceptionHolder tKillHolder ExceptionHolder Statement stmt con1 createStatement String queryId
execCommand String cmd exitCode String output Shell execCommand cmd
Assume assumeTrue System getProperty toLowerCase contains SSLTestUtils setSslConfOverlay confOverlay SSLTestUtils setBinaryConfOverlay confOverlay miniHS2 start confOverlay hs2Conn DriverManager getConnection miniHS2 getJdbcURL dataFileDir File separator TRUST_STORE_NAME KEY_STORE_TRUST_STORE_PASSWORD System getProperty hs2Conn close Assert assertEquals execCommand miniHS2 getHost miniHS2 getBinaryPort Assert assertEquals execCommand miniHS2 getHost miniHS2 getBinaryPort miniHS2 stop SSLTestUtils setHttpConfOverlay confOverlay miniHS2 start confOverlay hs2Conn DriverManager getConnection miniHS2 getJdbcURL dataFileDir File separator TRUST_STORE_NAME KEY_STORE_TRUST_STORE_PASSWORD System getProperty Assert fail
assertEquals count e String msg e LOG info msg e fail msg res stmt executeQuery dataTypeTableName count res res findColumn res findColumn count assertEquals count e String msg e
stmt executeQuery sql List String logs stmt getQueryLog stmt close verifyFetchedLog logs expectedLogs HiveStatement statement HiveStatement con createStatement assertNotNull statement statement setFetchSize List String incrementalLogs ArrayList String statement incrementalLogs addAll statement getQueryLog Thread sleep
verifyFetchedLog logs expectedLogs HiveStatement statement HiveStatement con createStatement assertNotNull statement statement setFetchSize List String incrementalLogs ArrayList String statement incrementalLogs addAll statement getQueryLog Thread sleep e LOG error e getMessage fail e
String message CoreCliDriver getName System currentTimeMillis
Stopwatch sw Stopwatch createStarted skipped failed
qt failedQuery e getCause e getResponseCode fname QTestUtil DEBUG_HINT setupAdditionalPartialMasks QTestProcessExecResult result qt checkCliDriverResults fname resetAdditionalPartialMasks result getReturnCode failed String message Strings isNullOrEmpty result getCapturedOutput QTestUtil DEBUG_HINT result getCapturedOutput qt failedDiff result getReturnCode fname message e skipped e e failed qt failedWithException e fname QTestUtil DEBUG_HINT
startTime System currentTimeMillis
qt cliInit File fpath qt executeClient fname e qt failedQuery e getCause e getResponseCode fname QTestUtil DEBUG_HINT QTestProcessExecResult result qt checkCliDriverResults fname result getReturnCode String message Strings isNullOrEmpty result getCapturedOutput QTestUtil DEBUG_HINT result getCapturedOutput qt failedDiff result getReturnCode fname message e e e qt failedWithException e fname QTestUtil DEBUG_HINT elapsedTime System currentTimeMillis startTime String message fname elapsedTime
MiniLlapCluster MiniLlapCluster llapCluster
String url conf get conn DriverManager getConnection url props ResultSet rs Statement s conn createStatement LOG LOG debug String mdbPath HiveTestEnvSetup HIVE_ROOT BufferedReader br BufferedReader FileReader File HiveTestEnvSetup HIVE_ROOT String command s execute s execute command br command LOG
LOG debug String mdbPath HiveTestEnvSetup HIVE_ROOT BufferedReader br BufferedReader FileReader File HiveTestEnvSetup HIVE_ROOT String command s execute s execute command br command LOG LOG debug command PreparedStatement psCommand conn prepareStatement command substring command length psCommand execute psCommand close LOG
LOG debug command br close java nio file Path tabColStatsCsv FileSystems getDefault getPath mdbPath java nio file Path tabParamsCsv FileSystems getDefault getPath mdbPath java nio file Path tmpFileLoc1 FileSystems getDefault getPath tmpBaseDir java nio file Path tmpFileLoc2 FileSystems getDefault getPath tmpBaseDir MyComp String String str1 String str2 str2 length str1 length str2 length str1 length str1 compareTo str2 SortedMap String Integer tableNameToID TreeMap String Integer MyComp rs s executeQuery rs String tblName rs getString
conf conf setVar ConfVars METASTOREDBTYPE getDbTypeConfString MetastoreConf setVar conf MetastoreConf ConfVars CONNECT_URL_KEY rule getJdbcUrl MetastoreConf setVar conf MetastoreConf ConfVars CONNECTION_DRIVER rule getJdbcDriver MetastoreConf setVar conf MetastoreConf ConfVars CONNECTION_USER_NAME rule getHiveUser MetastoreConf setVar conf MetastoreConf ConfVars PWD rule getHivePassword MetastoreConf setBoolVar conf MetastoreConf ConfVars AUTO_CREATE_ALL
String classpath System getProperty String classpathEntries classpath split File pathSeparator
File cleanupFile File cleanupScript cleanupFile String cleanupCommands FileUtils readFileToString cleanupFile
ecode String fname String debugHint String command SessionState get SessionState get getLastCommand String message ecode command command fname debugHint debugHint
ecode String fname String debugHint String message ecode fname debugHint debugHint
e ecode String fname String debugHint String command SessionState get SessionState get getLastCommand String message String format ecode command command fname debugHint debugHint e org apache hadoop util StringUtils stringifyException e
table cliDriver CommandProcessorResponse result cliDriver processLine table
Set String scheduledQueries ScheduledQueryCreationRegistryHook getSchedules String name scheduledQueries ScheduledQueryMaintenanceRequest request ScheduledQueryMaintenanceRequest request setType ScheduledQueryMaintenanceRequestType DROP ScheduledQuery schq ScheduledQuery schq setScheduleKey ScheduledQueryKey name qt getConf getVar ConfVars HIVE_SCHEDULED_QUERIES_NAMESPACE request setScheduledQuery schq HiveConf conf qt getConf Hive db Hive get conf db getMSC scheduledQueryMaintenance request db close
splits JdbcInputSplit FileInputFormat getInputPaths job splits intervals get setLeft intervals get intervals size setRight splits InputSplit intervals size i i intervals size i splits i JdbcInputSplit partitionColumn intervals get i getLeft intervals get i getRight tablePaths numRecords dbAccessor getTotalNumberOfRecords job numRecords numPartitions numPartitions numRecords numRecordsPerSplit numRecords numPartitions numSplitsWithExtraRecords numRecords numPartitions LOGGER debug numRecords splits InputSplit numPartitions
SerDeException hiveColumnTypesList size SerDeException numColumns hiveColumnNames length dbRecordWritable DBRecordWritable numColumns hiveColumnTypes PrimitiveTypeInfo hiveColumnTypesList size List ObjectInspector fieldInspectors ArrayList hiveColumnNames length i i hiveColumnNames length i TypeInfo ti hiveColumnTypesList get i ti SerDeException hiveColumnTypes i PrimitiveTypeInfo ti fieldInspectors add PrimitiveObjectInspectorFactory getPrimitiveJavaObjectInspector hiveColumnTypes i inspector ObjectInspectorFactory getStandardStructObjectInspector Arrays asList hiveColumnNames fieldInspectors row ArrayList hiveColumnNames length
classesToLoad add Class forName classesToLoad add Class forName classesToLoad add Class forName classesToLoad add Class forName JarUtils addDependencyJars conf classesToLoad
props DatabaseType dbType DatabaseType valueOf props getProperty JdbcStorageConfig DATABASE_TYPE getPropertyName
String conf Connection conn PreparedStatement ps ResultSet rs initializeDatabaseConnection conf String query JdbcStorageConfigManager getOrigQueryToExecute conf String metadataQuery getMetaDataQuery query
initializeDatabaseConnection conf String query JdbcStorageConfigManager getOrigQueryToExecute conf String metadataQuery getMetaDataQuery query LOGGER debug metadataQuery conn dbcpDataSource getConnection ps conn prepareStatement metadataQuery rs ps executeQuery ResultSetMetaData metadata rs getMetaData numColumns metadata getColumnCount List String columnNames ArrayList String numColumns i i numColumns i columnNames add metadata getColumnName i columnNames
conf Connection conn PreparedStatement ps ResultSet rs initializeDatabaseConnection conf String sql JdbcStorageConfigManager getQueryToExecute conf String countQuery sql
initializeDatabaseConnection conf String sql JdbcStorageConfigManager getQueryToExecute conf String countQuery sql LOGGER info countQuery conn dbcpDataSource getConnection ps conn prepareStatement countQuery rs ps executeQuery rs rs getInt LOGGER warn countQuery HiveJdbcDatabaseAccessException HiveJdbcDatabaseAccessException he he
initializeDatabaseConnection conf String tableName conf get Constants JDBC_TABLE String sql JdbcStorageConfigManager getQueryToExecute conf String partitionQuery partitionColumn partitionQuery addBoundaryToQuery tableName sql partitionColumn lowerBound upperBound partitionQuery addLimitAndOffsetToQuery sql limit offset LOGGER info partitionQuery conn dbcpDataSource getConnection ps conn prepareStatement partitionQuery ResultSet TYPE_FORWARD_ONLY ResultSet CONCUR_READ_ONLY ps setFetchSize getFetchSize conf rs ps executeQuery JdbcRecordIterator conn ps rs conf
ResultSet rs Preconditions checkArgument retrieveMin retrieveMax initializeDatabaseConnection conf String sql JdbcStorageConfigManager getOrigQueryToExecute conf String minClause quote partitionColumn quote String maxClause quote partitionColumn quote String countQuery retrieveMin countQuery minClause retrieveMax retrieveMin countQuery countQuery maxClause countQuery sql quote partitionColumn quote
FileInputStream input FileInputStream file br BufferedReader InputStreamReader input String line StringBuilder sb StringBuilder line br line line trim line line line line line concat sb append line initSqlList getInitSql sb toString
SQLException statement HiveStatement operationStatus operationStatus operationStatus HiveStatement statement waitForOperationToComplete TFetchOrientation orientation TFetchOrientation FETCH_NEXT fetchFirst orientation TFetchOrientation FETCH_FIRST fetchedRows fetchedRowsItr fetchFirst fetchedRows fetchedRowsItr TFetchResultsReq fetchReq TFetchResultsReq stmtHandle orientation fetchSize
String sql checkConnection reInitState TExecuteStatementReq execReq TExecuteStatementReq sessHandle sql execReq setRunAsync execReq setConfOverlay sessConf execReq setQueryTimeout queryTimeout TExecuteStatementResp execResp client ExecuteStatement execReq Utils verifySuccessWithInfo execResp getStatus List String infoMessages execResp getStatus getInfoMessages infoMessages String infoMessages
connParams ZooKeeperHiveClientHelper configureConnParams connParams String authorityStr connParams getHost connParams getPort
connParams connParams getRejectedHostZnodePaths add connParams getCurrentHostZnodePath String oldServerHost connParams getHost oldServerPort connParams getPort ZooKeeperHiveClientHelper configureConnParams connParams connParams setJdbcUriString connParams getJdbcUriString replace oldServerHost oldServerPort connParams getHost connParams getPort
List String connParams zooKeeperClient String zookeeperNamespace getZooKeeperNamespace connParams String zkPath ZKPaths makePath zookeeperNamespace List String serverHosts zooKeeperClient getChildren forPath zkPath
registryConf set HiveConf ConfVars HIVE_ZOOKEEPER_QUORUM varname connParams getZooKeeperEnsemble registryConf set HiveConf ConfVars HIVE_SERVER2_ACTIVE_PASSIVE_HA_REGISTRY_NAMESPACE varname getZooKeeperNamespace connParams HS2ActivePassiveHARegistry haRegistryClient HS2ActivePassiveHARegistryClient getClient registryConf foundLeader String maxRetriesConf connParams getSessionVars get JdbcConnectionParams RETRIES maxRetries StringUtils isEmpty maxRetriesConf Integer parseInt maxRetriesConf retries sleepMs foundLeader retries maxRetries hiveServer2Instance haRegistryClient hiveServer2Instance foundLeader connParams setHost hiveServer2Instance getHost connParams setPort hiveServer2Instance getRpcPort String mode hiveServer2Instance getTransportMode equals hiveServer2Instance getHttpEndpoint hiveServer2Instance getTransportMode
foundLeader String maxRetriesConf connParams getSessionVars get JdbcConnectionParams RETRIES maxRetries StringUtils isEmpty maxRetriesConf Integer parseInt maxRetriesConf retries sleepMs foundLeader retries maxRetries hiveServer2Instance hiveServer2Instance foundLeader connParams setHost hiveServer2Instance getHost connParams setPort hiveServer2Instance getRpcPort String mode hiveServer2Instance getTransportMode equals hiveServer2Instance getHttpEndpoint hiveServer2Instance getTransportMode LOG info hiveServer2Instance getHost hiveServer2Instance getRpcPort hiveServer2Instance getWorkerIdentity mode String serverConfStr Joiner on withKeyValueSeparator join hiveServer2Instance getProperties LOG
producerId epoch Preconditions checkState producerId epoch producerId epoch
List KafkaInputSplit configuration ExecutorService execService Executors newSingleThreadExecutor consumer configuration String topic configuration get KafkaTableProperties HIVE_KAFKA_TOPIC getName timeoutMs configuration getLong KafkaTableProperties KAFKA_FETCH_METADATA_TIMEOUT getName maxTries configuration getInt KafkaTableProperties MAX_RETRIES getName JobConf jobConf JobConf configuration Path tablePaths org apache hadoop mapred FileInputFormat getInputPaths jobConf Future List KafkaInputSplit futureFullHouse futureFullHouse execService submit buildFullScanFromKafka topic consumer tablePaths maxTries List KafkaInputSplit fullHouse fullHouse futureFullHouse get timeoutMs TimeUnit MILLISECONDS futureFullHouse cancel
Future List KafkaInputSplit futureFullHouse futureFullHouse execService submit buildFullScanFromKafka topic consumer tablePaths maxTries List KafkaInputSplit fullHouse fullHouse futureFullHouse get timeoutMs TimeUnit MILLISECONDS e futureFullHouse cancel LOG error e IOException e SuppressWarnings ImmutableMap Builder TopicPartition KafkaInputSplit fullHouseMapBuilder ImmutableMap Builder fullHouse forEach input fullHouseMapBuilder put TopicPartition input getTopic input getPartition input KafkaScanTrimmer kafkaScanTrimmer KafkaScanTrimmer fullHouseMapBuilder build consumer String filterExprSerialized configuration get TableScanDesc FILTER_EXPR_CONF_STR filterExprSerialized filterExprSerialized ExprNodeGenericFuncDesc filterExpr SerializationUtilities deserializeExpression filterExprSerialized
futureFullHouse cancel LOG error e IOException e SuppressWarnings ImmutableMap Builder TopicPartition KafkaInputSplit fullHouseMapBuilder ImmutableMap Builder fullHouse forEach input fullHouseMapBuilder put TopicPartition input getTopic input getPartition input KafkaScanTrimmer kafkaScanTrimmer KafkaScanTrimmer fullHouseMapBuilder build consumer String filterExprSerialized configuration get TableScanDesc FILTER_EXPR_CONF_STR filterExprSerialized filterExprSerialized ExprNodeGenericFuncDesc filterExpr SerializationUtilities deserializeExpression filterExprSerialized LOG info filterExpr getExprString Callable List KafkaInputSplit trimmerWorker kafkaScanTrimmer computeOptimizedScan filterExpr entrySet stream map Map Entry getValue collect Collectors toList Future List KafkaInputSplit futureTinyHouse execService submit trimmerWorker futureTinyHouse get timeoutMs TimeUnit MILLISECONDS stream filter split split getStartOffset split getEndOffset collect Collectors toList e
LOG info Properties properties KafkaUtils consumerProperties config String brokerString properties getProperty CommonClientConfigs BOOTSTRAP_SERVERS_CONFIG Preconditions checkNotNull brokerString
inputSplit jobConf config jobConf startOffset inputSplit getStartOffset endOffset inputSplit getEndOffset TopicPartition topicPartition TopicPartition inputSplit getTopic inputSplit getPartition Preconditions checkState startOffset startOffset endOffset startOffset endOffset totalNumberRecords endOffset startOffset initConsumer pollTimeout config getLong KafkaTableProperties KAFKA_POLL_TIMEOUT getName
SerDeException delegateSerDe getObjectInspector getClass getName delegateDeserializerOI StructObjectInspector delegateSerDe getObjectInspector columnNames addAll delegateDeserializerOI getAllStructFieldRefs stream map StructField getFieldName collect Collectors toList columnNames addAll MetadataColumn KAFKA_METADATA_COLUMN_NAMES List ObjectInspector inspectors ArrayList columnNames size inspectors addAll delegateDeserializerOI getAllStructFieldRefs stream map StructField getFieldObjectInspector collect Collectors toList inspectors addAll MetadataColumn KAFKA_METADATA_INSPECTORS objectInspector ObjectInspectorFactory getStandardStructObjectInspector columnNames inspectors metadataStartIndex columnNames size MetadataColumn values length delegateSerDe bytesConverter TextBytesConverter delegateSerDe String schemaFromProperty tbl getProperty AvroSerdeUtils AvroTableProperties SCHEMA_LITERAL getPropName Preconditions checkArgument schemaFromProperty isEmpty Schema schema AvroSerdeUtils getSchemaFor schemaFromProperty
props setProperty props setProperty String principalHost HiveConf getVar configuration HiveConf ConfVars HIVE_SERVER2_KERBEROS_PRINCIPAL String keyTab HiveConf getVar configuration HiveConf ConfVars HIVE_SERVER2_KERBEROS_KEYTAB principalHost principalHost keyTab keyTab keyTab HiveConf getVar configuration HiveConf ConfVars LLAP_FS_KERBEROS_KEYTAB_FILE principalHost HiveConf getVar configuration HiveConf ConfVars LLAP_FS_KERBEROS_PRINCIPAL String principal principal SecurityUtil getServerPrincipal principalHost e log error e RuntimeException e String jaasConf String format JAAS_TEMPLATE keyTab principal props setProperty jaasConf
e LOG error writerIdTopicId e getMessage producer close DURATION_0 LOG info writerIdTopicId producer flush String formattedMsg String flushedOffsetMsg offsets entrySet stream map topicPartitionLongEntry String format formattedMsg topicPartitionLongEntry getKey topic topicPartitionLongEntry getKey partition topicPartitionLongEntry getValue collect Collectors joining LOG info writerIdTopicId flushedOffsetMsg checkExceptions commitTransaction persistTxState checkExceptions
io ReaderEvent event getReaderEvent event event io event io io close
attemptNum retryDelay determineRetryDelay
externalRpcEndpoint getExternalRpcEndpoint daemonZkRecord addExternalEndpoint externalRpcEndpoint populateConfigValues conf Map String String capacityValues HashMap capacityValues put LlapRegistryService LLAP_DAEMON_NUM_ENABLED_EXECUTORS HiveConf getVarWithoutType conf ConfVars LLAP_DAEMON_NUM_EXECUTORS capacityValues put LlapRegistryService LLAP_DAEMON_TASK_SCHEDULER_ENABLED_WAIT_QUEUE_SIZE HiveConf getVarWithoutType conf ConfVars LLAP_DAEMON_TASK_SCHEDULER_WAIT_QUEUE_SIZE populateConfigValues capacityValues entrySet String uniqueId UNIQUE_ID toString znodeCreationTimeout initializeWithoutRegisteringInternal slotZnode SlotZnode zooKeeperClient workersPath SLOT_PREFIX WORKER_PREFIX uniqueId slotZnode znodeCreationTimeout Exception znodeCreationTimeout Exception
String uniqueId UNIQUE_ID toString znodeCreationTimeout initializeWithoutRegisteringInternal slotZnode SlotZnode zooKeeperClient workersPath SLOT_PREFIX WORKER_PREFIX uniqueId slotZnode znodeCreationTimeout Exception znodeCreationTimeout Exception e LOG error e CloseableUtils closeQuietly slotZnode stop e IOException IOException e IOException e registerServiceRecord daemonZkRecord uniqueId LOG info rpcEndpoint externalRpcEndpoint getShuffleEndpoint getServicesEndpoint getMngEndpoint getRegistrationZnodePath
windowEnd windowStart IllegalArgumentException windowStart windowEnd lockWindowEnd lockWindowEnd DistributedAtomicLong zooKeeperClient String join workersPath substring workersPath lastIndexOf CONFIG_CHANGE_PATH CONFIG_CHANGE_NODE i j sleeper lockWindowEnd initialize AtomicValue Long current lockWindowEnd get current LOG debug ConfigChangeLockResult current postValue windowStart LOG debug windowStart windowEnd current postValue ConfigChangeLockResult current postValue current lockWindowEnd compareAndSet current postValue windowEnd current
approxWorkerCount child child prefix child approxWorkerCount slots add Integer parseInt child substring prefix length Iterator Integer slotIter slots iterator slotToTake slotIter nextTaken slotIter next slotToTake nextTaken slotToTake nextTaken slotToTake currentSlot shouldFallBackOnCollision approxWorkerCount fallbackCount
isActive String createPath createPath getSlotPath currentSlot
event event getType EventType NodeDeleted String localPath nodePath get localPath localPath event
event doesExist event getResultCode KeeperException Code NODEEXISTS intValue doesExist event getResultCode KeeperException Code intValue
Token LlapTokenIdentifier appId user isSignatureRequired Token LlapTokenIdentifier token secretManager createLlapToken appId user isSignatureRequired
srv UnsupportedOperationException srv srv ServiceRecord Endpoint rpcEndpoint RegistryTypeUtils ipcEndpoint IPC_TEZCLIENT InetSocketAddress hostname amPort srv addInternalEndpoint rpcEndpoint Endpoint pluginEndpoint pluginPort pluginEndpoint RegistryTypeUtils ipcEndpoint IPC_PLUGIN InetSocketAddress hostname pluginPort srv addInternalEndpoint pluginEndpoint srv set AM_SESSION_ID sessionId hasToken serializedToken srv set AM_PLUGIN_TOKEN hasToken serializedToken srv set AM_PLUGIN_JOBID jobIdForToken jobIdForToken srv set AM_GUARANTEED_COUNT Integer toString guaranteedCount String uniqueId registerServiceRecord srv
znode PersistentNode zooKeeperClient CreateMode EPHEMERAL_SEQUENTIAL workersPath workerNodePrefix encoder toBytes srv znode start znodeCreationTimeout znode znodeCreationTimeout Exception znodeCreationTimeout znodePath znode getActualPath checkAndSetAcls Exception ex IOException disableMessage ex zooKeeperClient znodePath Exception Exception
childData data getWorkerData childData workerNodePrefix data String nodeName extractNodeName childData isLlapWorker nodeName workerNodePrefix ephSeqVersion extractSeqNum nodeName ServiceRecord srv encoder fromBytes childData getPath data InstanceType instance createServiceInstance srv addToCache childData getPath instance getHost instance InstanceType listener listener onCreate instance ephSeqVersion
Set InstanceType host Set InstanceType byHost nodeToInstanceCache get host byHost byHost Sets newHashSet byHost
instancesCache instancesCache ExecutorService tp Executors newFixedThreadPool ThreadFactoryBuilder setDaemon setNameFormat build startTimeNs System nanoTime deltaNs clusterReadyTimeoutMs sleepTimeMs Math min clusterReadyTimeoutMs instancesCache PathChildrenCache zooKeeperClient workersPath instancesCache getListenable addListener InstanceStateChangeListener tp instancesCache start PathChildrenCache StartMode BUILD_INITIAL_CACHE instancesCache instancesCache instancesCache CloseableUtils closeQuietly instancesCache elapsedNs System nanoTime startTimeNs deltaNs deltaNs elapsedNs
e CloseableUtils closeQuietly instancesCache elapsedNs System nanoTime startTimeNs deltaNs deltaNs elapsedNs LOG error e IOException e LOG warn Thread sleep Math min sleepTimeMs deltaNs elapsedNs e1 LOG error IOException e1 sleepTimeMs sleepTimeMs e CloseableUtils closeQuietly instancesCache
CuratorFramework curator newCurator ExecutorService executor Executors newFixedThreadPool nodeCount CountDownLatch cdlIn CountDownLatch nodeCount cdlOut CountDownLatch SuppressWarnings FutureTask SlotZnode startTasks FutureTask nodeCount i i nodeCount i curator create creatingParentsIfNeeded forPath PATH i ix i startTasks i FutureTask SlotZnode SlotZnode SlotZnode node createZnode curator SlotZnode syncThreadStart cdlIn cdlOut id System identityHashCode node LOG info id ix result node start TimeUnit SECONDS
i i startTasks length i executor execute startTasks i cdlIn await cdlOut countDown found nodeCount totalFallbackCount i i startTasks length i SlotZnode node startTasks i get assertNotNull i node totalFallbackCount node getFallbackCount slot node getCurrentSlot assertTrue slot found length assertFalse found slot found slot
nodeId String hostId getHostIdentifier nodeId getHostname nodeId getPort
LOG LOG debug nodeId createProtocolImpl getConfig nodeId getHostname nodeId getPort retryPolicy socketFactory token tokenUser AssertionError token String tokenUser tokenUser getTokenUser nodeToken tokenUser tokenUser tokenUser UserGroupInformation getCurrentUser getShortUserName LOG warn tokenUser UserGroupInformation ugi UserGroupInformation createRemoteUser tokenUser nodeToken nodeToken Token TokenType token SecurityUtil setTokenService nodeToken NetUtils createSocketAddrForHost nodeId getHostname nodeId getPort ugi addToken nodeToken LOG
String conf String String localDirList HiveConf getVar conf ConfVars LLAP_DAEMON_WORK_DIRS localDirList localDirList
service service
String principalUser LlapUtil getUserNameFromPrincipal conf get SecretManager ZK_DTSM_ZK_KERBEROS_PRINCIPAL
expectedRenewTimeSec conf getLong DelegationTokenManager RENEW_INTERVAL
expectedRenewTimeSec conf getLong DelegationTokenManager RENEW_INTERVAL LOG info expectedRenewTimeSec expectedRenewTimeSec java lang reflect Field f Class c org apache hadoop security token delegation AbstractDelegationTokenSecretManager f c getDeclaredField f setAccessible t LOG error t realValue f getLong expectedValue expectedRenewTimeSec
ArrowWrapperWritable batchData ArrowWrapperWritable data batchSize rowIndex batchSize batchSize rowIndex batchSize data List FieldVector vectors batchData getVectorSchemaRoot getFieldVectors Preconditions checkState vectors size batchSize vectors get getValueCount ArrowWrapperWritable wrapper ArrowWrapperWritable batchData getVectorSchemaRoot currentBatch Object serde deserialize wrapper StructObjectInspector rowOI StructObjectInspector serde getObjectInspector setRowFromStruct value currentBatch rowIndex rowOI
split job LlapInputSplit llapSplit LlapInputSplit split HiveConf setVar job HiveConf ConfVars LLAP_ZK_REGISTRY_USER llapSplit getLlapUser SubmitWorkInfo submitWorkInfo SubmitWorkInfo fromBytes llapSplit getPlanBytes LlapDaemonInfo llapDaemonInfo llapSplit getLlapDaemonInfos String host llapDaemonInfo getHost outputPort llapDaemonInfo getOutputFormatPort llapSubmitPort llapDaemonInfo getRpcPort
Token LlapTokenIdentifier llapToken llapTokenBytes DataInputBuffer in DataInputBuffer in reset llapTokenBytes llapTokenBytes length llapToken Token LlapTokenIdentifier llapToken readFields in LlapRecordReaderTaskUmbilicalExternalResponder umbilicalResponder LlapRecordReaderTaskUmbilicalExternalResponder LlapTaskUmbilicalExternalClient llapClient LlapTaskUmbilicalExternalClient job submitWorkInfo getTokenIdentifier submitWorkInfo getToken umbilicalResponder llapToken attemptNum taskNum TaskAttemptID taskAttemptId TaskAttemptID forName job get MRJobConfig TASK_ATTEMPT_ID taskAttemptId attemptNum taskAttemptId getId taskNum taskAttemptId getTaskID getId
LlapRecordReaderTaskUmbilicalExternalResponder umbilicalResponder LlapRecordReaderTaskUmbilicalExternalResponder LlapTaskUmbilicalExternalClient llapClient LlapTaskUmbilicalExternalClient job submitWorkInfo getTokenIdentifier submitWorkInfo getToken umbilicalResponder llapToken attemptNum taskNum TaskAttemptID taskAttemptId TaskAttemptID forName job get MRJobConfig TASK_ATTEMPT_ID taskAttemptId attemptNum taskAttemptId getId taskNum taskAttemptId getTaskID getId LOG LOG debug attemptNum taskNum taskAttemptId taskNum llapSplit getSplitNum SubmitWorkRequestProto request constructSubmitWorkRequestProto submitWorkInfo taskNum attemptNum llapClient getAddress submitWorkInfo getToken llapSplit job SignableVertexSpec vertex SignableVertexSpec parseFrom submitWorkInfo getVertexBinary String fragmentId Converters createTaskAttemptId vertex getQueryIdentifier vertex getVertexIndex request getFragmentNumber request getAttemptNumber toString
taskNum taskAttemptId getTaskID getId LOG LOG debug attemptNum taskNum taskAttemptId taskNum llapSplit getSplitNum SubmitWorkRequestProto request constructSubmitWorkRequestProto submitWorkInfo taskNum attemptNum llapClient getAddress submitWorkInfo getToken llapSplit job SignableVertexSpec vertex SignableVertexSpec parseFrom submitWorkInfo getVertexBinary String fragmentId Converters createTaskAttemptId vertex getQueryIdentifier vertex getVertexIndex request getFragmentNumber request getAttemptNumber toString LOG info fragmentId host llapSubmitPort llapClient submitWork request host llapSubmitPort Socket socket Socket host outputPort OutputStream socketStream socket getOutputStream LlapOutputSocketInitMessage Builder builder LlapOutputSocketInitMessage newBuilder setFragmentId fragmentId llapSplit getTokenBytes builder setToken ByteString copyFrom llapSplit getTokenBytes
LOG debug attemptNum taskNum taskAttemptId taskNum llapSplit getSplitNum SubmitWorkRequestProto request constructSubmitWorkRequestProto submitWorkInfo taskNum attemptNum llapClient getAddress submitWorkInfo getToken llapSplit job SignableVertexSpec vertex SignableVertexSpec parseFrom submitWorkInfo getVertexBinary String fragmentId Converters createTaskAttemptId vertex getQueryIdentifier vertex getVertexIndex request getFragmentNumber request getAttemptNumber toString LOG info fragmentId host llapSubmitPort llapClient submitWork request host llapSubmitPort Socket socket Socket host outputPort OutputStream socketStream socket getOutputStream LlapOutputSocketInitMessage Builder builder LlapOutputSocketInitMessage newBuilder setFragmentId fragmentId llapSplit getTokenBytes builder setToken ByteString copyFrom llapSplit getTokenBytes LOG info fragmentId host outputPort builder build writeDelimitedTo socketStream
submitWorkInfo llapInputSplit fragmentBytes llapInputSplit getFragmentBytes fragmentBytesSignature llapInputSplit getFragmentBytesSignature ApplicationId appId submitWorkInfo getFakeAppId String user System getenv ApplicationConstants Environment USER name
localizeJarForClass Arrays asList DEFAULT_AUX_CLASSES localizeJarForClass conf getStringCollection localizeJarForClass getDbSpecificJdbcJars localizeJarForClass Arrays asList HBASE_SERDE_CLASS Job fakeJob Job getInstance JobConf TableMapReduceUtil addDependencyJars fakeJob Collection String hbaseJars fakeJob getConfiguration getStringCollection String jarPath hbaseJars jarPath rawFs copyFromLocalFile Path jarPath libDir String err
Job fakeJob Job getInstance JobConf TableMapReduceUtil addDependencyJars fakeJob Collection String hbaseJars fakeJob getConfiguration getStringCollection String jarPath hbaseJars jarPath rawFs copyFromLocalFile Path jarPath libDir t String err LOG error err System err println err RuntimeException t Set String auxJars HashSet addAuxJarsToSet auxJars conf getAuxJars addAuxJarsToSet auxJars System getenv
Class clazz Class forName className jarPath Utilities jarFinderGetJar clazz t t IOException IOException t IOException t hasException String err className t getMessage LOG error err System err println err jarPath rawFs copyFromLocalFile Path jarPath libDir hasException String err className IOException err
Class dependencies Class LlapDaemonProtocolProtos LlapTezUtils LlapInputFormat HiveInputFormat SslContextFactory Rule RegistryUtils ServiceRecordMarshal com lmax disruptor RingBuffer org apache logging log4j Logger org apache logging log4j core Appender org apache logging slf4j Log4jLogger org apache log4j config Log4j1ConfigurationFactory io netty util NetUtil org jboss netty util NetUtil org apache arrow vector types pojo ArrowType org apache arrow memory BaseAllocator org apache arrow flatbuf Schema com google flatbuffers Table com carrotsearch hppc ByteArrayDeque io jsonwebtoken security Keys io jsonwebtoken impl DefaultJws io jsonwebtoken io JacksonSerializer Class c dependencies Path jarPath Path Utilities jarFinderGetJar c rawFs copyFromLocalFile jarPath libDir
LlapTarComponentGatherer tarComponentGatherer LlapTarComponentGatherer cl conf propsDirectOptions fs rawFs executor tmpDir tarComponentGatherer createDirs tarComponentGatherer submitTarComponentGatherTasks LlapConfigJsonCreator lcjCreator LlapConfigJsonCreator conf rawFs tmpDir cl getCache cl getXmx javaHome lcjCreator createLlapConfigJson LOG debug System nanoTime t0 tarComponentGatherer waitForFinish cl rc startLlap tmpDir scriptParent rc executor shutdown rawFs close fs close
Path tmpDir Path scriptParent String String outputDir Path scriptPath Path Path scriptParent List String scriptArgs ArrayList cl getArgs length scriptArgs addAll Arrays asList scriptPath toString tmpDir toString outputDir scriptArgs addAll Arrays asList cl getArgs
ServiceClient sc sc LlapSliderUtils createServiceClient conf e RuntimeException e LOG info sc actionStop name ex LOG info ex getLocalizedMessage LOG info sc actionDestroy name ex
sc actionDestroy name ex LOG info ex getLocalizedMessage LOG info CoreFileSystem fs CoreFileSystem conf String llapPackageDir HiveConf getVar conf HiveConf ConfVars LLAP_HDFS_PACKAGE_DIR LLAP_RELATIVE_PACKAGE_DIR fs createWithPermissions Path llapPackageDir FsPermission getDirDefault fs copyLocalFileToHdfs File packageDir toString packageName Path llapPackageDir FsPermission LOG info File yarnfile File Path packageDir toString Long lifetime sc actionLaunch yarnfile getAbsolutePath name lifetime queue LOG debug e RuntimeException e
task t1 System nanoTime task getValue get t2 System nanoTime
ExitCode ret ret processAppReport appReport appStatusBuilder e logError e e getExitCode ret ExitCode SUCCESS ret appStatusBuilder ExitCode SUCCESS ret populateAppStatusFromServiceStatus appName serviceClient appStatusBuilder e logError e
llapInstance llapInstance setMgmtPort serviceInstance getManagementPort llapInstance setRpcPort serviceInstance getRpcPort llapInstance setShufflePort serviceInstance getShufflePort llapInstance setWebUrl serviceInstance getServicesAddress llapInstance setStatusUrl serviceInstance getServicesAddress validatedInstances add llapInstance llapExtraInstances add containerIdString appStatusBuilder setLiveInstances validatedInstances size appStatusBuilder setLaunchingInstances llapExtraInstances size appStatusBuilder validatedInstances size appStatusBuilder appStatusBuilder setState State RUNNING_ALL validatedInstances size appStatusBuilder LOG warn
llapInstance setRpcPort serviceInstance getRpcPort llapInstance setShufflePort serviceInstance getShufflePort llapInstance setWebUrl serviceInstance getServicesAddress llapInstance setStatusUrl serviceInstance getServicesAddress validatedInstances add llapInstance llapExtraInstances add containerIdString appStatusBuilder setLiveInstances validatedInstances size appStatusBuilder setLaunchingInstances llapExtraInstances size appStatusBuilder validatedInstances size appStatusBuilder appStatusBuilder setState State RUNNING_ALL validatedInstances size appStatusBuilder LOG warn validatedInstances size
LlapStatusServiceDriver statusServiceDriver createServiceDriver ExitCode ret ExitCode SUCCESS Clock clock SystemClock getInstance lastSummaryLogTime firstAttempt refreshInterval cl getRefreshIntervalMs watchMode cl isWatchMode watchTimeout cl getWatchTimeoutMs numAttempts watchTimeout refreshInterval numAttempts watchMode numAttempts State launchingState State currentState desiredStateAttained runningNodesThreshold cl getRunningNodesThreshold cl cl
firstAttempt ret statusServiceDriver run cl watchMode watchTimeout currentState statusServiceDriver appStatusBuilder getState lastSummaryLogTime LlapStatusServiceDriver maybeLogSummary clock lastSummaryLogTime statusServiceDriver watchMode watchTimeout launchingState e LOG warn e ret watchMode launchingState currentState launchingState currentState currentState launchingState cl LOG warn
numAttempts LOG warn numAttempts LOG warn numAttempts LOG warn numAttempts
queryIdentifier queryIdentifier knownAppMasters LOG debug queryIdentifier Map LlapNodeId AMNodeInfo amNodeInfoPerQuery knownAppMasters remove queryIdentifier amNodeInfoPerQuery LOG debug AMNodeInfo amNodeInfo amNodeInfoPerQuery amNodeInfo setIsDone
Credentials credentials LlapUtil credentialsFromByteArray request getCredentialsBinary toByteArray Token JobTokenIdentifier jobToken TokenCache getSessionToken credentials LlapNodeId amNodeId LlapNodeId getInstance request getAmHost request getAmPort QueryFragmentInfo fragmentInfo queryTracker registerFragment queryIdentifier qIdProto getApplicationIdString dagId vertex getDagName vertex getHiveQueryId dagIdentifier vertex getVertexName request getFragmentNumber request getAttemptNumber vertex getUser vertex jobToken fragmentIdString tokenInfo amNodeId ugiPool Supplier Configuration callableConf Configuration getConfig UserGroupInformation fsTaskUgi fsUgiFactory fsUgiFactory createUgi isGuaranteed request hasIsGuaranteed request getIsGuaranteed ConfVars tezSummary ConfVars TEZ_EXEC_SUMMARY ConfVars llapTasks ConfVars LLAP_TASK_TIME_SUMMARY addTaskTimes getConfig getBoolean tezSummary varname tezSummary defaultBoolVal getConfig getBoolean llapTasks varname llapTasks defaultBoolVal String llapHost UserGroupInformation llapHost localAddress get getHostName llapHost localAddress get getHostName
extClientAppIdFromSplit LOG info extClientAppIdFromSplit
request QueryIdentifier queryIdentifier QueryIdentifier request getQueryIdentifier getApplicationIdString request getQueryIdentifier getDagIndex
queryComplete request QueryIdentifier queryIdentifier QueryIdentifier request getQueryIdentifier getApplicationIdString request getQueryIdentifier getDagIndex LOG info queryIdentifier QueryInfo queryInfo queryTracker queryComplete queryIdentifier request getDeleteDelay queryInfo List QueryFragmentInfo knownFragments queryInfo getRegisteredFragments
queryComplete request QueryIdentifier queryIdentifier QueryIdentifier request getQueryIdentifier getApplicationIdString request getQueryIdentifier getDagIndex LOG info queryIdentifier QueryInfo queryInfo queryTracker queryComplete queryIdentifier request getDeleteDelay queryInfo List QueryFragmentInfo knownFragments queryInfo getRegisteredFragments LOG info queryIdentifier knownFragments size QueryFragmentInfo knownFragments
request String fragmentId request getFragmentIdentifierString
request String fragmentId request getFragmentIdentifierString isGuaranteed request hasIsGuaranteed request getIsGuaranteed
queryIdentifier LOG info queryIdentifier List QueryFragmentInfo knownFragments knownFragments queryTracker getRegisteredFragments queryIdentifier
queryIdentifier LOG info queryIdentifier List QueryFragmentInfo knownFragments knownFragments queryTracker getRegisteredFragments queryIdentifier LOG info queryIdentifier knownFragments size QueryFragmentInfo knownFragments
e result deque offer e result
LocalizerWork lw lw workQueue take LOG debug isClosed isClosed deleteAllLocalResources lw run LOG debug isClosed
recentlyLocalizedJars isEmpty String jars recentlyLocalizedJars toArray String recentlyLocalizedJars clear ClassLoader updatedCl AddToClassPathAction addAction AddToClassPathAction executorClassloader Arrays asList jars updatedCl AccessController doPrivileged addAction
String String rcr LOG isInfoEnabled String desc rcr resources size rcr resources get toString rcr resources size
String asciiArt
String localHostName InetAddress getLocalHost getHostName
String localHostName InetAddress getLocalHost getHostName LOG debug localHostName String localHostName
conf daemonImpl LlapDaemonPolicyProvider pp LlapDaemonPolicyProvider server LlapUtil startProtocolServer srvPort numHandlers srvAddress conf daemonImpl LlapProtocolBlockingPB secretManager pp ConfVars LLAP_SECURITY_ACL ConfVars LLAP_SECURITY_ACL_DENY LlapUtil conf externalClientsRpcServer LlapUtil startProtocolServer externalClientsRpcPort numHandlers conf daemonImpl LlapProtocolBlockingPB secretManager pp ConfVars LLAP_SECURITY_ACL ConfVars LLAP_SECURITY_ACL_DENY
task TezCounters tezCounters task addAndGetTezCounter fragmentId FragmentCountersMap registerCountersForFragment fragmentId tezCounters
List LlapTokenIdentifier List LlapTokenIdentifier tokens id LlapTokenIdentifier KIND_NAME equals id getKind
queryIdentifier String String String dagName String String vertexName fragmentNumber attemptNumber String String ReadWriteLock dagLock getDagLock queryIdentifier dagLock readLock lock queryIdentifier dagSpecificLocks remove queryIdentifier String message dagName vertexName fragmentNumber attemptNumber
tokenInfo LlapTokenChecker getTokenInfo clusterId isExistingQueryInfo QueryInfo queryInfo queryInfoMap get queryIdentifier queryInfo Preconditions checkNotNull tokenInfo userName queryInfo QueryInfo queryIdentifier appIdString dagIdString dagName hiveQueryIdString dagIdentifier user getSourceCompletionMap queryIdentifier localDirsBase localFs tokenInfo userName tokenInfo appId amNodeId vertex getTokenIdentifier appToken vertex getIsExternalSubmission ugiPool QueryInfo old queryInfoMap putIfAbsent queryIdentifier queryInfo old queryInfo old isExistingQueryInfo isExistingQueryInfo LlapTokenChecker checkPermissions tokenInfo queryInfo getTokenUserName queryInfo getTokenAppId queryInfo getQueryIdentifier queryIdentifierToHiveQueryId putIfAbsent queryIdentifier hiveQueryIdString
fragmentInfo QueryIdentifier qId fragmentInfo getQueryInfo getQueryIdentifier QueryInfo queryInfo queryInfoMap get qId queryInfo
ReadWriteLock dagLock getDagLock queryIdentifier dagLock writeLock lock QueryInfo queryInfo isExternalQuery queryInfoMap get queryIdentifier checkPermissionsAndGetQuery queryIdentifier queryInfo LOG warn queryIdentifier LOG info queryIdentifier isExternalQuery deleteDelay queryInfoMap remove queryIdentifier isExternalQuery rememberCompletedDag queryIdentifier cleanupLocalDirs queryInfo deleteDelay handleLogOnQueryCompletion queryInfo getHiveQueryIdString queryInfo getDagIdString queryInfo
queryIdString dagIdString MDC put dagIdString MDC put queryIdString
queryInfo queryInfo ReadWriteLock dagLock getDagLock queryInfo getQueryIdentifier dagLock LOG warn queryInfo getQueryIdentifier locked dagLock writeLock tryLock locked queryInfo getRegisteredFragments size queryComplete queryInfo getQueryIdentifier LOG LOG trace queryInfo getHiveQueryIdString queryInfo getRegisteredFragments size
newWaitQueueSize configuredWaitingQueueSize IllegalArgumentException newWaitQueueSize configuredWaitingQueueSize newNumExecutors IllegalArgumentException newNumExecutors newWaitQueueSize IllegalArgumentException newWaitQueueSize numSlotsAvailable addAndGet newNumExecutors maxParallelExecutors maxParallelExecutors newNumExecutors waitQueue setWaitQueueSize newWaitQueueSize metrics setNumExecutors newNumExecutors metrics setWaitQueueSize newWaitQueueSize newNumExecutors TaskWrapper task waitQueue peek task
newWaitQueueSize IllegalArgumentException newWaitQueueSize numSlotsAvailable addAndGet newNumExecutors maxParallelExecutors maxParallelExecutors newNumExecutors waitQueue setWaitQueueSize newWaitQueueSize metrics setNumExecutors newNumExecutors metrics setWaitQueueSize newWaitQueueSize newNumExecutors TaskWrapper task waitQueue peek task LOG info task task getTaskRunnerCallable killTask waitQueue task metrics setExecutorNumQueuedRequests waitQueue size
TaskWrapper taskWrapper TaskWrapper task SubmissionState result TaskWrapper evictedTask canFinish LOG LOG debug waitQueue size numSlotsAvailable get runningFragmentCount get canFinish taskWrapper getTaskRunnerCallable canFinish taskWrapper updateCanFinishForPriority canFinish evictedTask waitQueue offer taskWrapper maxParallelExecutors runningFragmentCount get evictedTask evictedTask taskWrapper knownTasks put taskWrapper getRequestId taskWrapper taskWrapper setIsInWaitQueue task setWmCountersQueued LOG
canFinish LOG LOG debug waitQueue size numSlotsAvailable get runningFragmentCount get canFinish taskWrapper getTaskRunnerCallable canFinish taskWrapper updateCanFinishForPriority canFinish evictedTask waitQueue offer taskWrapper maxParallelExecutors runningFragmentCount get evictedTask evictedTask taskWrapper knownTasks put taskWrapper getRequestId taskWrapper taskWrapper setIsInWaitQueue task setWmCountersQueued LOG LOG debug task getRequestId waitQueue size result evictedTask SubmissionState ACCEPTED SubmissionState EVICTED_OTHER LOG evictedTask
LOG debug waitQueue size numSlotsAvailable get runningFragmentCount get canFinish taskWrapper getTaskRunnerCallable canFinish taskWrapper updateCanFinishForPriority canFinish evictedTask waitQueue offer taskWrapper maxParallelExecutors runningFragmentCount get evictedTask evictedTask taskWrapper knownTasks put taskWrapper getRequestId taskWrapper taskWrapper setIsInWaitQueue task setWmCountersQueued LOG LOG debug task getRequestId waitQueue size result evictedTask SubmissionState ACCEPTED SubmissionState EVICTED_OTHER LOG evictedTask LOG debug taskWrapper result evictedTask LOG
evictedTask waitQueue offer taskWrapper maxParallelExecutors runningFragmentCount get evictedTask evictedTask taskWrapper knownTasks put taskWrapper getRequestId taskWrapper taskWrapper setIsInWaitQueue task setWmCountersQueued LOG LOG debug task getRequestId waitQueue size result evictedTask SubmissionState ACCEPTED SubmissionState EVICTED_OTHER LOG evictedTask LOG debug taskWrapper result evictedTask LOG LOG info waitQueue size numSlotsAvailable get runningFragmentCount get task getRequestId evictedTask getTaskRunnerCallable killTask result SubmissionState REJECTED
LOG debug task getRequestId waitQueue size result evictedTask SubmissionState ACCEPTED SubmissionState EVICTED_OTHER LOG evictedTask LOG debug taskWrapper result evictedTask LOG LOG info waitQueue size numSlotsAvailable get runningFragmentCount get task getRequestId evictedTask getTaskRunnerCallable killTask result SubmissionState REJECTED LOG LOG debug taskWrapper getRequestId result metrics incrTotalRejectedRequests result stateChanged taskWrapper maybeRegisterForFinishedStateNotifications canFinish stateChanged
LOG evictedTask LOG debug taskWrapper result evictedTask LOG LOG info waitQueue size numSlotsAvailable get runningFragmentCount get task getRequestId evictedTask getTaskRunnerCallable killTask result SubmissionState REJECTED LOG LOG debug taskWrapper getRequestId result metrics incrTotalRejectedRequests result stateChanged taskWrapper maybeRegisterForFinishedStateNotifications canFinish stateChanged LOG LOG debug taskWrapper getRequestId canFinish
LOG LOG info waitQueue size numSlotsAvailable get runningFragmentCount get task getRequestId evictedTask getTaskRunnerCallable killTask result SubmissionState REJECTED LOG LOG debug taskWrapper getRequestId result metrics incrTotalRejectedRequests result stateChanged taskWrapper maybeRegisterForFinishedStateNotifications canFinish stateChanged LOG LOG debug taskWrapper getRequestId canFinish finishableStateUpdated taskWrapper canFinish LOG
LOG debug taskWrapper getRequestId result metrics incrTotalRejectedRequests result stateChanged taskWrapper maybeRegisterForFinishedStateNotifications canFinish stateChanged LOG LOG debug taskWrapper getRequestId canFinish finishableStateUpdated taskWrapper canFinish LOG LOG debug waitQueue evictedTask LOG LOG info evictedTask getRequestId task getRequestId LOG FragmentRuntimeInfo evictedInfo evictedTask getTaskRunnerCallable getFragmentRuntimeInfo
fragmentId TaskWrapper taskWrapper knownTasks get fragmentId taskWrapper
fragmentId TaskWrapper taskWrapper knownTasks remove fragmentId taskWrapper taskWrapper
taskWrapper taskWrapper LOG LOG debug fragmentId taskWrapper setIsInWaitQueue taskWrapper getTaskRunnerCallable setWmCountersDone waitQueue taskWrapper metrics setExecutorNumQueuedRequests waitQueue size taskWrapper LOG LOG debug fragmentId removeFromPreemptionQueue taskWrapper taskWrapper getTaskRunnerCallable setWmCountersDone taskWrapper getTaskRunnerCallable killTask
LOG LOG info taskWrapper TaskRunnerCallable task taskWrapper getTaskRunnerCallable ListenableFuture TaskRunner2Result future executorService submit task task setWmCountersRunning runningFragmentCount incrementAndGet taskWrapper setIsInWaitQueue FutureCallback TaskRunner2Result wrappedCallback createInternalCompletionListener taskWrapper Futures addCallback future wrappedCallback executionCompletionExecutorService canFinish taskWrapper getTaskRunnerCallable canFinish isGuaranteed taskWrapper isGuaranteed LOG LOG debug taskWrapper getRequestId canFinish isGuaranteed canFinish isGuaranteed LOG
executor StatsRecordingThreadPool TimeUnit MILLISECONDS LinkedBlockingQueue Runnable ThreadFactoryBuilder setDaemon setNameFormat threadNameSuffix build runtimeWatch start fsTaskUgi fsTaskUgi UserGroupInformation createRemoteUser vertex getUser fsTaskUgi addCredentials credentials Map String ByteBuffer serviceConsumerMetadata HashMap serviceConsumerMetadata put TezConstants TEZ_SHUFFLE_HANDLER_SERVICE_ID TezCommonUtils convertJobTokenToBytes jobToken Multimap String String startedInputsMap createStartedInputMap vertex UserGroupInformation taskOwner vertex taskOwner fragmentInfo getQueryInfo getUmbilicalUgi taskOwner UserGroupInformation createRemoteUser vertex getTokenIdentifier taskOwner addToken jobToken InetSocketAddress address NetUtils createSocketAddrForHost request getAmHost request getAmPort
taskOwner UserGroupInformation createRemoteUser vertex getTokenIdentifier taskOwner addToken jobToken InetSocketAddress address NetUtils createSocketAddrForHost request getAmHost request getAmPort SecurityUtil setTokenService jobToken address LOG LOG debug taskOwner hashCode InetSocketAddress address NetUtils createSocketAddrForHost request getAmHost request getAmPort umbilical taskOwner LlapTaskUmbilicalProtocol LlapTaskUmbilicalProtocol RPC getProxy LlapTaskUmbilicalProtocol LlapTaskUmbilicalProtocol versionID address taskOwner config socketFactory String fragmentId LlapTezUtils stripAttemptPrefix taskSpec getTaskAttemptID toString taskReporter LlapTaskReporter completionListener umbilical confParams amHeartbeatIntervalMsMax confParams amCounterHeartbeatInterval confParams amMaxEventsPerHeartbeat AtomicLong request getContainerIdString fragmentId initialEvent requestId wmCounters String attemptId fragmentInfo getFragmentIdentifierString IOContextMap setThreadAttemptId attemptId
RPC getProxy LlapTaskUmbilicalProtocol LlapTaskUmbilicalProtocol versionID address taskOwner config socketFactory String fragmentId LlapTezUtils stripAttemptPrefix taskSpec getTaskAttemptID toString taskReporter LlapTaskReporter completionListener umbilical confParams amHeartbeatIntervalMsMax confParams amCounterHeartbeatInterval confParams amMaxEventsPerHeartbeat AtomicLong request getContainerIdString fragmentId initialEvent requestId wmCounters String attemptId fragmentInfo getFragmentIdentifierString IOContextMap setThreadAttemptId attemptId taskRunner TezTaskRunner2 config fsTaskUgi fragmentInfo getLocalDirs taskSpec vertex getQueryIdentifier getAppAttemptNumber serviceConsumerMetadata envMap startedInputsMap taskReporter executor objectRegistry pid executionContext memoryAvailable tezHadoopShim taskRunner LOG info taskSpec getTaskAttemptID TaskRunner2Result EndReason KILL_REQUESTED TaskRunner2Result result taskRunner run
String fragmentId LlapTezUtils stripAttemptPrefix taskSpec getTaskAttemptID toString taskReporter LlapTaskReporter completionListener umbilical confParams amHeartbeatIntervalMsMax confParams amCounterHeartbeatInterval confParams amMaxEventsPerHeartbeat AtomicLong request getContainerIdString fragmentId initialEvent requestId wmCounters String attemptId fragmentInfo getFragmentIdentifierString IOContextMap setThreadAttemptId attemptId taskRunner TezTaskRunner2 config fsTaskUgi fragmentInfo getLocalDirs taskSpec vertex getQueryIdentifier getAppAttemptNumber serviceConsumerMetadata envMap startedInputsMap taskReporter executor objectRegistry pid executionContext memoryAvailable tezHadoopShim taskRunner LOG info taskSpec getTaskAttemptID TaskRunner2Result EndReason KILL_REQUESTED TaskRunner2Result result taskRunner run result
TezTaskAttemptID ta taskSpec getTaskAttemptID
TezTaskAttemptID ta taskSpec getTaskAttemptID LOG info ta taskRunner shouldRunTask taskRunner killtimerWatch start
killTask TezTaskAttemptID ta taskSpec getTaskAttemptID LOG info ta taskRunner shouldRunTask taskRunner killtimerWatch start LOG info taskSpec getTaskAttemptID killed taskRunner killTask killed
TezTaskAttemptID ta taskSpec getTaskAttemptID LOG info ta taskRunner shouldRunTask taskRunner killtimerWatch start LOG info taskSpec getTaskAttemptID killed taskRunner killTask killed LOG info ta completionListener fragmentCompleting getRequestId SchedulerFragmentCompletingListener State KILLED reportTaskKilled
killed taskRunner killTask killed LOG info ta completionListener fragmentCompleting getRequestId SchedulerFragmentCompletingListener State KILLED reportTaskKilled LOG info ta LOG debug getRequestId reportTaskKilled fragmentCompletionHanler fragmentComplete fragmentInfo amReporter unregisterTask request getAmHost request getAmPort fragmentInfo getQueryInfo getQueryIdentifier ta
reportTaskKilled LOG info ta LOG debug getRequestId reportTaskKilled fragmentCompletionHanler fragmentComplete fragmentInfo amReporter unregisterTask request getAmHost request getAmPort fragmentInfo getQueryInfo getQueryIdentifier ta thr LOG error thr LOG warn taskSpec getTaskAttemptID
event Marker marker event getMarker marker marker marker
key Preconditions checkNotNull key removed knownAppenders remove key removed
name Preconditions checkNotNull name LlapRoutingAppenderPurgePolicy getName LlapRoutingAppenderPurgePolicy llapRoutingAppenderPurgePolicy LlapRoutingAppenderPurgePolicy name LlapRoutingAppenderPurgePolicy old INSTANCES putIfAbsent name llapRoutingAppenderPurgePolicy old
event Node cnode Node appNode Node cnode config createConfiguration appNode event appNode getObject Appender Appender app appNode getObject app start app RandomAccessFileAppender String message RandomAccessFileAppender getName app getClass getName
Node cnode Node appNode Node cnode config createConfiguration appNode event appNode getObject Appender Appender app appNode getObject app start app RandomAccessFileAppender String message RandomAccessFileAppender getName app getClass getName LOGGER error message IllegalStateException message realAppender set app appenderControl set AppenderControl app LOGGER RandomAccessFileAppender raf RandomAccessFileAppender app
String appIdString String user jobToken String jobIdString appIdString replace userRsrc putIfAbsent jobIdString user secretManager addTokenForJob jobIdString jobToken
executor execute sameTask executor execute upTask executor execute downTask cdlIn await cdlOut countDown t LOG error t RuntimeException t upTask get e LOG error e
executor execute sameTask executor execute upTask executor execute downTask cdlIn await cdlOut countDown t LOG error t RuntimeException t upTask get e LOG error e RuntimeException e
cdlOut countDown i i allocTasks i Object result allocTasks i get LOG info result tt LOG error tt t a dumpTestLog t tt dumpTask cancel defragTask defragStopped set defragTask get
tt LOG error tt t a dumpTestLog t tt dumpTask cancel defragTask defragStopped set defragTask get tt LOG error t t a dumpTestLog t tt
logs logs
a sizes dealloc size LlapAllocatorBuffer initial prepareCustomFragmentedAllocator a sizes dealloc LlapAllocatorBuffer after allocate a size initial length
a baseSize pairCount allocs LlapAllocatorBuffer initial prepareZebraFragmentedAllocator a baseSize pairCount allocFraction allocs bigAllocSize pairCount baseSize allocFraction LlapAllocatorBuffer after allocate a allocs bigAllocSize initial length
a baseSize LlapAllocatorBuffer initial prepareSimpleFragmentedAllocator a baseSize LlapAllocatorBuffer after allocate a baseSize initial length
LlapAllocatorBuffer a baseSize doIncRef LlapAllocatorBuffer initial allocate a baseSize doIncRef checkInitialValues initial a deallocate initial a deallocate initial
a baseSize deallocOneFirst deallocOneSecond LlapAllocatorBuffer initial prepareAllocatorWithSmallFragments a baseSize deallocOneFirst deallocOneSecond bigAllocSize baseSize LlapAllocatorBuffer after allocate a bigAllocSize initial length
offset LlapAllocatorBuffer initial LlapAllocatorBuffer initial offset allocate a baseSize offset doIncRef MemoryBuffer tmp allocate a baseSize offset System arraycopy tmp initial offset offset initial offset allocate a baseSize offset doIncRef tmp allocate a baseSize offset System arraycopy tmp initial offset a deallocate initial a deallocate initial a deallocate initial a deallocate initial
obj HashMap Class ObjectEstimator map IncrementalObjectSizeEstimator createEstimators obj ObjectEstimator root map get obj getClass estimate root estimate obj map
fileId isFirstFile fn1 fn2 head cache getFileData fileId head testFactory DiskRange results head listToArray startIndex rdm nextInt results length index startIndex LlapDataBuffer victim DiskRange r results index r CacheChunk LlapDataBuffer result LlapDataBuffer CacheChunk r getBuffer cache decRefBuffer result victim result evictions victim result index index results length index
HEAP_SIZE Configuration conf Configuration conf setFloat HiveConf ConfVars LLAP_LRFU_LAMBDA varname conf setInt HiveConf ConfVars LLAP_LRFU_BP_WRAPPER_SIZE varname EvictionTracker et EvictionTracker LowLevelLrfuCachePolicy lrfu LowLevelLrfuCachePolicy HEAP_SIZE conf MetricsMock m createMetricsMock LowLevelCacheMemoryManager mm LowLevelCacheMemoryManager HEAP_SIZE lrfu m metricsMock lrfu setEvictionListener et assertEquals lrfu purge HEAP_SIZE
LlapDataBuffer buffer LowLevelCacheImpl allocateFake assertTrue cache mm lrfu et buffer assertEquals Math min i heapSize m cacheUsed get LlapDataBuffer evictedBuf getOneEvictedBuffer et i evicted i buffer i heapSize assertSame evicted i heapSize evictedBuf assertTrue evictedBuf isInvalid assertNull evictedBuf inserted add buffer LOG info dumpInserted inserted Collections shuffle inserted rdm
conf rpcPort externalClientCloudRpcPort mngPort shufflePort webPort outputFormatServicePort usePortsFromConf conf getBoolean
shufflePort conf getInt ShuffleHandler SHUFFLE_PORT_CONFIG_KEY ShuffleHandler DEFAULT_SHUFFLE_PORT webPort HiveConf getIntVar conf ConfVars LLAP_DAEMON_WEB_PORT outputFormatServicePort HiveConf getIntVar conf ConfVars LLAP_DAEMON_OUTPUT_SERVICE_PORT HiveConf setIntVar conf ConfVars LLAP_DAEMON_OUTPUT_SERVICE_PORT outputFormatServicePort miniZooKeeperCluster MiniZooKeeperCluster miniZooKeeperCluster startup zkWorkDir conf set ConfVars LLAP_DAEMON_SERVICE_HOSTS varname clusterNameTrimmed conf set ConfVars HIVE_ZOOKEEPER_QUORUM varname conf setInt ConfVars HIVE_ZOOKEEPER_CLIENT_PORT varname miniZooKeeperCluster getClientPort clusterSpecificConfiguration set ConfVars LLAP_DAEMON_SERVICE_HOSTS varname clusterNameTrimmed clusterSpecificConfiguration set ConfVars HIVE_ZOOKEEPER_QUORUM varname clusterSpecificConfiguration setInt ConfVars HIVE_ZOOKEEPER_CLIENT_PORT varname miniZooKeeperCluster getClientPort externalClientCloudSetupEnabled LlapUtil isCloudDeployment conf
miniZooKeeperCluster MiniZooKeeperCluster miniZooKeeperCluster startup zkWorkDir conf set ConfVars LLAP_DAEMON_SERVICE_HOSTS varname clusterNameTrimmed conf set ConfVars HIVE_ZOOKEEPER_QUORUM varname conf setInt ConfVars HIVE_ZOOKEEPER_CLIENT_PORT varname miniZooKeeperCluster getClientPort clusterSpecificConfiguration set ConfVars LLAP_DAEMON_SERVICE_HOSTS varname clusterNameTrimmed clusterSpecificConfiguration set ConfVars HIVE_ZOOKEEPER_QUORUM varname clusterSpecificConfiguration setInt ConfVars HIVE_ZOOKEEPER_CLIENT_PORT varname miniZooKeeperCluster getClientPort externalClientCloudSetupEnabled LlapUtil isCloudDeployment conf LOG info numInstances clusterNameTrimmed i i numInstances i llapDaemons i LlapDaemon conf numExecutorsPerService execBytesPerService llapIoEnabled ioIsDirect ioBytesPerService localDirs rpcPort externalClientCloudSetupEnabled externalClientCloudRpcPort mngPort shufflePort webPort clusterNameTrimmed llapDaemons i init Configuration conf
initialize initialize Configuration conf getConf numThreads HiveConf getIntVar conf ConfVars LLAP_DAEMON_COMMUNICATOR_NUM_THREADS communicator createLlapProtocolClientProxy numThreads conf deleteDelayOnDagComplete HiveConf getTimeVar conf ConfVars LLAP_FILE_CLEANUP_DELAY_SECONDS TimeUnit SECONDS
Configuration conf getConf JobTokenSecretManager jobTokenSecretManager JobTokenSecretManager jobTokenSecretManager addTokenForJob tokenIdentifier sessionToken numHandlers HiveConf getIntVar conf ConfVars LLAP_TASK_COMMUNICATOR_LISTENER_THREAD_COUNT umbilicalPort HiveConf getIntVar conf ConfVars LLAP_TASK_UMBILICAL_SERVER_PORT umbilicalPort umbilicalPort server RPC Builder conf setProtocol LlapTaskUmbilicalProtocol setBindAddress setPort umbilicalPort setInstance umbilical setNumHandlers numHandlers setSecretManager jobTokenSecretManager build conf server refreshServiceAcl conf LlapUmbilicalPolicyProvider server start address NetUtils getConnectAddress server amHost LlapUtil getAmHostNameFromAddress address conf
registerContainerEnd containerId endReason diagnostics registerContainerEnd containerId endReason diagnostics endReason
ContainerInfo containerInfo getContainerInfo containerId String host port containerInfo containerInfo host containerInfo host port containerInfo port RuntimeException containerId taskSpec getTaskAttemptID LlapNodeId nodeId LlapNodeId getInstance host port registerKnownNode nodeId entityTracker registerTaskAttempt containerId taskSpec getTaskAttemptID host port nodesForQuery add nodeId sourceStateTracker registerTaskForStateUpdates host port taskSpec getInputs FragmentRuntimeInfo fragmentRuntimeInfo
sourceStateTracker registerTaskForStateUpdates host port taskSpec getInputs FragmentRuntimeInfo fragmentRuntimeInfo fragmentRuntimeInfo sourceStateTracker getFragmentRuntimeInfo taskSpec getVertexName taskSpec getTaskAttemptID getTaskID getId priority e LOG error taskSpec getTaskAttemptID containerId currentQueryIdentifierProto currentHiveQueryId e e RuntimeException RuntimeException e RuntimeException e SubmitWorkRequestProto requestProto requestProto constructSubmitWorkRequest containerId taskSpec fragmentRuntimeInfo currentHiveQueryId e RuntimeException e
RuntimeException e RuntimeException e SubmitWorkRequestProto requestProto requestProto constructSubmitWorkRequest containerId taskSpec fragmentRuntimeInfo currentHiveQueryId e RuntimeException e getContext taskStartedRemotely taskSpec getTaskAttemptID containerId requestProto response response LlapDaemonProtocolProtos SubmissionStateProto ss response getSubmissionState ss LlapDaemonProtocolProtos SubmissionStateProto LOG info taskSpec getTaskAttemptID containerId
requestProto constructSubmitWorkRequest containerId taskSpec fragmentRuntimeInfo currentHiveQueryId e RuntimeException e getContext taskStartedRemotely taskSpec getTaskAttemptID containerId requestProto response response LlapDaemonProtocolProtos SubmissionStateProto ss response getSubmissionState ss LlapDaemonProtocolProtos SubmissionStateProto LOG info taskSpec getTaskAttemptID containerId getContext taskKilled taskSpec getTaskAttemptID TaskAttemptEndReason EXECUTOR_BUSY RuntimeException
getContext taskStartedRemotely taskSpec getTaskAttemptID containerId response response LlapDaemonProtocolProtos SubmissionStateProto ss response getSubmissionState ss LlapDaemonProtocolProtos SubmissionStateProto LOG info taskSpec getTaskAttemptID containerId getContext taskKilled taskSpec getTaskAttemptID TaskAttemptEndReason EXECUTOR_BUSY RuntimeException response entityTracker registerTaskSubmittedToNode taskSpec getTaskAttemptID response getUniqueNodeId LOG info taskSpec getTaskAttemptID scheduler notifyStarted taskSpec getTaskAttemptID
response LlapDaemonProtocolProtos SubmissionStateProto ss response getSubmissionState ss LlapDaemonProtocolProtos SubmissionStateProto LOG info taskSpec getTaskAttemptID containerId getContext taskKilled taskSpec getTaskAttemptID TaskAttemptEndReason EXECUTOR_BUSY RuntimeException response entityTracker registerTaskSubmittedToNode taskSpec getTaskAttemptID response getUniqueNodeId LOG info taskSpec getTaskAttemptID scheduler notifyStarted taskSpec getTaskAttemptID Throwable t Throwable originalError t t
unregisterRunningTaskAttempt taskAttemptId endReason diagnostics unregisterRunningTaskAttempt taskAttemptId endReason diagnostics endReason
dagIdentifier QueryIdentifierProto queryIdentifierProto constructQueryIdentifierProto dagIdentifier QueryCompleteRequestProto request QueryCompleteRequestProto newBuilder setQueryIdentifier queryIdentifierProto setDeleteDelay deleteDelayOnDagComplete build
nodeId Long old knownNodeMap putIfAbsent nodeId TimeUnit MILLISECONDS convert System nanoTime TimeUnit NANOSECONDS old
nodeId currentTs TimeUnit MILLISECONDS convert System nanoTime TimeUnit NANOSECONDS PingingNodeInfo ni PingingNodeInfo currentTs PingingNodeInfo old pingedNodeMap put nodeId ni old
biMap i i tasks get i isGuaranteed guaranteed isGuaranteed BooleanWritable guaranteed get i get TezTaskAttemptID attemptID TezTaskAttemptID tasks get i biMap attemptID String taskNodeId entityTracker getUniqueNodeId attemptID taskNodeId taskNodeId getContext taskAlive attemptID scheduler taskInfoUpdated attemptID isGuaranteed getContext containerAlive biMap inverse get attemptID error add attemptID error
isGuaranteed guaranteed isGuaranteed BooleanWritable guaranteed get i get TezTaskAttemptID attemptID TezTaskAttemptID tasks get i biMap attemptID String taskNodeId entityTracker getUniqueNodeId attemptID taskNodeId taskNodeId getContext taskAlive attemptID scheduler taskInfoUpdated attemptID isGuaranteed getContext containerAlive biMap inverse get attemptID error add attemptID error LOG info error TezTaskAttemptID error
newDagId hiveQueryId currentQueryIdentifierProto constructQueryIdentifierProto newDagId currentHiveQueryId hiveQueryId sourceStateTracker resetState currentQueryIdentifierProto nodesForQuery clear
newTotalGuaranteed List TaskInfo toUpdate tgVersionForZk writeLock lock delta newTotalGuaranteed totalGuaranteed tgVersionForZk totalGuaranteedVersion
tgVersionForZk writeLock lock delta newTotalGuaranteed totalGuaranteed tgVersionForZk totalGuaranteedVersion WM_LOG info newTotalGuaranteed tgVersionForZk delta delta totalGuaranteed newTotalGuaranteed metrics metrics setWmTotalGuaranteed totalGuaranteed delta toUpdate ArrayList totalUpdated distributeGuaranteed delta toUpdate delta totalUpdated
unusedGuaranteed toUpdate ArrayList totalUpdated distributeGuaranteed delta toUpdate delta totalUpdated WM_LOG info totalUpdated result unusedGuaranteed delta metrics metrics setWmUnusedGuaranteed result WM_LOG info result delta delta delta delta unusedGuaranteed result unusedGuaranteed delta metrics metrics setWmUnusedGuaranteed result
WM_LOG info result delta delta delta delta unusedGuaranteed result unusedGuaranteed delta metrics metrics setWmUnusedGuaranteed result WM_LOG info result delta delta unusedGuaranteed unusedGuaranteed toUpdate ArrayList totalUpdated revokeGuaranteed delta toUpdate metrics
result unusedGuaranteed delta metrics metrics setWmUnusedGuaranteed result WM_LOG info result delta delta unusedGuaranteed unusedGuaranteed toUpdate ArrayList totalUpdated revokeGuaranteed delta toUpdate metrics metrics setWmUnusedGuaranteed WM_LOG info totalUpdated delta delta totalUpdated AssertionError delta
timeoutLock lock timeoutFuture timeoutFuture timeoutFuture timeoutFuture timeoutExecutor schedule timeoutMonitor timeout TimeUnit MILLISECONDS timeoutFutureRef set timeoutFuture
TreeSet TaskInfo set speculativeTasks get entry getKey set set TreeSet speculativeTasks put entry getKey set TaskInfo info entry getValue info info isGuaranteed set add info guaranteedTasks clear TreeSet TaskInfo entry speculativeTasks entry getValue runningCount entry getValue size totalGuaranteed unusedGuaranteed tgVersionForZk totalGuaranteedVersion
task capability hosts racks priority clientCookie TezTaskAttemptID id getTaskAttemptId task TaskInfo taskInfo TaskInfo localityDelayConf clock task clientCookie priority capability hosts racks clock getTime id
task capability priority clientCookie TezTaskAttemptID id getTaskAttemptId task TaskInfo taskInfo TaskInfo localityDelayConf clock task clientCookie priority capability clock getTime id
request String requestedHosts request requestedHosts String requestedHostsDebugStr Arrays toString requestedHosts
schedulerAttemptTime clock getTime readLock lock shouldDelayForLocality request shouldDelayForLocality schedulerAttemptTime LOG debug shouldDelayForLocality request task requestedHostsDebugStr request prefHostCount requestedHostsWillBecomeAvailable host prefHostCount Set LlapServiceInstance instances activeInstances getByHost host instances LlapServiceInstance inst instances NodeInfo nodeInfo instanceToNodeMap get inst getWorkerIdentity nodeInfo
host requestedHosts prefHostCount Set LlapServiceInstance instances activeInstances getByHost host instances LlapServiceInstance inst instances NodeInfo nodeInfo instanceToNodeMap get inst getWorkerIdentity nodeInfo nodeInfo LOG info nodeInfo toShortString host prefHostCount requestedHosts length SelectHostResult nodeInfo requestedHostsWillBecomeAvailable
LOG info nodeInfo toShortString host prefHostCount requestedHosts length SelectHostResult nodeInfo requestedHostsWillBecomeAvailable nodeInfo nodeInfo nodeInfo LOG debug nodeInfo requestedHostsWillBecomeAvailable LOG warn inst host requestedHostsWillBecomeAvailable
request requestedHostsWillBecomeAvailable nodeInfo request getLocalityDelayTimeout nodeInfo nodeInfo LOG debug nodeInfo requestedHostsWillBecomeAvailable LOG warn inst host requestedHostsWillBecomeAvailable LOG LOG debug request task requestedHostsDebugStr schedulerAttemptTime request getLocalityDelayTimeout SELECT_HOST_RESULT_DELAYED_LOCALITY
LOG LOG debug request task requestedHostsDebugStr Collection LlapServiceInstance instances instances activeInstances getAllInstancesOrdered instances activeInstances getAll List NodeInfo allNodes ArrayList instances size List NodeInfo activeNodesWithFreeSlots ArrayList LlapServiceInstance inst instances inst allNodes add NodeInfo nodeInfo instanceToNodeMap get inst getWorkerIdentity nodeInfo
NodeInfo nodeInfo instanceToNodeMap get inst getWorkerIdentity nodeInfo allNodes add allNodes add nodeInfo nodeInfo activeNodesWithFreeSlots add nodeInfo allNodes SELECT_HOST_RESULT_DELAYED_RESOURCES activeNodesWithFreeSlots isClusterCapacityFull set request request request resetLocalityDelayInfo isClusterCapacityFull set
writeLock lock
writeLock lock
TaskInfo task writeLock lock TaskInfo taskInfo knownTasks remove task taskInfo tasksById remove taskInfo attemptId
LOG LOG debug constructPendingTaskCountsLogMessage Iterator Entry Priority List TaskInfo pendingIterator pendingTasks entrySet iterator Resource totalResource getTotalResources pendingIterator Entry Priority List TaskInfo entry pendingIterator next List TaskInfo taskListAtPriority entry getValue Iterator TaskInfo taskIter taskListAtPriority iterator scheduledAllAtPriority taskIter TaskInfo taskInfo taskIter next taskInfo dagStats registerDelayedAllocation taskInfo triedAssigningTask ScheduleResult scheduleResult scheduleTask taskInfo totalResource downgradedTask
LOG LOG debug taskInfo scheduleResult scheduleResult taskIter remove scheduleResult LOG info startTimeoutMonitor String potentialHosts scheduleResult maybeAddToDelayedTaskQueue taskInfo potentialHosts taskInfo requestedHosts potentialHosts potentialHosts potentialHosts
LOG info startTimeoutMonitor String potentialHosts maybeAddToDelayedTaskQueue taskInfo potentialHosts taskInfo requestedHosts potentialHosts potentialHosts potentialHosts potentialHosts potentialHosts LOG LOG debug taskInfo Arrays toString potentialHosts
String potentialHosts maybeAddToDelayedTaskQueue taskInfo potentialHosts taskInfo requestedHosts potentialHosts potentialHosts potentialHosts potentialHosts potentialHosts LOG LOG debug taskInfo Arrays toString potentialHosts shouldPreempt String host potentialHosts MutableInt pendingHostPreemptions pendingPreemptionsPerHost get host pendingHostPreemptions pendingHostPreemptions
potentialHosts taskInfo requestedHosts potentialHosts potentialHosts potentialHosts potentialHosts potentialHosts LOG LOG debug taskInfo Arrays toString potentialHosts shouldPreempt host potentialHosts MutableInt pendingHostPreemptions pendingPreemptionsPerHost get host pendingHostPreemptions pendingHostPreemptions intValue shouldPreempt LOG debug taskInfo task host pendingHostPreemptions intValue
potentialHosts potentialHosts potentialHosts LOG LOG debug taskInfo Arrays toString potentialHosts shouldPreempt host potentialHosts MutableInt pendingHostPreemptions pendingPreemptionsPerHost get host pendingHostPreemptions pendingHostPreemptions intValue shouldPreempt LOG debug taskInfo task host pendingHostPreemptions intValue shouldPreempt LOG
potentialHosts potentialHosts LOG LOG debug taskInfo Arrays toString potentialHosts shouldPreempt host potentialHosts MutableInt pendingHostPreemptions pendingPreemptionsPerHost get host pendingHostPreemptions pendingHostPreemptions intValue shouldPreempt LOG debug taskInfo task host pendingHostPreemptions intValue shouldPreempt LOG LOG debug taskInfo task Arrays toString potentialHosts pendingPreemptions get
LOG LOG debug taskInfo Arrays toString potentialHosts shouldPreempt host potentialHosts MutableInt pendingHostPreemptions pendingPreemptionsPerHost get host pendingHostPreemptions pendingHostPreemptions intValue shouldPreempt LOG debug taskInfo task host pendingHostPreemptions intValue shouldPreempt LOG LOG debug taskInfo task Arrays toString potentialHosts pendingPreemptions get preemptTasks entry getKey getPriority vertexNum taskInfo potentialHosts LOG
shouldPreempt LOG debug taskInfo task host pendingHostPreemptions intValue shouldPreempt LOG LOG debug taskInfo task Arrays toString potentialHosts pendingPreemptions get preemptTasks entry getKey getPriority vertexNum taskInfo potentialHosts LOG LOG debug taskInfo task Arrays toString potentialHosts LOG debug taskInfo task pendingPreemptions get pendingPreemptions get LOG LOG debug taskInfo task taskInfo priority
preemptHosts Sets newHashSet potentialHosts Iterator TaskInfo taskInfoIterator entryAtPriority getValue iterator taskInfoIterator preemptedCount TaskInfo taskInfo taskInfoIterator next preemptHosts preemptHosts taskInfo Map Integer Set Integer depInfo getDependencyInfo taskInfo attemptId getTaskID getVertexID getDAGId Set Integer vertexDepInfo depInfo vertexDepInfo depInfo get forVertex depInfo vertexDepInfo LOG warn forVertex depInfo vertexDepInfo vertexDepInfo taskInfo preemptedCount
vertexDepInfo depInfo get forVertex depInfo vertexDepInfo LOG warn forVertex depInfo vertexDepInfo vertexDepInfo taskInfo preemptedCount LOG info taskInfo forPriority potentialHosts Arrays toString potentialHosts taskInfo setPreemptedInfo clock getTime preemptedTaskList preemptedTaskList LinkedList dagStats registerTaskPreempted taskInfo assignedNode getHost preemptedTaskList add taskInfo registerPendingPreemption taskInfo assignedNode getHost taskInfoIterator remove
conf registry clientFactory registry registry clientFactory clientFactory minServedTasksNumber HiveConf getIntVar conf HiveConf ConfVars LLAP_NODEHEALTHCHECKS_MINTASKS minConfigChangeDelayMs HiveConf getTimeVar conf HiveConf ConfVars LLAP_NODEHEALTHCHECKS_MININTERVALDURATION TimeUnit MILLISECONDS timeThreshold HiveConf getFloatVar conf HiveConf ConfVars LLAP_NODEHEALTHCHECKS_TASKTIMERATIO emptyExecutorsThreshold HiveConf getFloatVar conf HiveConf ConfVars LLAP_NODEHEALTHCHECKS_EXECUTORRATIO maxBlacklistedNodes HiveConf getIntVar conf HiveConf ConfVars LLAP_NODEHEALTHCHECKS_MAXNODES Preconditions checkArgument minServedTasksNumber Preconditions checkArgument minConfigChangeDelayMs Preconditions checkArgument timeThreshold Preconditions checkArgument maxBlacklistedNodes Preconditions checkNotNull registry Preconditions checkNotNull clientFactory
Map String newMetrics sumAverageTime sumEmptyExecutors maxAverageTime maxAverageTimeEmptyExecutors maxAverageTimeMaxExecutors workerNum blacklistedNodes String maxAverageTimeIdentity String workerIdentity newMetrics Map String Long metrics newMetrics get workerIdentity getMetrics requestHandled metrics get LlapDaemonExecutorInfo ExecutorTotalRequestsHandled name averageTime metrics get LlapDaemonExecutorInfo AverageResponseTime name emptyExecutor metrics get LlapDaemonExecutorInfo ExecutorNumExecutorsAvailableAverage name maxExecutors metrics get LlapDaemonExecutorInfo ExecutorNumExecutors name
maxAverageTimeEmptyExecutors maxAverageTimeMaxExecutors workerNum blacklistedNodes String maxAverageTimeIdentity String workerIdentity newMetrics Map String Long metrics newMetrics get workerIdentity getMetrics requestHandled metrics get LlapDaemonExecutorInfo ExecutorTotalRequestsHandled name averageTime metrics get LlapDaemonExecutorInfo AverageResponseTime name emptyExecutor metrics get LlapDaemonExecutorInfo ExecutorNumExecutorsAvailableAverage name maxExecutors metrics get LlapDaemonExecutorInfo ExecutorNumExecutors name LOG debug workerIdentity requestHandled averageTime emptyExecutor maxExecutors maxExecutors blacklistedNodes blacklistedNodes
workerNum sumAverageTime averageTime averageTime maxAverageTime maxAverageTime averageTime maxAverageTimeEmptyExecutors emptyExecutor maxAverageTimeMaxExecutors maxExecutors maxAverageTimeIdentity workerIdentity sumEmptyExecutors emptyExecutor workerNum LOG debug sumAverageTime sumEmptyExecutors maxAverageTime maxAverageTimeEmptyExecutors maxAverageTimeMaxExecutors workerNum maxAverageTimeIdentity blacklistedNodes averageTimeWithoutSlowest sumAverageTime maxAverageTime workerNum averageTimeWithoutSlowest maxAverageTime emptyExecutorsWithoutSlowest sumEmptyExecutors maxAverageTimeEmptyExecutors
sumAverageTime averageTime averageTime maxAverageTime maxAverageTime averageTime maxAverageTimeEmptyExecutors emptyExecutor maxAverageTimeMaxExecutors maxExecutors maxAverageTimeIdentity workerIdentity sumEmptyExecutors emptyExecutor workerNum LOG debug sumAverageTime sumEmptyExecutors maxAverageTime maxAverageTimeEmptyExecutors maxAverageTimeMaxExecutors workerNum maxAverageTimeIdentity blacklistedNodes averageTimeWithoutSlowest sumAverageTime maxAverageTime workerNum averageTimeWithoutSlowest maxAverageTime emptyExecutorsWithoutSlowest sumEmptyExecutors maxAverageTimeEmptyExecutors emptyExecutorsWithoutSlowest maxAverageTimeMaxExecutors
currentTime System currentTimeMillis currentTime LlapZookeeperRegistryImpl ConfigChangeLockResult lockResult registry lockForConfigChange currentTime currentTime minConfigChangeDelayMs
currentTime System currentTimeMillis currentTime LlapZookeeperRegistryImpl ConfigChangeLockResult lockResult registry lockForConfigChange currentTime currentTime minConfigChangeDelayMs LOG debug lockResult lockResult
ICacheableMetaStoreClient ICacheableMetaStoreClient ICacheableMetaStoreClient ICacheableMetaStoreClient notification ICacheableMetaStoreClient hiveMetaStoreClient notification getValue hiveMetaStoreClient
hiveCache cleanUp
fs eventsDir String owner eventsDir getOwner owner fs delete eventsDir getPath LOG info eventsDir getPath owner UserGroupInformation ugi UserGroupInformation createProxyUser owner UserGroupInformation getLoginUser ugi doAsFs eventsDir getPath doAsFs delete eventsDir getPath
job String inputName job get Utilities INPUT_NAME
LOG info portFromConf HiveConf getIntVar conf HiveConf ConfVars LLAP_DAEMON_OUTPUT_SERVICE_PORT sendBufferSize HiveConf getIntVar conf HiveConf ConfVars LLAP_DAEMON_OUTPUT_SERVICE_SEND_BUFFER_SIZE eventLoopGroup NioEventLoopGroup serverBootstrap ServerBootstrap serverBootstrap group eventLoopGroup serverBootstrap channel NioServerSocketChannel serverBootstrap childHandler LlapOutputFormatServiceChannelHandler sendBufferSize listeningChannelFuture serverBootstrap bind portFromConf sync port InetSocketAddress listeningChannelFuture channel localAddress getPort
perfLogger perfLogBegin CLASS_NAME PerfLogger COMPILE driverState compilingWithLocking variableSubstitution String String SessionState get getHiveVariables String command variableSubstitution substitute driverContext getConf rawCommand String queryStr command queryStr HookUtils redactLogString driverContext getConf command e LOG warn e DriverUtils checkInterrupted driverState driverContext context setCmd command driverContext getQueryDisplay setQueryStr queryStr
conf Hive hiveDb Hive get Long lastReplId hiveDb getMSC getCurrentNotificationEventId getEventId conf setLong ReplUtils LAST_REPL_ID_KEY lastReplId
explainOutput sem plan driverContext getConf driverContext getConf String explainOutput ExplainTask getExplainOutput sem plan tree driverContext getQueryState context driverContext getConf explainOutput driverContext getConf
String fileSystem inputPathUri getScheme inputPathUri getAuthority FileSystem fs fs inputPath getFileSystem conf e IllegalStateException inputPath e e String stagingPathName inputPathName indexOf stagingDir stagingPathName Path inputPathName stagingDir toString stagingPathName inputPathName substring inputPathName indexOf stagingDir stagingDir length String key fileSystem stagingPathName TaskRunner getTaskRunnerID Path dir fsScratchDirs get key dir dir fs makeQualified Path stagingPathName executionId TaskRunner getTaskRunnerID
fsResultCacheDirs Path p fsResultCacheDirs FileSystem fs p getFileSystem conf
materializedTable Path location materializedTable getDataLocation FileSystem fs location getFileSystem conf status fs delete location
subContext subContext clear resDir resDir FileSystem fs resDir getFileSystem conf LOG debug resDir fs delete resDir e LOG info StringUtils stringifyException e resFile resFile FileSystem fs resFile getFileSystem conf LOG debug resFile fs delete resFile e
SessionState getPerfLogger perfLogBegin CLASS_NAME PerfLogger DRIVER_EXECUTE noName Strings isNullOrEmpty driverContext getConf get MRJobConfig JOB_NAME checkState executionError
driverContext getHookRunner runAfterExecutionHook driverContext getQueryString hookContext executionError e LOG warn e SessionState get getHiveHistory endQuery driverContext getQueryId driverContext getConf set MRJobConfig JOB_NAME duration SessionState getPerfLogger perfLogEnd CLASS_NAME PerfLogger DRIVER_EXECUTE ImmutableMap String Long executionHMSTimings Hive dumpMetaCallTimingWithoutEx driverContext getQueryDisplay setHmsTimings QueryDisplay Phase EXECUTION executionHMSTimings logExecutionResourceUsage SessionState get getSparkSession SessionState get getSparkSession onQueryCompletion driverContext getQueryId driverState executionFinishedWithLocking executionError driverState
e LOG warn e SessionState get getHiveHistory endQuery driverContext getQueryId driverContext getConf set MRJobConfig JOB_NAME duration SessionState getPerfLogger perfLogEnd CLASS_NAME PerfLogger DRIVER_EXECUTE ImmutableMap String Long executionHMSTimings Hive dumpMetaCallTimingWithoutEx driverContext getQueryDisplay setHmsTimings QueryDisplay Phase EXECUTION executionHMSTimings logExecutionResourceUsage SessionState get getSparkSession SessionState get getSparkSession onQueryCompletion driverContext getQueryId driverState executionFinishedWithLocking executionError driverState LOG info driverContext getQueryId duration
MapRedTask mapredTask MapRedTask runner getTask MapWork mapWork mapredTask getWork getMapWork ReduceWork reduceWork mapredTask getWork getReduceWork List Operator operators ArrayList Operator mapWork getAliasToWork values reduceWork operators add reduceWork getReducer List String statKeys ArrayList String operators fsOp fsOp getConf statKeys add fsOp getConf getStatsAggPrefix String statKey statKeys statsTasks statKey statsTasks get statKey getWork setSourceTask mapredTask
CacheEntry CacheEntry result
CacheEntry queryInfo txnWriteIdList String queryText queryInfo getLookupInfo getQueryText CacheEntry addedEntry CacheEntry addedEntry queryInfo queryInfo addedEntry txnWriteIdList txnWriteIdList Lock writeLock rwLock writeLock writeLock lock
entry QueryInfo queryInfo entry getQueryInfo readEntity queryInfo readEntity Table tableUsed readEntity getTable Map String Table tempTables SessionHiveMetaStoreClient getTempTablesForDatabase tableUsed getDbName tableUsed getTableName tempTables tempTables tableUsed getTableName
tableUsed getTableName LOG info tableUsed getTableName tableUsed writeIdCheckPassed String tableName tableUsed getFullyQualifiedName ValidTxnWriteIdList currentTxnWriteIdList lookupInfo txnWriteIdListProvider get currentTxnWriteIdList LOG warn entry txnWriteIdList LOG warn ValidWriteIdList currentWriteIdForTable currentTxnWriteIdList getTableValidWriteIdList tableName ValidWriteIdList cachedWriteIdForTable entry txnWriteIdList getTableValidWriteIdList tableName
writeIdCheckPassed String tableName tableUsed getFullyQualifiedName ValidTxnWriteIdList currentTxnWriteIdList lookupInfo txnWriteIdListProvider get currentTxnWriteIdList LOG warn entry txnWriteIdList LOG warn ValidWriteIdList currentWriteIdForTable currentTxnWriteIdList getTableValidWriteIdList tableName ValidWriteIdList cachedWriteIdForTable entry txnWriteIdList getTableValidWriteIdList tableName LOG debug tableName currentWriteIdForTable cachedWriteIdForTable currentWriteIdForTable cachedWriteIdForTable currentWriteIdForTable cachedWriteIdForTable writeIdCheckPassed
entry Preconditions checkState entry getStatus CacheEntryStatus INVALID HiveConf conf getInstance conf entry cachedResultsPath getInstance entry cachedResultsPath Path path entry cachedResultsPath
serdeName conf Deserializer d ReflectionUtil newInstance conf getClassByName serdeName asSubclass Deserializer conf d
List String databases context getDb getAllDatabases
FunctionResource resources FunctionUtils toFunctionResource desc getResources FunctionUtils addFunctionResources resources Class udfClass getUdfClass FunctionInfo registered FunctionRegistry registerTemporaryUDF desc getName udfClass resources registered context getConsole printError desc getClassName e context getConsole printError e toString LOG info e e context getConsole printError desc getClassName
String dbName String Map String String dbProps Hive get getDatabase dbName getParameters dbProps
String dbName String Map String String dbProps Hive get getDatabase dbName getParameters dbProps
Set String Set String funcs desc getPattern funcs FunctionRegistry getFunctionNamesByLikePattern desc getPattern
Msck msck Msck msck init Msck getMsckConf context getDb getConf TableName tableName HiveTableName of desc getTableName partitionExpirySeconds msc context getConf msckEnablePartitionRetention MetastoreConf getBoolVar context getConf MetastoreConf ConfVars MSCK_REPAIR_ENABLE_PARTITION_RETENTION msckEnablePartitionRetention Table table msc getTable SessionState get getCurrentCatalog tableName getDb tableName getTable String qualifiedTableName Warehouse getCatalogQualifiedTableName table partitionExpirySeconds PartitionManagementTask getRetentionPeriodInSeconds table
Msck msck Msck msck init Msck getMsckConf context getDb getConf TableName tableName HiveTableName of desc getTableName partitionExpirySeconds msc context getConf msckEnablePartitionRetention MetastoreConf getBoolVar context getConf MetastoreConf ConfVars MSCK_REPAIR_ENABLE_PARTITION_RETENTION msckEnablePartitionRetention Table table msc getTable SessionState get getCurrentCatalog tableName getDb tableName getTable String qualifiedTableName Warehouse getCatalogQualifiedTableName table partitionExpirySeconds PartitionManagementTask getRetentionPeriodInSeconds table LOG info qualifiedTableName partitionExpirySeconds MsckInfo msckInfo MsckInfo SessionState get getCurrentCatalog tableName getDb tableName getTable desc getFilterExp desc getResFile desc isRepairPartitions desc isAddPartitions desc isDropPartitions partitionExpirySeconds msck repair msckInfo
TableName tableName HiveTableName of desc getTableName partitionExpirySeconds msc context getConf msckEnablePartitionRetention MetastoreConf getBoolVar context getConf MetastoreConf ConfVars MSCK_REPAIR_ENABLE_PARTITION_RETENTION msckEnablePartitionRetention Table table msc getTable SessionState get getCurrentCatalog tableName getDb tableName getTable String qualifiedTableName Warehouse getCatalogQualifiedTableName table partitionExpirySeconds PartitionManagementTask getRetentionPeriodInSeconds table LOG info qualifiedTableName partitionExpirySeconds MsckInfo msckInfo MsckInfo SessionState get getCurrentCatalog tableName getDb tableName getTable desc getFilterExp desc getResFile desc isRepairPartitions desc isAddPartitions desc isDropPartitions partitionExpirySeconds msck repair msckInfo e LOG error e e
Table Table tbl Table tableName getDb tableName getTable getTblProps tbl getTTable getParameters putAll getTblProps getPartCols tbl setPartCols getPartCols getNumBuckets tbl setNumBuckets getNumBuckets getStorageHandler tbl setProperty org apache hadoop hive metastore api hive_metastoreConstants META_TABLE_STORAGE getStorageHandler HiveStorageHandler storageHandler tbl getStorageHandler String serDeClassName storageHandler serDeClassName PlanUtils getDefaultSerDe getName
tbl getTTable getParameters putAll getTblProps getPartCols tbl setPartCols getPartCols getNumBuckets tbl setNumBuckets getNumBuckets getStorageHandler tbl setProperty org apache hadoop hive metastore api hive_metastoreConstants META_TABLE_STORAGE getStorageHandler HiveStorageHandler storageHandler tbl getStorageHandler String serDeClassName storageHandler serDeClassName PlanUtils getDefaultSerDe getName LOG info serDeClassName tableName serDeClassName storageHandler getSerDeClass getName
Table tbl desc toTable context getConf
desc getPrimaryKeys desc getForeignKeys desc getUniqueConstraints desc getNotNullConstraints desc getDefaultConstraints desc getCheckConstraints context getDb createTable tbl desc getIfNotExists desc getPrimaryKeys desc getForeignKeys desc getUniqueConstraints desc getNotNullConstraints desc getDefaultConstraints desc getCheckConstraints context getDb createTable tbl desc getIfNotExists desc Table createdTable context getDb getTable tbl getDbName tbl getTableName DataContainer dc DataContainer createdTable getTTable context getQueryState getLineageState setLineage createdTable getPath dc createdTable getCols createdTable createdTable org apache hadoop hive metastore api Table tTable createdTable getTTable Path tabLocation Path tTable getSd getLocation List Path newFilesList ArrayList Hive listFilesInsideAcidDirectory tabLocation tabLocation getFileSystem context getConf newFilesList
table table setInputFormatClass desc getDefaultInputFormat table setOutputFormatClass desc getDefaultOutputFormat table getTTable getSd setInputFormat table getInputFormatClass getName table getTTable getSd setOutputFormat table getOutputFormatClass getName desc
desc table table desc table HiveException HiveException ReplicationSpec replicationSpec desc getReplicationSpec replicationSpec replicationSpec table table PartitionIterable partitions PartitionIterable context getDb table MetastoreConf getIntVar context getConf MetastoreConf ConfVars BATCH_RETRIEVE_MAX p partitions replicationSpec context getDb dropPartition table getDbName table getTableName p getValues
Table table getTable Partition part getPartition table String dbTableName desc getDbTableName desc
List FieldSchema cols ArrayList List ColumnStatisticsObj colStats ArrayList Deserializer deserializer getDeserializer table desc getColumnPath getColumnsNoColumnPath table part cols desc isFormatted getColumnDataColPathSpecified table part cols colStats deserializer cols addAll Hive getFieldsFromDeserializer desc getColumnPath deserializer fixDecimalColumnTypeName cols setConstraintsAndStorageHandlerInfo table handleMaterializedView table isOutputPadded SessionState get isHiveServerQuery context getFormatter describeTable outStream desc getColumnPath dbTableName table part cols desc isFormatted desc isExtended isOutputPadded colStats
StringBuilder builder StringBuilder String propertyName desc getPropertyName propertyName String propertyValue tbl getProperty propertyName propertyValue String errMsg tableName propertyName builder append errMsg DDLUtils appendNonNull builder propertyName DDLUtils appendNonNull builder propertyValue Map String String properties TreeMap String String tbl getParameters String String entry properties DDLUtils appendNonNull builder entry getKey DDLUtils appendNonNull builder entry getValue
truncateWork setListBucketingCtx desc getLbCtx truncateWork setMapperCannotSpanPartns TaskQueue taskQueue TaskQueue ColumnTruncateTask taskExec ColumnTruncateTask taskExec initialize context getQueryState taskQueue taskExec setWork truncateWork taskExec setQueryPlan context getQueryPlan ret taskExec execute taskExec getException context getTask setException taskExec getException ret String tableName desc getTableName Map String String partSpec desc getPartSpec ReplicationSpec replicationSpec desc getReplicationSpec context tableName partSpec replicationSpec
partitionSpec List Partition parts parts db getPartitions table partitionSpec e LOG error StringUtils stringifyException e SemanticException e getMessage e parts ArrayList Partition Partition p db getPartition table partitionSpec p parts add p e
String tableName desc getTableName Map String String oldPartSpec desc getOldPartSpec ReplicationSpec replicationSpec desc getReplicationSpec tableName oldPartSpec replicationSpec
ASTNode root TableName viewName getQualifiedTableName ASTNode root getChild String fqViewName viewName getNotEmptyDbTable
sortColNames tbl setProperty Constants MATERIALIZED_VIEW_SORT_COLUMNS Utilities encodeColumnNames sortColNames distributeColNames tbl setProperty Constants MATERIALIZED_VIEW_DISTRIBUTE_COLUMNS Utilities encodeColumnNames distributeColNames getInputFormat tbl setInputFormatClass getInputFormat getOutputFormat tbl setOutputFormatClass getOutputFormat getLocation tbl setDataLocation Path getLocation getStorageHandler tbl setProperty org apache hadoop hive metastore api hive_metastoreConstants META_TABLE_STORAGE getStorageHandler HiveStorageHandler storageHandler tbl getStorageHandler String serDeClassName
distributeColNames tbl setProperty Constants MATERIALIZED_VIEW_DISTRIBUTE_COLUMNS Utilities encodeColumnNames distributeColNames getInputFormat tbl setInputFormatClass getInputFormat getOutputFormat tbl setOutputFormatClass getOutputFormat getLocation tbl setDataLocation Path getLocation getStorageHandler tbl setProperty org apache hadoop hive metastore api hive_metastoreConstants META_TABLE_STORAGE getStorageHandler HiveStorageHandler storageHandler tbl getStorageHandler String serDeClassName storageHandler serDeClassName PlanUtils getDefaultSerDe getName
desc Table mvTable context getDb getTable desc getName HiveMaterializedViewsRegistry get createMaterializedView context getDb getConf mvTable desc String names desc getName split HiveMaterializedViewsRegistry get dropMaterializedView names names desc Table mvTable context getDb getTable desc getName CreationMetadata cm CreationMetadata MetaStoreUtils getDefaultCatalog context getConf mvTable getDbName mvTable getTableName ImmutableSet copyOf mvTable getCreationMetadata getTablesUsed cm setValidTxnList context getConf get ValidTxnWriteIdList VALID_TABLES_WRITEIDS_KEY context getDb updateCreationMetadata mvTable getDbName mvTable getTableName cm mvTable setCreationMetadata cm HiveMaterializedViewsRegistry get createMaterializedView context getDb getConf mvTable
appliedResourcePlan String name name appliedResourcePlan getPlan getName
LOG info wm ListenableFuture Boolean future wm updateResourcePlanAsync appliedResourcePlan isOk future get isOk LOG info name LOG info e HiveException e isOk
future get isOk LOG info name LOG info e HiveException e isOk LOG error name LOG error TezSessionPoolManager pm TezSessionPoolManager getInstance
fileName live hotspotMBean MBeanServer server ManagementFactory getPlatformMBeanServer hotspotMBean ManagementFactory newPlatformMXBeanProxy server HOTSPOT_BEAN_NAME HOTSPOT_MXBEAN_CLASS e LOG error e getMessage RuntimeException e DUMP_HEAP_METHOD DUMP_HEAP_METHOD invoke hotspotMBean Object fileName Boolean valueOf live RuntimeException re LOG error re getMessage re
inputPath dpPath inputPath String msg dpPath inputPath
hconf success Path outputDir conf getOutputPath FileSystem fs outputDir getFileSystem hconf Long mmWriteId conf getWriteId stmtId conf getStmtId Path backupPath backupOutputPath fs outputDir Utilities mvFileToFinalPath outputDir hconf success LOG conf getDpCtx reporter success
row HiveException hasReachedMaxSize ObjectInspector rowInspector inputObjInspectors Writable writableRow serializer serialize row rowInspector writableRow write buffer buffer getLength LOG LOG info buffer getLength hasReachedMaxSize buffer e HiveException e LOG
sum i i numAliases i offsets i sum sum joinValues order i size offsets numAliases sum outputObjInspector getJoinOutputObjectInspector order joinValuesStandardObjectInspectors conf i i i i hasLeftSemiJoin i hasLeftAntiSemiJoin conf getResidualFilterExprs residualJoinFilters ArrayList conf getResidualFilterExprs size residualJoinFiltersOIs ArrayList conf getResidualFilterExprs size i i conf getResidualFilterExprs size i
List Path String refTableInputFile String String alias List String pathStr aliasBucketMapping get alias get refTableInputFile List Path paths ArrayList Path pathStr String pathStr
e RuntimeException e childrenDone newChildOperatorsTag childOperators size i i childOperators size i Operator OperatorDesc child childOperators get i List Integer childOperatorTags ArrayList Integer child index Operator OperatorDesc child getParentOperators childOperatorTags add index index childOperatorTags add child getParentOperators indexOf
state State INIT LOG LOG info id getName
LOG info id getName i i childOperatorsArray length i LOG LOG info i childOperatorsArray i getIdentifier childOperatorsArray i getName childInputObjInspectors i length childOperatorsArray i ObjectInspector ois childInputObjInspectors i j j ois length j ois j childOperatorsArray i initialize hconf ois j j reporter childOperatorsArray i setReporter reporter i i childOperatorsArray length i LOG
tag currentChildIndex newTagToChildIndex tag endGroupIfNecessary currentChildIndex oldTag newTagToOldTag tag cntrs tag cntrs tag tag
i i newTagToOldTag i newTag i oldTag newTagToOldTag i childIndex newTagToChildIndex newTag
work work getAstStringTree outputAST work getAstStringTree out work isFormatted work JsonParser jsonParser JsonParserFactory getParser conf work getConfig setFormatted JSONObject jsonPlan getJSONPlan out work work getCboInfo jsonPlan put work getCboInfo jsonParser print jsonPlan out e LOG error e work getConfig setFormatted
TableExport Paths exportPaths TableExport Paths work getAstRepresentationForErrorMsg work getExportRootDir conf Hive db getHive
writeIdStr job set ValidWriteIdList VALID_WRITEIDS_KEY writeIdStr
ValidWriteIdList String txnString job get ValidWriteIdList VALID_WRITEIDS_KEY
job job JobConf conf Operator source work getSource source TableScanOperator TableScanOperator ts TableScanOperator source ColumnProjectionUtils appendReadColumns job ts getNeededColumnIDs ts getNeededColumns ts getNeededNestedColumnPaths HiveInputFormat pushFilters job ts AcidUtils setAcidOperationalProperties job ts getConf isTranscationalTable ts getConf getAcidOperationalProperties sink work getSink fetch FetchOperator work job source getVirtualColumns source source initialize conf ObjectInspector fetch getOutputObjectInspector totalRows ExecMapper setDone
row_count set numRows
genericUDF GenericUDFMacro GenericUDFMacro bridge GenericUDFMacro genericUDF clonedUDF GenericUDFMacro bridge getMacroName bridge getBody clone bridge getColNames bridge getColTypes clonedUDF ReflectionUtils newInstance genericUDF getClass clonedUDF genericUDF copyToNewInstance clonedUDF err IllegalArgumentException err genericUDF SettableUDF TypeInfo typeInfo SettableUDF genericUDF getTypeInfo typeInfo SettableUDF clonedUDF setTypeInfo typeInfo
Map Entry KeyWrapper AggregationBuffer entry hashAggregations entrySet forward entry getKey getKeyArray entry getValue hashAggregations LOG info oldSize hashAggregations size LOG info oldSize Iterator Map Entry KeyWrapper AggregationBuffer iter hashAggregations entrySet iterator numDel iter Map Entry KeyWrapper AggregationBuffer m iter next forward m getKey getKeyArray m getValue iter remove numDel numDel oldSize
Path tmpURI getExecContext getLocalWork getTmpPath
List Object nr getFilteredValue alias row addToAliasFilterTags alias nr skewJoinKeyContext handleSkew tag sz storage alias rowCount StructObjectInspector soi StructObjectInspector inputObjInspectors tag StructField sf soi getStructFieldRef Utilities ReduceField KEY toString List keyObject List soi getStructFieldData row sf alias skewJoinKeyContext sz alias alias checkAndGenObject storage alias clearRows alias nextSz getNextSize sz nextSz
pos partitionId HybridHashTableContainer container HybridHashTableContainer mapJoinTables pos HashPartition partition container getHashPartitions partitionId LOG info KeyValueContainer kvContainer partition getSidefileKVContainer rowCount kvContainer size
partitionId HashPartition partition firstSmallTable getHashPartitions partitionId ObjectContainer bigTable partition getMatchfileObjContainer
JoinCondDesc joinConds getConf getConds joinConds JoinCondDesc joinConds skipJoinProcessing idx idx mapJoinTables idx idx getConf MapJoinTableContainer mapJoinTable mapJoinTables idx mapJoinTable
Configuration hconf List Operator OperatorDesc children ArrayList Operator OperatorDesc Map String Configuration tableNameToConf cloneConfsForNestedColPruning hconf Map TableDesc StructObjectInspector convertedOI getConvertedOI tableNameToConf Map Path List String entry conf Path onefile entry getKey List String aliases entry getValue PartitionDesc partDesc conf getPathToPartitionInfo get onefile TableDesc tableDesc partDesc getTableDesc Configuration newConf tableNameToConf get tableDesc getTableName String alias aliases Operator OperatorDesc op conf getAliasToWork get alias
closeOp abort closeOp abort
srcFs sourcePath getFileSystem conf e LOG error e HiveException e getMessage e srcFs sourcePath Path deletePath conf deletePath createTargetPath targetPath tgtFs Hive clearDestForSubDirSrc conf targetPath sourcePath Hive conf sourcePath targetPath deletePath tgtFs delete deletePath
HiveException startTime System currentTimeMillis Partition entry Partition partn entry getValue tbd ti bucketCols ti sortCols updatePartitionBucketSortColumns db table partn ti bucketCols ti numBuckets ti sortCols WriteEntity enty WriteEntity partn getWriteType tbd work getLoadTableWork getWriteType work getOutputs DDLUtils addIfAbsentByName enty work getOutputs queryPlan getOutputs queryPlan setOutputs LinkedHashSet WriteEntity queryPlan getOutputs add enty dc DataContainer table getTTable partn getTPartition work getLoadTableWork getWriteType work getLoadTableWork getWriteType queryState getLineageState setLineage tbd getSourcePath dc table getCols
tag cntrs tag cntrs tag tag
ObjectCache queryId queryId RuntimeException ObjectCache result llapQueryCaches get queryId result result result LlapObjectCache ObjectCache old llapQueryCaches putIfAbsent queryId result old
i i childOperatorsArray length i childOperatorsArray i childOperators get i multiChildren childOperatorsArray length childOperatorsTag childOperatorsArray length i i childOperatorsArray length i List Operator OperatorDesc parentOperators childOperatorsArray i getParentOperators childOperatorsTag i parentOperators indexOf childOperatorsTag i HiveException inputObjInspectors length HiveException outputObjInspector inputObjInspectors isInitOk initializeOp hconf
List Operator OperatorDesc parentOperators childOperatorsArray i getParentOperators childOperatorsTag i parentOperators indexOf childOperatorsTag i HiveException inputObjInspectors HiveException outputObjInspector inputObjInspectors isInitOk initializeOp hconf childOperatorsArray AssertionError LOG debug initializeChildren hconf isInitOk
closeOp abort publishRunTimeStats LongWritable runTimeRowsWritable LongWritable runTimeNumRows LongWritable recordCounter LongWritable numRows statsMap put Counter RECORDS_OUT_OPERATOR name getOperatorId runTimeRowsWritable statsMap put getCounterName Counter RECORDS_OUT_INTERMEDIATE hconf recordCounter runTimeNumRows reporter logStats op LOG debug op
k OrcFileKeyWrapper CombineHiveKey key getKey k OrcFileKeyWrapper key k LOG warn k getInputPath addIncompatibleFile k getInputPath filePath k getInputPath toUri getPath Utilities FILE_OP_LOGGER info filePath fixTmpPath k getInputPath getParent v OrcFileValueWrapper value prevPath prevPath k getInputPath reader OrcFile createReader fs k getInputPath LOG
bucketId bucketId AcidUtils parseBucketId Path filePath bucketId compression k getCompression compressBuffSize k getCompressBufferSize fileVersion k getFileVersion writerVersion k getWriterVersion fileSchema k getFileSchema rowIndexStride k getRowIndexStride OrcFile WriterOptions options OrcFile writerOptions jc compress compression version fileVersion rowIndexStride rowIndexStride inspector reader getObjectInspector compression options bufferSize compressBuffSize enforceBufferSize Path outPath getOutPath
fileSchema k getFileSchema rowIndexStride k getRowIndexStride OrcFile WriterOptions options OrcFile writerOptions jc compress compression version fileVersion rowIndexStride rowIndexStride inspector reader getObjectInspector compression options bufferSize compressBuffSize enforceBufferSize Path outPath getOutPath outPath getOutPath bucketId outWriters put bucketId OrcFile createWriter outPath options LOG LOG info outPath k addIncompatibleFile k getInputPath k getInputPath
initializeOp hconf initializeOp hconf numRows cntr logEveryNRows HiveConf getLongVar hconf HiveConf ConfVars HIVE_LOG_N_RECORDS List ExprNodeDesc keys conf getKeyCols
initializeOp hconf initializeOp hconf numRows cntr logEveryNRows HiveConf getLongVar hconf HiveConf ConfVars HIVE_LOG_N_RECORDS List ExprNodeDesc keys conf getKeyCols LOG LOG debug keys size ExprNodeDesc keys
FunctionResource resources function getResources FunctionUtils addFunctionResources resources e LOG error qualifiedName e e ClassLoader loader Utilities getSessionSpecifiedClassLoader Class udfClass Class forName function getClassName loader ret SessionState getRegistryForWrite registerFunction qualifiedName FunctionType PERSISTENT udfClass resources ret LOG error function getClassName SessionState SessionState getRegistryForWrite addToUDFLoaders loader e
Path dataPath Path fileListing Path dataPath EximUtil FILES_NAME
Task Task copyTask
String cmdArgs splitArgs conf getScriptCmd String prog cmdArgs File currentDir File getAbsoluteFile File prog PathFinder finder PathFinder finder prependPathComponent currentDir toString sparkConf SparkEnv get conf finder prependPathComponent SparkFiles getRootDirectory File f finder getAbsolutePath prog f cmdArgs f getAbsolutePath f String wrappedCmdArgs addWrapper cmdArgs
scriptOutWriter conf getInRecordWriterClass newInstance scriptOutWriter initialize scriptOut hconf RecordReader scriptOutputReader conf getOutRecordReaderClass newInstance scriptOutputReader initialize scriptIn hconf conf getScriptOutputInfo getProperties outThread StreamThread scriptOutputReader OutputStreamProcessor scriptOutputDeserializer getObjectInspector RecordReader scriptErrReader conf getErrRecordReaderClass newInstance scriptErrReader initialize scriptErr hconf conf getScriptErrInfo getProperties errThread StreamThread scriptErrReader ErrorStreamProcessor HiveConf getIntVar hconf HiveConf ConfVars SCRIPTERRORLIMIT HiveConf hconf HiveConf ConfVars autoProgressor AutoProgressor getClass getName reporter Utilities getDefaultNotificationInterval hconf HiveConf getTimeVar hconf HiveConf ConfVars HIVES_AUTO_PROGRESS_TIMEOUT TimeUnit MILLISECONDS autoProgressor go outThread start errThread start e HiveException ErrorMsg SCRIPT_INIT_ERROR getErrorCodedMsg e
scriptError HiveException ErrorMsg SCRIPT_GENERIC_ERROR getErrorCodedMsg scriptError Writable res scriptInputSerializer serialize row inputObjInspectors tag scriptOutWriter write res e LOG error e getMessage scriptError e serialize_error_count set serialize_error_count get HiveException e e e scriptPid waitFor
scriptOutWriter scriptOutWriter close e e LOG warn e displayBrokenPipeInfo e exitVal scriptPid exitVal scriptPid waitFor exitVal
scriptOutWriter scriptOutWriter close e e LOG warn e displayBrokenPipeInfo e exitVal scriptPid exitVal scriptPid waitFor exitVal LOG error exitVal new_abort
exitVal scriptPid exitVal scriptPid waitFor exitVal LOG error exitVal new_abort e LOG error e new_abort e Thread mythread Thread currentThread Timer timer Timer timer
T T T PerfLogger perfLogger SessionState getPerfLogger perfLogger perfLogBegin CLASS_NAME PerfLogger DESERIALIZE_PLAN T plan
List ObjectInspector skewTableKeyInspectors ArrayList ObjectInspector StructObjectInspector soi StructObjectInspector joinOp inputObjInspectors alias StructField sf soi getStructFieldRef Utilities ReduceField KEY toString List StructField keyFields StructObjectInspector sf getFieldObjectInspector getAllStructFieldRefs keyFieldSize keyFields size k k keyFieldSize k skewTableKeyInspectors add keyFields get k getFieldObjectInspector TableDesc joinKeyDesc desc getKeyTableDesc List String keyColNames Utilities getColumnNames joinKeyDesc getProperties StructObjectInspector structTblKeyInpector ObjectInspectorFactory getStandardStructObjectInspector keyColNames skewTableKeyInspectors AbstractSerDe serializer AbstractSerDe ReflectionUtils newInstance tblDesc get alias getDeserializerClass SerDeUtils initializeSerDe serializer tblDesc get alias getProperties tblSerializers put i serializer
work work RuntimeException ret work work getBasicStatsNoJobWork setPartitions work getPartitions Hive db getHive Table tbl getTable db task task setDpPartSpecs dpPartSpecs ret task process db tbl ret ret
ExecutorService HiveConf conf numThreads HiveConf getIntVar conf ConfVars HIVE_STATS_GATHER_NUM_THREADS ExecutorService executor Executors newFixedThreadPool numThreads ThreadFactoryBuilder setDaemon setNameFormat build
LOG info HiveException ErrorMsg STATSPUBLISHER_CONNECTION_ERROR getErrorCodedMsg Map String String statsToPublish HashMap String String String pspecs stats statsToPublish clear String prefix Utilities join conf getStatsAggPrefix pspecs String key prefix endsWith Path SEPARATOR prefix prefix Path SEPARATOR String statType stats get pspecs statsToPublish put statType Long toString stats get pspecs getStat statType key statsToPublish HiveException ErrorMsg STATSPUBLISHER_PUBLISHING_ERROR getErrorCodedMsg LOG
topNKeyFilters TopNKeyFilter filter topNKeyFilters values iterator next
columnTypeResolvers c ReturnObjectInspectorResolver p p parents p assert columns parentFields p size columns c c columns c columnTypeResolvers c parentFields p get c getFieldObjectInspector HiveException ArrayList ObjectInspector outputFieldOIs ArrayList ObjectInspector columns c c columns c ObjectInspector fieldOI parentFields get c getFieldObjectInspector outputFieldOIs add columnTypeResolvers c get fieldOI outputObjInspector ObjectInspectorFactory getStandardStructObjectInspector columnNames outputFieldOIs outputRow ArrayList Object columns c c columns c outputRow add needsTransform parents
conf name Path path getPlanPath conf name
Path localPath path LOG debug localPath serializedSize String planMode conf String planStringPath path toUri getPath LOG debug planStringPath String planString conf getRaw planStringPath planString LOG info serializedSize planString length planMode planBytes Base64 getDecoder decode planString in ByteArrayInputStream planBytes
conf get MAPRED_MAPPER_CLASS gWork SerializationUtilities deserializePlan kryo in MapWork conf get MAPRED_MAPPER_CLASS gWork SerializationUtilities deserializePlan kryo in MergeFileWork conf get MAPRED_MAPPER_CLASS gWork SerializationUtilities deserializePlan kryo in ColumnTruncateWork RuntimeException MAPRED_MAPPER_CLASS conf get MAPRED_MAPPER_CLASS conf get MAPRED_REDUCER_CLASS gWork SerializationUtilities deserializePlan kryo in ReduceWork RuntimeException MAPRED_REDUCER_CLASS conf get MAPRED_REDUCER_CLASS
out fs create planPath SerializationUtilities serializePlan kryo w out out close out fileLen fs getFileStatus planPath getLen serializedSize fileLen planMode IOUtils closeStream out conf DistributedCache conf DistributedCache createSymlink conf String uriWithLink planPath toUri toString name DistributedCache addCacheFile URI uriWithLink conf
LOG info src dst ExecutorService pool createMoveThreadPool conf List Future Void futures LinkedList FileStatus files fs listStatus src FileStatus file files futures pool Void Void HiveException Utilities moveFile fs file dst e HiveException e shutdownAndCleanup pool futures
List FileStatus statusList HiveStatsUtils getFileStatusRecurse tmpPath dpCtx dpCtx getNumDPCols fs FileStatus statuses statusList toArray FileStatus statusList size statuses statuses Set FileStatus filesKept HashSet perfLogger perfLogBegin List Path emptyBuckets Utilities removeTempOrDuplicateFiles fs statuses dpCtx conf hconf filesKept perfLogger perfLogEnd emptyBuckets perfLogger perfLogBegin createEmptyBuckets hconf emptyBuckets conf getCompressed conf getTableInfo reporter Path p emptyBuckets FileStatus items fs listStatus p filesKept addAll Arrays asList items perfLogger perfLogEnd Utilities FILE_OP_LOGGER trace tmpPath specPath
Set FileStatus filesKept HashSet perfLogger perfLogBegin List Path emptyBuckets Utilities removeTempOrDuplicateFiles fs statuses dpCtx conf hconf filesKept perfLogger perfLogEnd emptyBuckets perfLogger perfLogBegin createEmptyBuckets hconf emptyBuckets conf getCompressed conf getTableInfo reporter Path p emptyBuckets FileStatus items fs listStatus p filesKept addAll Arrays asList items perfLogger perfLogEnd Utilities FILE_OP_LOGGER trace tmpPath specPath conf hconf LOG debug filesKept toString conf getFilesToFetch addAll filesKept
perfLogger perfLogBegin createEmptyBuckets hconf emptyBuckets conf getCompressed conf getTableInfo reporter p emptyBuckets FileStatus items fs listStatus p filesKept addAll Arrays asList items perfLogger perfLogEnd Utilities FILE_OP_LOGGER trace tmpPath specPath conf hconf LOG debug filesKept toString conf getFilesToFetch addAll filesKept conf conf perfLogger perfLogBegin LOG debug filesKept toString moveSpecifiedFilesInParallel hconf fs tmpPath specPath filesKept perfLogger perfLogEnd
moveSpecifiedFilesInParallel conf fs srcPath destPath filesToMove LOG info filesToMove size srcPath destPath PerfLogger perfLogger SessionState getPerfLogger perfLogger perfLogBegin ExecutorService pool createMoveThreadPool conf List Future Void futures LinkedList moveSpecifiedFilesInParallel fs srcPath destPath filesToMove futures pool shutdownAndCleanup pool futures
HiveOutputFormat hiveOutputFormat Class Writable outputClass Serializer serializer Serializer tableInfo getDeserializerClass newInstance serializer initialize hconf tableInfo getProperties outputClass serializer getSerializedClass hiveOutputFormat HiveFileFormatUtils getHiveOutputFormat hconf tableInfo e HiveException e e HiveException e e HiveException e path Utilities FILE_OP_LOGGER trace path
Path path part getPath pool pool FileStatus items removeEmptyDpDirectory fs path partStatusMap put path items partStatusMap put path removeEmptyDpDirectory fs path pool pool shutdown future future get
path path path ContentSummary cs ctx getCS path cs summary cs getLength summary cs getFileCount summary cs getDirectoryCount pathNeedProcess add path ExecutorService executor numExecutors getMaxExecutorsForInputListing ctx getConf pathNeedProcess size numExecutors
metaTableStorage partDesc getTableDesc getProperties getProperty hive_metastoreConstants META_TABLE_STORAGE partDesc getProperties metaTableStorage partDesc getProperties getProperty hive_metastoreConstants META_TABLE_STORAGE metaTableStorage HiveStorageHandler handler HiveUtils getStorageHandler myConf metaTableStorage handler InputEstimator total TableDesc tableDesc partDesc getTableDesc InputEstimator estimator InputEstimator handler alias JobConf jobConf JobConf myJobConf TableScanOperator scanOp TableScanOperator aliasToWork get alias Utilities setColumnNameList jobConf scanOp Utilities setColumnTypeList jobConf scanOp PlanUtils configureInputJobPropertiesForStorageHandler tableDesc Utilities copyTableJobPropertiesToConf tableDesc jobConf
partDesc getProperties metaTableStorage partDesc getProperties getProperty hive_metastoreConstants META_TABLE_STORAGE metaTableStorage HiveStorageHandler handler HiveUtils getStorageHandler myConf metaTableStorage handler InputEstimator total TableDesc tableDesc partDesc getTableDesc InputEstimator estimator InputEstimator handler alias JobConf jobConf JobConf myJobConf TableScanOperator scanOp TableScanOperator aliasToWork get alias Utilities setColumnNameList jobConf scanOp Utilities setColumnTypeList jobConf scanOp PlanUtils configureInputJobPropertiesForStorageHandler tableDesc Utilities copyTableJobPropertiesToConf tableDesc jobConf total estimator estimate jobConf scanOp getTotalLength
alias path JobConf jobConf JobConf myJobConf TableScanOperator scanOp TableScanOperator aliasToWork get alias Utilities setColumnNameList jobConf scanOp Utilities setColumnTypeList jobConf scanOp PlanUtils configureInputJobPropertiesForStorageHandler tableDesc Utilities copyTableJobPropertiesToConf tableDesc jobConf total estimator estimate jobConf scanOp getTotalLength recordSummary path ContentSummary total FileSystem fs path getFileSystem myConf recordSummary path fs getContentSummary path e LOG info path LOG debug path e
total estimator estimate jobConf scanOp getTotalLength recordSummary path ContentSummary total FileSystem fs path getFileSystem myConf recordSummary path fs getContentSummary path e LOG info path LOG debug path e recordSummary ContentSummary cs csLength cs getLength csFileCount cs getFileCount csDirectoryCount cs getDirectoryCount totalLength addAndGet csLength totalFileCount addAndGet csFileCount totalDirectoryCount addAndGet csDirectoryCount
dirPath ctx ctx ContentSummary cs ctx getCS dirPath cs
HiveConf conf inputSummary work bytesPerReducer conf getLongVar HiveConf ConfVars BYTESPERREDUCER maxReducers conf getIntVar HiveConf ConfVars MAXREDUCERS samplePercentage getHighestSamplePercentage work totalInputFileSize getTotalInputFileSize inputSummary work samplePercentage totalInputFileSize inputSummary
isEmptyTable hasLogged Path List String e IOException Path file e getKey List String aliases e getValue aliases alias file isEmptyTable LOG warn alias file
IOException Path file e getKey List String aliases e getValue aliases alias file isEmptyTable LOG warn alias pathsProcessed file StringInternUtils internUriStringsInPath file pathsProcessed add file LOG debug file
String origUmask
URL taskAttemptLogUrl taskAttemptLogUrl URL urlString e LOG error e BufferedReader in in BufferedReader InputStreamReader taskAttemptLogUrl openStream String inputLine inputLine in e e processLogLine inputLine in close e
job setOutputKeyClass Text job setOutputValueClass Text returnVal noName StringUtils isEmpty job get MRJobConfig JOB_NAME noName job set MRJobConfig JOB_NAME ThreadLocalRandom current nextInt MapredLocalWork localwork mWork getMapRedLocalWork localwork localwork job Path localPath localwork getTmpPath Path hdfsPath mWork getTmpHDFSPath FileSystem hdfs hdfsPath getFileSystem job FileSystem localFS localPath getFileSystem job FileStatus hashtableFiles localFS listStatus localPath
values BytesWritable valueWritable BytesWritable values next valueObject tag inputValueDeserializer tag deserialize valueWritable e HiveException tag Utilities formatBinaryString valueWritable get valueWritable getSize valueTableDesc tag getProperties e row clear row add keyObject row add valueObject tag reducer process row tag e String rowString rowString SerDeUtils getJSONString row rowObjectInspector tag
String currentInputPath context getCurrentInputPath toString
mapJoinTables String currentInputPath context getCurrentInputPath toString LOG info currentInputPath MapredLocalWork localWork context getLocalWork localWork loadDirectly mapJoinTables currentInputPath Path baseDir getBaseDir localWork baseDir String fileName localWork getBucketFileName currentInputPath pos pos mapJoinTables pos pos desc mapJoinTables pos Path path Utilities generatePath baseDir desc getDumpFilePrefix pos fileName
ctxCreated Context ctx context ctx ctx Context conf ctxCreated setNumberOfReducers ctx conf inputSummary inputSummary Utilities getInputSummary ctx work getMapWork samplePercentage Utilities getHighestSamplePercentage work getMapWork totalInputFileSize Utilities getTotalInputFileSize inputSummary work getMapWork samplePercentage totalInputNumFiles Utilities getTotalInputNumFiles inputSummary work getMapWork samplePercentage numReducers work getReduceWork work getReduceWork getNumReduceTasks
out FileSystem getLocal conf create planPath SerializationUtilities serializePlan plan out out close out IOUtils closeQuietly out String isSilent equalsIgnoreCase System getProperty String jarCmd hiveJar ExecDriver getName libJarsOption String cmdLine hadoopExec jarCmd planPath toString isSilent hiveConfArgs String workDir File getCanonicalPath String files getResource conf ResourceType FILE files cmdLine cmdLine files workDir ctx getLocalTmpPath toUri getPath
String hiveJar conf getJar String hadoopExec conf getVar HiveConf ConfVars HADOOPBIN conf setVar ConfVars HIVEADDEDJARS Utilities getResourceFiles conf SessionState ResourceType JAR Path planPath Path context getLocalTmpPath MapredLocalWork plan getWork
estimateNewRowCount oldRefsCount refs length newRefsCount oldRefsCount estimateNewRowCount newRefsCount newRefsCount Long bitCount newRefsCount newRefsCount nextHighestPowerOfTwo newRefsCount expandAndRehashImpl newRefsCount
WriteBuffers ByteSegmentRef byteSegmentRef hashMapResult first byteSegmentRef results add hashMapResult byteSegmentRef byteSegmentRef hashMapResult next dump append results size append i i results size i WriteBuffers ByteSegmentRef segment results get i byteIntervals put segment getOffset segment getLength i examined dump append examined currentOffset e byteIntervals start e getKey len e getValue start currentOffset dump append currentOffset start
LOG warn lastPartitionInMem nwayConf biggest biggestPartition spillPartition biggest setSpill biggest putToSidefile LOG info biggest nwayConf getNextSpillPartition memoryThreshold nwayConf spill biggest biggest
LOG warn File file FileUtils createLocalDirsTempFile spillLocalDirs partitionId OutputStream outputStream FileOutputStream file com esotericsoftware kryo io Output output com esotericsoftware kryo io Output outputStream Kryo kryo SerializationUtilities borrowKryo LOG info partitionId kryo writeObject output partition hashMap output close outputStream close SerializationUtilities releaseKryo kryo partition hashMapLocalPath file toPath partition hashMapOnDisk
OutputStream outputStream FileOutputStream file com esotericsoftware kryo io Output output com esotericsoftware kryo io Output outputStream Kryo kryo SerializationUtilities borrowKryo LOG info partitionId kryo writeObject output partition hashMap output close outputStream close SerializationUtilities releaseKryo kryo partition hashMapLocalPath file toPath partition hashMapOnDisk LOG info partitionId inMemRowCount partition hashMap memorySize file LOG info memoryUsed memFreed partition hashMap memorySize
i i hashPartitions i HashPartition hp hashPartitions i hp
startSplit bI startingSplit endSplit blockNum blockInfos endSplit blockInfos get blockNum startingSplit endSplit getLastActualSplit readIntoOffset i startSplit i endSplit readIntoOffset i org apache hadoop mapred RecordReader rr setReaderAtSplit i i startSplit PTFSequenceFileRecordReader rr seek bI startOffset nextBlock readIntoOffset readIntoOffset getCurrentReadBlockSize
rr Object key rr createKey i currentReadBlock rr key val nextSplit currentReadBlock i ROW ObjectInspectorUtils copyToStandardObject serde deserialize val serde getObjectInspector ObjectInspectorCopyOption WRITABLE nextSplit currentSplitPointer JobConf localJc getLocalFSJobConfClone jc rr inputFormat getRecordReader inputSplits currentSplitPointer jobCloneUsingLocalFs reporter currentSplitPointer nextBlock readBlockSize i readBlockSize e LOG error e getMessage e
numFlushedBlocks readBlockSize actualSplitNum currentSplitPointer firstCalled inputSplits tempOutPath addCursor size rw rw close rr rr close
keyObject String keyObjectStr keyObject toString String md5Str DigestUtils md5Hex keyObjectStr toString LOG info md5Str keyObjectStr suffix md5Str suffix parentDir FileUtils createLocalDirsTempFile spillFileDirs tmpFile File createTempFile suffix parentDir LOG info tmpFile getAbsolutePath parentDir deleteOnExit tmpFile deleteOnExit HiveOutputFormat hiveOutputFormat HiveFileFormatUtils getHiveOutputFormat jc tblDesc tempOutPath Path tmpFile toString JobConf localJc getLocalFSJobConfClone jc rw hiveOutputFormat getHiveRecordWriter localJc tempOutPath serde getSerializedClass tblDesc getProperties reporter
Path ackPath work getAckFilePath Utils create ackPath conf
SecurityUtils reloginExpiringKeytabUser AtlasReplInfo atlasReplInfo createAtlasReplInfo
SecurityUtils reloginExpiringKeytabUser AtlasReplInfo atlasReplInfo createAtlasReplInfo LOG info atlasReplInfo getSrcDB atlasReplInfo getTgtDB atlasReplInfo getStagingDir AtlasDumpLogger replLogger AtlasDumpLogger atlasReplInfo getSrcDB atlasReplInfo getStagingDir toString replLogger startLog Map String Long metricMap HashMap metricMap put ReplUtils MetricName ENTITIES name work getMetricCollector reportStageStart getName metricMap atlasRestClient AtlasRestClientBuilder atlasReplInfo getAtlasEndpoint getClient atlasReplInfo getConf AtlasRequestBuilder atlasRequestBuilder AtlasRequestBuilder String entityGuid checkHiveEntityGuid atlasRequestBuilder atlasReplInfo getSrcCluster atlasReplInfo getSrcDB currentModifiedTime getCurrentTimestamp atlasReplInfo entityGuid numBytesWritten dumpAtlasMetaData atlasRequestBuilder atlasReplInfo
replLogger startLog Map String Long metricMap HashMap metricMap put ReplUtils MetricName ENTITIES name work getMetricCollector reportStageStart getName metricMap atlasRestClient AtlasRestClientBuilder atlasReplInfo getAtlasEndpoint getClient atlasReplInfo getConf AtlasRequestBuilder atlasRequestBuilder AtlasRequestBuilder String entityGuid checkHiveEntityGuid atlasRequestBuilder atlasReplInfo getSrcCluster atlasReplInfo getSrcDB currentModifiedTime getCurrentTimestamp atlasReplInfo entityGuid numBytesWritten dumpAtlasMetaData atlasRequestBuilder atlasReplInfo LOG debug numBytesWritten createDumpMetadata atlasReplInfo currentModifiedTime replLogger endLog work getMetricCollector reportStageEnd getName Status SUCCESS
replLogger endLog work getMetricCollector reportStageEnd getName Status SUCCESS e LOG error e setException e errorCode ErrorMsg getErrorMsg e getMessage getErrorCode errorCode Path nonRecoverableMarker Path work getStagingDir getParent ReplAck NON_RECOVERABLE_MARKER toString Utils writeStackTrace e nonRecoverableMarker conf work getMetricCollector reportStageEnd getName Status FAILED_ADMIN nonRecoverableMarker toString work getMetricCollector reportStageEnd getName Status FAILED
atlasReplInfo entityGuid AtlasServer atlasServer atlasRestClient getServer atlasReplInfo getSrcCluster conf ret atlasServer atlasServer getAdditionalInfoRepl entityGuid atlasServer getAdditionalInfoRepl entityGuid
atlasReplInfo lastModifiedTime Path dumpFile Path atlasReplInfo getStagingDir EximUtil METADATA_NAME List List String listValues ArrayList listValues add Arrays asList atlasReplInfo getSrcFsUri String valueOf lastModifiedTime Utils writeOutput listValues dumpFile conf
SecurityUtils reloginExpiringKeytabUser AtlasReplInfo atlasReplInfo createAtlasReplInfo Map String Long metricMap HashMap metricMap put ReplUtils MetricName ENTITIES name work getMetricCollector reportStageStart getName metricMap
SecurityUtils reloginExpiringKeytabUser AtlasReplInfo atlasReplInfo createAtlasReplInfo Map String Long metricMap HashMap metricMap put ReplUtils MetricName ENTITIES name work getMetricCollector reportStageStart getName metricMap LOG info atlasReplInfo getSrcDB atlasReplInfo getTgtDB atlasReplInfo getStagingDir AtlasLoadLogger replLogger AtlasLoadLogger atlasReplInfo getSrcDB atlasReplInfo getTgtDB atlasReplInfo getStagingDir toString replLogger startLog importCount importAtlasMetadata atlasReplInfo replLogger endLog importCount work getMetricCollector reportStageProgress getName ReplUtils MetricName ENTITIES name importCount
SecurityUtils reloginExpiringKeytabUser AtlasReplInfo atlasReplInfo createAtlasReplInfo Map String Long metricMap HashMap metricMap put ReplUtils MetricName ENTITIES name work getMetricCollector reportStageStart getName metricMap LOG info atlasReplInfo getSrcDB atlasReplInfo getTgtDB atlasReplInfo getStagingDir AtlasLoadLogger replLogger AtlasLoadLogger atlasReplInfo getSrcDB atlasReplInfo getTgtDB atlasReplInfo getStagingDir toString replLogger startLog importCount importAtlasMetadata atlasReplInfo replLogger endLog importCount work getMetricCollector reportStageProgress getName ReplUtils MetricName ENTITIES name importCount LOG info importCount work getMetricCollector reportStageEnd getName Status SUCCESS
LOG info importCount work getMetricCollector reportStageEnd getName Status SUCCESS e LOG error e setException e errorCode ErrorMsg getErrorMsg e getMessage getErrorCode errorCode Path nonRecoverableMarker Path work getStagingDir getParent ReplAck NON_RECOVERABLE_MARKER toString Utils writeStackTrace e nonRecoverableMarker conf work getMetricCollector reportStageEnd getName Status FAILED_ADMIN nonRecoverableMarker toString work getMetricCollector reportStageEnd getName Status FAILED
rangerRestClient rangerEndpoint conf SemanticException ErrorMsg REPL_EXTERNAL_SERVICE_CONNECTION_ERROR format ReplUtils REPL_RANGER_SERVICE rangerEndpoint RangerExportPolicyList rangerExportPolicyList rangerRestClient exportRangerPolicies rangerEndpoint work getDbName rangerHiveServiceName conf List RangerPolicy rangerPolicies rangerExportPolicyList getPolicies rangerPolicies LOG info rangerExportPolicyList RangerExportPolicyList rangerPolicies rangerRestClient removeMultiResourcePolicies rangerPolicies rangerPolicies rangerExportPolicyList setPolicies rangerPolicies filePath rangerRestClient saveRangerPoliciesToFile rangerExportPolicyList work getCurrentDumpPath ReplUtils HIVE_RANGER_POLICIES_FILE_NAME conf filePath LOG info exportCount rangerExportPolicyList getListSize
SemanticException ErrorMsg REPL_EXTERNAL_SERVICE_CONNECTION_ERROR format ReplUtils REPL_RANGER_SERVICE rangerEndpoint RangerExportPolicyList rangerExportPolicyList rangerRestClient exportRangerPolicies rangerEndpoint work getDbName rangerHiveServiceName conf List RangerPolicy rangerPolicies rangerExportPolicyList getPolicies rangerPolicies LOG info rangerExportPolicyList RangerExportPolicyList rangerPolicies rangerRestClient removeMultiResourcePolicies rangerPolicies rangerPolicies rangerExportPolicyList setPolicies rangerPolicies filePath rangerRestClient saveRangerPoliciesToFile rangerExportPolicyList work getCurrentDumpPath ReplUtils HIVE_RANGER_POLICIES_FILE_NAME conf filePath LOG info exportCount rangerExportPolicyList getListSize work getMetricCollector reportStageProgress getName ReplUtils MetricName POLICIES name exportCount
List RangerPolicy rangerPolicies SecurityUtils reloginExpiringKeytabUser rangerRestClient rangerRestClient getRangerRestClient URL url work getRangerConfigResource url SemanticException ErrorMsg REPL_INVALID_CONFIG_FOR_SERVICE format ReplUtils RANGER_CONFIGURATION_RESOURCE_NAME ReplUtils REPL_RANGER_SERVICE conf addResource url String rangerHiveServiceName conf get ReplUtils RANGER_HIVE_SERVICE_NAME String rangerEndpoint conf get ReplUtils RANGER_REST_URL rangerEndpoint SemanticException ErrorMsg REPL_INVALID_CONFIG_FOR_SERVICE format rangerEndpoint ReplUtils REPL_RANGER_SERVICE rangerRestClient rangerEndpoint conf SemanticException ErrorMsg REPL_EXTERNAL_SERVICE_CONNECTION_ERROR format ReplUtils REPL_RANGER_SERVICE rangerEndpoint work
replLogger startLog Map String Long metricMap HashMap metricMap put ReplUtils MetricName POLICIES name expectedPolicyCount work getMetricCollector reportStageStart getName metricMap rangerExportPolicyList rangerExportPolicyList getPolicies rangerPolicies rangerExportPolicyList getPolicies rangerPolicies LOG info rangerPolicies ArrayList List RangerPolicy rangerPoliciesWithDenyPolicy rangerPolicies rangerPoliciesWithDenyPolicy rangerRestClient addDenyPolicies rangerPolicies rangerHiveServiceName work getSourceDbName work getTargetDbName List RangerPolicy updatedRangerPolicies rangerRestClient changeDataSet rangerPoliciesWithDenyPolicy work getSourceDbName work getTargetDbName importCount updatedRangerPolicies
rangerExportPolicyList rangerExportPolicyList getPolicies rangerPolicies rangerExportPolicyList getPolicies rangerPolicies LOG info rangerPolicies ArrayList List RangerPolicy rangerPoliciesWithDenyPolicy rangerPolicies conf rangerPoliciesWithDenyPolicy rangerRestClient addDenyPolicies rangerPolicies rangerHiveServiceName work getSourceDbName work getTargetDbName List RangerPolicy updatedRangerPolicies rangerRestClient changeDataSet rangerPoliciesWithDenyPolicy work getSourceDbName work getTargetDbName importCount updatedRangerPolicies rangerExportPolicyList rangerExportPolicyList RangerExportPolicyList rangerExportPolicyList setPolicies updatedRangerPolicies rangerRestClient importRangerPolicies rangerExportPolicyList work getTargetDbName rangerEndpoint rangerHiveServiceName conf
Path previousValidHiveDumpPath getPreviousValidDumpMetadataPath dumpRoot isBootstrap previousValidHiveDumpPath previousValidHiveDumpPath Path currentDumpPath getCurrentDumpPath dumpRoot isBootstrap Path hiveDumpRoot Path currentDumpPath ReplUtils REPL_HIVE_BASE_DIR work setCurrentDumpPath currentDumpPath work setMetricCollector initMetricCollection isBootstrap hiveDumpRoot addAtlasDumpTask isBootstrap previousValidHiveDumpPath LOG info initiateAuthorizationDumpTask DumpMetaData dmd DumpMetaData hiveDumpRoot conf ReplChangeManager getInstance conf Path cmRoot Path conf getVar HiveConf ConfVars REPLCMDIR
Path rangerDumpRoot Path work getCurrentDumpPath ReplUtils REPL_RANGER_BASE_DIR
Path Path dumpRoot Path lastDumpPath ReplUtils getLatestDumpPath dumpRoot conf lastDumpPath lastDumpPath
LOG debug dumpSchema
dumpRoot FileStatus latestValidStatus FileSystem fs dumpRoot getFileSystem conf fs dumpRoot FileStatus statuses fs listStatus dumpRoot FileStatus statuses
Long Long lastReplId String validTxnList waitUntilTime bootDumpBeginReplId List String tableList work replScope includeAllTables ArrayList bootDumpBeginReplId queryState getConf getLong ReplUtils LAST_REPL_ID_KEY assert bootDumpBeginReplId
IMetaStoreClient NotificationFilter evFilter AndFilter ReplEventFilter work replScope EventBoundaryFilter work eventFrom work eventTo EventUtils MSClientNotificationFetcher evFetcher EventUtils MSClientNotificationFetcher hiveDb maxEventLimit getMaxEventAllowed work maxEventLimit EventUtils NotificationEventIterator evIter EventUtils NotificationEventIterator evFetcher work eventFrom maxEventLimit evFilter lastReplId work eventTo Path ackFile Path dumpRoot ReplAck EVENTS_DUMP toString resumeFrom Utils fileExists ackFile conf getResumeFrom ackFile work eventFrom String dbName work dbNameOrPattern work dbNameOrPattern isEmpty work dbNameOrPattern estimatedNumEvents evFetcher getDbNotificationEventsCount work eventFrom dbName work eventTo maxEventLimit replLogger IncrementalDumpLogger dbName dumpRoot toString estimatedNumEvents work eventFrom work eventTo maxEventLimit replLogger startLog Map String Long metricMap HashMap metricMap put ReplUtils MetricName EVENTS name estimatedNumEvents work getMetricCollector reportStageStart getName metricMap dumpedCount resumeFrom work eventFrom
work getMetricCollector reportStageStart getName metricMap dumpedCount resumeFrom work eventFrom dumpedCount LOG info work eventFrom resumeFrom dumpedCount cleanFailedEventDirIfExists dumpRoot resumeFrom evIter NotificationEvent ev evIter next lastReplId ev getEventId ev getEventId resumeFrom String tblName ev getTableName tblName Table table hiveDb getTable dbName tblName
lastReplId ev getEventId ev getEventId String tblName ev getTableName tblName Table table hiveDb getTable dbName tblName table table LOG info tblName te LOG debug te getMessage Path evRoot Path dumpRoot String valueOf lastReplId dumpEvent ev evRoot dumpRoot cmRoot hiveDb
Long Path dumpRoot Path hiveDb Long bootDumpBeginReplId queryState getConf getLong ReplUtils LAST_REPL_ID_KEY assert bootDumpBeginReplId List String tableList LOG info work dbNameOrPattern timeoutInMs HiveConf getTimeVar conf HiveConf ConfVars REPL_BOOTSTRAP_DUMP_OPEN_TXN_TIMEOUT TimeUnit MILLISECONDS waitUntilTime System currentTimeMillis timeoutInMs String validTxnList getValidTxnListForReplDump hiveDb waitUntilTime Path metadataPath Path dumpRoot EximUtil METADATA_PATH_NAME metadataPath getFileSystem conf delete metadataPath List EximUtil DataCopyPath functionsBinaryCopyPaths Collections emptyList cacheSize conf getIntVar HiveConf ConfVars REPL_FILE_LIST_CACHE_SIZE dumpRoot EximUtil cacheSize dumpRoot EximUtil cacheSize String hiveDb work dbNameOrPattern
Map String Long metricMap HashMap metricMap put ReplUtils MetricName TABLES name estimatedNumTables metricMap put ReplUtils MetricName FUNCTIONS name estimatedNumFunctions work getMetricCollector reportStageStart getName metricMap Path dbRoot dumpDbMetadata dbName metadataPath bootDumpBeginReplId hiveDb Path dbDataRoot Path Path dumpRoot EximUtil DATA_PATH_NAME dbName dataCopyAtLoad conf getBoolVar HiveConf ConfVars REPL_RUN_DATA_COPY_TASKS_ON_TARGET functionsBinaryCopyPaths dumpFunctionMetadata dbName dbRoot dbDataRoot hiveDb dataCopyAtLoad String uniqueKey Utils setDbBootstrapDumpState hiveDb dbName Exception caught dbRoot conf String tblName Utils hiveDb dbName work Table table HiveWrapper Tuple Table tableTuple HiveWrapper hiveDb dbName table tblName conf
work getMetricCollector reportStageStart getName metricMap Path dbRoot dumpDbMetadata dbName metadataPath bootDumpBeginReplId hiveDb Path dbDataRoot Path Path dumpRoot EximUtil DATA_PATH_NAME dbName dataCopyAtLoad conf getBoolVar HiveConf ConfVars REPL_RUN_DATA_COPY_TASKS_ON_TARGET functionsBinaryCopyPaths dumpFunctionMetadata dbName dbRoot dbDataRoot hiveDb dataCopyAtLoad String uniqueKey Utils setDbBootstrapDumpState hiveDb dbName Exception caught dbRoot conf String tblName Utils hiveDb dbName work Table table HiveWrapper Tuple Table tableTuple HiveWrapper hiveDb dbName table tblName conf table tableTuple tableTuple object tableTuple tableTuple object LOG info tblName
Path dbRoot dumpDbMetadata dbName metadataPath bootDumpBeginReplId hiveDb Path dbDataRoot Path Path dumpRoot EximUtil DATA_PATH_NAME dbName dataCopyAtLoad conf getBoolVar HiveConf ConfVars REPL_RUN_DATA_COPY_TASKS_ON_TARGET functionsBinaryCopyPaths dumpFunctionMetadata dbName dbRoot dbDataRoot hiveDb dataCopyAtLoad String uniqueKey Utils setDbBootstrapDumpState hiveDb dbName Exception caught dbRoot conf String tblName Utils hiveDb dbName Table table HiveWrapper Tuple Table tableTuple HiveWrapper hiveDb dbName table tblName conf table tableTuple tableTuple object tableTuple tableTuple object LOG info tblName
LOG debug tblName writer dataLocationDump tableTuple object extTableFileList conf dumpTable dbName tblName validTxnList dbRoot dbDataRoot bootDumpBeginReplId hiveDb tableTuple managedTblList dataCopyAtLoad te LOG debug te getMessage dumpConstraintMetadata dbName tblName dbRoot hiveDb tableList tableList add tblName dumpTableListToDumpLocation tableList dumpRoot dbName conf e caught e Utils resetDbBootstrapDumpState hiveDb dbName uniqueKey e
dumpConstraintMetadata dbName tblName dbRoot hiveDb tableList tableList add tblName dumpTableListToDumpLocation tableList dumpRoot dbName conf e caught e Utils resetDbBootstrapDumpState hiveDb dbName uniqueKey e caught e LOG error uniqueKey e caught
Path commonConstraintsFile Path constraintsRoot ConstraintFileType COMMON getPrefix tblName Path fkConstraintsFile Path constraintsRoot ConstraintFileType FOREIGNKEY getPrefix tblName List SQLPrimaryKey pks hiveDb getPrimaryKeyList dbName tblName List SQLForeignKey fks hiveDb getForeignKeyList dbName tblName List SQLUniqueConstraint uks hiveDb getUniqueConstraintList dbName tblName List SQLNotNullConstraint nns hiveDb getNotNullConstraintList dbName tblName pks pks uks uks nns nns jsonWriter commonConstraintsFile conf commonConstraintsFile ConstraintsSerializer serializer ConstraintsSerializer pks uks nns conf serializer writeTo jsonWriter fks fks jsonWriter fkConstraintsFile conf fkConstraintsFile ConstraintsSerializer serializer ConstraintsSerializer fks conf serializer writeTo jsonWriter
List Task tracker conf List Task tasks ArrayList functionCopyPathIterator functionCopyPathIterator tracker EximUtil DataCopyPath binaryCopyPath functionCopyPathIterator next Task copyTask ReplCopyTask getLoadCopyTask binaryCopyPath getReplicationSpec binaryCopyPath getSrcPath binaryCopyPath getTargetPath conf tasks add copyTask tracker addTask copyTask
hiveConf location Path basePath getExternalTableBaseDir hiveConf Path currentPath Path location Path dataLocation externalTableDataPath hiveConf basePath currentPath
Task rootTask work getRootTask rootTask rootTask setChildTasks work setRootTask parentTasks addAtlasLoadTask initiateAuthorizationLoadTask LOG info conf getBoolVar HiveConf ConfVars REPL_RUN_DATA_COPY_TASKS_ON_TARGET work executeIncrementalLoad executeBootStrapLoad
addAtlasLoadTask initiateAuthorizationLoadTask LOG info conf getBoolVar HiveConf ConfVars REPL_RUN_DATA_COPY_TASKS_ON_TARGET work executeIncrementalLoad executeBootStrapLoad e LOG error e work getMetricCollector reportEnd Status FAILED ex LOG error ex e
e LOG error e work getMetricCollector reportEnd Status FAILED ex LOG error ex e e LOG error e setException e errorCode ErrorMsg getErrorMsg e getMessage getErrorCode errorCode Path nonRecoverableMarker Path Path work dumpDirectory getParent ReplAck NON_RECOVERABLE_MARKER toString Utils writeStackTrace e nonRecoverableMarker conf
Path rangerLoadRoot Path Path work dumpDirectory getParent ReplUtils REPL_RANGER_BASE_DIR
Path atlasDumpDir Path Path work dumpDirectory getParent ReplUtils REPL_ATLAS_BASE_DIR
tableEvent LoadPartitions loadPartitions LoadPartitions loadContext iterator replLogger loadTaskTracker tableEvent work dbNameToLoadIn tableContext work getMetricCollector TaskTracker partitionsTracker loadPartitions tasks partitionsPostProcessing iterator scope loadTaskTracker tableTracker partitionsTracker tableTracker debugLog partitionsTracker debugLog loadContext iterator scope loadTaskTracker tableTracker loadTaskTracker loadContext iterator scope loadTaskTracker loadContext scope iterator
partitionsTracker debugLog loadContext iterator scope loadTaskTracker loadTaskTracker loadContext iterator scope loadTaskTracker loadContext scope iterator createEndReplLogTask loadContext scope iterator replLogger addAnotherLoadTask iterator hasNext loadTaskTracker hasReplicationState constraintIterator hasNext addAnotherLoadTask createBuilderTask scope rootTasks iterator hasNext constraintIterator hasNext
addLazyDataCopyTask tracker childTasks add builder build context getHive LOG tracker builder String dbName work dbNameToLoadIn dbName dbName work currentReplScope String replScopeDbName work currentReplScope getDbName replScopeDbName replScopeDbName dbName replScopeDbName dbName String lastEventid builder eventTo toString Map String String mapProp HashMap mapProp put ReplicationSpec KEY CURR_STATE_ID toString lastEventid AlterDatabaseSetPropertiesDesc alterDbDesc AlterDatabaseSetPropertiesDesc dbName mapProp ReplicationSpec lastEventid lastEventid Task updateReplIdTask TaskFactory get DDLWork HashSet HashSet alterDbDesc conf
String String clusterName String srcDb String qualifiedName String format QUALIFIED_NAME_FORMAT srcDb toLowerCase clusterName
AtlasImportRequest sourceDataSet targetDataSet sourceClusterName targetClusterName sourceFsEndpoint targetFsEndpoint AtlasImportRequest request AtlasImportRequest addTransforms request getOptions sourceClusterName targetClusterName sourceDataSet targetDataSet sourceFsEndpoint targetFsEndpoint addReplicatedFrom request getOptions sourceClusterName
userGroupInformation UserGroupInformation getLoginUser
eventPath LocatedFileStatus fileSystem RemoteIterator LocatedFileStatus iteratorNext fileSystem listFiles eventPath iteratorNext LocatedFileStatus status iteratorNext next
next remoteIterator LocatedFileStatus next remoteIterator next next getPath toString next getPath toString next getPath toString String replacedString next getPath toString replace dbLevelPath toString List String filteredNames Arrays stream replacedString split Path SEPARATOR filter StringUtils isNotBlank collect Collectors toList filteredNames next next getPath getParent
previous next next
table AlterTableAddPartitionDesc addPartitionDesc AlterTableAddPartitionDesc PartitionDesc partSpec addPartitionDesc getPartitions get Path sourceWarehousePartitionLocation Path partSpec getLocation Path replicaWarehousePartitionLocation locationOnReplicaWarehouse table partSpec partSpec setLocation replicaWarehousePartitionLocation toString
lastPartitionReplicated encounteredTheLastReplicatedPartition lastPartitionReplicated Map String String lastReplicatedPartSpec encounteredTheLastReplicatedPartition lastReplicatedPartSpec lastPartitionReplicated getPartitions get getPartSpec
URI inputPathUri inputPath toUri String inputPathName inputPathUri getPath String fileSystemAsString inputPathUri getScheme inputPathUri getAuthority String stagingPathName inputPathName stagingDir stagingPathName Path inputPathName stagingDir toString stagingPathName inputPathName substring inputPathName indexOf stagingDir stagingDir length String key fileSystemAsString stagingPathName TaskRunner getTaskRunnerID Path dir fsScratchDirs get key FileSystem fileSystem inputPath getFileSystem hiveConf dir Path path Path stagingPathName generateExecutionId TaskRunner getTaskRunnerID dir fileSystem makeQualified path
String String params params params ReplicationSpec KEY CURR_STATE_ID toString String replLastId params get ReplicationSpec KEY CURR_STATE_ID toString replLastId
Task String dbName String tableName String String partSpec String replState Task preCursor HashMap String String mapProp HashMap mapProp put ReplicationSpec KEY CURR_STATE_ID toString replState TableName tName TableName fromString tableName dbName AlterTableSetPropertiesDesc alterTblDesc AlterTableSetPropertiesDesc tName partSpec ReplicationSpec replState replState mapProp Task updateReplIdTask TaskFactory get DDLWork inputs outputs alterTblDesc conf preCursor preCursor addDependentTask updateReplIdTask
Task String dbName String replState Task preCursor HashMap String String mapProp HashMap mapProp put ReplicationSpec KEY CURR_STATE_ID toString replState AlterDatabaseSetPropertiesDesc alterDbDesc AlterDatabaseSetPropertiesDesc dbName mapProp ReplicationSpec replState replState Task updateReplIdTask TaskFactory get DDLWork inputs outputs alterDbDesc conf preCursor preCursor addDependentTask updateReplIdTask
String sourceRangerEndpoint String rangerHiveServiceName String dbName String finalUrl getRangerExportUrl sourceRangerEndpoint rangerHiveServiceName dbName
RangerExportPolicyList String sourceRangerEndpoint String rangerHiveServiceName String dbName String finalUrl getRangerExportUrl sourceRangerEndpoint rangerHiveServiceName dbName LOG debug finalUrl WebResource Builder builder getRangerResourceBuilder finalUrl RangerExportPolicyList rangerExportPolicyList RangerExportPolicyList ClientResponse clientResp builder get ClientResponse String response clientResp clientResp Gson gson GsonBuilder create response clientResp getEntity String
rangerExportPolicyList String dbName String baseUrl String rangerHiveServiceName String sourceClusterServiceName String serviceMapJsonFileName String rangerPoliciesJsonFileName rangerExportPolicyList getPolicies sourceClusterServiceName rangerExportPolicyList getPolicies get getService sourceClusterServiceName sourceClusterServiceName rangerHiveServiceName Map String String serviceMap LinkedHashMap String String sourceClusterServiceName rangerHiveServiceName serviceMap put sourceClusterServiceName rangerHiveServiceName Gson gson GsonBuilder create String jsonServiceMap gson toJson serviceMap String jsonRangerExportPolicyList gson toJson rangerExportPolicyList String finalUrl getRangerImportUrl baseUrl dbName
Exception Exception filePartPolicies filePartPolicies cleanup filePartServiceMap filePartServiceMap cleanup formDataMultiPart formDataMultiPart close multipartEntity multipartEntity close
thresholdHit fileListStreamer setName getNextID fileListStreamer setDaemon fileListStreamer start thresholdHit
BufferedWriter FileSystem fs FileSystem get backingFile toUri conf BufferedWriter writer BufferedWriter OutputStreamWriter fs create backingFile
backingFileWriter lazyInitWriter e valid RuntimeException e exThrown exThrown cache String nextEntry cache poll TIMEOUT_IN_SECS TimeUnit SECONDS nextEntry backingFileWriter write nextEntry backingFileWriter newLine LOG debug nextEntry backingFile valid
String nextEntry cache poll TIMEOUT_IN_SECS TimeUnit SECONDS nextEntry backingFileWriter write nextEntry backingFileWriter newLine LOG debug nextEntry backingFile iEx iEx valid LOG error backingFile iEx exThrown closeBackingFile completed
dumpRoot conf FileSystem fs dumpRoot getFileSystem conf fs dumpRoot FileStatus statuses fs listStatus dumpRoot statuses FileStatus latestValidStatus statuses FileStatus statuses
String currentInputPath context getCurrentInputPath context getCurrentInputPath toString
String sessionIdString hiveSessionId appName hiveSessionId appName SPARK_DEFAULT_APP_NAME appName SPARK_DEFAULT_APP_NAME sessionIdString appName appName sessionIdString sparkConf put appNameKey appName sparkConf put SPARK_DEFAULT_SERIALIZER sparkConf put SPARK_DEFAULT_REFERENCE_TRACKING InputStream inputStream inputStream HiveSparkClientFactory getClassLoader getResourceAsStream SPARK_DEFAULT_CONF_FILE inputStream
appName appName sessionIdString sparkConf put appNameKey appName sparkConf put SPARK_DEFAULT_SERIALIZER sparkConf put SPARK_DEFAULT_REFERENCE_TRACKING InputStream inputStream inputStream HiveSparkClientFactory getClassLoader getResourceAsStream SPARK_DEFAULT_CONF_FILE inputStream LOG info SPARK_DEFAULT_CONF_FILE Properties properties Properties properties load InputStreamReader inputStream CharsetNames UTF_8 String propertyName properties propertyName String value properties getProperty propertyName
appName appName sessionIdString sparkConf put appNameKey appName sparkConf put SPARK_DEFAULT_SERIALIZER sparkConf put SPARK_DEFAULT_REFERENCE_TRACKING InputStream inputStream inputStream HiveSparkClientFactory getClassLoader getResourceAsStream SPARK_DEFAULT_CONF_FILE inputStream LOG info SPARK_DEFAULT_CONF_FILE Properties properties Properties properties load InputStreamReader inputStream CharsetNames UTF_8 String propertyName properties propertyName String value properties getProperty propertyName
InputStream inputStream inputStream HiveSparkClientFactory getClassLoader getResourceAsStream SPARK_DEFAULT_CONF_FILE inputStream LOG info SPARK_DEFAULT_CONF_FILE Properties properties Properties properties load InputStreamReader inputStream CharsetNames UTF_8 String propertyName properties propertyName String value properties getProperty propertyName sparkConf put propertyName properties getProperty propertyName LOG debug String format SPARK_DEFAULT_CONF_FILE propertyName LogUtils maskIfPassword propertyName value e LOG info SPARK_DEFAULT_CONF_FILE e
sparkMaster sparkMaster sparkConf get hiveConf set sparkMaster String deployMode SparkClientUtilities sparkMaster deployMode hiveConf get SPARK_DEPLOY_MODE deployMode deployMode sparkConf get SPARK_DEPLOY_MODE deployMode deployMode SparkClientUtilities getDeployModeFromMaster sparkMaster deployMode deployMode SPARK_DEFAULT_DEPLOY_MODE hiveConf set SPARK_DEPLOY_MODE deployMode SessionState get SessionState get getConf SessionState get getConf set sparkMaster
deployMode sparkConf get SPARK_DEPLOY_MODE deployMode deployMode SparkClientUtilities getDeployModeFromMaster sparkMaster deployMode deployMode SPARK_DEFAULT_DEPLOY_MODE hiveConf set SPARK_DEPLOY_MODE deployMode SessionState get SessionState get getConf SessionState get getConf set sparkMaster deployMode SessionState get getConf set SPARK_DEPLOY_MODE deployMode SparkClientUtilities sparkMaster deployMode sparkConf put String String entry hiveConf String propertyName entry getKey propertyName
deployMode deployMode SPARK_DEFAULT_DEPLOY_MODE hiveConf set SPARK_DEPLOY_MODE deployMode SessionState get SessionState get getConf SessionState get getConf set sparkMaster deployMode SessionState get getConf set SPARK_DEPLOY_MODE deployMode sparkMaster deployMode sparkConf put String String entry hiveConf String propertyName entry getKey propertyName String value hiveConf get propertyName sparkConf put propertyName value LOG debug String format propertyName LogUtils maskIfPassword propertyName value
SessionState get SessionState get getConf SessionState get getConf set sparkMaster deployMode SessionState get getConf set SPARK_DEPLOY_MODE deployMode sparkMaster deployMode sparkConf put String String entry hiveConf String propertyName entry getKey propertyName String value hiveConf get propertyName sparkConf put propertyName value LOG debug String format propertyName LogUtils maskIfPassword propertyName value propertyName sparkMaster String value hiveConf get propertyName sparkConf put propertyName value
remoteClient SparkClientFactory createClient conf hiveConf sessionId HiveConf hiveConf ConfVars hiveConf hiveConf minExecutors getExecutorsToWarm minExecutors LOG info minExecutors curExecutors maxPrewarmTime HiveConf getTimeVar hiveConf ConfVars HIVE_PREWARM_SPARK_TIMEOUT TimeUnit MILLISECONDS ts System currentTimeMillis curExecutors getExecutorCount maxPrewarmTime TimeUnit MILLISECONDS e LOG warn e curExecutors minExecutors
LOG info minExecutors curExecutors maxPrewarmTime HiveConf getTimeVar hiveConf ConfVars HIVE_PREWARM_SPARK_TIMEOUT TimeUnit MILLISECONDS ts System currentTimeMillis curExecutors getExecutorCount maxPrewarmTime TimeUnit MILLISECONDS e LOG warn e curExecutors minExecutors LOG info curExecutors Thread sleep System currentTimeMillis ts maxPrewarmTime
conf String currentQueryId conf get HiveConf ConfVars HIVEQUERYID varname currentQueryId TABLE_CONTAINER_CACHE TABLE_CONTAINER_CACHE currentQueryId TABLE_CONTAINER_CACHE TABLE_CONTAINER_CACHE clear path tableContainer tableContainer clear
work jobConf ObjectInputStream in Path baseDir work getTmpPathForPartitionPruning FileSystem fs FileSystem get baseDir toUri jobConf name Path sourceDir Path baseDir name fs sourceDir
work converter String columnName Object Object row Object Iterator Path it work getPathToPartitionInfo keySet iterator it Path p it next PartitionDesc desc work getPathToPartitionInfo get p Map String String spec desc getPartSpec Preconditions checkNotNull spec String partValueString spec get columnName Preconditions checkNotNull partValueString columnName Object partValue converter convert partValueString
Object row Object Iterator Path it work getPathToPartitionInfo keySet iterator it Path p it next PartitionDesc desc work getPathToPartitionInfo get p Map String String spec desc getPartSpec Preconditions checkNotNull spec String partValueString spec get columnName Preconditions checkNotNull partValueString columnName Object partValue converter convert partValueString LOG LOG debug partValue partValueString row partValue partValue eval evaluate row LOG
it Path p it next PartitionDesc desc work getPathToPartitionInfo get p Map String String spec desc getPartSpec Preconditions checkNotNull spec String partValueString spec get columnName Preconditions checkNotNull partValueString columnName Object partValue converter convert partValueString LOG LOG debug partValue partValueString row partValue partValue eval evaluate row LOG LOG debug partValue partValue
jc job execContext ExecMapperContext jc MapWork mrwork Utilities getMapWork job part mrwork TableDesc tableDesc part getTableDesc Utilities copyJobSecretToTableProperties tableDesc CompilationOpContext runtimeCtx CompilationOpContext mrwork mo VectorMapOperator runtimeCtx mo MapOperator runtimeCtx mo setConf mrwork mo initialize jc mo setChildren job
value anyRow OperatorUtils setChildrenCollector mo getChildOperators oc anyRow execContext resetRow mo process Writable value incrementRowNumber e abort Utilities setMapWork jc e OutOfMemoryError OutOfMemoryError e String msg e
LOG trace abort abort execContext getIoCxt getIOExceptions mo close abort localWork List Operator OperatorDesc dummyOps localWork getDummyParentOp Operator OperatorDesc dummyOp dummyOps dummyOp close abort ReportStats rps ReportStats rp jc mo preorderMap rps e abort String msg e
sc setCallSite CallSite apply rdd name prevRDD name rdd rdd union prevRDD rdd setName rdd getNumPartitions sc setCallSite CallSite apply tran getName getLongFormCallSite tran rdd tran transform rdd tranToOutputRDDMap put tran rdd JavaPairRDD HiveKey BytesWritable finalRDD leafTran JavaPairRDD HiveKey BytesWritable rdd tranToOutputRDDMap get leafTran finalRDD finalRDD rdd sc setCallSite CallSite apply rdd name finalRDD name finalRDD finalRDD union rdd
String tran jobConf getBoolean HiveConf ConfVars varname HiveConf ConfVars defaultBoolVal perfLogger perfLogBegin CLASS_NAME PerfLogger SPARK_CREATE_EXPLAIN_PLAN tran getName ExplainWork explainWork ExplainWork explainWork setConfig ExplainConfiguration ExplainTask explainTask ExplainTask explainTask setWork explainWork String explainOutput ByteArrayOutputStream outputStream ByteArrayOutputStream explainTask outputPlan tran getBaseWork PrintStream outputStream jobConf getBoolean HiveConf ConfVars HIVE_IN_TEST varname HiveConf ConfVars HIVE_IN_TEST defaultBoolVal explainOutput StringUtils abbreviate tran getName outputStream toString
usedMemory memoryMXBean getHeapMemoryUsage getUsed
BytesColumnVector bytesColumnVector BytesColumnVector colVector bytesColumnVector initBuffer ois add keyObjectInspector ois add valueObjectInspector tag rowObjectInspector tag ObjectInspectorFactory getStandardStructObjectInspector Utilities reduceFieldNameList ois e RuntimeException e ExecMapperContext execContext ExecMapperContext job localWork gWork getMapRedLocalWork execContext setJc jc execContext setLocalWork localWork reducer passExecContext execContext reducer setReporter rp OperatorUtils setChildrenCollector Arrays Operator OperatorDesc asList reducer output
LOG trace reducer endGroup keyObject inputKeyDeserializer deserialize keyWritable e LOG trace Utilities formatBinaryString keyWritable get keyWritable getSize keyTableDesc getProperties HiveException e groupKey set keyWritable get keyWritable getSize LOG trace reducer setGroupKeyObject keyObject reducer startGroup processKeyValues values tag e abort
printConfigInfo sparkSessionManager SparkSessionManagerImpl getInstance sparkSession SparkUtilities getSparkSession conf sparkSessionManager SparkWork sparkWork getWork sparkWork setRequiredCounterPrefix getOperatorCounters perfLogger perfLogBegin CLASS_NAME PerfLogger SPARK_SUBMIT_JOB submitTime perfLogger getStartTime PerfLogger SPARK_SUBMIT_JOB jobRef sparkSession submit taskQueue context sparkWork perfLogger perfLogEnd CLASS_NAME PerfLogger SPARK_SUBMIT_JOB taskQueue LOG warn killJob HiveException String format getId sparkWork getQueryId sparkJobHandleId jobRef getJobId addToHistory Keys SPARK_JOB_HANDLE_ID jobRef getJobId
sparkJobID jobRef getSparkJobStatus getJobId addToHistory Keys SPARK_JOB_ID Integer toString sparkJobID SparkJobStatus sparkJobStatus jobRef getSparkJobStatus getSparkJobInfo sparkJobStatus setSparkException sparkJobStatus rc rc sparkStatistics sparkJobStatus getSparkStatistics SparkCounters counters sparkJobStatus getCounter counters SparkCounter counter counters getCounter HiveConf getVar conf HiveConf ConfVars HIVECOUNTERGROUP FileSinkOperator TOTAL_TABLE_ROWS_WRITTEN counter queryState setNumModifiedRows counter getValue printConsoleMetrics printExcessiveGCWarning
SparkJobStatus sparkJobStatus jobRef getSparkJobStatus getSparkJobInfo sparkJobStatus setSparkException sparkJobStatus rc rc sparkStatistics sparkJobStatus getSparkStatistics SparkCounters counters sparkJobStatus getCounter counters SparkCounter counter counters getCounter HiveConf getVar conf HiveConf ConfVars HIVECOUNTERGROUP FileSinkOperator TOTAL_TABLE_ROWS_WRITTEN counter queryState setNumModifiedRows counter getValue printConsoleMetrics printExcessiveGCWarning LOG sparkStatistics LOG info sparkStatisticsToString sparkStatistics sparkJobID
setSparkException sparkJobStatus rc rc sparkStatistics sparkJobStatus getSparkStatistics SparkCounters counters sparkJobStatus getCounter counters SparkCounter counter counters getCounter HiveConf getVar conf HiveConf ConfVars HIVECOUNTERGROUP FileSinkOperator TOTAL_TABLE_ROWS_WRITTEN counter queryState setNumModifiedRows counter getValue printConsoleMetrics printExcessiveGCWarning LOG sparkStatistics LOG info sparkStatisticsToString sparkStatistics sparkJobID LOG info sparkJobID jobID getId rc
SparkCounters counters sparkJobStatus getCounter counters SparkCounter counter counters getCounter HiveConf getVar conf HiveConf ConfVars HIVECOUNTERGROUP FileSinkOperator TOTAL_TABLE_ROWS_WRITTEN counter queryState setNumModifiedRows counter getValue printConsoleMetrics printExcessiveGCWarning LOG sparkStatistics LOG info sparkStatisticsToString sparkStatistics sparkJobID LOG info sparkJobID jobID getId LOG debug sparkJobHandleId LOG info Strings isNullOrEmpty jobID jobID killJob
numExecutors Pair of executorMemoryInMB Utils memoryStringToMb sparkConf get memoryFraction sparkConf getDouble totalMemory numExecutors executorMemoryInMB memoryFraction totalCores String masterURL sparkConf get masterURL masterURL totalCores sparkConf contains sparkConf getInt hiveSparkClient getDefaultParallelism totalCores Math max totalCores numExecutors coresPerExecutor sparkConf getInt totalCores numExecutors coresPerExecutor totalCores totalCores sparkConf getInt memoryPerTaskInBytes totalMemory totalCores
close closeLock writeLock lock LOG info sessionId hiveSparkClient hiveSparkClient close
inputSplit colProjSize inputSplit getLength inputSplit ColumnarSplit colProjSize ColumnarSplit inputSplit getColumnarProjectionSize
ByteBuffer payload context getUserPayload getPayload
numInputsSeenSoFar
MRInputUserPayloadProto protoPayload MRInputHelpers parseMRInputPayload inputDescriptor getUserPayload conf TezUtils createConfFromByteString protoPayload getConfigurationBytes MRInputUserPayloadProto updatedPayload MRInputUserPayloadProto newBuilder protoPayload setGroupingEnabled build inputDescriptor setUserPayload UserPayload create updatedPayload toByteString asReadOnlyByteBuffer e RuntimeException e dataInformationEventSeen Map String Set FileSplit pathFileSplitsMap TreeMap String Set FileSplit event event InputConfigureVertexTasksEvent LOG info inputName Preconditions checkState dataInformationEventSeen InputConfigureVertexTasksEvent cEvent InputConfigureVertexTasksEvent event configureVertexTaskEvent cEvent
LOG info inputName configureVertexTaskEvent getNumTasks event Preconditions checkState event InputDataInformationEvent dataInformationEventSeen InputDataInformationEvent diEvent InputDataInformationEvent event FileSplit fileSplit fileSplit getFileSplitFromEvent diEvent e RuntimeException diEvent e Set FileSplit fsList pathFileSplitsMap get Utilities getBucketFileNameFromPathSubString fileSplit getPath getName fsList fsList TreeSet FileSplit PathComparatorForSplit pathFileSplitsMap put Utilities getBucketFileNameFromPathSubString fileSplit getPath getName fsList
FileSplit fileSplit fileSplit getFileSplitFromEvent diEvent e RuntimeException diEvent e Set FileSplit fsList pathFileSplitsMap get Utilities getBucketFileNameFromPathSubString fileSplit getPath getName fsList fsList TreeSet FileSplit PathComparatorForSplit pathFileSplitsMap put Utilities getBucketFileNameFromPathSubString fileSplit getPath getName fsList fsList add fileSplit LOG LOG debug inputName pathFileSplitsMap Multimap Integer InputSplit bucketToInitialSplitMap getBucketSplitMapForPath inputName pathFileSplitsMap totalResource context getTotalAvailableResource getMemory
inputName LOG info inputName
ByteBuffer bs serializedSplit toByteString asReadOnlyByteBuffer bucketToSerializedSplitMap put entry getKey bs Integer Collection ByteBuffer entry bucketToSerializedSplitMap Collection Integer destTasks bucketToTaskMap get entry getKey destTasks destTasks Integer task destTasks count ByteBuffer buf entry count InputDataInformationEvent diEvent InputDataInformationEvent createWithSerializedPayload count buf diEvent setTargetIndex task taskEvents add diEvent numSplitsForTask task count inputNameInputSpecMap put inputName InputSpecUpdate createPerTaskInputSpecUpdate Arrays asList numSplitsForTask
LOG info taskCount inputName List InputDataInformationEvent taskEvents Lists newArrayListWithCapacity totalInputsCount count inputSplit TezGroupedSplit tezGroupedSplit TezGroupedSplit inputSplit subSplit tezGroupedSplit subSplit TezGroupedSplit IOException subSplit getClass getCanonicalName MRSplitProto serializedSplit MRInputHelpers createSplitProto subSplit InputDataInformationEvent diEvent InputDataInformationEvent createWithSerializedPayload count serializedSplit toByteString asReadOnlyByteBuffer diEvent setTargetIndex count taskEvents add diEvent MRSplitProto serializedSplit MRInputHelpers createSplitProto inputSplit
baseWork Set URI fileSinkUris HashSet URI List Node topNodes getTopNodes baseWork
baseWork Set URI fileSinkUris HashSet URI List Node topNodes getTopNodes baseWork LOG debug baseWork getClass topNodes collectFileSinkUris topNodes fileSinkUris LOG URI fileSinkUris
Class mergeInputClass
remoteFs file FileStatus fstat remoteFs getFileStatus file URL resourceURL ConverterUtils getYarnUrlFromPath file resourceSize fstat getLen resourceModificationTime fstat getModificationTime
FileStatus conf FileStatus fstatus String hdfsDirPathStr HiveConf getVar conf HiveConf ConfVars HIVE_JAR_DIRECTORY String hdfsDirPathStr
src dest conf FileSystem destFS dest getFileSystem conf FileSystem srcFs FileSystem getLocal conf src srcFs src dest conf String srcStr src toString
conf getFloatVar ConfVars TEZ_TASK_SCALE_MEMORY_RESERVE_FRACTION conf getFloatVar ConfVars TEZ_TASK_SCALE_MEMORY_RESERVE_FRACTION tezHeapFraction conf getFloatVar ConfVars TEZ_CONTAINER_MAX_JAVA_HEAP_FRACTION tezMinReserveFraction conf getFloatVar ConfVars TEZ_TASK_SCALE_MEMORY_RESERVE_FRACTION_MIN tezMaxReserveFraction conf getFloatVar ConfVars TEZ_TASK_SCALE_MEMORY_RESERVE_FRACTION_MAX Resource resource getContainerResource conf containerSize resource getMemory String javaOpts getContainerJavaOpts conf xmx parseRightmostXmx javaOpts xmx xmx tezHeapFraction containerSize actualMemToBeAllocated tezMinReserveFraction xmx actualMemToBeAllocated memoryRequested LOG warn actualMemToBeAllocated memoryRequested frac memoryRequested xmx
tezMinReserveFraction conf getFloatVar ConfVars TEZ_TASK_SCALE_MEMORY_RESERVE_FRACTION_MIN tezMaxReserveFraction conf getFloatVar ConfVars TEZ_TASK_SCALE_MEMORY_RESERVE_FRACTION_MAX Resource resource getContainerResource conf containerSize resource getMemory String javaOpts getContainerJavaOpts conf xmx parseRightmostXmx javaOpts xmx xmx tezHeapFraction containerSize actualMemToBeAllocated tezMinReserveFraction xmx actualMemToBeAllocated memoryRequested LOG warn actualMemToBeAllocated memoryRequested frac memoryRequested xmx LOG info frac frac tezMinReserveFraction tezMinReserveFraction
expectedEvents String entry String source entry getKey entry taskNum context getVertexNumTasks source
it Path p it next PartitionDesc desc work getPathToPartitionInfo get p Map String String spec desc getPartSpec spec IllegalStateException String partValueString spec get columnName partValueString IllegalStateException columnName Object partValue converter convert partValueString LOG LOG debug partValue partValueString row partValue partValue eval evaluate row LOG
PartitionDesc desc work getPathToPartitionInfo get p Map String String spec desc getPartSpec spec IllegalStateException String partValueString spec get columnName partValueString IllegalStateException columnName Object partValue converter convert partValueString LOG LOG debug partValue partValueString row partValue partValue eval evaluate row LOG LOG debug partValue partValue work getPathToPartitionInfo
String payload String DataInputStream in DataInputStream ByteBufferBackedInputStream payload String columnName in readUTF
info si info IllegalStateException columnName info skipPruning skip in readBoolean skip info skipPruning set writable readFields in Object row info deserializer deserialize writable Object value info soi getStructFieldData row info field value ObjectInspectorUtils copyToStandardObject value info fieldInspector
conf RegistryConfTez rct RegistryConfTez conf rct
session Integer intAlloc Integer valueToSend session setSendingGuaranteed intAlloc valueToSend UpdateQueryRequestProto request UpdateQueryRequestProto newBuilder setGuaranteedTaskCount valueToSend intValue build
biggest pos tableMemorySizes divideHybridHashTableMemory mapJoinTables desc totalSize totalMapJoinMemory memory tableMemorySizes get biggest numPartitions numPartitions HybridHashTableContainer calcNumPartitions memory maxSize HiveConf getIntVar hconf HiveConf ConfVars HIVEHYBRIDGRACEHASHJOINMINNUMPARTITIONS HiveConf getIntVar hconf HiveConf ConfVars HIVEHYBRIDGRACEHASHJOINMINWBSIZE e HiveException e nwayConf setNumberOfPartitions numPartitions MemoryMonitorInfo memoryMonitorInfo desc getMemoryMonitorInfo doMemCheck effectiveThreshold memoryMonitorInfo effectiveThreshold memoryMonitorInfo getEffectiveThreshold desc getMaxMemoryAvailable
tableMemorySizes divideHybridHashTableMemory mapJoinTables desc totalSize totalMapJoinMemory memory tableMemorySizes get biggest numPartitions numPartitions HybridHashTableContainer calcNumPartitions memory maxSize HiveConf getIntVar hconf HiveConf ConfVars HIVEHYBRIDGRACEHASHJOINMINNUMPARTITIONS HiveConf getIntVar hconf HiveConf ConfVars HIVEHYBRIDGRACEHASHJOINMINWBSIZE e HiveException e nwayConf setNumberOfPartitions numPartitions MemoryMonitorInfo memoryMonitorInfo desc getMemoryMonitorInfo doMemCheck effectiveThreshold memoryMonitorInfo effectiveThreshold memoryMonitorInfo getEffectiveThreshold desc getMaxMemoryAvailable memoryMonitorInfo setLlap
pos pos pos pos numEntries String inputName parentToInput get pos LogicalInput input tezContext getInput inputName input start tezContext getTezProcessorContext waitForAnyInputReady Collections Input singletonList input e HiveException e KeyValueReader kvReader KeyValueReader input getReader MapJoinObjectSerDeContext keyCtx mapJoinTableSerdes pos getKeyContext valCtx mapJoinTableSerdes pos getValueContext
MapJoinObjectSerDeContext keyCtx mapJoinTableSerdes pos getKeyContext valCtx mapJoinTableSerdes pos getValueContext useOptimizedTables ObjectInspector keyOi keyCtx getSerDe getObjectInspector keyOi isFirstKey useOptimizedTables LOG info describeOi keyOi HiveException describeOi keyOi isFirstKey Long keyCountObj parentKeyCounts get pos estKeyCount keyCountObj keyCountObj inputRecords inputRecords AbstractLogicalInput input getContext getCounters findCounter getValue
e LOG debug e keyCount Math max estKeyCount inputRecords memory memory tableMemorySizes get pos memory totalMapJoinMemory MapJoinTableContainer tableContainer tableContainer MapJoinBytesTableContainer hconf valCtx keyCount tableContainer HybridHashTableContainer hconf keyCount memory desc getParentDataSizes get pos nwayConf
InputFormat inputFormat InputFormat ReflectionUtils newInstance JavaUtils loadClass realInputFormatName jobConf totalResource taskResource availableSlots getContext availableSlots getContext totalResource getContext getTotalAvailableResource getMemory taskResource getContext getVertexTaskResource getMemory availableSlots totalResource taskResource conf blockSize conf getLongBytes DFSConfigKeys DFS_BLOCK_SIZE_KEY DFSConfigKeys DFS_BLOCK_SIZE_DEFAULT minGrouping conf getLong TezMapReduceSplitsGrouper TEZ_GROUPING_SPLIT_MIN_SIZE TezMapReduceSplitsGrouper TEZ_GROUPING_SPLIT_MIN_SIZE_DEFAULT preferredSplitSize Math min blockSize minGrouping
FileSystem fs paths get getFileSystem jobConf FileStatus fileStatuses fs listStatus paths get fileStatuses length splits InputSplit Preconditions checkState paths size fileStatuses length mapWork getAliasToPartnInfo size paths size fileStatuses length splits InputSplit FileStatus fileStatus fileStatuses BlockLocation locations fs getFileBlockLocations fileStatus fileStatus getLen Set String hostsSet HashSet BlockLocation location locations hostsSet addAll Lists newArrayList location getHosts String hosts hostsSet toArray String FileSplit fileSplit FileSplit fileStatus getPath fileStatus getLen hosts String alias mapWork getAliases get
groupName HiveInputCounters getName vertexName jobConf get Operator CONTEXT_NAME_KEY counterName Utilities getVertexCounterName HiveInputCounters RAW_INPUT_SPLITS name vertexName tezCounters findCounter groupName counterName increment splits length List Path paths Utilities getInputPathsTez jobConf work counterName Utilities getVertexCounterName HiveInputCounters INPUT_DIRECTORIES name vertexName tezCounters findCounter groupName counterName increment paths size Set String files HashSet inputSplit splits inputSplit FileSplit FileSplit fileSplit FileSplit inputSplit Path path fileSplit getPath String fileStr path toString files fileStr files add fileStr
String locations String path start String bytes getHashInputForSplit path start hash1 hash1 bytes index Hashing consistentHash hash1 locations size String location locations get index
String locations String path start String desc bytes getHashInputForSplit path start hash1 hash1 bytes index Hashing consistentHash hash1 locations size String location locations get index LOG LOG debug desc index location iter hash2 location iter locations size iter hash2 hash2 bytes index Hashing consistentHash hash1 iter hash2 locations size location locations get index LOG
nRows checkInterruptionAfterRows time System nanoTime checkAbortCondition elapsedNs time lastInterruptCheckNs elapsedNs diff elapsedNs TARGET_INTERRUPT_CHECK_TIME_NS elapsedNs newRows Math min CHECK_INTERRUPTION_AFTER_ROWS_MAX Math max CHECK_INTERRUPTION_AFTER_ROWS_MIN diff checkInterruptionAfterRows checkInterruptionAfterRows newRows
WmTezSession wmTezSession entry getKey entry getValue Future Boolean killFuture wm wmTezSession entry getValue killFutures put wmTezSession killFuture destPoolName entry getValue Future Boolean moveFuture wm applyMoveSessionAsync wmTezSession destPoolName moveFutures put wmTezSession moveFuture entry getValue WmTezSession Future Boolean entry moveFutures WmTezSession wmTezSession entry getKey Future Boolean future entry getValue future
Future Boolean killFuture wm wmTezSession entry getValue killFutures put wmTezSession killFuture destPoolName entry getValue getPoolName Future Boolean moveFuture wm applyMoveSessionAsync wmTezSession destPoolName moveFutures put wmTezSession moveFuture entry getValue WmTezSession Future Boolean entry moveFutures WmTezSession wmTezSession entry getKey Future Boolean future entry getValue future LOG info wmTezSession getSessionId wmTezSession getPoolName
entry getValue WmTezSession Future Boolean entry WmTezSession wmTezSession entry getKey Future Boolean future entry getValue future LOG info wmTezSession getSessionId wmTezSession getPoolName e LOG error wmTezSession getSessionId e WmTezSession Future Boolean entry WmTezSession wmTezSession entry getKey Future Boolean future entry getValue future
WmTezSession Future Boolean entry WmTezSession wmTezSession entry getKey Future Boolean future entry getValue future LOG info wmTezSession getSessionId wmTezSession getPoolName e LOG error wmTezSession getSessionId e WmTezSession Future Boolean entry WmTezSession wmTezSession entry getKey Future Boolean future entry getValue future LOG info wmTezSession getSessionId e
T T key T value lock lock value T registry getIfPresent key value
T T key T T value ReentrantLock objectLock lock lock value T registry getIfPresent key value
value locks key objectLock locks get key objectLock ReentrantLock locks put key objectLock lock unlock objectLock lock lock lock value T registry getIfPresent key value
lock unlock objectLock lock lock lock value T registry getIfPresent key value LOG LOG debug key value lock unlock value fn call
context String attemptId Converters createTaskAttemptId context toString
mapOp VectorMapOperator runtimeCtx mapOp MapOperator runtimeCtx checkAbortCondition mapOp clearConnectedOperators mapOp setExecContext execContext fromCache AbstractMapOperator mergeMapOp mergeWork MapWork mergeMapWork MapWork mergeWork mergeMapWork mergeMapOp VectorMapOperator runtimeCtx
sources MapRecordSource size position mapOp getConf getTag sources position MapRecordSource KeyValueReader reader mainWorkMultiMRInput reader getKeyValueReader mainWorkMultiMRInput getKeyValueReaders mapOp reader legacyMRInput getReader sources position init jconf mapOp reader mapOp tag mapOp getConf getTag sources tag MapRecordSource String inputName mapOp getConf getName MultiMRInput multiMRInput multiMRInputMap get inputName Collection KeyValueReader kvReaders multiMRInput getKeyValueReaders
abort abort
T T key T value value T registry get key value
T T key T fn T value value T registry get key value value fn call
ThreadFactory threadFactory ThreadFactoryBuilder setDaemon setNameFormat build ScheduledExecutorService validatorExecutorService Executors newScheduledThreadPool sessionTriggerProviders size threadFactory String entry sessionTriggerProviders String poolName entry getKey poolName
init mrReporter inputs outputs MapredContext init JobConf jconf List LogicalInput shuffleInputs getShuffleInputs inputs checkAbortCondition shuffleInputs LOG info processorContext waitForAllInputsReady ArrayList Input shuffleInputs connectOps clear ReduceWork redWork reduceWork LOG info reduceWork getName List HashTableDummyOperator workOps reduceWork getDummyOps Set HashTableDummyOperator dummyOps workOps HashSet HashSet workOps tagToReducerMap put redWork getTag redWork
reducer mergeReduceWork getReducer checkAbortCondition DummyStoreOperator dummyStoreOp getJoinParentOp reducer connectOps put mergeReduceWork getTag dummyStoreOp tagToReducerMap put mergeReduceWork getTag mergeReduceWork TezContext MapredContext get setDummyOpsMap connectOps checkAbortCondition bigTablePosition reduceWork getTag ObjectInspector mainWorkOIs TezContext MapredContext get setInputs inputs TezContext MapredContext get setTezProcessorContext processorContext numTags reduceWork getTagToValueDesc size reducer reduceWork getReducer checkAbortCondition memoryAvailableToTask processorContext getTotalMemoryAvailableToTask
mainWorkOIs ObjectInspector numTags i tagToReducerMap redWork tagToReducerMap get i reducer redWork getReducer checkAbortCondition initializeSourceForTag redWork i mainWorkOIs sources redWork getTagToValueDesc get redWork getTagToInput get reducer initializeLocalWork jconf reducer reduceWork getReducer checkAbortCondition TezContext MapredContext get setRecordSources sources reducer initialize jconf ObjectInspector mainWorkOIs bigTablePosition i tagToReducerMap i bigTablePosition redWork tagToReducerMap get i
abort abort
TezSessionPoolSession next restartQueue take
TezSessionPoolSession nextToExpire nextToExpire expirationQueue take
TezSessionPoolSession nextToExpire nextToExpire expirationQueue take LOG LOG debug nextToExpire nextToExpire tryExpire e LOG error nextToExpire e nextToExpire LOG info nextToExpire nextToExpire LOG
nextToExpire tryExpire e LOG error nextToExpire e nextToExpire LOG info nextToExpire nextToExpire LOG LOG debug nextToExpire expirationQueue nextToExpire expirationQueue add nextToExpire nextToExpire expirationQueue peek nextToExpire timeToWaitMs nextToExpire getExpirationNs System nanoTime timeToWaitMs Math max timeToWaitMs
Multimap Integer InputSplit conf Multimap Integer InputSplit bucketSplitMultimap availableSlots waves splitLocationProvider Map Integer Integer bucketTaskMap estimateBucketSizes availableSlots waves bucketSplitMultimap asMap Multimap Integer InputSplit bucketGroupedSplitMultimap ArrayListMultimap Integer InputSplit create bucketId bucketSplitMultimap Collection InputSplit inputSplitCollection bucketSplitMultimap get bucketId InputSplit rawSplits inputSplitCollection toArray InputSplit InputSplit groupedSplits tezGrouper getGroupedSplits conf rawSplits bucketTaskMap get bucketId HiveInputFormat getName ColumnarSplitSizeEstimator splitLocationProvider
MapWork mapWork populateMapWork jobConf inputName Multimap Integer InputSplit schemaGroupedSplitMultiMap ArrayListMultimap Integer InputSplit create jobConf List Path paths Utilities getInputPathsTez jobConf mapWork Path path paths List String aliases mapWork getPathToAliases get path aliases aliases Operator OperatorDesc op mapWork getAliasToWork get aliases get op op TableScanOperator TableScanOperator tableScan TableScanOperator op PartitionDesc partitionDesc mapWork getAliasToPartnInfo get aliases get isMinorCompaction AcidUtils isCompactionTable partitionDesc getTableDesc getProperties tableScan isMinorCompaction String splitPath getFirstSplitPath splits String errorMessage splitPath
PartitionDesc pd HiveFileFormatUtils getFromPathRecursively work getPathToPartitionInfo path cache String currentDeserializerClass pd getDeserializerClassName Class currentInputFormatClass pd getInputFileFormatClass Class previousInputFormatClass String previousDeserializerClass prevSplit Path prevPath FileSplit prevSplit getPath path equals prevPath PartitionDesc prevPD HiveFileFormatUtils getFromPathRecursively work getPathToPartitionInfo prevPath cache previousDeserializerClass prevPD getDeserializerClassName previousInputFormatClass prevPD getInputFileFormatClass currentInputFormatClass previousInputFormatClass currentDeserializerClass equals previousDeserializerClass retval
perfLogger perfLogEnd CLASS_NAME PerfLogger TEZ_RUN_PROCESSOR t originalThrowable t originalThrowable originalThrowable originalThrowable LOG error StringUtils stringifyException originalThrowable getContext reportFailure TaskFailureType FATAL originalThrowable RuntimeException originalThrowable rproc rproc close t originalThrowable originalThrowable t originalThrowable
oldSession close poolLock lock pool remove oldSession poolLock unlock notifyClosed oldSession newSession getConf set TezConfiguration TEZ_QUEUE_NAME queueName configureAmRegistry newSession SessionState parentSessionState SessionState setCurrentSessionState parentSessionState newSession open newSession
TezConfiguration TEZ_QUEUE_NAME LOG warn queueName queueName hasQueue conf unset TezConfiguration TEZ_QUEUE_NAME SessionState ss SessionState get String userName ss userName ss getAuthenticator ss getAuthenticator getUserName ss getUserName userName userName Utils getUGI getShortUserName
yarnQueueChecker SessionState ss SessionState get String userName ss userName ss getAuthenticator ss getAuthenticator getUserName ss getUserName userName userName Utils getUGI getShortUserName LOG info userName yarnQueueChecker checkQueueAccess queueName userName restrictedConfig restrictedConfig validate conf initConf conf set ConfVars LLAP_CACHE_DEFAULT_FS_FILE_ID varname HiveConf getVarWithoutType initConf ConfVars LLAP_CACHE_DEFAULT_FS_FILE_ID nonDefaultUser conf getBoolVar HiveConf ConfVars HIVE_SERVER2_ENABLE_DOAS
String userName Utils getUGI getShortUserName LOG info userName session getUser userName session getUser LOG info userName session getUser e HiveException e doAsEnabled conf getBoolVar HiveConf ConfVars HIVE_SERVER2_ENABLE_DOAS doAsEnabled session getBoolVar HiveConf ConfVars HIVE_SERVER2_ENABLE_DOAS session String queueName session getQueueName String confQueueName conf get TezConfiguration TEZ_QUEUE_NAME
String userName Utils getUGI getShortUserName LOG info userName session getUser userName session getUser LOG info userName session getUser e HiveException e doAsEnabled conf getBoolVar HiveConf ConfVars HIVE_SERVER2_ENABLE_DOAS doAsEnabled session getBoolVar HiveConf ConfVars HIVE_SERVER2_ENABLE_DOAS session String queueName session getQueueName String confQueueName conf get TezConfiguration TEZ_QUEUE_NAME LOG info queueName confQueueName
queueName queueName confQueueName LOG warn queueName confQueueName queueName confQueueName doAsEnabled conf getBoolVar HiveConf ConfVars HIVE_SERVER2_ENABLE_DOAS llapMode equalsIgnoreCase HiveConf getVar conf HiveConf ConfVars HIVE_EXECUTION_MODE UserGroupInformation ugi Utils getUGI user ugi getShortUserName LOG info sessionId user tezScratchDir createTezDir sessionId resources resources resources LOG info resources resources HiveResources createTezDir sessionId ensureLocalResources conf additionalFilesNotFromConf
setupTezParamsBasedOnMR tezConfig tezConfig set TezConfiguration TEZ_AM_STAGING_DIR tezScratchDir toUri toString conf stripHiddenConfigurations tezConfig ServicePluginsDescriptor servicePluginsDescriptor Credentials llapCredentials tezConfig llapCredentials Credentials llapCredentials addToken LlapTokenIdentifier KIND_NAME getLlapToken user tezConfig UserPayload servicePluginPayload TezUtils createUserPayloadFromConf tezConfig servicePluginsDescriptor ServicePluginsDescriptor create TaskSchedulerDescriptor TaskSchedulerDescriptor create LLAP_SERVICE LLAP_SCHEDULER setUserPayload servicePluginPayload ContainerLauncherDescriptor ContainerLauncherDescriptor create LLAP_SERVICE LLAP_LAUNCHER TaskCommunicatorDescriptor TaskCommunicatorDescriptor create LLAP_SERVICE LLAP_TASK_COMMUNICATOR setUserPayload servicePluginPayload servicePluginsDescriptor ServicePluginsDescriptor create HiveConf conf ConfVars n HiveConf getIntVar conf ConfVars HIVE_PREWARM_NUM_CONTAINERS
session HiveConf conf session start isSuccessful HiveConf conf ConfVars n HiveConf getIntVar conf ConfVars HIVE_PREWARM_NUM_CONTAINERS
conf setIfUnset TezConfiguration TEZ_AM_VIEW_ACLS conf get MRJobConfig JOB_ACL_VIEW_JOB MRJobConfig DEFAULT_JOB_ACL_VIEW_JOB conf setIfUnset TezConfiguration TEZ_AM_MODIFY_ACLS conf get MRJobConfig JOB_ACL_MODIFY_JOB MRJobConfig DEFAULT_JOB_ACL_MODIFY_JOB ArrayList Map String String maps ArrayList Map String String maps add DeprecatedKeys getMRToTezRuntimeParamMap maps add DeprecatedKeys getMRToDAGParamMap preferTez Map String String maps Map String String dep conf get dep getKey String mrValue conf get dep getKey String tezValue conf get dep getValue conf unset dep getKey tezValue conf set dep getValue mrValue preferTez
tezConf HiveConf hiveConf String user SessionState getUserFromAuthenticator UserGroupInformation loginUserUgi UserGroupInformation getLoginUser String loginUser loginUserUgi loginUserUgi getShortUserName addHs2User HiveConf getBoolVar hiveConf ConfVars HIVETEZHS2USERACCESS String viewStr Utilities getAclStringWithHiveModification tezConf TezConfiguration TEZ_AM_VIEW_ACLS addHs2User user loginUser String modifyStr Utilities getAclStringWithHiveModification tezConf TezConfiguration TEZ_AM_MODIFY_ACLS addHs2User user loginUser
String localFile FileSystem localFs FileSystem getLocal conf FileStatus fileStatus localFs getFileStatus localFile String key getKey fileStatus String sha256 shaCache getIfPresent key sha256 FSDataInputStream is is localFs open localFile start System currentTimeMillis sha256 DigestUtils sha256Hex is end System currentTimeMillis
String conf String user SessionState getUserFromAuthenticator UserGroupInformation loginUserUgi UserGroupInformation getLoginUser String loginUser loginUserUgi loginUserUgi getShortUserName addHs2User HiveConf getBoolVar conf HiveConf ConfVars HIVETEZHS2USERACCESS String viewStr Utilities getAclStringWithHiveModification conf TezConfiguration TEZ_AM_VIEW_ACLS addHs2User user loginUser String modifyStr Utilities getAclStringWithHiveModification conf TezConfiguration TEZ_AM_MODIFY_ACLS addHs2User user loginUser
Map TezSessionState Trigger violatedSessions HashMap List TezSessionState sessions sessionTriggerProvider getSessions List Trigger triggers sessionTriggerProvider getTriggers TezSessionState sessionState sessions WmContext wmContext sessionState getWmContext wmContext wmContext wmContext Map String Long currentCounters wmContext getCurrentCounters wmContext updateElapsedTimeCounter Trigger currentTrigger triggers String desiredCounter currentTrigger getExpression getCounterLimit getName
Map String Long currentCounters wmContext getCurrentCounters wmContext updateElapsedTimeCounter Trigger currentTrigger String desiredCounter currentTrigger getExpression getCounterLimit getName LOG LOG debug currentTrigger currentCounters currentCounters desiredCounter currentCounterValue currentCounters get desiredCounter currentTrigger currentCounterValue String queryId sessionState getWmContext getQueryId violatedSessions sessionState Trigger existingTrigger violatedSessions get sessionState existingTrigger currentTrigger currentTrigger setViolationMsg currentTrigger currentCounterValue violatedSessions put sessionState currentTrigger
SplitLocationProvider conf useCacheAffinity useCustomLocations HiveConf getVar conf HiveConf ConfVars HIVE_EXECUTION_MODE equals HiveConf getBoolVar conf HiveConf ConfVars LLAP_CLIENT_CONSISTENT_SPLITS useCacheAffinity SplitLocationProvider splitLocationProvider String locationProviderClass HiveConf getVar conf HiveConf ConfVars LLAP_SPLIT_LOCATION_PROVIDER_CLASS customLocationProvider HostAffinitySplitLocationProvider getName equals locationProviderClass
LlapRegistryService serviceRegistry LOG LOG info serviceRegistry getApplicationId Collection LlapServiceInstance serviceInstances serviceRegistry getInstances getAllInstancesOrdered Preconditions checkArgument serviceInstances isEmpty ArrayList String locations ArrayList serviceInstances size LlapServiceInstance serviceInstance serviceInstances String executors serviceInstance getProperties get LlapRegistryService LLAP_DAEMON_NUM_ENABLED_EXECUTORS executors executors locations add LOG
sessionState wmTezSessionInfo WmTezSessionInfo sessionState eventEndTimestamp System currentTimeMillis elapsedTime eventEndTimestamp eventStartTimestamp WmContext wmContext sessionState getWmContext wmContext wmContext addWMEvent
si AmPluginInfo info si AmPluginInfo si getHost si getPluginPort si getPluginToken si getPluginTokenJobId info
LOG warn hasChanges currentEvents current current currentEvents one two one currentLock unlock LOG info processCurrentEvents currentEvents syncWork scheduleWork syncWork updateSessionTriggerProvidersOnMasterThread LOG warn
killCtx WmTezSession toKill killCtx session String reason killCtx reason
killCtx WmTezSession toKill killCtx session String reason killCtx reason LOG info toKill String queryId toKill getQueryId KillQuery kq toKill getKillQuery kq queryId WmEvent wmEvent WmEvent WmEvent EventType KILL
String queryId toKill getQueryId KillQuery kq toKill getKillQuery kq queryId WmEvent wmEvent WmEvent WmEvent EventType KILL LOG info queryId reason UserGroupInformation ugi UserGroupInformation getCurrentUser SessionState ss SessionState HiveConf ugi getShortUserName ss setIsHiveServerQuery SessionState start ss kq killQuery queryId reason toKill getConf addKillQueryResult toKill killCtx killSessionFuture set wmEvent endEvent toKill
kq queryId WmEvent wmEvent WmEvent WmEvent EventType KILL LOG info queryId reason UserGroupInformation ugi UserGroupInformation getCurrentUser SessionState ss SessionState HiveConf ugi getShortUserName ss setIsHiveServerQuery SessionState start ss kq killQuery queryId reason toKill getConf addKillQueryResult toKill killCtx killSessionFuture set wmEvent endEvent toKill LOG debug queryId
LOG info queryId reason UserGroupInformation ugi UserGroupInformation getCurrentUser SessionState ss SessionState HiveConf ugi getShortUserName ss setIsHiveServerQuery SessionState start ss kq killQuery queryId reason toKill getConf addKillQueryResult toKill killCtx killSessionFuture set wmEvent endEvent toKill LOG debug queryId ex LOG error queryId ex
addKillQueryResult toKill killCtx killSessionFuture set wmEvent endEvent toKill LOG debug queryId ex LOG error queryId ex LOG info toKill queryId kq toKill setQueryId addKillQueryResult toKill context toKillQuery clear context
context toKillQuery clear toRestart context toRestartInUse LOG info toRestart toRestart setQueryId WmEvent wmEvent WmEvent WmEvent EventType RESTART tezAmPool replaceSession toRestart wmEvent endEvent toRestart ex LOG error ex context toRestartInUse clear context
tezAmPool replaceSession toRestart wmEvent endEvent toRestart ex LOG error ex context toRestartInUse clear toDestroy context LOG info toDestroy WmEvent wmEvent WmEvent WmEvent EventType DESTROY toDestroy close wmEvent endEvent toDestroy ex LOG error ex getMessage
moveSession e moveSessions handleMoveSessionOnMasterThread moveSession syncWork poolsToRedistribute e toReuse recordMoveEvents e moveSessions clear GetRequest req req e LOG info req mappingInput queueGetRequestOnMasterThread req poolsToRedistribute syncWork e toReuse clear Iterator KillQueryContext iter killQueryInProgress values iterator iter KillQueryContext ctx iter next KillQueryResult kr ctx process kr
moveSession String String destPoolName moveSession destPool
RemoveSessionResult rr checkAndRemoveSessionFromItsPool moveSession srcSession poolsToRedistribute rr RemoveSessionResult destPoolName Boolean added checkAndAddSessionToAnotherPool moveSession srcSession destPoolName poolsToRedistribute added added moveSession future set recordMoveEvents put moveSession srcSession moveEvent LOG error moveSession WmTezSession session moveSession srcSession KillQueryContext killQueryContext KillQueryContext session destPoolName resetAndQueueKill syncWork toKillQuery killQueryContext toReuse
destPoolName Boolean added checkAndAddSessionToAnotherPool moveSession srcSession destPoolName poolsToRedistribute added added moveSession future set recordMoveEvents put moveSession srcSession moveEvent LOG error moveSession WmTezSession session moveSession srcSession KillQueryContext killQueryContext KillQueryContext session destPoolName resetAndQueueKill syncWork toKillQuery killQueryContext toReuse LOG error moveSession
session Ref Integer endpointVersion Ref AmPluginInfo info session getAmPluginInfo endpointVersion info endpointVersion
level level poolsByLevel level List WMPool poolsOnLevel poolsByLevel get level WMPool pool poolsOnLevel String fullName pool getPoolPath qp pool getQueryParallelism fraction pool getAllocFraction level String parentName fullName substring fullName lastIndexOf POOL_SEPARATOR PoolState parent pools get parentName fraction parent finalFraction fraction parent finalFractionRemaining fraction PoolState state oldPools oldPools remove fullName state state PoolState fullName qp fraction pool getSchedulingPolicy metricsSystem
state PoolState fullName qp fraction pool getSchedulingPolicy metricsSystem state update qp fraction syncWork e pool getSchedulingPolicy poolsToRedistribute add fullName state setTriggers LinkedList Trigger LOG info state pools put fullName state totalQueryParallelism qp PoolState pool pools pool metrics pool metrics setMaxExecutors allocationManager translateAllocationToCpus pool finalFractionRemaining Map String Trigger triggers HashMap trigger ExecutionTrigger execTrigger ExecutionTrigger fromWMTrigger trigger
state setTriggers LinkedList Trigger LOG info state pools put fullName state totalQueryParallelism qp PoolState pool pools pool metrics pool metrics setMaxExecutors allocationManager translateAllocationToCpus pool finalFractionRemaining Map String Trigger triggers HashMap trigger ExecutionTrigger execTrigger ExecutionTrigger fromWMTrigger trigger triggers put trigger getTriggerName execTrigger poolTrigger PoolState pool pools get poolTrigger getPool Trigger trigger triggers get poolTrigger getTrigger
WmTezSession source WmTezSession deltaSessions deltaSessions deltaSessions toTransfer Math min deltaSessions source size Iterator WmTezSession iter source iterator toTransfer WmTezSession session iter next
srcSession destPoolName currentLock lock MoveSession moveSession moveSession MoveSession srcSession destPoolName current moveSessions add moveSession
wmTezSession killReason KillQueryContext killQueryContext currentLock lock killQueryContext KillQueryContext wmTezSession killReason resetAndQueueKill syncWork toKillQuery killQueryContext current toReuse
Boolean SettableFuture Boolean testEvent SettableFuture create currentLock lock
WmTezSession conf WmTezSession session createSessionObject TezSessionState makeSessionId conf session setQueueName yarnQueue session setDefault
session WmContext wmContext session getWmContext String poolName session getPoolName PoolState poolState pools get poolName wmContext poolState wmContext addTriggers poolState getTriggers
input UserPoolMapping mapping userPoolMapping mapping String mappedPool mapping mapSessionToPoolName input allowAnyPool
wmContext context getWmContext EnumSet StatusGetOpts opts wmContext Set String desiredCounters wmContext getSubscribedCounters desiredCounters desiredCounters opts EnumSet of StatusGetOpts GET_COUNTERS status dagClient getDAGStatus opts checkInterval vertexProgressMap status getVertexProgress List String vertexNames vertexProgressMap keySet stream map k k replaceAll collect Collectors toList wmContext Set String desiredCounters wmContext getSubscribedCounters TezCounters dagCounters status getDAGCounters TezCounters mergedCounters counters dagCounters Utils mergeTezCounters dagCounters counters mergedCounters desiredCounters desiredCounters Map String Long currentCounters getCounterValues mergedCounters vertexNames vertexProgressMap desiredCounters done
firstBatch vectorExtractRow VectorExtractRow vectorExtractRow init StructObjectInspector inputObjInspectors vContext getProjectedColumns singleRow Object vectorExtractRow getCount firstBatch ObjectInspector rowInspector inputObjInspectors Writable writableRow batch selected batch selected logical logical batch logical batchIndex selected logical vectorExtractRow extractRow batch batchIndex singleRow writableRow serializer serialize singleRow rowInspector writableRow write buffer
selected batch selected logical logical batch logical batchIndex selected logical vectorExtractRow extractRow batch batchIndex singleRow writableRow serializer serialize singleRow rowInspector writableRow write buffer buffer getLength LOG info buffer getLength hasReachedMaxSize buffer batchIndex batchIndex batch batchIndex vectorExtractRow extractRow batch batchIndex singleRow writableRow serializer serialize singleRow rowInspector
Class VectorExpression matchedVe Class VectorExpression ve VectorExpression candidateVe ve newInstance candidateVe ve candidateVe ve matchedVe ve ex HiveException ve getSimpleName ex matchedVe matchedVe
VectorExpression candidateVe ve newInstance candidateVe descriptor ve candidateVe ve matchedVe ve ex HiveException ve getSimpleName ex matchedVe matchedVe LOG LOG debug udf getSimpleName descriptor toString VectorExpression ve
Map KeyWrapper TopNKeyFilter filters KeyWrapper Iterator Map Entry KeyWrapper TopNKeyFilter iterator filters entrySet iterator iterator Map Entry KeyWrapper TopNKeyFilter each iterator next KeyWrapper partitionKey each getKey TopNKeyFilter filter each getValue
Map KeyWrapper TopNKeyFilter filters KeyWrapper efficiencyThreshold log Iterator Map Entry KeyWrapper TopNKeyFilter iterator filters entrySet iterator iterator Map Entry KeyWrapper TopNKeyFilter each iterator next KeyWrapper partitionKey each getKey TopNKeyFilter filter each getValue log debug filter efficiencyThreshold filter filter efficiencyThreshold
topNKeyFilters TopNKeyFilter filter topNKeyFilters values iterator next
newChildren addAll childExpr getChildren subList childExpr getChildren size expr setTypeInfo childExpr getTypeInfo expr setGenericUDF childExpr getGenericUDF expr setChildren newChildren List ExprNodeDesc childExpressions getChildExpressionsWithImplicitCast expr getGenericUDF exprDesc getChildren exprDesc getTypeInfo ve getGenericUdfVectorExpression expr getGenericUDF childExpressions mode exprDesc getTypeInfo ve HiveException mode name exprDesc toString expr mode ve getCustomUDFExpression expr mode HiveException mode name exprDesc toString
HiveException mode name exprDesc toString expr mode ve getCustomUDFExpression expr mode HiveException mode name exprDesc toString LOG LOG debug exprDesc toString ve getCustomUDFExpression expr mode name ve HiveException mode name exprDesc toString exprDesc
myagg VectorUDAFBloomFilterMerge Aggregation agg VectorUDAFBloomFilterMerge Aggregation myagg agg
bloomFilterDynamicValue Object Object InputStream in Object val bloomFilterDynamicValue getValue
ve ve evaluate batch LongColumnVector joinColVector LongColumnVector batch cols singleJoinColumn vector joinColVector vector allKeyInputColumnsRepeating joinColVector isRepeating allKeyInputColumnsRepeating JoinUtil JoinResult joinResult joinColVector joinColVector joinResult JoinUtil JoinResult MATCH key vector key key joinResult JoinUtil JoinResult MATCH joinResult hashSet contains key hashSetResults
haveSaveKey saveKey currentKey currentKey currentKey saveJoinResult JoinUtil JoinResult NOMATCH saveJoinResult hashSet contains currentKey hashSetResults hashSetResultCount saveJoinResult inverseResultForAntiJoin saveJoinResult saveJoinResult spillCount spillHashMapResultIndices spillCount hashSetResultCount spillCount NOMATCH
allKeyInputColumnsRepeating allKeyInputColumnsRepeating batch allKeyInputColumnsRepeating allKeyInputColumnsRepeating keyVectorSerializeWrite setOutput currentKeyOutput keyVectorSerializeWrite serializeWrite batch JoinUtil JoinResult joinResult keyVectorSerializeWrite joinResult JoinUtil JoinResult MATCH keyBytes currentKeyOutput getData
temp saveKeyOutput saveKeyOutput currentKeyOutput currentKeyOutput temp keyBytes saveKeyOutput getData keyLength saveKeyOutput getLength saveJoinResult hashSet contains keyBytes keyLength hashSetResults hashSetResultCount saveJoinResult inverseResultForAntiJoin saveJoinResult saveJoinResult spillCount spillHashMapResultIndices spillCount hashSetResultCount spillCount
ve evaluate batch BytesColumnVector joinColVector BytesColumnVector batch cols singleJoinColumn vector joinColVector vector start joinColVector start length joinColVector length allKeyInputColumnsRepeating joinColVector isRepeating allKeyInputColumnsRepeating JoinUtil JoinResult joinResult joinColVector joinColVector joinResult JoinUtil JoinResult MATCH keyBytes vector keyStart start keyLength length joinResult hashSet contains keyBytes keyStart keyLength hashSetResults
keyLength length batchIndex saveJoinResult hashSet contains keyBytes keyStart keyLength hashSetResults hashSetResultCount saveJoinResult inverseResultForAntiJoin saveJoinResult saveJoinResult batchIndex spillCount batchIndex spillHashMapResultIndices spillCount hashSetResultCount spillCount saveJoinResult batchIndex
overflowBatch outputColumn typeName dataTypePhysicalVariation overflowBatch cols outputColumn typeName VectorizationContext mapTypeNameSynonyms typeName TypeInfo typeInfo TypeInfoUtils getTypeInfoFromTypeString typeName overflowBatch cols outputColumn VectorizedBatchUtil createColumnVector typeInfo dataTypePhysicalVariation
batch batchName LOG debug getLoggingPrefix batchName batch numCols batch numCols
length bigTable currentLength bigTableVectorDeserializeRow setBytes bytes offset length bigTableVectorDeserializeRow deserialize spillReplayBatch spillReplayBatch size e HiveException bigTableVectorDeserializeRow getDetailedReadPositionString e spillReplayBatch size spillReplayBatch size process spillReplayBatch posBigTable spillReplayBatch reset batchCount spillReplayBatch size process spillReplayBatch posBigTable spillReplayBatch reset batchCount
bigTableVectorDeserializeRow deserialize spillReplayBatch spillReplayBatch size e HiveException bigTableVectorDeserializeRow getDetailedReadPositionString e spillReplayBatch size spillReplayBatch size process spillReplayBatch posBigTable spillReplayBatch reset batchCount spillReplayBatch size process spillReplayBatch posBigTable spillReplayBatch reset batchCount bigTable clear e LOG info CLASS_NAME e
ve ve evaluate batch LongColumnVector joinColVector LongColumnVector batch cols singleJoinColumn vector joinColVector vector allKeyInputColumnsRepeating joinColVector isRepeating allKeyInputColumnsRepeating JoinUtil JoinResult joinResult joinColVector joinColVector joinResult JoinUtil JoinResult NOMATCH key vector key key joinResult JoinUtil JoinResult NOMATCH
LongColumnVector joinColVector LongColumnVector batch cols singleJoinColumn vector joinColVector vector allKeyInputColumnsRepeating joinColVector isRepeating allKeyInputColumnsRepeating JoinUtil JoinResult joinResult joinColVector joinColVector joinResult JoinUtil JoinResult NOMATCH key vector key key joinResult JoinUtil JoinResult NOMATCH joinResult hashMultiSet contains key hashMultiSetResults LOG LOG debug CLASS_NAME batchCounter joinResult name
saveJoinResult hashMultiSet contains currentKey hashMultiSetResults hashMultiSetResultCount saveJoinResult equalKeySeriesCount hashMultiSetResults hashMultiSetResultCount equalKeySeriesAllMatchIndices equalKeySeriesCount allMatchCount equalKeySeriesDuplicateCounts equalKeySeriesCount allMatchs allMatchCount batchIndex spillCount batchIndex spillHashMapResultIndices spillCount hashMultiSetResultCount spillCount saveJoinResult
allKeyInputColumnsRepeating allKeyInputColumnsRepeating batch allKeyInputColumnsRepeating allKeyInputColumnsRepeating keyVectorSerializeWrite setOutput currentKeyOutput keyVectorSerializeWrite serializeWrite batch JoinUtil JoinResult joinResult keyVectorSerializeWrite joinResult JoinUtil JoinResult NOMATCH
keyLength saveKeyOutput getLength saveJoinResult hashMultiSet contains keyBytes keyLength hashMultiSetResults hashMultiSetResultCount saveJoinResult equalKeySeriesCount hashMultiSetResults hashMultiSetResultCount equalKeySeriesAllMatchIndices equalKeySeriesCount allMatchCount equalKeySeriesDuplicateCounts equalKeySeriesCount allMatchs allMatchCount batchIndex spillCount batchIndex spillHashMapResultIndices spillCount hashMultiSetResultCount spillCount saveJoinResult
ve evaluate batch numSel BytesColumnVector joinColVector BytesColumnVector batch cols singleJoinColumn vector joinColVector vector start joinColVector start length joinColVector length allKeyInputColumnsRepeating joinColVector isRepeating allKeyInputColumnsRepeating JoinUtil JoinResult joinResult joinColVector joinColVector joinResult JoinUtil JoinResult NOMATCH keyBytes vector keyStart start keyLength length
equalKeySeriesCount hashMultiSetResultCount equalKeySeriesAllMatchIndices equalKeySeriesCount allMatchCount equalKeySeriesDuplicateCounts equalKeySeriesCount allMatchs allMatchCount batchIndex spillCount batchIndex spillHashMapResultIndices spillCount hashMultiSetResultCount spillCount equalKeySeriesDuplicateCounts equalKeySeriesCount allMatchs allMatchCount batchIndex
ve ve evaluate batch LongColumnVector joinColVector LongColumnVector batch cols singleJoinColumn vector joinColVector vector allKeyInputColumnsRepeating joinColVector isRepeating allKeyInputColumnsRepeating JoinUtil JoinResult joinResult joinColVector joinColVector joinResult JoinUtil JoinResult NOMATCH key vector key key joinResult JoinUtil JoinResult NOMATCH
LongColumnVector joinColVector LongColumnVector batch cols singleJoinColumn vector joinColVector vector allKeyInputColumnsRepeating joinColVector isRepeating allKeyInputColumnsRepeating JoinUtil JoinResult joinResult joinColVector joinColVector joinResult JoinUtil JoinResult NOMATCH key vector key key joinResult JoinUtil JoinResult NOMATCH joinResult hashMap lookup key hashMapResults LOG LOG debug CLASS_NAME batchCounter joinResult name
saveJoinResult hashMap lookup currentKey hashMapResults hashMapResultCount saveJoinResult equalKeySeriesCount hashMapResultCount equalKeySeriesAllMatchIndices equalKeySeriesCount allMatchCount equalKeySeriesIsSingleValue equalKeySeriesCount hashMapResults hashMapResultCount isSingleRow equalKeySeriesDuplicateCounts equalKeySeriesCount allMatchs allMatchCount batchIndex spillCount batchIndex spillHashMapResultIndices spillCount hashMapResultCount spillCount saveJoinResult
allKeyInputColumnsRepeating allKeyInputColumnsRepeating batch allKeyInputColumnsRepeating allKeyInputColumnsRepeating keyVectorSerializeWrite setOutput currentKeyOutput keyVectorSerializeWrite serializeWrite batch JoinUtil JoinResult joinResult keyVectorSerializeWrite joinResult JoinUtil JoinResult NOMATCH
equalKeySeriesCount hashMapResultCount equalKeySeriesAllMatchIndices equalKeySeriesCount allMatchCount equalKeySeriesIsSingleValue equalKeySeriesCount hashMapResults hashMapResultCount isSingleRow equalKeySeriesDuplicateCounts equalKeySeriesCount allMatchs allMatchCount batchIndex spillCount batchIndex spillHashMapResultIndices spillCount hashMapResultCount spillCount equalKeySeriesDuplicateCounts equalKeySeriesCount
ve ve evaluate batch BytesColumnVector joinColVector BytesColumnVector batch cols singleJoinColumn vector joinColVector vector start joinColVector start length joinColVector length allKeyInputColumnsRepeating joinColVector isRepeating allKeyInputColumnsRepeating JoinUtil JoinResult joinResult joinColVector joinColVector joinResult JoinUtil JoinResult NOMATCH keyBytes vector keyStart start keyLength length
equalKeySeriesIsSingleValue equalKeySeriesCount hashMapResults hashMapResultCount isSingleRow equalKeySeriesDuplicateCounts equalKeySeriesCount allMatchs allMatchCount batchIndex spillCount batchIndex spillHashMapResultIndices spillCount hashMapResultCount spillCount equalKeySeriesDuplicateCounts equalKeySeriesCount allMatchs allMatchCount batchIndex spillCount batchIndex
ve ve evaluate batch LongColumnVector joinColVector LongColumnVector batch cols singleJoinColumn vector joinColVector vector allKeyInputColumnsRepeating joinColVector isRepeating allKeyInputColumnsRepeating JoinUtil JoinResult joinResult joinColVector joinColVector joinResult JoinUtil JoinResult NOMATCH key vector key key joinResult JoinUtil JoinResult NOMATCH
LongColumnVector joinColVector LongColumnVector batch cols singleJoinColumn vector joinColVector vector allKeyInputColumnsRepeating joinColVector isRepeating allKeyInputColumnsRepeating JoinUtil JoinResult joinResult joinColVector joinColVector joinResult JoinUtil JoinResult NOMATCH key vector key key joinResult JoinUtil JoinResult NOMATCH joinResult hashSet contains key hashSetResults LOG LOG debug CLASS_NAME batchCounter joinResult name
haveSaveKey saveKey currentKey currentKey currentKey saveJoinResult JoinUtil JoinResult NOMATCH saveJoinResult hashSet contains currentKey hashSetResults hashSetResultCount saveJoinResult spillCount spillHashMapResultIndices spillCount hashSetResultCount spillCount NOMATCH
allKeyInputColumnsRepeating allKeyInputColumnsRepeating batch allKeyInputColumnsRepeating allKeyInputColumnsRepeating keyVectorSerializeWrite setOutput currentKeyOutput keyVectorSerializeWrite serializeWrite batch JoinUtil JoinResult joinResult keyVectorSerializeWrite joinResult JoinUtil JoinResult NOMATCH
haveSaveKey temp saveKeyOutput saveKeyOutput currentKeyOutput currentKeyOutput temp keyBytes saveKeyOutput getData keyLength saveKeyOutput getLength saveJoinResult hashSet contains keyBytes keyLength hashSetResults hashSetResultCount saveJoinResult spillCount spillHashMapResultIndices spillCount hashSetResultCount spillCount
ve ve evaluate batch BytesColumnVector joinColVector BytesColumnVector batch cols singleJoinColumn vector joinColVector vector start joinColVector start length joinColVector length allKeyInputColumnsRepeating joinColVector isRepeating allKeyInputColumnsRepeating JoinUtil JoinResult joinResult joinColVector joinColVector joinResult JoinUtil JoinResult NOMATCH keyBytes vector keyStart start keyLength length
keyStart start batchIndex keyLength length batchIndex saveJoinResult hashSet contains keyBytes keyStart keyLength hashSetResults hashSetResultCount saveJoinResult batchIndex spillCount batchIndex spillHashMapResultIndices spillCount hashSetResultCount spillCount saveJoinResult batchIndex
noMatchCount spillCount nonSpillCount subtractFromInputSelected inputSelectedInUse inputLogicalSize spills spillCount nonSpills LOG LOG debug intArrayToRangesString nonSpills nonSpillCount doValueExpr batch nonSpills nonSpillCount noMatchCount subtract nonSpills nonSpillCount allMatchs allMatchCount noMatchs LOG LOG debug intArrayToRangesString noMatchs noMatchCount doValueExprOnInputSelected batch inputSelectedInUse inputLogicalSize noMatchCount subtractFromInputSelected inputSelectedInUse inputLogicalSize allMatchs allMatchCount noMatchs
doValueExprOnInputSelected batch inputSelectedInUse inputLogicalSize noMatchCount subtractFromInputSelected inputSelectedInUse inputLogicalSize allMatchs allMatchCount noMatchs LOG LOG debug intArrayToRangesString noMatchs noMatchCount allMatchCount numSel i i i hashMapResultIndex equalKeySeriesHashMapResultIndices i VectorMapJoinHashMapResult hashMapResult hashMapResults hashMapResultIndex allMatchesIndex equalKeySeriesAllMatchIndices i isSingleValue equalKeySeriesIsSingleValue i duplicateCount equalKeySeriesDuplicateCounts i isSingleValue
numSel generateHashMapResultSingleValue batch hashMapResult allMatchs allMatchesIndex duplicateCount numSel generateHashMapResultMultiValue batch hashMapResult allMatchs allMatchesIndex duplicateCount batch size numSel batch selectedInUse LOG LOG debug intArrayToRangesString batch selected batch size batch size noMatchCount batch size generateOuterNulls batch noMatchs noMatchCount mergeCount sortMerge noMatchs noMatchCount batch selected batch size merged LOG LOG debug intArrayToRangesString merged mergeCount
equalKeySeriesCount hashMapResultCount equalKeySeriesAllMatchIndices equalKeySeriesCount allMatchCount equalKeySeriesIsSingleValue equalKeySeriesCount hashMapResults hashMapResultCount isSingleRow equalKeySeriesDuplicateCounts equalKeySeriesCount allMatchs allMatchCount batchIndex spillCount batchIndex spillHashMapResultIndices spillCount hashMapResultCount spillCount equalKeySeriesDuplicateCounts equalKeySeriesCount
equalKeySeriesCount hashMapResultCount equalKeySeriesAllMatchIndices equalKeySeriesCount allMatchCount equalKeySeriesIsSingleValue equalKeySeriesCount hashMapResults hashMapResultCount isSingleRow equalKeySeriesDuplicateCounts equalKeySeriesCount allMatchs allMatchCount batchIndex spillCount batchIndex spillHashMapResultIndices spillCount hashMapResultCount spillCount
ve evaluate batch BytesColumnVector joinColVector BytesColumnVector batch cols singleJoinColumn vector joinColVector vector start joinColVector start length joinColVector length allKeyInputColumnsRepeating joinColVector isRepeating allKeyInputColumnsRepeating JoinUtil JoinResult joinResult batch joinResult JoinUtil JoinResult NOMATCH joinColVector joinColVector joinResult JoinUtil JoinResult NOMATCH keyBytes vector keyStart start
equalKeySeriesDuplicateCounts equalKeySeriesCount allMatchs allMatchCount batchIndex spillCount batchIndex spillHashMapResultIndices spillCount hashMapResultCount spillCount equalKeySeriesDuplicateCounts equalKeySeriesCount allMatchs allMatchCount batchIndex spillCount batchIndex
isNewKey refWord partialHashCode VectorMapJoinFastBytesHashKeyRef extractPartialHashCode hashCode refWord slots slot refWord isNewKey VectorMapJoinFastBytesHashKeyRef refWord partialHashCode VectorMapJoinFastBytesHashKeyRef refWord isNewKey metricPutConflict probeSlot i slot probeSlot logicalHashBucketMask i
isNewKey refWord partialHashCode VectorMapJoinFastBytesHashKeyRef extractPartialHashCode hashCode refWord slots slot refWord isNewKey VectorMapJoinFastBytesHashKeyRef refWord partialHashCode VectorMapJoinFastBytesHashKeyRef refWord isNewKey metricPutConflict probeSlot i slot probeSlot logicalHashBucketMask i
isNewKey refWord partialHashCode VectorMapJoinFastBytesHashKeyRef extractPartialHashCode hashCode refWord slots slot refWord isNewKey VectorMapJoinFastBytesHashKeyRef refWord partialHashCode VectorMapJoinFastBytesHashKeyRef refWord isNewKey metricPutConflict probeSlot i slot probeSlot logicalHashBucketMask i
slot slot slot refWord slots slot refWord hashCode VectorMapJoinFastBytesHashKeyRef calculateHashCode refWord writeBuffers unsafeReadPos intHashCode hashCode newSlot intHashCode newLogicalHashBucketMask newProbeSlot newSlot i newSlot newMetricPutConflict newProbeSlot i newSlot newProbeSlot newLogicalHashBucketMask i
Map Integer String parentToInput desc getParentToInput Map Integer Long parentKeyCounts desc getParentKeyCounts MemoryMonitorInfo memoryMonitorInfo desc getMemoryMonitorInfo doMemCheck effectiveThreshold memoryMonitorInfo effectiveThreshold memoryMonitorInfo getEffectiveThreshold desc getMaxMemoryAvailable memoryMonitorInfo setLlap memoryMonitorInfo doMemCheck LOG LOG info memoryMonitorInfo doMemCheck LOG
pos pos pos pos numEntries String inputName parentToInput get pos LogicalInput input tezContext getInput inputName input start tezContext getTezProcessorContext waitForAnyInputReady Collections Input singletonList input e HiveException e KeyValueReader kvReader KeyValueReader input getReader Long keyCountObj parentKeyCounts get pos estKeyCount keyCountObj keyCountObj
pos numEntries String inputName parentToInput get pos LogicalInput input tezContext getInput inputName input start tezContext getTezProcessorContext waitForAnyInputReady Collections Input singletonList input e HiveException e KeyValueReader kvReader KeyValueReader input getReader Long keyCountObj parentKeyCounts get pos estKeyCount keyCountObj keyCountObj inputRecords
KeyValueReader kvReader KeyValueReader input getReader Long keyCountObj parentKeyCounts get pos estKeyCount keyCountObj keyCountObj inputRecords inputRecords AbstractLogicalInput input getContext getCounters findCounter getValue e LOG debug e keyCount Math max estKeyCount inputRecords VectorMapJoinFastTableContainer vectorMapJoinFastTableContainer VectorMapJoinFastTableContainer desc hconf keyCount LOG info inputName cacheKey vectorMapJoinFastTableContainer getClass getSimpleName pos estKeyCount keyCount vectorMapJoinFastTableContainer setSerde startTime System currentTimeMillis kvReader vectorMapJoinFastTableContainer putRow BytesWritable kvReader getCurrentKey BytesWritable kvReader getCurrentValue
e LOG debug e keyCount Math max estKeyCount inputRecords VectorMapJoinFastTableContainer vectorMapJoinFastTableContainer VectorMapJoinFastTableContainer desc hconf keyCount LOG info inputName cacheKey vectorMapJoinFastTableContainer getClass getSimpleName pos estKeyCount keyCount vectorMapJoinFastTableContainer setSerde startTime System currentTimeMillis kvReader vectorMapJoinFastTableContainer putRow BytesWritable kvReader getCurrentKey BytesWritable kvReader getCurrentValue numEntries numEntries memoryMonitorInfo estMemUsage vectorMapJoinFastTableContainer getEstimatedMemorySize estMemUsage effectiveThreshold String msg inputName numEntries estMemUsage effectiveThreshold memoryMonitorInfo LOG error msg
LOG debug e keyCount Math max estKeyCount inputRecords VectorMapJoinFastTableContainer vectorMapJoinFastTableContainer VectorMapJoinFastTableContainer desc hconf keyCount LOG info inputName cacheKey vectorMapJoinFastTableContainer getClass getSimpleName pos estKeyCount keyCount vectorMapJoinFastTableContainer setSerde startTime System currentTimeMillis kvReader vectorMapJoinFastTableContainer putRow BytesWritable kvReader getCurrentKey BytesWritable kvReader getCurrentValue numEntries numEntries memoryMonitorInfo estMemUsage vectorMapJoinFastTableContainer getEstimatedMemorySize estMemUsage effectiveThreshold String msg inputName numEntries estMemUsage effectiveThreshold memoryMonitorInfo LOG error msg MapJoinMemoryExhaustionError msg
isNewKey pairIndex slot valueRef slotPairs pairIndex valueRef isNewKey tableKey slotPairs pairIndex tableKey isNewKey metricPutConflict probeSlot i slot probeSlot logicalHashBucketMask i
hashCode HashCodeUtil calculateLongHashCode tableKey intHashCode hashCode newSlot intHashCode newLogicalHashBucketMask newProbeSlot newSlot newPairIndex i newPairIndex newSlot newValueRef newSlotPairs newPairIndex newValueRef newMetricPutConflict newProbeSlot i newSlot newProbeSlot newLogicalHashBucketMask i
row VectorizedRowBatch batch VectorizedRowBatch row batchCounter batch
row VectorizedRowBatch batch VectorizedRowBatch row batchCounter batch
row VectorizedRowBatch batch VectorizedRowBatch row batchCounter batch
parentDir FileUtils createLocalDirsTempFile spillLocalDirs parentDir deleteOnExit tmpFile File createTempFile parentDir
writer endArray writer name value HiveConf getVar conf HiveConf ConfVars HIVE_EXECUTION_ENGINE writer name value ss getCurrentDatabase writer name value getQueryHash queryStr writer name value queryStr List Edge edges getEdges plan index Set Vertex vertices getVertices edges writeEdges writer edges hookContext getConf writeVertices writer vertices writer endObject writer close String lineage out toString log lineage
List HdfsFileStatusWithId Boolean useFileIds fs directory useFileIds List HdfsFileStatusWithId childrenWithId Boolean val useFileIds value val val childrenWithId SHIMS listLocatedHdfsStatus fs directory hiddenFileFilter val useFileIds value uoe LOG info uoe getMessage val useFileIds value
useFileIds List HdfsFileStatusWithId childrenWithId Boolean val useFileIds value val val childrenWithId SHIMS listLocatedHdfsStatus fs directory hiddenFileFilter val useFileIds value uoe LOG info uoe getMessage val useFileIds value ioe LOG info ioe getMessage
conf ValidWriteIdList validWriteIds conf set ValidWriteIdList VALID_WRITEIDS_KEY validWriteIds toString
dbName dbName tbl getDbName tblName tblName tbl getTableName writeId ValidWriteIdList validWriteIdList SessionState get HiveTxnManager sessionTxnMgr SessionState get getTxnMgr String fullTableName getFullTableName dbName tblName sessionTxnMgr sessionTxnMgr validWriteIdList getTableValidWriteIdList conf fullTableName writeId sessionTxnMgr getAllocatedTableWriteId dbName tblName writeId
LOG debug getAcidState fileSystem get candidateDirectory conf writeIdList useFileIds ignoreEmptyFiles initDirCache dirCacheDuration String key writeIdList getTableName candidateDirectory toString DirInfoValue value dirCache getIfPresent key exceptions writeIdList getInvalidWriteIds recompute exceptions exceptions length recompute LOG info key dirCache invalidate key value value value writeIdList LOG
recompute LOG info key dirCache invalidate key value value value getTxnString writeIdList writeToString LOG LOG debug writeIdList writeToString value getTxnString key recompute recompute value Directory dirInfo getAcidState fileSystem get candidateDirectory conf writeIdList useFileIds ignoreEmptyFiles value DirInfoValue writeIdList writeToString dirInfo value dirInfo value dirInfo value dirInfo populateBaseFiles dirInfo useFileIds fileSystem
dirCache invalidate key value value value getTxnString writeIdList writeToString LOG LOG debug writeIdList writeToString value getTxnString key recompute recompute value Directory dirInfo getAcidState fileSystem get candidateDirectory conf writeIdList useFileIds ignoreEmptyFiles value DirInfoValue writeIdList writeToString dirInfo value dirInfo value dirInfo value dirInfo populateBaseFiles dirInfo useFileIds fileSystem dirCache put key value
FileStatus job dir IOException ArrayList FileStatus result ArrayList FileStatus List IOException errors ArrayList IOException FileSystem fs dir getFileSystem job FileStatus matches fs globStatus dir FileUtils HIDDEN_FILES_PATH_FILTER matches errors add IOException dir matches errors add IOException dir FileStatus globStat matches FileUtils listStatusRecursively fs globStat result errors InvalidInputException errors LOG debug dir result
finalDirs ArrayList dirsWithMmOriginals ArrayList processPathsForMmRead Lists newArrayList dir newjob mmIds finalDirs dirsWithMmOriginals finalDirs dirsWithMmOriginals dirsWithMmOriginals finalDir finalDirs FileStatus listStatus listStatus newjob finalDir FileStatus status listStatus numOrigSplits addBHISplit status inputFormat inputFormatClass numOrigSplits newjob result dirsWithMmOriginals originalsDir dirsWithMmOriginals FileSystem fs originalsDir getFileSystem job FileStatus listStatus fs listStatus dir FileUtils HIDDEN_FILES_PATH_FILTER FileStatus status listStatus status isDirectory
status LOG info status getBlockSize
String inputFormatClassName inputFormatClass getName InputFormat inputFormat getInputFormatFromCache inputFormatClass job String deserializerClassName deserializerClassName part getDeserializer job getClass getName FileSystem inpFs path getFileSystem job inputFormat splits getSplits job numSplits splits Path filterPath path CombineFilter f List Operator OperatorDesc opList opList HiveFileFormatUtils doGetWorksFromPath pathToAliases aliasToWork filterPath
deserializerClassName part getDeserializer job getClass getName FileSystem inpFs path getFileSystem job splits getSplits job numSplits splits Path filterPath path CombineFilter f List Operator OperatorDesc opList opList HiveFileFormatUtils doGetWorksFromPath pathToAliases aliasToWork filterPath CombinePathInputFormat combinePathInputFormat CombinePathInputFormat opList inputFormatClassName deserializerClassName f poolMap get combinePathInputFormat f f CombineFilter filterPath
init job ArrayList InputSplit result ArrayList InputSplit Path paths getInputPaths job List Path nonCombinablePaths ArrayList Path paths length List Path combinablePaths ArrayList Path paths length numThreads Math min MAX_CHECK_NONCOMBINABLE_THREAD_NUM Math ceil paths length DEFAULT_NUM_PATH_PER_THREAD numThreads Set Integer nonCombinablePathIndices getNonCombinablePathIndices job paths numThreads i i paths length i nonCombinablePathIndices i nonCombinablePaths add paths i combinablePaths add paths i
numThreads Math min MAX_CHECK_NONCOMBINABLE_THREAD_NUM Math ceil paths length DEFAULT_NUM_PATH_PER_THREAD numThreads Set Integer nonCombinablePathIndices getNonCombinablePathIndices job paths numThreads i i paths length i nonCombinablePathIndices i nonCombinablePaths add paths i combinablePaths add paths i e LOG error e perfLogger perfLogEnd CLASS_NAME PerfLogger GET_SPLITS IOException e String oldPaths job get org apache hadoop mapreduce lib input FileInputFormat INPUT_DIR LOG
String oldPaths job get org apache hadoop mapreduce lib input FileInputFormat INPUT_DIR LOG LOG debug oldPaths org apache hadoop mapreduce lib input FileInputFormat INPUT_DIR nonCombinablePaths size FileInputFormat setInputPaths job nonCombinablePaths toArray Path nonCombinablePaths size InputSplit splits getSplits job numSplits InputSplit split splits result add split combinablePaths size FileInputFormat setInputPaths job combinablePaths toArray Path combinablePaths size Map Path PartitionDesc pathToPartitionInfo pathToPartitionInfo pathToPartitionInfo Utilities getMapWork job getPathToPartitionInfo InputSplit splits getCombineSplits job numSplits pathToPartitionInfo InputSplit split splits result add split oldPaths
aliasToSplitList get alias add split retLists add split ArrayList CombineFileSplit entry aliasToSplitList ArrayList CombineFileSplit splitList entry getValue totalSize CombineFileSplit split splitList totalSize split getLength SplitSample splitSample nameToSamples get entry getKey targetSize splitSample getTargetSize totalSize startIndex splitSample getSeedNum splitList size size i i splitList size i CombineFileSplit split splitList get startIndex i splitList size retLists add split
PartitionDesc PartitionDesc part Map Map Path PartitionDesc Map Path PartitionDesc cache HashMap Path path PartitionDesc otherPart HiveFileFormatUtils getFromPathRecursively pathToPartInfo path cache
startPos isBlockPointer inputPath ioCxtRef getIOContext ioCxtRef setCurrentBlockStart startPos ioCxtRef setBlockPointer isBlockPointer ioCxtRef setInputPath inputPath
genericUDFClassName genericUDFClassName genericUDFClassName genericUDFClassName stopComparisons add Comparison GREATER genericUDFClassName stopComparisons add Comparison EQUAL stopComparisons add Comparison GREATER beginLinearSearch genericUDFClassName stopComparisons add Comparison GREATER beginLinearSearch genericUDFClassName genericUDFClassName
List FileStatus files List FileStatus files2 LinkedList files Iterator FileStatus iter files2 iterator iter FileStatus file iter next file file
inputFormat String ifName inputFormat getClass getCanonicalName isSupported inputFormat LlapWrappableInputFormatInterface isCacheOnly inputFormat LlapCacheOnlyInputFormatInterface isVectorized Utilities getIsVectorized conf isVectorized isVectorized HiveConf getBoolVar conf ConfVars LLAP_IO_NONVECTOR_WRAPPER_ENABLED Utilities getPlanPath conf isSerdeBased isVectorized isSupported HiveConf getBoolVar conf ConfVars isSupported isSerdeBased checkInputFormatForLlapEncode conf ifName isSupported isVectorized isCacheOnly LOG LOG info ifName isSupported isVectorized isCacheOnly inputFormat LOG
conf String String formatList HiveConf getVar conf ConfVars LLAP_IO_ENCODE_FORMATS
InputSplit split job IOException HiveInputSplit hsplit HiveInputSplit split InputSplit inputSplit hsplit getInputSplit String inputFormatClassName Class inputFormatClass inputFormatClassName hsplit inputFormatClassName inputFormatClass job getClassByName inputFormatClassName e IOException inputFormatClassName e pathToPartitionInfo init job nonNative PartitionDesc part HiveFileFormatUtils getFromPathRecursively pathToPartitionInfo hsplit getPath
Class InputFormat inputFormatClass part getInputFileFormatClass TableDesc table part getTableDesc TableScanOperator tableScan List String aliases mrwork getPathToAliases get dir aliases aliases Operator op mrwork getAliasToWork get aliases get op op TableScanOperator tableScan TableScanOperator op readColumnsBuffer setLength readColumnNamesBuffer setLength ColumnProjectionUtils appendReadColumns readColumnsBuffer readColumnNamesBuffer tableScan getNeededColumnIDs tableScan getNeededColumns pushDownProjection pushFilters newjob tableScan mrwork
op op TableScanOperator tableScan TableScanOperator op readColumnsBuffer setLength readColumnNamesBuffer setLength ColumnProjectionUtils appendReadColumns readColumnsBuffer readColumnNamesBuffer tableScan getNeededColumnIDs tableScan getNeededColumns pushDownProjection pushFilters newjob tableScan mrwork LOG LOG debug aliases mrwork getPathToAliases dir currentDirs tableScan currentDirs add dir currentDirs LOG
currentDirs inputFormatClass currentInputFormatClass table currentTable tableScan currentTableScan currentDirs add dir currentDirs LOG LOG info currentDirs pushProjection newjob readColumnsBuffer readColumnNamesBuffer addSplitsForGroup currentDirs currentTableScan newjob getInputFormatFromCache currentInputFormatClass job currentInputFormatClass currentDirs size numSplits dirs length currentTable result currentDirs clear currentDirs add dir currentTableScan tableScan currentTable table currentInputFormatClass inputFormatClass
currentDirs LOG LOG info currentDirs pushProjection newjob readColumnsBuffer readColumnNamesBuffer addSplitsForGroup currentDirs currentTableScan newjob getInputFormatFromCache currentInputFormatClass job currentInputFormatClass currentDirs size numSplits dirs length currentTable result currentDirs clear currentDirs add dir currentTableScan tableScan currentTable table currentInputFormatClass inputFormatClass pushProjection newjob readColumnsBuffer readColumnNamesBuffer dirs length LOG
newjob readColumnsBuffer readColumnNamesBuffer String readColIds readColumnsBuffer toString String readColNames readColumnNamesBuffer toString newjob setBoolean ColumnProjectionUtils READ_ALL_COLUMNS newjob set ColumnProjectionUtils READ_COLUMN_IDS_CONF_STR readColIds newjob set ColumnProjectionUtils READ_COLUMN_NAMES_CONF_STR readColNames
newjob readColumnsBuffer readColumnNamesBuffer String readColIds readColumnsBuffer toString String readColNames readColumnNamesBuffer toString newjob setBoolean ColumnProjectionUtils READ_ALL_COLUMNS newjob set ColumnProjectionUtils READ_COLUMN_IDS_CONF_STR readColIds newjob set ColumnProjectionUtils READ_COLUMN_NAMES_CONF_STR readColNames LOG LOG info ColumnProjectionUtils READ_COLUMN_IDS_CONF_STR readColIds
jobConf scanDesc scanDesc String serializedFilterObj scanDesc getSerializedFilterObject String serializedFilterExpr scanDesc getSerializedFilterExpr hasObj serializedFilterObj hasExpr serializedFilterExpr hasObj Serializable filterObject scanDesc getFilterObject filterObject serializedFilterObj SerializationUtilities serializeObject filterObject serializedFilterObj jobConf set TableScanDesc FILTER_OBJECT_CONF_STR serializedFilterObj hasExpr serializedFilterExpr SerializationUtilities serializeExpression filterExpr String filterText filterExpr getExprString
jc outPath isCompressed tableProperties progress FileSystem fs outPath getFileSystem jc OutputStream outStream Utilities createCompressedStream jc fs create outPath progress isCompressed r BytesWritable bw BytesWritable r recordLength bw getLength String rowLength tableProperties getProperty TeradataBinaryRecordReader TD_ROW_LENGTH TeradataBinaryRecordReader DEFAULT_TD_ROW_LENGTH toLowerCase
hasConsumed readExpectedBytes recordLengthBytes lengthExpected hasConsumed LOG info hasConsumed lengthExpected LOG error format lengthExpected hasConsumed LOG error format getFilePosition LOG error format pos LOG error format Hex encodeHexString recordLengthBytes EOFException recordLength EndianUtils readSwappedUnsignedShort recordLengthBytes pos lengthExpected lengthExpected recordLength hasConsumed readExpectedBytes valueByteArray lengthExpected hasConsumed lengthExpected
LOG info hasConsumed lengthExpected LOG error format lengthExpected hasConsumed LOG error format getFilePosition LOG error format pos LOG error format Hex encodeHexString recordLengthBytes EOFException recordLength EndianUtils readSwappedUnsignedShort recordLengthBytes pos lengthExpected lengthExpected recordLength hasConsumed readExpectedBytes valueByteArray lengthExpected hasConsumed lengthExpected LOG error format lengthExpected hasConsumed LOG error format getFilePosition
hasConsumed lengthExpected LOG error format lengthExpected hasConsumed LOG error format getFilePosition LOG error format pos LOG error format Hex encodeHexString recordLengthBytes EOFException recordLength EndianUtils readSwappedUnsignedShort recordLengthBytes pos lengthExpected lengthExpected recordLength hasConsumed readExpectedBytes valueByteArray lengthExpected hasConsumed lengthExpected LOG error format lengthExpected hasConsumed LOG error format getFilePosition LOG error format pos
EOFException recordLength EndianUtils readSwappedUnsignedShort recordLengthBytes pos lengthExpected lengthExpected recordLength hasConsumed readExpectedBytes valueByteArray lengthExpected hasConsumed lengthExpected LOG error format lengthExpected hasConsumed LOG error format getFilePosition LOG error format pos LOG error format Hex encodeHexString recordLengthBytes Hex encodeHexString valueByteArray EOFException value set valueByteArray recordLength pos lengthExpected lengthExpected endOfRecord length hasConsumed readExpectedBytes endOfRecord lengthExpected
recordLength EndianUtils readSwappedUnsignedShort recordLengthBytes pos lengthExpected lengthExpected recordLength hasConsumed readExpectedBytes valueByteArray lengthExpected hasConsumed lengthExpected LOG error format lengthExpected hasConsumed LOG error format getFilePosition LOG error format pos LOG error format Hex encodeHexString recordLengthBytes Hex encodeHexString valueByteArray EOFException value set valueByteArray recordLength pos lengthExpected lengthExpected endOfRecord length hasConsumed readExpectedBytes endOfRecord lengthExpected hasConsumed lengthExpected
pos lengthExpected lengthExpected recordLength hasConsumed readExpectedBytes valueByteArray lengthExpected hasConsumed lengthExpected LOG error format lengthExpected hasConsumed LOG error format getFilePosition LOG error format pos LOG error format Hex encodeHexString recordLengthBytes Hex encodeHexString valueByteArray EOFException value set valueByteArray recordLength pos lengthExpected lengthExpected endOfRecord length hasConsumed readExpectedBytes endOfRecord lengthExpected hasConsumed lengthExpected LOG error format lengthExpected hasConsumed
job job MapWork mapWork Utilities getMapWork job Path pathsAndParts mapWork Path partitionPath pathsAndParts getKey partitionPath
AvroSerdeUtils job MapWork mapWork Utilities getMapWork job Path pathsAndParts mapWork Path partitionPath pathsAndParts getKey split partitionPath LOG info partitionPath split Properties props pathsAndParts getValue getProperties props AvroTableProperties getPropName props AvroTableProperties getPropName AvroSerdeUtils determineSchemaOrThrowException job props LOG info split String s job get AvroTableProperties AVRO_SERDE_SCHEMA getPropName s LOG info
SplitInfos sarg fileMetadata conf OrcTail orcTail ReaderImpl extractFileTail fileMetadata OrcProto Footer footer orcTail getFooter stripeCount footer getStripesCount writerUsedProlepticGregorian footer hasCalendar footer getCalendar OrcProto CalendarKind PROLEPTIC_GREGORIAN OrcConf PROLEPTIC_GREGORIAN_DEFAULT getBoolean conf result OrcInputFormat pickStripesViaTranslatedSarg sarg orcTail getWriterVersion footer getTypesList orcTail getStripeStatistics writerUsedProlepticGregorian stripeCount SplitInfos Builder sb SplitInfos newBuilder List StripeInformation stripes orcTail getStripes isEliminated i i result i result result i isEliminated StripeInformation si stripes get i
sarg filterColumns stripeStats stripeCount evolution includeStripe stripeCount i i includeStripe i includeStripe i i stripeStats size isStripeSatisfyPredicate stripeStats get i sarg filterColumns evolution includeStripe i
List PredicateLeaf predLeaves sarg getLeaves TruthValue truthValues TruthValue predLeaves size pred pred truthValues pred filterColumns pred filterColumns pred truthValues pred TruthValue YES_NO_NULL ColumnStatistics stats stripeStatistics getColumnStatistics filterColumns pred stats stats truthValues pred TruthValue YES_NO_NULL PredicateLeaf leaf predLeaves get pred truthValues pred RecordReaderImpl evaluatePredicate stats leaf
columnNameProperty conf get IOConstants SCHEMA_EVOLUTION_COLUMNS columnTypeProperty conf get IOConstants SCHEMA_EVOLUTION_COLUMNS_TYPES haveSchemaEvolutionProperties columnNameProperty columnTypeProperty haveSchemaEvolutionProperties schemaEvolutionColumnNames Lists newArrayList columnNameProperty split schemaEvolutionColumnNames haveSchemaEvolutionProperties schemaEvolutionTypeDescrs typeDescriptionsFromHiveTypeProperty columnTypeProperty dataColumns schemaEvolutionTypeDescrs dataColumns schemaEvolutionColumnNames haveSchemaEvolutionProperties IllegalArgumentException ErrorMsg SCHEMA_REQUIRED_TO_READ_ACID_TABLES getErrorCodedMsg haveSchemaEvolutionProperties
columnNameProperty conf get serdeConstants LIST_COLUMNS columnTypeProperty conf get serdeConstants LIST_COLUMN_TYPES columnTypeProperty columnNameProperty schemaEvolutionColumnNames Lists newArrayList columnNameProperty split schemaEvolutionColumnNames schemaEvolutionTypeDescrs typeDescriptionsFromHiveTypeProperty columnTypeProperty dataColumns schemaEvolutionTypeDescrs dataColumns schemaEvolutionColumnNames virtualColumnClipNum columnNum schemaEvolutionColumnNames
List String columnNames List TypeInfo columnTypes String columnNameDelimiter props containsKey serdeConstants COLUMN_NAME_DELIMITER props getProperty serdeConstants COLUMN_NAME_DELIMITER String valueOf SerDeUtils COMMA columnNameProperty columnNames ArrayList String columnNames Arrays asList columnNameProperty split columnNameDelimiter columnTypeProperty columnTypes ArrayList TypeInfo columnTypes TypeInfoUtils getTypeInfosFromTypeString columnTypeProperty TypeDescription schema TypeDescription createStruct i i columnNames i schema addField columnNames get i OrcInputFormat convertTypeInfo columnTypes get i
key ReaderPair deltaPair ReaderPair oldPair readers put key deltaPair oldPair String error key deltaPair oldPair
close LOG LOG debug path fs delete path indexBuilder acidStats writer LOG LOG debug path indexBuilder acidStats writer close
LOG LOG debug path fs delete path indexBuilder acidStats writer LOG LOG debug path indexBuilder acidStats writer close LOG debug path OrcFile createWriter path writerOptions close
indexBuilder acidStats writer LOG LOG debug path indexBuilder acidStats writer close LOG debug path OrcFile createWriter path writerOptions close LOG debug path fs delete path
LOG LOG debug path indexBuilder acidStats writer close LOG debug path OrcFile createWriter path writerOptions close LOG debug path fs delete path LOG LOG debug path initWriter writer close
LOG debug path OrcFile createWriter path writerOptions close LOG debug path fs delete path LOG LOG debug path initWriter writer close LOG
LOG debug path OrcFile createWriter path writerOptions close LOG debug path fs delete path LOG LOG debug path initWriter writer close deleteEventWriter acidStats LOG LOG debug path indexBuilder acidStats deleteEventWriter close
b SearchArgumentFactory newBuilder b startAnd startNot lessThan OrcRecordUpdater ORIGINAL_WRITEID_FIELD_NAME PredicateLeaf Type LONG k getWriteId end b startNot lessThan OrcRecordUpdater BUCKET_FIELD_NAME PredicateLeaf Type LONG minBucketProp end b startNot lessThan OrcRecordUpdater ROW_ID_FIELD_NAME PredicateLeaf Type LONG minRowId end b end keyInterval getMaxKey RecordIdentifier k keyInterval getMaxKey b b SearchArgumentFactory newBuilder b startAnd lessThanEquals OrcRecordUpdater ORIGINAL_WRITEID_FIELD_NAME PredicateLeaf Type LONG k getWriteId b lessThanEquals OrcRecordUpdater BUCKET_FIELD_NAME PredicateLeaf Type LONG maxBucketProp b lessThanEquals OrcRecordUpdater ROW_ID_FIELD_NAME PredicateLeaf Type LONG maxRowId b end b deleteEventSarg b build
splitEnd orcSplit getStart orcSplit getLength minRowId syntheticProps getRowIdOffset maxRowId syntheticProps getRowIdOffset stripe stripe minRowId stripe getNumberOfRows splitEnd stripe maxRowId stripe getNumberOfRows RecordIdentifier minKey RecordIdentifier syntheticProps getSyntheticWriteId syntheticProps getBucketProperty minRowId RecordIdentifier maxKey RecordIdentifier syntheticProps getSyntheticWriteId syntheticProps getBucketProperty maxRowId maxRowId OrcRawRecordMerger KeyInterval keyIntervalTmp OrcRawRecordMerger KeyInterval minKey maxKey minRowId maxRowId LOG info
DiskRangeList MutateHelper DiskRangeList listToRead DiskRangeList MutateHelper toRead DiskRangeList MutateHelper listToRead
index stripe streams physicalFileIncludes sargColumns stripeOffset stripe getOffset DiskRangeList indexRanges planIndexReading fileSchema streams physicalFileIncludes sargColumns version index getBloomFilterKinds indexRanges
ColumnStreamData csd POOLS csdPool take endCOffset sctx offset sctx length DiskRangeList lastCached readEncodedStream stripeOffset iter sctx offset endCOffset csd endCOffset sctx offset toRelease lastCached iter lastCached traceLogBuffersUsedToParse csd CodedInputStream cis CodedInputStream newInstance IndexStream csd getCacheBuffers sctx length cis setSizeLimit InStream PROTOBUF_MESSAGE_MAX_LIMIT sctx tmp cis LOG trace tmp toString replace cis
DiskRangeList iter toRead next hasError colIx colIx colCtxs length colIx ReadContext ctx colCtxs colIx ctx streamIx streamIx ctx streamIx StreamContext sctx ctx streams streamIx DiskRangeList newIter preReadUncompressedStream stripeOffset iter sctx offset sctx offset sctx length sctx kind newIter iter newIter toRelease releaseBuffers toRelease keySet toRelease clear
toRelease releaseBuffers toRelease keySet toRelease clear LOG LOG debug fileKey stripeOffset RecordReaderUtils stringifyDiskRanges toRead next iter toRead next hasError hasError releaseInitialRefcounts toRead next toRelease releaseBuffers toRelease keySet toRelease clear
ix log event getFirstInt log ix event
ix logger info ix log ix getSecondInt log ix ix rgsLength log ix elements rgsLength rgsLength rgs rgsLength rgsOffset i i elements i val log ix i bitsInByte Math min rgsLength rgsOffset j j rgsOffset j val rgs rgsOffset j val rgsOffset bitsInByte
rgsOffset i i elements i val log ix i bitsInByte Math min rgsLength rgsOffset j j rgsOffset j val rgs rgsOffset j val rgsOffset bitsInByte logger info ix getSecondInt log ix DebugUtils toString rgs ix elements val getSecondInt log ix RangesSrc src RangesSrc values val MAX_ELEMENT_BITS rangeCount val MAX_ELEMENT_BITS currentOffset ix StringBuilder sb StringBuilder
val log ix i bitsInByte Math min rgsLength rgsOffset j j rgsOffset j val rgs rgsOffset j val rgsOffset bitsInByte logger info ix getSecondInt log ix DebugUtils toString rgs ix elements val getSecondInt log ix RangesSrc src RangesSrc values val MAX_ELEMENT_BITS rangeCount val MAX_ELEMENT_BITS currentOffset ix StringBuilder sb StringBuilder i i rangeCount i currentOffset sb append printRange currentOffset log append
rgsOffset bitsInByte logger info ix getSecondInt log ix DebugUtils toString rgs ix elements val getSecondInt log ix RangesSrc src RangesSrc values val MAX_ELEMENT_BITS rangeCount val MAX_ELEMENT_BITS currentOffset ix StringBuilder sb StringBuilder rangeCount currentOffset sb append printRange currentOffset log append logger info ix log ix log ix src sb toString ix rangeCount logger info ix getSecondInt log ix getFirstInt log ix ColumnEncoding Kind values getSecondInt log ix
ix elements val getSecondInt log ix RangesSrc src RangesSrc values val MAX_ELEMENT_BITS rangeCount val MAX_ELEMENT_BITS currentOffset ix StringBuilder sb StringBuilder rangeCount currentOffset sb append printRange currentOffset log append logger info ix log ix log ix src sb toString ix rangeCount logger info ix getSecondInt log ix getFirstInt log ix ColumnEncoding Kind values getSecondInt log ix ix
val getSecondInt log ix RangesSrc src RangesSrc values val MAX_ELEMENT_BITS rangeCount val MAX_ELEMENT_BITS currentOffset ix StringBuilder sb StringBuilder rangeCount currentOffset sb append printRange currentOffset log append logger info ix log ix log ix src sb toString ix rangeCount logger info ix getSecondInt log ix getFirstInt log ix ColumnEncoding Kind values getSecondInt log ix ix streamOffset log ix logger info ix getSecondInt log ix streamOffset streamOffset getFirstInt log ix Kind values getSecondInt log ix
currentOffset ix StringBuilder sb StringBuilder rangeCount currentOffset sb append printRange currentOffset log append logger info ix log ix log ix src sb toString ix rangeCount logger info ix getSecondInt log ix getFirstInt log ix ColumnEncoding Kind values getSecondInt log ix ix streamOffset log ix logger info ix getSecondInt log ix streamOffset streamOffset getFirstInt log ix Kind values getSecondInt log ix ix streamOffset log ix
sb append printRange currentOffset log append logger info ix log ix log ix src sb toString ix rangeCount logger info ix getSecondInt log ix getFirstInt log ix ColumnEncoding Kind values getSecondInt log ix ix streamOffset log ix logger info ix getSecondInt log ix streamOffset streamOffset getFirstInt log ix Kind values getSecondInt log ix ix streamOffset log ix logger info ix getSecondInt log ix streamOffset streamOffset getFirstInt log ix Kind values getSecondInt log ix getFirstInt log ix getSecondInt log ix ix
logger info ix getSecondInt log ix getFirstInt log ix ColumnEncoding Kind values getSecondInt log ix ix streamOffset log ix logger info ix getSecondInt log ix streamOffset streamOffset getFirstInt log ix Kind values getSecondInt log ix ix streamOffset log ix logger info ix getSecondInt log ix streamOffset streamOffset getFirstInt log ix Kind values getSecondInt log ix getFirstInt log ix getSecondInt log ix ix logger info ix getSecondInt log ix ix logger info ix getSecondInt log ix
streamOffset log ix logger info ix getSecondInt log ix streamOffset streamOffset getFirstInt log ix Kind values getSecondInt log ix ix streamOffset log ix logger info ix getSecondInt log ix streamOffset streamOffset getFirstInt log ix Kind values getSecondInt log ix getFirstInt log ix getSecondInt log ix ix logger info ix getSecondInt log ix ix logger info ix getSecondInt log ix ix
streamOffset log ix logger info ix getSecondInt log ix streamOffset streamOffset getFirstInt log ix Kind values getSecondInt log ix getFirstInt log ix getSecondInt log ix ix logger info ix getSecondInt log ix ix logger info ix getSecondInt log ix ix logger info ix Kind values getSecondInt log ix ix offset log ix
ix logger info ix getSecondInt log ix ix logger info ix getSecondInt log ix ix logger info ix Kind values getSecondInt log ix ix offset log ix unlockLen getFirstInt log ix String unlockStr unlockLen Integer MAX_VALUE offset unlockLen logger info ix Kind values getSecondInt log ix offset offset getSecondInt log ix unlockStr
logger info ix getSecondInt log ix ix logger info ix getSecondInt log ix ix logger info ix Kind values getSecondInt log ix ix offset log ix unlockLen getFirstInt log ix String unlockStr unlockLen Integer MAX_VALUE offset unlockLen logger info ix Kind values getSecondInt log ix offset offset getSecondInt log ix unlockStr ix
logger info ix getSecondInt log ix ix logger info ix Kind values getSecondInt log ix ix offset log ix unlockLen getFirstInt log ix String unlockStr unlockLen Integer MAX_VALUE offset unlockLen logger info ix Kind values getSecondInt log ix offset offset getSecondInt log ix unlockStr ix logger info ix Integer toHexString getSecondInt log ix ix
offset log ix unlockLen getFirstInt log ix String unlockStr unlockLen Integer MAX_VALUE offset unlockLen logger info ix Kind values getSecondInt log ix offset offset getSecondInt log ix unlockStr ix logger info ix Integer toHexString getSecondInt log ix ix offset log ix logger info ix offset offset getSecondInt log ix ix offset log ix
String unlockStr unlockLen Integer MAX_VALUE offset unlockLen logger info ix Kind values getSecondInt log ix offset offset getSecondInt log ix unlockStr ix logger info ix Integer toHexString getSecondInt log ix ix offset log ix logger info ix offset offset getSecondInt log ix ix offset log ix logger info ix offset offset getSecondInt log ix ix
logger info ix Integer toHexString getSecondInt log ix ix offset log ix logger info ix offset offset getSecondInt log ix ix offset log ix logger info ix offset offset getSecondInt log ix ix logger info ix getSecondInt log ix Integer toHexString log ix ix
ix offset log ix logger info ix offset offset getSecondInt log ix ix offset log ix logger info ix offset offset getSecondInt log ix ix logger info ix getSecondInt log ix Integer toHexString log ix ix logger info ix printRange ix log Integer toHexString getSecondInt log ix ix
page ValuesReader rlReader page getRlEncoding getValuesReader descriptor REPETITION_LEVEL ValuesReader dlReader page getDlEncoding getValuesReader descriptor DEFINITION_LEVEL repetitionLevelColumn ValuesReaderIntIterator rlReader definitionLevelColumn ValuesReaderIntIterator dlReader BytesInput bytes page getBytes
page ValuesReader rlReader page getRlEncoding getValuesReader descriptor REPETITION_LEVEL ValuesReader dlReader page getDlEncoding getValuesReader descriptor DEFINITION_LEVEL repetitionLevelColumn ValuesReaderIntIterator rlReader definitionLevelColumn ValuesReaderIntIterator dlReader BytesInput bytes page getBytes LOG debug bytes size pageValueCount ByteBufferInputStream in bytes toInputStream
page ValuesReader rlReader page getRlEncoding getValuesReader descriptor REPETITION_LEVEL ValuesReader dlReader page getDlEncoding getValuesReader descriptor DEFINITION_LEVEL repetitionLevelColumn ValuesReaderIntIterator rlReader definitionLevelColumn ValuesReaderIntIterator dlReader BytesInput bytes page getBytes LOG debug bytes size pageValueCount ByteBufferInputStream in bytes toInputStream LOG debug in position rlReader initFromPage pageValueCount in
page ValuesReader rlReader page getRlEncoding getValuesReader descriptor REPETITION_LEVEL ValuesReader dlReader page getDlEncoding getValuesReader descriptor DEFINITION_LEVEL repetitionLevelColumn ValuesReaderIntIterator rlReader definitionLevelColumn ValuesReaderIntIterator dlReader BytesInput bytes page getBytes LOG debug bytes size pageValueCount ByteBufferInputStream in bytes toInputStream LOG debug in position rlReader initFromPage pageValueCount in LOG debug in position dlReader initFromPage pageValueCount in
page pageValueCount page getValueCount repetitionLevelColumn newRLEIterator descriptor getMaxRepetitionLevel page getRepetitionLevels definitionLevelColumn newRLEIterator descriptor getMaxDefinitionLevel page getDefinitionLevels
cacheKey MemoryBufferOrBuffers footerData cacheKey metadataCache metadataCache getFileMetadata cacheKey footerData
ParquetFileReader readFooter ParquetFooterInputFromCache footerData filter metadataCache decRefBuffer footerData throwIfCacheOnlyRead isReadCacheOnly FileSystem fs file getFileSystem configuration FileStatus stat fs getFileStatus file metadataCache readFooterFromFile file fs stat filter stream fs file footerLengthIndex stat getLen ParquetFooterInputFromCache FOOTER_LENGTH_SIZE ParquetFileWriter MAGIC length stream seek footerLengthIndex footerLength BytesUtils readIntLittleEndian stream stream seek footerLengthIndex footerLength
job setBoolean MRJobConfig MAP_SPECULATIVE work getMinSplitSize HiveConf setLongVar job HiveConf ConfVars MAPREDMINSPLITSIZE work getMinSplitSize longValue work getInputformat HiveConf setVar job HiveConf ConfVars HIVEINPUTFORMAT work getInputformat String inpFormat HiveConf getVar job HiveConf ConfVars HIVEINPUTFORMAT LOG info inpFormat job setInputFormat JavaUtils loadClass inpFormat e RuntimeException e getMessage e Path outputPath work getOutputDir Path tempOutPath Utilities toTempPath outputPath FileSystem fs tempOutPath getFileSystem job
LOG debug LOCK_ACQUIRED_MSG aquired e Thread currentThread interrupt LOG LOG debug e failedToAquire LOG LOG debug WAIT_LOCK_ACQUIRE_MSG command
e Thread currentThread interrupt LOG LOG debug e failedToAquire LOG LOG debug WAIT_LOCK_ACQUIRE_MSG command LOG error ErrorMsg COMPILE_LOCK_TIMED_OUT getErrorCodedMsg command failedToAquire e Thread currentThread interrupt LOG
queryId Objects requireNonNull queryId nextSleep MAX_SLEEP Math max conf getTimeVar HiveConf ConfVars HIVE_LOCK_SLEEP_BETWEEN_RETRIES TimeUnit MILLISECONDS maxNumWaits Math max conf getIntVar HiveConf ConfVars HIVE_LOCK_NUMRETRIES
queryId Objects requireNonNull queryId nextSleep MAX_SLEEP Math max conf getTimeVar HiveConf ConfVars HIVE_LOCK_SLEEP_BETWEEN_RETRIES TimeUnit MILLISECONDS maxNumWaits Math max conf getIntVar HiveConf ConfVars HIVE_LOCK_NUMRETRIES LOG info queryId
lock lock queryId Objects requireNonNull queryId nextSleep MAX_SLEEP Math max conf getTimeVar HiveConf ConfVars HIVE_LOCK_SLEEP_BETWEEN_RETRIES TimeUnit MILLISECONDS maxNumWaits Math max conf getIntVar HiveConf ConfVars HIVE_LOCK_NUMRETRIES LOG info queryId LOG debug lock LockResponse res txnManager getMS lock lock
nextSleep MAX_SLEEP Math max conf getTimeVar HiveConf ConfVars HIVE_LOCK_SLEEP_BETWEEN_RETRIES TimeUnit MILLISECONDS maxNumWaits Math max conf getIntVar HiveConf ConfVars HIVE_LOCK_NUMRETRIES LOG info queryId LOG debug lock LockResponse res txnManager getMS lock lock LOG info queryId res res LockState WAITING LockState WAITING numRetries startRetry System currentTimeMillis res LockState WAITING numRetries maxNumWaits backoff
res txnManager getMS checkLock res getLockid retryDuration System currentTimeMillis startRetry DbHiveLock hl DbHiveLock res getLockid queryId lock getTxnid lock getComponent locks logMsg DbHiveLock locks hl logMsg queryId hl queryId logMsg logMsg LOG warn hl locks
LOG warn hl locks locks add hl res LOG error res getLockid numRetries retryDuration queryId res res unlock hl LockException le LockException ErrorMsg LOCK_ACQUIRE_TIMEDOUT lock toString Long toString retryDuration res toString showLocksNewFormat le getMessage le LockException ErrorMsg LOCK_CANNOT_BE_ACQUIRED getMsg res acquiredLocks add hl Metrics metrics MetricsFactory getInstance metrics
locks add hl res LOG error res getLockid numRetries retryDuration queryId res res unlock hl LockException le LockException ErrorMsg LOCK_ACQUIRE_TIMEDOUT lock toString Long toString retryDuration res toString showLocksNewFormat le getMessage le LockException ErrorMsg LOCK_CANNOT_BE_ACQUIRED getMsg res acquiredLocks add hl Metrics metrics MetricsFactory getInstance metrics metrics incrementCounter MetricsConstant METASTORE_HIVE_LOCKS
ShowLocksResponse rsp getLocks ByteArrayOutputStream baos ByteArrayOutputStream DataOutputStream os DataOutputStream baos ShowLocksOperation dumpLockInfo os rsp os flush
hiveLock lockId DbHiveLock hiveLock lockId removed
lockId DbHiveLock hiveLock lockId removed LOG debug hiveLock txnManager getMS unlock lockId removed locks remove hiveLock Metrics metrics MetricsFactory getInstance metrics metrics decrementCounter MetricsConstant METASTORE_HIVE_LOCKS e LOG warn e LOG debug removed e removed locks remove hiveLock
metrics decrementCounter MetricsConstant METASTORE_HIVE_LOCKS e LOG warn e LOG debug removed e removed locks remove hiveLock LOG error JavaUtils lockIdToString lockId LockException e ErrorMsg LOCK_NO_SUCH_LOCK JavaUtils lockIdToString lockId e RuntimeException JavaUtils lockIdToString lockId e getMessage e e LockException ErrorMsg METASTORE_COMMUNICATION_FAILED getMsg e removed
getLockManager verifyState plan queryId plan getQueryId plan getOperation LockRequestBuilder rqstBuilder LockRequestBuilder queryId LOG info JavaUtils txnIdToString txnId queryId rqstBuilder setTransactionId txnId setUser username rqstBuilder setZeroWaitReadEnabled conf getBoolVar HiveConf ConfVars TXN_OVERWRITE_X_LOCK conf getBoolVar HiveConf ConfVars TXN_WRITE_X_LOCK plan getInputs plan getOutputs LOG debug queryId List LockComponent lockComponents AcidUtils makeLockComponents plan getOutputs plan getInputs ctx getOperation conf lockComponents addAll getGlobalLocks ctx getConf lockComponents
LockComponent conf String lockNames conf get Constants HIVE_QUERY_EXCLUSIVE_LOCK lockNames Collections emptyList List LockComponent globalLocks ArrayList LockComponent String lockName lockNames lockName lockName trim lockName LockComponentBuilder compBuilder LockComponentBuilder compBuilder setExclusive compBuilder setOperationType DataOperationType UPDATE compBuilder setDbName GLOBAL_LOCKS compBuilder setTableName lockName globalLocks add compBuilder build
locks lockMgr getLocks LOG StringBuilder sb StringBuilder append JavaUtils txnIdToString txnId append lock locks sb append append lock toString LOG info sb toString locks LOG LOG debug lock locks lockId DbLockManager DbHiveLock lock lockId getMS heartbeat txnId lockId
LOG StringBuilder sb StringBuilder append JavaUtils txnIdToString txnId append lock sb append append lock toString LOG info sb toString LOG LOG debug lock lockId DbLockManager DbHiveLock lock lockId getMS heartbeat txnId lockId LOG error JavaUtils lockIdToString lockId
heartbeatTask heartbeatTask cancel startTime System currentTimeMillis sleepInterval heartbeatTask heartbeatTask now System currentTimeMillis now startTime LOG warn queryId Thread sleep sleepInterval sleepInterval
List HiveLockObj lockObjects ArrayList HiveLockObj input plan input LOG debug input getName input lockObjects addAll getLockObjects plan input getDatabase HiveLockMode SHARED input lockObjects addAll getLockObjects plan input getTable HiveLockMode SHARED lockObjects addAll getLockObjects plan input getPartition HiveLockMode SHARED output plan HiveLockMode lockMode getWriteEntityLockMode output lockMode
sharedClient sharedClient close sharedClient String shutdownMsg
ctx ctx ctx HiveConf conf ctx getConf sleepTime conf getTimeVar HiveConf ConfVars HIVE_LOCK_SLEEP_BETWEEN_RETRIES TimeUnit MILLISECONDS numRetriesForLock conf getIntVar HiveConf ConfVars HIVE_LOCK_NUMRETRIES numRetriesForUnLock conf getIntVar HiveConf ConfVars HIVE_UNLOCK_NUMRETRIES curatorFramework CuratorFrameworkSingleton getInstance conf parent conf getVar HiveConf ConfVars HIVE_ZOOKEEPER_NAMESPACE curatorFramework create withMode CreateMode PERSISTENT forPath parent e e e LOG warn parent e e
Thread sleep sleepTime prepareRetry ret lockPrimitive key mode keepAlive parentCreated conflictingLocks ret e1 lastException e1 e1 KeeperException KeeperException e KeeperException e1 e e e
e1 lastException e1 e1 KeeperException KeeperException e KeeperException e1 e LOG e LOG error e LOG error e1 tryNum numRetriesForLock console printError key getData getLockMode mode key getDisplayName tryNum printConflictingLocks key mode conflictingLocks
key HiveLockObjectData requestedLock HiveLockObjectData key getData toString
key mode HiveLockObjectData requestedLock HiveLockObjectData key getData toString LOG debug key getDisplayName requestedLock getLockMode mode requestedLock getQueryStr conflictingLock HiveLockObjectData conflictingLockData HiveLockObjectData conflictingLock
curatorFramework delete forPath name curatorFramework delete forPath name Metrics metrics MetricsFactory getInstance metrics metrics metrics metrics
curatorFramework delete forPath name Metrics metrics MetricsFactory getInstance metrics metrics metrics metrics e LOG warn e
curChild locks children curatorFramework getChildren forPath curChild child children childn add curChild child HiveLockMode mode getLockMode curChild mode HiveLockObjectData data HiveLockObject obj getLockObject conf curChild mode data parent verifyTablePartition obj
tab names HiveLockObject tab data Map String String partSpec HashMap String String indx indx names indx String partVals names indx split partSpec put partVals partVals Partition partn partn db getPartition tab partSpec partn partn HiveLockObject DummyPartition tab path partSpec data
Timestamp fileLowerBound getTimeStampFromPath fileStatus fileLowerBound Timestamp fileUpperBound Timestamp from fileLowerBound toInstant plusSeconds timeSliceSeconds Location predLowerLocation Location predUpperLocation predLowerLocation compareToRange predLowerBound fileLowerBound fileUpperBound selected predLowerLocation Location predLowerLocation Location predUpperLocation compareToRange predUpperBound fileLowerBound fileUpperBound predUpperLocation Location predUpperLocation Location selectedFiles add fileStatus selected predUpperLocation Location selectedFiles add fileStatus
Location predUpperLocation predLowerLocation compareToRange predLowerBound fileLowerBound fileUpperBound selected predLowerLocation Location predLowerLocation Location predUpperLocation compareToRange predUpperBound fileLowerBound fileUpperBound predUpperLocation Location predUpperLocation Location selectedFiles add fileStatus selected predUpperLocation Location selectedFiles add fileStatus selected predLowerLocation Location selectedFiles add fileStatus
genericSplit genericSplit FileSplit Path finalPath FileSplit genericSplit getPath
HashSet String registryFunctions HashSet String FunctionRegistry getFunctionNames function String functionName function getFunctionName
Hive Hive db hiveDB get db db db db
List RelOptMaterialization result ArrayList RelOptMaterialization materialization RelNode viewScan materialization tableRel Table materializedViewTable viewScan materializedViewTable RelOptHiveTable viewScan getInput getTable getHiveTableMD materializedViewTable RelOptHiveTable viewScan getTable getHiveTableMD Boolean outdated HiveMaterializedViewUtils isOutdatedMaterializedView materializedViewTable currentTxnWriteIds defaultTimeWindow tablesUsed outdated CreationMetadata creationMetadata materializedViewTable getCreationMetadata outdated
materializedViewTable Boolean outdated HiveMaterializedViewUtils isOutdatedMaterializedView materializedViewTable currentTxnWriteIds defaultTimeWindow tablesUsed forceMVContentsUpToDate outdated CreationMetadata creationMetadata materializedViewTable getCreationMetadata outdated ignore forceMVContentsUpToDate ignore forceMVContentsUpToDate ignore Materialization invalidationInfo getMSC getMaterializationInvalidationInfo creationMetadata conf get ValidTxnList VALID_TXNS_KEY ignore invalidationInfo invalidationInfo isSourceTablesUpdateDeleteModified ignore
Materialization invalidationInfo getMSC getMaterializationInvalidationInfo creationMetadata conf get ValidTxnList VALID_TXNS_KEY ignore invalidationInfo invalidationInfo isSourceTablesUpdateDeleteModified ignore LOG debug materializedViewTable getFullyQualifiedName RelOptMaterialization materialization HiveMaterializedViewsRegistry get getRewritingMaterializedView materializedViewTable getDbName materializedViewTable getTableName materialization Table cachedMaterializedViewTable HiveMaterializedViewUtils extractTable materialization cachedMaterializedViewTable materializedViewTable materialization HiveMaterializedViewUtils augmentMaterializationWithTimeInformation materialization validTxnsList ValidTxnWriteIdList creationMetadata getValidTxnList result addAll HiveMaterializedViewUtils deriveGroupingSetsMaterializedViews materialization
Partition oldPart getPartition tbl partSpec isTxnTable AcidUtils isTransactionalTable tbl List Path newFiles Collections synchronizedList ArrayList Partition newTPart loadPartitionInternal loadPath tbl partSpec oldPart loadFileType inheritTableSpecs inheritLocation isSkewedStoreAsSubdir isSrcLocal isAcidIUDoperation resetStatistics writeId stmtId isInsertOverwrite isTxnTable newFiles isDirectInsert AcidUtils TableSnapshot tableSnapshot isTxnTable getTableSnapshot tbl writeId tableSnapshot newTPart getTPartition setWriteId tableSnapshot getWriteId oldPart addPartitionToMetastore newTPart resetStatistics tbl tableSnapshot isTxnTable newFiles addWriteNotificationLog tbl partSpec newFiles writeId setStatsPropAndAlterPartition resetStatistics tbl newTPart tableSnapshot
getSynchronizedMSC add_partition newTPart getTPartition LOG debug setStatsPropAndAlterPartition resetStatistics tbl newTPart tableSnapshot e LOG error StringUtils stringifyException e HiveException e e FileSystem newPathFileSystem newTPart getPartitionPath getFileSystem getConf isSkipTrash MetaStoreUtils isSkipTrash tbl getParameters FileStatus status newPathFileSystem getFileStatus newTPart getPartitionPath Hive trashFiles newPathFileSystem FileStatus status getConf isSkipTrash
LOG debug setStatsPropAndAlterPartition resetStatistics tbl newTPart tableSnapshot e LOG error StringUtils stringifyException e HiveException e e FileSystem newPathFileSystem newTPart getPartitionPath getFileSystem getConf isSkipTrash MetaStoreUtils isSkipTrash tbl getParameters FileStatus status newPathFileSystem getFileStatus newTPart getPartitionPath Hive trashFiles newPathFileSystem FileStatus status getConf isSkipTrash io LOG error io
acidDir srcFs FileStatus acidFiles acidFiles srcFs listStatus acidDir acidFiles
partitionDetailsMap put partPath details PartitionIterable partitionIterable PartitionIterable Hive get tbl partSpec conf getInt MetastoreConf ConfVars BATCH_RETRIEVE_MAX getVarname Iterator Partition iterator partitionIterable iterator iterator Partition partition iterator next partitionDetailsMap entry entry getValue partition entry entry getValue partition partition entry getValue hasOldPartition isTxnTable AcidUtils isTransactionalTable tbl AcidUtils TableSnapshot tableSnapshot isTxnTable getTableSnapshot tbl writeId PartitionDetails entry partitionDetailsMap PartitionDetails partitionDetails entry getValue
PartitionDetails partitionDetails entry getValue Map String String fullPartSpec partitionDetails fullSpec SessionState setCurrentSessionState parentSession LOG info entry getKey fullPartSpec List Path newFiles Lists newArrayList Partition oldPartition partitionDetails partition Partition partition loadPartitionInternal entry getKey tbl fullPartSpec oldPartition loadFileType numLB isAcid resetStatistics writeId stmtId isInsertOverwrite isTxnTable newFiles isDirectInsert tableSnapshot partition getTPartition setWriteId tableSnapshot getWriteId partitionDetails tableSnapshot tableSnapshot oldPartition partitionDetails newFiles newFiles partitionDetails partition partition
partition e LOG error entry getKey tbl getTableName fullPartSpec loadFileType toString numLB isAcid resetStatistics e e poolSize conf getInt ConfVars HIVE_LOAD_DYNAMIC_PARTITIONS_THREAD_COUNT varname ExecutorService executor Executors newFixedThreadPool poolSize ThreadFactoryBuilder setDaemon setNameFormat build List Future Partition futures Lists newLinkedList Map Map String String Partition result Maps newLinkedHashMap futures executor invokeAll tasks LOG debug futures size Future Partition future futures Partition partition future get result put partition getSpec partition
poolSize conf getInt ConfVars HIVE_LOAD_DYNAMIC_PARTITIONS_THREAD_COUNT varname ExecutorService executor Executors newFixedThreadPool poolSize ThreadFactoryBuilder setDaemon setNameFormat build List Future Partition futures Lists newLinkedList Map Map String String Partition result Maps newLinkedHashMap futures executor invokeAll tasks LOG debug futures size Future Partition future futures Partition partition future get result put partition getSpec partition addPartitionsToMetastore partitionDetailsMap entrySet stream filter entry entry getValue hasOldPartition map entry entry getValue partition collect Collectors toList resetStatistics tbl partitionDetailsMap entrySet stream filter entry entry getValue hasOldPartition map entry entry getValue tableSnapshot collect Collectors toList PartitionDetails entry partitionDetailsMap entrySet PartitionDetails partitionDetails entry getValue partitionDetails newFiles addWriteNotificationLog tbl partitionDetails fullSpec partitionDetails newFiles writeId
Partition future Partition partition future get result put partition getSpec partition addPartitionsToMetastore partitionDetailsMap entrySet stream filter entry entry getValue hasOldPartition map entry entry getValue partition collect Collectors toList resetStatistics tbl partitionDetailsMap entrySet stream filter entry entry getValue hasOldPartition map entry entry getValue tableSnapshot collect Collectors toList PartitionDetails entry partitionDetailsMap entrySet PartitionDetails partitionDetails entry getValue partitionDetails newFiles addWriteNotificationLog tbl partitionDetails fullSpec partitionDetails newFiles writeId setStatsPropAndAlterPartitions resetStatistics tbl partitionDetailsMap entrySet stream filter entry entry getValue hasOldPartition map entry entry getValue partition collect Collectors toList tableSnapshot e HiveException validPartitions size tbl getTableName loadPath e e LOG error StringUtils stringifyException e HiveException e e
Partition tbl String String partSpec String HiveException tbl validatePartColumnNames partSpec List String pvals ArrayList String field tbl String val partSpec get field getName val val val HiveException field getName val pvals add val org apache hadoop hive metastore api Partition tpart tpart getSynchronizedMSC getPartitionWithAuthInfo tbl getDbName tbl getTableName pvals getUserName getGroupNames tpart
val val val HiveException field getName val pvals add val org apache hadoop hive metastore api Partition tpart tpart getSynchronizedMSC getPartitionWithAuthInfo tbl getDbName tbl getTableName pvals getUserName getGroupNames tpart e LOG error StringUtils stringifyException e HiveException e tpart
tpart getSynchronizedMSC appendPartition tbl getDbName tbl getTableName pvals LOG debug tpart getSynchronizedMSC getPartitionWithAuthInfo tbl getDbName tbl getTableName pvals getUserName getGroupNames alterPartitionSpec tbl partSpec tpart inheritTableSpecs partPath e e LOG debug tpart getSynchronizedMSC getPartitionWithAuthInfo tbl getDbName tbl getTableName pvals getUserName getGroupNames tpart e alterPartitionSpec tbl partSpec tpart inheritTableSpecs partPath e
LOG debug
GetPartitionNamesPsRequest req GetPartitionNamesPsRequest req setTblName tblName req setDbName dbName req setPartValues pvals req setMaxParts max t ValidWriteIdList validWriteIdList getValidWriteIdList dbName tblName req setValidWriteIdList validWriteIdList validWriteIdList toString req setId t getTTable getId GetPartitionNamesPsResponse res getMSC listPartitionNamesRequest req names res getNames Lists newArrayList
List org apache hadoop hive metastore api Partition tParts GetPartitionsPsWithAuthRequest req GetPartitionsPsWithAuthRequest req setTblName tbl getTableName req setDbName tbl getDbName req setUserName getUserName req setMaxParts req setGroupNames getGroupNames tbl ValidWriteIdList validWriteIdList getValidWriteIdList tbl getDbName tbl getTableName req setValidWriteIdList validWriteIdList validWriteIdList toString req setId tbl getTTable getId GetPartitionsPsWithAuthResponse res getMSC listPartitionsWithAuthInfoRequest req tParts res getPartitions
srcf LOG debug String fullF1 getQualifiedPathWithoutSchemeAndAuthority srcf srcFs toString Path SEPARATOR String fullF2 getQualifiedPathWithoutSchemeAndAuthority destf destFs toString Path SEPARATOR isInTest HiveConf getBoolVar srcFs getConf ConfVars HIVE_IN_TEST LOG debug fullF1 fullF2 isInTest fullF1 startsWith fullF2 String schemaSrcf srcf toUri getScheme String schemaDestf destf toUri getScheme schemaDestf LOG debug schemaSrcf schemaDestf schemaSrcf schemaDestf
name getPathName taskId String type FilenameUtils getExtension sourcePath getName Path destFilePath Path destDirPath taskId fullname name counter destFs destFilePath counter destFs delete destFilePath destFilePath Path destDirPath name Utilities COPY_KEYWORD counter taskId type isEmpty type destFs rename sourcePath destFilePath destFs copyFromLocalFile sourcePath destFilePath sourcePath destFs destFilePath
destFs destFile destFs delete destFile
e LOG error e HiveException e getMessage e srcFs srcf getFileSystem conf e LOG error e HiveException e getMessage e String configuredOwner HiveConf getVar conf ConfVars HIVE_LOAD_DATA_OWNER srcIsSubDirOfDest isSubDir srcf destf srcFs destFs isSrcLocal destIsSubDirOfSrc isSubDir destf srcf destFs srcFs String msg srcf destf srcIsSubDirOfDest
LOG error e HiveException e getMessage e String configuredOwner HiveConf getVar conf ConfVars HIVE_LOAD_DATA_OWNER srcIsSubDirOfDest isSubDir srcf destf srcFs destFs isSrcLocal destIsSubDirOfSrc isSubDir destf srcf destFs srcFs String msg srcf destf srcIsSubDirOfDest destFs delete destf LOG debug destf toString SessionState parentSession SessionState get isSrcLocal destFs copyFromLocalFile srcf destf
HiveException e HiveException he e HiveException he HiveException e he he
conf srcf destf FileSystem fs HiveException fs destf FileUtils mkdir fs destf conf e HiveException e FileStatus srcs FileSystem srcFs srcFs srcf getFileSystem conf srcs srcFs globStatus srcf e LOG error StringUtils stringifyException e HiveException e getMessage e srcs
Path Path Set Path createdDeltaDirs HashSet Path stat Path srcPath stat getPath
Set Path createdDeltaDirs HashSet Path FileStatus stat Path srcPath stat getPath LOG debug srcPath FileStatus origBucketStats origBucketStats fs listStatus srcPath AcidUtils originalBucketFilter origBucketStats origBucketStats FileStatus unionSubdirs fs globStatus Path srcPath AbstractFileMergeOperator UNION_SUDBIR_PREFIX List FileStatus buckets ArrayList FileStatus unionSubdir unionSubdirs Collections addAll buckets fs listStatus unionSubdir getPath AcidUtils originalBucketFilter origBucketStats buckets toArray FileStatus buckets size String msg srcPath toUri toString
e HiveException deltaFileType origBucketPath toUri toString e LOG debug deltaStats length deltaFileType deltaStat deltaStats Path deltaPath deltaStat getPath Path deltaDest Path dst deltaPath getName createdDeltaDirs deltaDest fs deltaDest fs rename AcidUtils OrcAcidVersion getVersionFilePath deltaStat getPath AcidUtils OrcAcidVersion getVersionFilePath deltaDest createdDeltaDirs add deltaDest
cache conf get HiveConf ConfVars HIVE_SERVER2_MATERIALIZED_VIEWS_REGISTRY_IMPL varname equals cache materializedViewTable LOG debug materializedViewTable getCompleteName ConcurrentMap String RelOptMaterialization dbMap ConcurrentHashMap String RelOptMaterialization ConcurrentMap String RelOptMaterialization prevDbMap materializedViews putIfAbsent materializedViewTable getDbName dbMap prevDbMap dbMap prevDbMap RelOptMaterialization materialization createMaterialization conf materializedViewTable materialization dbMap put materializedViewTable getTableName materialization LOG
ConcurrentMap String RelOptMaterialization dbMap ConcurrentHashMap String RelOptMaterialization ConcurrentMap String RelOptMaterialization prevDbMap materializedViews putIfAbsent materializedViewTable getDbName dbMap prevDbMap dbMap prevDbMap RelOptMaterialization newMaterialization createMaterialization conf materializedViewTable newMaterialization dbMap materializedViewTable String RelOptMaterialization RelOptMaterialization RelOptMaterialization String RelOptMaterialization existingMaterialization existingMaterialization newMaterialization Table existingMaterializedViewTable HiveMaterializedViewUtils extractTable existingMaterialization existingMaterializedViewTable newMaterialization existingMaterialization
String Class String ret String hadoopJarFinder Class jarFinder
String Class String ret String hadoopJarFinder Class jarFinder log debug hadoopJarFinder jarFinder JavaUtils loadClass hadoopJarFinder
err MetaException metaException MetaException table getTableName metaException initCause err metaException Map String Table tables getTempTablesForDatabase dbName tableName tables tables tableName MetaException StatsUtils getFullyQualifiedTableName dbName tableName removePartitionedTempTable table table ifPurge envContext ifPurge Boolean parseBoolean envContext getProperties get getWh deleteDir tablePath ifPurge err
SessionState ss SessionState get ss
SessionState ss SessionState get ss
reduce ReduceSinkDesc reduceConf reduce getConf Map String ExprNodeDesc oldMap reduce getColumnExprMap
colInfo oldRS getColumnInfo outputCol colInfo outputColExpr oldMap remove outputCol signature remove colInfo newValueColNames add outputCol newValueExprs add outputColExpr oldRS setSignature signature reduce getSchema setSignature signature reduceConf setOutputValueColumnNames newValueColNames reduceConf setValueCols newValueExprs TableDesc newValueTable PlanUtils getReduceValueTableDesc PlanUtils getFieldSchemasFromColumnList reduceConf getValueCols newValueColNames reduceConf setValueSerializeInfo newValueTable
ctx op List ColumnPrunerProcCtx cppCtx ColumnPrunerProcCtx ctx List Operator OperatorDesc childOperators op getChildOperators
List ExprNodeDesc valueCols conf getExprs get Byte valueOf pos StringBuilder keyOrder StringBuilder valueCols keyOrder append TableDesc valueTableDesc PlanUtils getMapJoinValueTableDesc PlanUtils getFieldSchemasFromColumnList valueCols valueTableDescs add valueTableDesc MapJoinDesc conf setValueTblDescs valueTableDescs Set Map Entry Byte List ExprNodeDesc exprs MapJoinDesc conf getKeys entrySet Iterator Map Entry Byte List ExprNodeDesc iters exprs iterator iters Map Entry Byte List ExprNodeDesc entry iters next List ExprNodeDesc lists entry getValue j j lists j ExprNodeDesc desc lists get j Byte tag entry getKey
constants List Map Integer ExprNodeDesc parentsToConstant ArrayList areAllParentsContainConstant noParentsContainConstant parent Map ColumnInfo ExprNodeDesc constMap opToConstantExprs get parent constMap LOG debug parent getOperatorId areAllParentsContainConstant noParentsContainConstant Map Integer ExprNodeDesc map HashMap ColumnInfo ExprNodeDesc entry constMap map put parent getSchema getPosition entry getKey getInternalName entry getValue
op JoinOperator JoinOperator joinOp JoinOperator op Iterator Entry Byte List ExprNodeDesc itr joinOp getConf getExprs entrySet iterator itr Entry Byte List ExprNodeDesc e itr next tag e getKey Operator parent op getParentOperators get tag List ExprNodeDesc exprs e getValue exprs ExprNodeDesc expr exprs expr ExprNodeColumnDesc String parentColName ExprNodeColumnDesc expr getColumn parentPos parent getSchema getPosition parentColName get tag parentPos
ti PrimitiveTypeInfo desc getTypeInfo PrimitiveTypeInfo PrimitiveTypeInfo priti PrimitiveTypeInfo ti PrimitiveTypeInfo descti PrimitiveTypeInfo desc getTypeInfo contains priti getPrimitiveCategory contains descti getPrimitiveCategory LOG LOG debug priti descti brokenDataTypesCombination unsafeConversionTypes contains priti getPrimitiveCategory unsafeConversionTypes contains descti getPrimitiveCategory priti getPrimitiveCategory PrimitiveCategory TIMESTAMP descti getPrimitiveCategory PrimitiveCategory DATE brokenDataTypesCombination LOG LOG debug priti descti LOG
desc ExprNodeGenericFuncDesc ExprNodeGenericFuncDesc funcDesc ExprNodeGenericFuncDesc desc GenericUDF udf funcDesc getGenericUDF propagateNext propagate propagatableUdfs contains udf getClass List ExprNodeDesc newExprs ArrayList ExprNodeDesc ExprNodeDesc childExpr desc newExprs add foldExpr childExpr constants cppCtx op tag propagateNext udf newExprs LOG LOG debug udf getClass ExprNodeGenericFuncDesc desc setChildren newExprs desc ExprNodeDesc shortcut shortcutFunction udf newExprs op shortcut LOG
ExprNodeGenericFuncDesc funcDesc ExprNodeGenericFuncDesc desc GenericUDF udf funcDesc getGenericUDF propagateNext propagate propagatableUdfs contains udf getClass List ExprNodeDesc newExprs ArrayList ExprNodeDesc ExprNodeDesc childExpr desc getChildren newExprs add foldExpr childExpr constants cppCtx op tag propagateNext udf newExprs LOG LOG debug udf getClass ExprNodeGenericFuncDesc desc setChildren newExprs desc ExprNodeDesc constant evaluateFunction udf newExprs desc getChildren constant LOG
udf newExprs LOG LOG debug udf getClass ExprNodeGenericFuncDesc desc setChildren newExprs desc ExprNodeDesc constant evaluateFunction udf newExprs desc getChildren constant LOG LOG debug desc constant constant ExprNodeDesc shortcut shortcutFunction udf newExprs op shortcut LOG
constant ExprNodeDesc shortcut shortcutFunction udf newExprs op shortcut LOG LOG debug desc shortcut shortcut ExprNodeGenericFuncDesc desc setChildren newExprs propagate propagate udf newExprs op getSchema constants desc desc op getParentOperators op getParentOperators desc Operator Serializable parent op getParentOperators get tag
udf udf udf String files String jars udf GenericUDFBridge GenericUDFBridge bridge GenericUDFBridge udf String udfClassName bridge getUdfClassName UDF udfInternal UDF Class forName bridge getUdfClassName Utilities getSessionSpecifiedClassLoader newInstance files udfInternal getRequiredFiles jars udfInternal getRequiredJars
lOperand ExprNodeColumnDesc c ExprNodeColumnDesc lOperand rOperand ExprNodeColumnDesc c ExprNodeColumnDesc rOperand ColumnInfo ci resolveColumn rs c ci LOG LOG debug udf getDisplayString String lOperand getExprString rOperand getExprString v ci getType v typeCast v ci getType v constants put ci v udf
desc parent RowSchema rs parent getSchema ColumnInfo ci rs getColumnInfo desc getColumn ci
ObjectInspector oi udf initialize argois Object o udf evaluate arguments LOG LOG debug udf getClass getName exprs o o ExprNodeConstantDesc TypeInfoUtils getTypeInfoFromObjectInspector oi o Class clz o getClass clz PrimitiveObjectInspector poi PrimitiveObjectInspector oi TypeInfo typeInfo poi getTypeInfo o poi getPrimitiveJavaObject o typeInfo typeInfo typeInfo typeInfo
LOG debug udf getClass getName exprs o o ExprNodeConstantDesc TypeInfoUtils getTypeInfoFromObjectInspector oi o Class clz o getClass clz PrimitiveObjectInspector poi PrimitiveObjectInspector oi TypeInfo typeInfo poi getTypeInfo o poi getPrimitiveJavaObject o typeInfo typeInfo typeInfo typeInfo ExprNodeConstantDesc typeInfo o udf oi ConstantObjectInspector coi ConstantObjectInspector oi TypeInfo structType TypeInfoUtils getTypeInfoFromObjectInspector coi ExprNodeConstantDesc structType ObjectInspectorUtils copyToStandardJavaObject o coi clz
op cppCtx RowSchema schema op getSchema Map ColumnInfo ExprNodeDesc constants cppCtx getOpToConstantExprs get op schema schema ColumnInfo col schema ExprNodeDesc constant constants get col constant
hashMapDataStructure HashMapDataStructureType of joinOp getConf TezBucketJoinProcCtx tezBucketJoinProcCtx TezBucketJoinProcCtx context conf hiveConvertJoin context conf getBoolVar HiveConf ConfVars HIVECONVERTJOIN context parseContext getDisableMapJoin hiveConvertJoin Object retval checkAndConvertSMBJoin context joinOp tezBucketJoinProcCtx retval retval fallbackToReduceSideJoin joinOp context numBuckets context conf getBoolVar HiveConf ConfVars numBuckets estimateNumBuckets joinOp numBuckets
numExecutorsPerNode llapInfo numExecutorsPerNode llapInfo getNumExecutorsPerNode numExecutorsPerNode numExecutorsPerNode context conf getIntVar ConfVars LLAP_DAEMON_NUM_EXECUTORS numNodes llapInfo getKnownExecutorCount numExecutorsPerNode LOG debug numNodes numExecutorsPerNode mapJoinConversionPos mapJoinConversion getBigTablePos totalSize pos pos joinOp getParentOperators pos pos mapJoinConversionPos Operator OperatorDesc parentOp joinOp getParentOperators get pos totalSize computeOnlineDataSize parentOp getStatistics bigTableSize computeOnlineDataSize joinOp getParentOperators get mapJoinConversionPos getStatistics
numExecutorsPerNode llapInfo getNumExecutorsPerNode numExecutorsPerNode numExecutorsPerNode context conf getIntVar ConfVars LLAP_DAEMON_NUM_EXECUTORS numNodes llapInfo getKnownExecutorCount numExecutorsPerNode LOG debug numNodes numExecutorsPerNode mapJoinConversionPos mapJoinConversion getBigTablePos totalSize pos pos joinOp getParentOperators pos pos mapJoinConversionPos Operator OperatorDesc parentOp joinOp getParentOperators get pos totalSize computeOnlineDataSize parentOp getStatistics bigTableSize computeOnlineDataSize joinOp getParentOperators get mapJoinConversionPos getStatistics networkCostDPHJ totalSize bigTableSize LOG info totalSize bigTableSize networkCostDPHJ
executorsPerNode conf getIntVar ConfVars LLAP_DAEMON_NUM_EXECUTORS numExecutorsPerNodeFromCluster llapInfo getNumExecutorsPerNode numExecutorsPerNodeFromCluster LOG warn executorsPerNode conf getIntVar ConfVars LLAP_DAEMON_NUM_EXECUTORS executorsPerNode numExecutorsPerNodeFromCluster slotsPerQuery Math min maxSlotsPerQuery executorsPerNode llapMaxSize maxSize maxSize overSubscriptionFactor slotsPerQuery adjustedMaxSize Math max maxSize llapMaxSize memoryMonitorInfo MemoryMonitorInfo executorsPerNode maxSlotsPerQuery overSubscriptionFactor maxSize adjustedMaxSize memoryCheckInterval inflationFactor memoryMonitorInfo MemoryMonitorInfo maxSlotsPerQuery overSubscriptionFactor maxSize maxSize memoryCheckInterval inflationFactor LOG
LOG info joinOp getParentOperators get getName ReduceSinkOperator rs ReduceSinkOperator joinOp getParentOperators get bigTablePosition List List String parentColNames rs getOpTraits getBucketColNames Operator OperatorDesc parentOfParent rs getParentOperators get List List String grandParentColNames parentOfParent getOpTraits getBucketColNames numBuckets parentOfParent getOpTraits getNumBuckets grandParentColNames parentColNames rs LOG info shouldCheckExternalTables tezBucketJoinProcCtx getConf getBoolVar HiveConf ConfVars HIVE_DISABLE_UNSAFE_EXTERNALTABLE_OPERATIONS shouldCheckExternalTables StringBuilder sb StringBuilder Operator joinOp getParentOperators sb
isFullOuterEnabledForDynamicPartitionHashJoin MapJoinProcessor isFullOuterEnabledForDynamicPartitionHashJoin context conf joinOp Set Integer bigTableCandidateSet MapJoinProcessor getBigTableCandidates conds bigTableCandidateSet bigTablePosition bigInputCumulativeCardinality Statistics bigInputStat foundInputNotFittingInMemory totalSize convertDPHJ pos pos joinOp getParentOperators pos Operator OperatorDesc parentOp joinOp getParentOperators get pos Statistics currInputStat parentOp getStatistics currInputStat
joinOp numReducers estimateNumBuckets joinOp
joinOp position context max HiveConf getLongVar context parseContext getConf HiveConf ConfVars HIVECONVERTJOINMAXENTRIESHASHTABLE max ReduceSinkOperator rsOp ReduceSinkOperator joinOp getParentOperators get position List String keys StatsUtils getQualifedReducerKeyNames rsOp getConf getOutputKeyColumnNames Statistics inputStats rsOp getStatistics List ColStatistics columnStats ArrayList String key keys ColStatistics cs inputStats getColumnStatisticsFromColName key cs columnStats add cs numRows inputStats getNumRows estimation estimateNDV numRows columnStats
procCtx OptimizeTezProcContext parseContext OptimizeTezProcContext procCtx parseContext procCtx OptimizeSparkProcContext parseContext OptimizeSparkProcContext procCtx getParseContext IllegalArgumentException procCtx getClass getName FilterOperator filter FilterOperator nd FilterDesc desc filter getConf parseContext getConf parseContext getConf TableScanOperator ts filter getParentOperators filter getParentOperators get TableScanOperator ts TableScanOperator filter getParentOperators get LOG LOG debug filter getParentOperators get
parseContext OptimizeTezProcContext procCtx parseContext procCtx OptimizeSparkProcContext parseContext OptimizeSparkProcContext procCtx getParseContext IllegalArgumentException procCtx getClass getName FilterOperator filter FilterOperator nd FilterDesc desc filter getConf parseContext getConf parseContext getConf TableScanOperator ts filter getParentOperators filter getParentOperators get TableScanOperator ts TableScanOperator filter getParentOperators get LOG LOG debug filter getParentOperators get LOG debug desc getPredicateString
getConf semiJoin List ExprNodeDesc newBetweenNodes ArrayList List ExprNodeDesc newBloomFilterNodes ArrayList ctx String column ExprNodeDescUtils extractColName ctx parent semiJoinAttempted ExprNodeDesc constNode ExprNodeConstantDesc ctx parent getTypeInfo column String keyBaseAlias Table table ts getConf getTableMetadata nonEquiJoin isNonEquiJoin ctx parent table table column nonEquiJoin String columnType table getPartColByName column getType String alias ts getConf getAlias
semiJoinAttempted ExprNodeDesc constNode ExprNodeConstantDesc ctx parent getTypeInfo column String keyBaseAlias Table table ts getConf getTableMetadata nonEquiJoin isNonEquiJoin ctx parent table table column nonEquiJoin String columnType table getPartColByName column getType String alias ts getConf getAlias PrunedPartitionList plist parseContext getPrunedPartitions alias ts LOG LOG debug alias LOG debug plist plist
column String keyBaseAlias Table table ts getConf getTableMetadata nonEquiJoin isNonEquiJoin ctx parent table table column nonEquiJoin String columnType table getPartColByName column getType String alias ts getConf getAlias PrunedPartitionList plist parseContext getPrunedPartitions alias ts LOG LOG debug alias LOG debug plist p plist LOG debug p getCompleteName plist plist
ctx Operator OperatorDesc parentOfRS ctx generator getParentOperators get ExprNodeDesc key ctx getKeyCol ExprNodeDesc partKey ctx parent getChildren get
ctx Operator OperatorDesc parentOfRS ctx generator getParentOperators get ExprNodeDesc key ctx getKeyCol ExprNodeDesc partKey ctx parent getChildren get LOG LOG debug key
ArrayList String gbOutputNames ArrayList gbOutputNames add SemanticAnalyzer getColumnInternalName gbOutputNames add SemanticAnalyzer getColumnInternalName gbOutputNames add SemanticAnalyzer getColumnInternalName colPos ArrayList ExprNodeDesc rsValueCols ArrayList ExprNodeDesc gbOutputNames ExprNodeColumnDesc expr ExprNodeColumnDesc key getTypeInfo gbOutputNames get colPos rsValueCols add expr ExprNodeColumnDesc colBFExpr ExprNodeColumnDesc TypeInfoFactory binaryTypeInfo gbOutputNames get colPos rsValueCols add colBFExpr ReduceSinkDesc rsDescFinal PlanUtils getReduceSinkDesc ArrayList ExprNodeDesc rsValueCols gbOutputNames Operation NOT_ACID NullOrdering defaultNullOrder parseContext getConf ReduceSinkOperator rsOpFinal ReduceSinkOperator OperatorFactory getAndMakeChild rsDescFinal RowSchema gb getSchema gb Map String ExprNodeDesc columnExprMap HashMap rsOpFinal setColumnExprMap columnExprMap
LimitDesc tempGlobalLimitDesc tempGlobalLimit getConf Table tab ts getConf getTableMetadata Set FilterOperator filterOps OperatorUtils findOperators ts FilterOperator tab filterOps Integer tempOffset tempGlobalLimitDesc getOffset globalLimitCtx enableOpt tempGlobalLimitDesc getLimit tempOffset tempOffset tab filterOps String alias String topOps keySet toArray PrunedPartitionList partsList pctx getPrunedPartitions alias ts partsList Integer tempOffset tempGlobalLimitDesc getOffset globalLimitCtx enableOpt tempGlobalLimitDesc getLimit tempOffset tempOffset globalLimitCtx
Table tab ts getConf getTableMetadata Set FilterOperator filterOps OperatorUtils findOperators ts FilterOperator tab filterOps Integer tempOffset tempGlobalLimitDesc getOffset globalLimitCtx enableOpt tempGlobalLimitDesc getLimit tempOffset tempOffset tab filterOps String alias String topOps keySet toArray PrunedPartitionList partsList pctx getPrunedPartitions alias ts partsList Integer tempOffset tempGlobalLimitDesc getOffset globalLimitCtx enableOpt tempGlobalLimitDesc getLimit tempOffset tempOffset globalLimitCtx LOG info globalLimitCtx getGlobalOffset
joinOp JoinDesc joinDesc joinOp getConf List ExprNodeDesc mapEntry joinDesc List ExprNodeDesc exprList mapEntry getValue ExprNodeDesc exprList
Byte List ExprNodeDesc mapEntry joinDesc List ExprNodeDesc exprList mapEntry getValue ExprNodeDesc expr exprList expr LOG debug expr toString Byte order joinDesc getTagOrder ExprNodeDesc joinKeysArray joinDesc getJoinKeys i i order i pos order i ExprNodeDesc keyExprs joinKeysArray pos ExprNodeDesc keyExpr keyExprs TypeInfo typeInfo keyExpr getTypeInfo typeInfo LOG
String testMapJoinFullOuterOverrideString HiveConf getVar hiveConf HiveConf ConfVars HIVE_TEST_MAPJOINFULLOUTER_OVERRIDE EnabledOverride mapJoinFullOuterOverride EnabledOverride nameMap get testMapJoinFullOuterOverrideString isEnabled HiveConf getBoolVar hiveConf HiveConf ConfVars HIVEMAPJOINFULLOUTER mapJoinFullOuterOverride isEnabled LOG LOG debug HiveConf ConfVars HIVEMAPJOINFULLOUTER varname LOG LOG debug HiveConf ConfVars HIVE_TEST_MAPJOINFULLOUTER_OVERRIDE varname HiveConf ConfVars HIVEMAPJOINFULLOUTER varname isEnabled HiveConf hiveConf HiveConf ConfVars HIVEMAPJOINFULLOUTER LOG
leaf FileSinkDesc leaf FileSinkOperator FileSinkDesc fsd FileSinkOperator leaf getConf fsd fsd
maxKeyCount cs getCountDistint maxKeyCount keyCount keyCount Math min maxKeyCount keyCount OpTraits opTraits mapJoinOp getOpTraits bucketCount opTraits opTraits getNumBuckets bucketCount keyCount bucketCount tableSize bucketCount bucketCount parentRS getConf getNumReducers keyCount bucketCount tableSize bucketCount keyCount
Operator rootOp OperatorUtils findSingleOperatorUpstreamJoinAccounted mapJoinOp getParentOperators get joinConf getPosBigTable ReduceSinkOperator rootOp edgeType EdgeType CUSTOM_EDGE edgeType EdgeType CUSTOM_SIMPLE_EDGE Operator rootOp OperatorUtils findSingleOperatorUpstreamJoinAccounted mapJoinOp getParentOperators get joinConf getPosBigTable TableScanOperator rootOp edgeType EdgeType CUSTOM_EDGE edgeType EdgeType CUSTOM_SIMPLE_EDGE mapJoinOp edgeType EdgeType ONE_TO_ONE_EDGE
r parentRS r getConf setOutputName myWork getName context connectedReduceSinks add r Map BaseWork TezEdgeProperty linkWorkMap context linkOpWithWorkMap mapJoinOp linkWorkMap context linkOpWithWorkMap get mapJoinOp linkWorkMap HashMap BaseWork TezEdgeProperty linkWorkMap put parentWork edgeProp context linkOpWithWorkMap put mapJoinOp linkWorkMap List ReduceSinkOperator reduceSinks context linkWorkWithReduceSinkMap get parentWork reduceSinks reduceSinks ArrayList ReduceSinkOperator reduceSinks add parentRS
Arrays sort srcs hasFile allFile src srcs sizeLeft allFile src LOG info src getPath AddPathReturnStatus ret addPath fs src getPath toString sizeLeft fileLimit retPathList ret sizeLeft ret sizeLeft hasFile ret hasFile allFile ret allFile
List ColStatistics colStats ArrayList i i desc i ColumnInfo ci groupByOperator getSchema getSignature get i colStats add groupByOperator getStatistics getColumnStatisticsFromColName ci getInternalName Statistics parentStats groupByOperator getParentOperators get getStatistics ndvProduct StatsUtils computeNDVGroupingColumns colStats parentStats ndvProduct numRows parentStats getNumRows ndvProduct numRows ndvProduct numRows defaultMinReductionHashAggrFactor desc getMinReductionHashAggr minReductionHashAggrFactor ndvProduct numRows minReductionHashAggrFactor defaultMinReductionHashAggrFactor desc setMinReductionHashAggr minReductionHashAggrFactor
nd procContext OptimizeTezProcContext context OptimizeTezProcContext procContext ReduceSinkOperator sink ReduceSinkOperator nd ReduceSinkDesc desc sink getConf bytesPerReducer context conf getLongVar HiveConf ConfVars BYTESPERREDUCER maxReducers context conf getIntVar HiveConf ConfVars MAXREDUCERS constantReducers context conf getIntVar HiveConf ConfVars HADOOPNUMREDUCERS context sink
LOG debug sink getName context visitedReduceSinks add sink desc constantReducers LOG info sink constantReducers desc setNumReducers constantReducers numberOfBytes sibling sink sibling getStatistics numberOfBytes StatsUtils safeAdd numberOfBytes sibling getStatistics getDataSize LOG warn sibling numReducers Utilities estimateReducers numberOfBytes bytesPerReducer maxReducers
numberOfBytes sibling sink sibling getStatistics numberOfBytes StatsUtils safeAdd numberOfBytes sibling getStatistics getDataSize LOG warn sibling numReducers Utilities estimateReducers numberOfBytes bytesPerReducer maxReducers LOG info sink numReducers desc setNumReducers numReducers Collection ExprNodeDescEqualityWrapper keyCols ExprNodeDescEqualityWrapper transform desc getKeyCols Collection ExprNodeDescEqualityWrapper partCols ExprNodeDescEqualityWrapper transform desc getPartitionCols keyCols keyCols partCols desc setReducerTraits EnumSet of UNIFORM AUTOPARALLEL
Map String TableScanOperator topOps pctx getTopOps topOps size pctx ArrayListMultimap String TableScanOperator tableNameToOps splitTableScanOpsByTable pctx tablesReferencedOnlyOnce tableNameToOps asMap entrySet stream noneMatch e e getValue size tablesReferencedOnlyOnce pctx LOG LOG debug Operator toString pctx getTopOps values List Entry String Long sortedTables rankTablesByAccumulatedSize pctx LOG debug sortedTables SharedWorkOptimizerCache optimizerCache SharedWorkOptimizerCache gatherDPPTableScanOps pctx optimizerCache SchemaAwareSharedWorkOptimizer sharedWorkOptimization pctx optimizerCache tableNameToOps sortedTables LOG
ArrayListMultimap String TableScanOperator tableNameToOps splitTableScanOpsByTable pctx tablesReferencedOnlyOnce tableNameToOps asMap entrySet stream noneMatch e e getValue size tablesReferencedOnlyOnce pctx LOG LOG debug Operator toString pctx getTopOps values List Entry String Long sortedTables rankTablesByAccumulatedSize pctx LOG debug sortedTables SharedWorkOptimizerCache optimizerCache SharedWorkOptimizerCache gatherDPPTableScanOps pctx optimizerCache SchemaAwareSharedWorkOptimizer sharedWorkOptimization pctx optimizerCache tableNameToOps sortedTables LOG LOG debug Operator toString pctx getTopOps values pctx sharedWorkExtendedOptimization pctx optimizerCache
List Entry String Long sortedTables rankTablesByAccumulatedSize pctx LOG debug sortedTables SharedWorkOptimizerCache optimizerCache SharedWorkOptimizerCache gatherDPPTableScanOps pctx optimizerCache SchemaAwareSharedWorkOptimizer sharedWorkOptimization pctx optimizerCache tableNameToOps sortedTables LOG LOG debug Operator toString pctx getTopOps values pctx sharedWorkExtendedOptimization pctx optimizerCache LOG LOG debug Operator toString pctx getTopOps values pctx tableNameToOps splitTableScanOpsByTable pctx sortedTables rankTablesByAccumulatedSize pctx optimized SchemaAwareSharedWorkOptimizer sharedWorkOptimization pctx optimizerCache tableNameToOps sortedTables
SchemaAwareSharedWorkOptimizer sharedWorkOptimization pctx optimizerCache tableNameToOps sortedTables LOG LOG debug Operator toString pctx getTopOps values pctx sharedWorkExtendedOptimization pctx optimizerCache LOG LOG debug Operator toString pctx getTopOps values pctx tableNameToOps splitTableScanOpsByTable pctx sortedTables rankTablesByAccumulatedSize pctx optimized SchemaAwareSharedWorkOptimizer sharedWorkOptimization pctx optimizerCache tableNameToOps sortedTables optimized pctx sharedWorkExtendedOptimization pctx optimizerCache LOG LOG debug Operator toString pctx getTopOps values
gatherReduceSinkOpsByInput parentToRsOps visited findWorkOperators optimizerCache e getValue Set Operator removedOps HashSet parentToRsOps List Entry Operator Long sortedRSGroups rankOpsByAccumulatedSize parentToRsOps keySet LOG debug sortedRSGroups Multimap Operator ReduceSinkOperator existingRsOps ArrayListMultimap create Entry Operator Long rsGroupInfo sortedRSGroups Operator rsParent rsGroupInfo getKey ReduceSinkOperator discardableRsOp parentToRsOps get rsParent removedOps discardableRsOp LOG debug discardableRsOp Collection ReduceSinkOperator otherRsOps existingRsOps get rsParent ReduceSinkOperator otherRsOps removedOps
List Entry Operator Long sortedRSGroups rankOpsByAccumulatedSize parentToRsOps keySet LOG debug sortedRSGroups Multimap Operator ReduceSinkOperator existingRsOps ArrayListMultimap create Entry Operator Long rsGroupInfo sortedRSGroups Operator rsParent rsGroupInfo getKey ReduceSinkOperator discardableRsOp parentToRsOps get rsParent discardableRsOp LOG debug discardableRsOp Collection ReduceSinkOperator otherRsOps existingRsOps get rsParent ReduceSinkOperator retainableRsOp otherRsOps retainableRsOp LOG debug retainableRsOp mergeable compareOperator pctx retainableRsOp discardableRsOp compareOperator pctx retainableRsOp getChildOperators get discardableRsOp getChildOperators get
Operator rsGroupInfo Operator rsParent rsGroupInfo getKey ReduceSinkOperator discardableRsOp get rsParent discardableRsOp LOG debug discardableRsOp Collection ReduceSinkOperator otherRsOps existingRsOps get rsParent ReduceSinkOperator retainableRsOp otherRsOps retainableRsOp LOG debug retainableRsOp mergeable compareOperator pctx retainableRsOp discardableRsOp compareOperator pctx retainableRsOp getChildOperators get discardableRsOp getChildOperators get mergeable LOG debug retainableRsOp discardableRsOp
LOG debug discardableRsOp Collection ReduceSinkOperator otherRsOps existingRsOps get rsParent ReduceSinkOperator retainableRsOp otherRsOps retainableRsOp LOG debug retainableRsOp mergeable compareOperator pctx retainableRsOp discardableRsOp compareOperator pctx retainableRsOp getChildOperators get discardableRsOp getChildOperators get mergeable LOG debug retainableRsOp discardableRsOp LOG debug discardableRsOp retainableRsOp Operator retainableRsOpChild retainableRsOp getChildOperators get Operator discardableRsOpChild discardableRsOp getChildOperators get SharedResult sr extractSharedOptimizationInfo pctx optimizerCache retainableRsOp discardableRsOp retainableRsOpChild discardableRsOpChild
LOG debug discardableRsOp retainableRsOp Operator retainableRsOpChild retainableRsOp getChildOperators get Operator discardableRsOpChild discardableRsOp getChildOperators get SharedResult sr extractSharedOptimizationInfo pctx optimizerCache retainableRsOp discardableRsOp retainableRsOpChild discardableRsOpChild sr retainableOps pctx optimizerCache sr LOG debug retainableRsOp discardableRsOp deduplicateReduceTraits retainableRsOp getConf discardableRsOp getConf Operator lastRetainableOp sr retainableOps get sr retainableOps size Operator lastDiscardableOp sr discardableOps get sr discardableOps size lastDiscardableOp List Operator OperatorDesc allChildren Lists newArrayList lastDiscardableOp getChildOperators Operator OperatorDesc op allChildren lastDiscardableOp getChildOperators remove op
op lastDiscardableOp getChildOperators remove op op replaceParent lastDiscardableOp lastRetainableOp lastRetainableOp getChildOperators add op LOG debug discardableRsOp retainableRsOp op OperatorUtils removeOperator op optimizerCache removeOp op removedOps add op op ReduceSinkOperator SemiJoinBranchInfo sjbi pctx getRsToSemiJoinBranchInfo get op sjbi sjbi getTsOp sjbi getTsOp GenTezUtils removeSemiJoinOperator pctx ReduceSinkOperator op sjbi getTsOp optimizerCache tableScanToDPPSource remove sjbi getTsOp op op
lastRetainableOp getChildOperators add op LOG debug discardableRsOp retainableRsOp op OperatorUtils removeOperator op optimizerCache removeOp op removedOps add op op ReduceSinkOperator SemiJoinBranchInfo sjbi pctx getRsToSemiJoinBranchInfo get op sjbi sjbi getTsOp sjbi getTsOp GenTezUtils removeSemiJoinOperator pctx ReduceSinkOperator op sjbi getTsOp optimizerCache tableScanToDPPSource remove sjbi getTsOp op op AppMasterEventOperator DynamicPruningEventDesc dped DynamicPruningEventDesc op getConf dped getTableScan dped getTableScan GenTezUtils removeSemiJoinOperator pctx AppMasterEventOperator op dped getTableScan
optimizerCache removeOp op removedOps add op op ReduceSinkOperator SemiJoinBranchInfo sjbi pctx getRsToSemiJoinBranchInfo get op sjbi sjbi getTsOp sjbi getTsOp GenTezUtils removeSemiJoinOperator pctx ReduceSinkOperator op sjbi getTsOp optimizerCache tableScanToDPPSource remove sjbi getTsOp op op AppMasterEventOperator DynamicPruningEventDesc dped DynamicPruningEventDesc op getConf dped getTableScan dped getTableScan GenTezUtils removeSemiJoinOperator pctx AppMasterEventOperator op dped getTableScan optimizerCache tableScanToDPPSource remove dped getTableScan op LOG debug op OperatorUtils removeOperator discardableRsOp optimizerCache removeOp discardableRsOp
nd procContext OptimizeSparkProcContext context OptimizeSparkProcContext procContext remove SparkPartitionPruningSinkOperator op SparkPartitionPruningSinkOperator nd SparkPartitionPruningSinkDesc desc op getConf context getConf op
List String parts List String partNames ArrayList String parts size parts
keys set pkPos ImmutableBitSet key keys build builder add key nonNullbuilder add key ImmutableBitSet Builder keys ImmutableBitSet builder isNonNullable ukPos ukPos ukPos rowType getFieldNames ukPos String colName rowType getFieldNames get ukPos colName colName rowType get ukPos isNonNullable
List fkCols String parentDatabaseName fkCols get parentDatabaseName String parentTableName fkCols get parentTableName String qualifiedName List String parentTableQualifiedName ArrayList parentDatabaseName parentDatabaseName parentTableQualifiedName add parentDatabaseName parentTableQualifiedName add parentTableName qualifiedName TableName getDbTable parentDatabaseName parentTableName parentTableQualifiedName add parentTableName qualifiedName parentTableName Table parentTab getTable qualifiedName parentTab
Table parentTab getTable qualifiedName parentTab LOG error parentDatabaseName parentTableName ImmutableList of ImmutableList Builder IntPair keys ImmutableList builder fkPos fkPos fkPos rowType getFieldNames fkPos String fkColName rowType getFieldNames get fkPos fkColName pkPos pkPos pkPos parentTab getAllCols pkPos String pkColName parentTab getAllCols get pkPos getName pkColName
List String partColNamesThatRqrStats ArrayList String List Integer partColIndxsThatRqrStats ArrayList Integer Set String colNamesFailedStats HashSet String ColumnInfo tmp Integer pi pi tmp pi nonPartColNamesThatRqrStats add tmp getInternalName nonPartColIndxsThatRqrStats add pi tmp pi partColNamesThatRqrStats add tmp getInternalName partColIndxsThatRqrStats add pi noColsMissingStats getAndIncrement String logMsg pi hiveTblMetadata getCompleteName
hiveColStats add columnStatsMap get colName e String logMsg hiveTblMetadata getTableName LOG error logMsg e RuntimeException logMsg e rowCount hiveColStats ArrayList ColStatistics i i nonPartColNamesThatRqrStats i hiveColStats add ColStatistics nonPartColNamesThatRqrStats get i hiveNonPartitionColsMap get nonPartColIndxsThatRqrStats get i getTypeName colNamesFailedStats clear colStatsCached updateState State COMPLETE
hiveColStats add ColStatistics nonPartColNamesThatRqrStats get i hiveNonPartitionColsMap get nonPartColIndxsThatRqrStats get i getTypeName colNamesFailedStats clear colStatsCached updateState State COMPLETE Statistics stats StatsUtils collectStatistics hiveConf partitionList hiveTblMetadata hiveNonPartitionCols nonPartColNamesThatRqrStats colStatsCached nonPartColNamesThatRqrStats rowCount stats getNumRows hiveColStats ArrayList ColStatistics c nonPartColNamesThatRqrStats ColStatistics cs stats getColumnStatisticsFromColName c cs hiveColStats add cs cs colNamesFailedStats add c colNamesFailedStats add c
hiveColStats add cs cs colNamesFailedStats add c colNamesFailedStats add c colStatsCached updateState stats getColumnStatsState e String logMsg LOG error logMsg e RuntimeException logMsg e hiveColStats hiveColStats i i hiveColStats i hiveColStatsMap put nonPartColIndxsThatRqrStats get i hiveColStats get i colStatsCached put hiveColStats get i getColumnName hiveColStats get i LOG
List List projectInput RelMetadataQuery relMetadataQuery RelMetadataQuery instance Map RexTableInputRef RelTableRef JoinedBackFieldsBuilder fieldMappingBuilders HashMap List RexTableInputRef RelTableRef tablesOrdered ArrayList expr Set RexNode expressionLineage relMetadataQuery getExpressionLineage projectInput expr expressionLineage expressionLineage
node optimized JaninoRelMetadataProvider original RelMetadataQuery THREAD_PROVIDERS get RelMetadataQuery THREAD_PROVIDERS set HiveTezModelRelMetadataProvider DEFAULT node getCluster invalidateMetadataQuery RelMetadataQuery metadataQuery RelMetadataQuery instance RelOptCost optimizedCost metadataQuery getCumulativeCost optimized RelOptCost originalCost metadataQuery getCumulativeCost node originalCost originalCost multiplyBy factor
node optimized JaninoRelMetadataProvider original RelMetadataQuery THREAD_PROVIDERS get RelMetadataQuery THREAD_PROVIDERS set HiveTezModelRelMetadataProvider DEFAULT node getCluster invalidateMetadataQuery RelMetadataQuery metadataQuery RelMetadataQuery instance RelOptCost optimizedCost metadataQuery getCumulativeCost optimized RelOptCost originalCost metadataQuery getCumulativeCost node originalCost originalCost multiplyBy factor LOG debug originalCost optimizedCost optimizedCost originalCost LOG
bldr add createFirstGB hiveExcept getInputs get cluster rexBuilder e LOG debug e toString RuntimeException e HiveRelNode union HiveUnion cluster TraitsUtil getDefaultTraitSet cluster bldr build List RexNode gbChildProjLst Lists newArrayList List Integer groupSetPositions Lists newArrayList unionColumnSize union getRowType getFieldList size cInd cInd unionColumnSize cInd gbChildProjLst add rexBuilder makeInputRef union cInd cInd unionColumnSize groupSetPositions add cInd gbChildProjLst add multiply rexBuilder makeInputRef union unionColumnSize rexBuilder makeInputRef union unionColumnSize cluster rexBuilder e
HiveRelNode union HiveUnion cluster TraitsUtil getDefaultTraitSet cluster bldr build List RexNode gbChildProjLst Lists newArrayList List Integer groupSetPositions Lists newArrayList unionColumnSize union getRowType getFieldList size cInd cInd unionColumnSize cInd gbChildProjLst add rexBuilder makeInputRef union cInd cInd unionColumnSize groupSetPositions add cInd gbChildProjLst add multiply rexBuilder makeInputRef union unionColumnSize rexBuilder makeInputRef union unionColumnSize cluster rexBuilder e LOG debug e toString RuntimeException e RelNode gbInputRel
RuntimeException e RelNode gbInputRel gbInputRel HiveProject create union gbChildProjLst e LOG debug e toString RuntimeException e List AggregateCall aggregateCalls Lists newArrayList RelDataType aggFnRetType TypeConverter convert TypeInfoFactory longTypeInfo cluster getTypeFactory AggregateCall aggregateCall HiveCalciteUtil createSingleArgAggCall cluster TypeInfoFactory longTypeInfo unionColumnSize aggFnRetType aggregateCalls add aggregateCall aggregateCall HiveCalciteUtil createSingleArgAggCall cluster TypeInfoFactory longTypeInfo unionColumnSize aggFnRetType aggregateCalls add aggregateCall ImmutableBitSet groupSet ImmutableBitSet of groupSetPositions HiveRelNode aggregateRel HiveAggregate cluster cluster traitSetOf HiveRelNode CONVENTION gbInputRel groupSet aggregateCalls
RuntimeException e List AggregateCall aggregateCalls Lists newArrayList RelDataType aggFnRetType TypeConverter convert TypeInfoFactory longTypeInfo cluster getTypeFactory AggregateCall aggregateCall HiveCalciteUtil createSingleArgAggCall cluster TypeInfoFactory longTypeInfo unionColumnSize aggFnRetType aggregateCalls add aggregateCall aggregateCall HiveCalciteUtil createSingleArgAggCall cluster TypeInfoFactory longTypeInfo unionColumnSize aggFnRetType aggregateCalls add aggregateCall ImmutableBitSet groupSet ImmutableBitSet of groupSetPositions HiveRelNode aggregateRel HiveAggregate cluster cluster traitSetOf HiveRelNode CONVENTION gbInputRel groupSet aggregateCalls RelNode filterRel filterRel HiveFilter cluster cluster traitSetOf HiveRelNode CONVENTION aggregateRel makeFilterExprForExceptDistinct aggregateRel unionColumnSize cluster rexBuilder e LOG debug e toString
RelNode filterRel filterRel HiveFilter cluster cluster traitSetOf HiveRelNode CONVENTION aggregateRel makeFilterExprForExceptDistinct aggregateRel unionColumnSize cluster rexBuilder e LOG debug e toString RuntimeException e Set Integer projectOutColumnPositions HashSet projectOutColumnPositions add filterRel getRowType getFieldList size projectOutColumnPositions add filterRel getRowType getFieldList size call transformTo HiveCalciteUtil createProjectWithoutColumn filterRel projectOutColumnPositions e LOG debug e toString RuntimeException e
call transformTo HiveCalciteUtil createProjectWithoutColumn filterRel projectOutColumnPositions e LOG debug e toString RuntimeException e List RexNode aggregateRel RexNode RexNode input RexInputRef input getIndex input getType List RexNode copyInputRefs ArrayList copyInputRefs add makeExprForExceptAll aggregateRel unionColumnSize cluster rexBuilder e LOG debug e toString RuntimeException e
RexBuilder rexBuilder cluster getRexBuilder numOfBranch hiveIntersect getInputs size Builder RelNode bldr ImmutableList Builder RelNode index index numOfBranch index RelNode input hiveIntersect getInputs get index List RexNode gbChildProjLst Lists newArrayList List Integer groupSetPositions Lists newArrayList cInd cInd input size cInd gbChildProjLst add rexBuilder makeInputRef input cInd groupSetPositions add cInd gbChildProjLst add rexBuilder makeBigintLiteral BigDecimal RelNode gbInputRel gbInputRel HiveProject create input gbChildProjLst
countInd cInd List RexNode childRexNodeLst ArrayList RexNode RexInputRef ref rexBuilder makeInputRef aggregateRel countInd RexLiteral literal rexBuilder makeBigintLiteral BigDecimal numOfBranch childRexNodeLst add ref childRexNodeLst add literal ImmutableList Builder RelDataType calciteArgTypesBldr ImmutableList Builder RelDataType calciteArgTypesBldr add TypeConverter convert TypeInfoFactory longTypeInfo cluster getTypeFactory calciteArgTypesBldr add TypeConverter convert TypeInfoFactory longTypeInfo cluster getTypeFactory RexNode factoredFilterExpr factoredFilterExpr rexBuilder makeCall SqlFunctionConverter getCalciteFn calciteArgTypesBldr build TypeConverter convert TypeInfoFactory longTypeInfo cluster getTypeFactory childRexNodeLst e LOG debug e toString RuntimeException e
Set Integer projectOutColumnPositions HashSet projectOutColumnPositions add filterRel getRowType getFieldList size call transformTo HiveCalciteUtil createProjectWithoutColumn filterRel projectOutColumnPositions e LOG debug e toString RuntimeException e List RexNode originalInputRefs filterRel getRowType getFieldList RexNode RexNode input RexInputRef input getIndex input getType List RexNode copyInputRefs ArrayList copyInputRefs add originalInputRefs get originalInputRefs size originalInputRefs size
List Integer iRefSet Lists newArrayList key Project Project project Project key rx project iRefSet addAll HiveCalciteUtil getInputRefs rx fieldCount tableAccessRel getRowType getFieldCount ImmutableBitSet range fieldCount iRefSet addAll ImmutableBitSet range fieldCount asList tableAccessRel HiveTableScan iRefSet removeAll HiveTableScan tableAccessRel getVirtualCols iRefSet RelOptTable table tableAccessRel getTable table RelOptHiveTable RelOptHiveTable table getColStat iRefSet
creationMetadata currentTxnWriteIds LOG debug materializedViewTable getFullyQualifiedName creationMetadata getValidTxnList creationMetadata getValidTxnList LOG debug materializedViewTable getFullyQualifiedName ignore ValidTxnWriteIdList mvTxnWriteIds ValidTxnWriteIdList creationMetadata getValidTxnList qName creationMetadata qName ValidWriteIdList tableCurrentWriteIds currentTxnWriteIds getTableValidWriteIdList qName tableCurrentWriteIds
ignore ValidTxnWriteIdList mvTxnWriteIds ValidTxnWriteIdList creationMetadata getValidTxnList qName creationMetadata qName ValidWriteIdList tableCurrentWriteIds currentTxnWriteIds getTableValidWriteIdList qName tableCurrentWriteIds LOG debug materializedViewTable getFullyQualifiedName qName ignore ValidWriteIdList tableWriteIds mvTxnWriteIds getTableValidWriteIdList qName tableWriteIds LOG warn materializedViewTable getFullyQualifiedName qName mvTxnWriteIds ignore
joinSelectivity Math min constraintBasedResult left pkInfo selectivity constraintBasedResult left ndvScalingFactor residualSelectivity RelMdUtil guessSelectivity constraintBasedResult right rowCount constraintBasedResult left rowCount constraintBasedResult left pkInfo rowCount HIVE_PK_FK_NO_FILTERING_COST_INCREASING_FACTOR rowCount constraintBasedResult left fkInfo rowCount joinSelectivity residualSelectivity LOG LOG debug RelOptUtil toString join constraintBasedResult left rowCount joinSelectivity residualSelectivity rowCount PKFKRelationInfo pkfk analyzeJoinForPKFK join mq pkfk selectivity pkfk pkInfo selectivity pkfk ndvScalingFactor selectivity Math min selectivity LOG
rowCount constraintBasedResult left pkInfo rowCount HIVE_PK_FK_NO_FILTERING_COST_INCREASING_FACTOR rowCount constraintBasedResult left fkInfo rowCount joinSelectivity residualSelectivity LOG LOG debug RelOptUtil toString join constraintBasedResult left rowCount joinSelectivity residualSelectivity rowCount PKFKRelationInfo pkfk analyzeJoinForPKFK join mq pkfk selectivity pkfk pkInfo selectivity pkfk ndvScalingFactor selectivity Math min selectivity LOG LOG debug RelOptUtil toString join pkfk pkfk fkInfo rowCount selectivity Double rowCount join estimateRowCount mq LOG
RelNode RelNode rel RelNode newTopNode rel
RelNode convertOpTree RelNode rel RelNode newTopNode rel LOG LOG debug RelOptUtil toString newTopNode newTopNode newTopNode newTopNode newTopNode introduceDerivedTable newTopNode LOG LOG debug RelOptUtil toString newTopNode convertOpTree newTopNode RelNode LOG LOG debug RelOptUtil toString newTopNode HiveRelColumnsAlignment propagator HiveRelColumnsAlignment HiveRelFactories HIVE_BUILDER create newTopNode getCluster newTopNode propagator align newTopNode LOG
newTopNode newTopNode newTopNode newTopNode introduceDerivedTable newTopNode LOG LOG debug RelOptUtil toString newTopNode convertOpTree newTopNode RelNode LOG LOG debug RelOptUtil toString newTopNode HiveRelColumnsAlignment propagator HiveRelColumnsAlignment HiveRelFactories HIVE_BUILDER create newTopNode getCluster newTopNode propagator align newTopNode LOG LOG debug RelOptUtil toString newTopNode Pair RelNode RelNode topSelparentPair HiveCalciteUtil getTopLevelSelect newTopNode PlanModifierUtil fixTopOBSchema newTopNode topSelparentPair resultSchema LOG
LOG debug RelOptUtil toString newTopNode convertOpTree newTopNode RelNode LOG LOG debug RelOptUtil toString newTopNode HiveRelColumnsAlignment propagator HiveRelColumnsAlignment HiveRelFactories HIVE_BUILDER create newTopNode getCluster newTopNode propagator align newTopNode LOG LOG debug RelOptUtil toString newTopNode Pair RelNode RelNode topSelparentPair HiveCalciteUtil getTopLevelSelect newTopNode PlanModifierUtil fixTopOBSchema newTopNode topSelparentPair resultSchema LOG LOG debug RelOptUtil toString newTopNode topSelparentPair HiveCalciteUtil getTopLevelSelect newTopNode newTopNode renameTopLevelSelectInResultSchema newTopNode topSelparentPair resultSchema
RelNode RelNode RelNode RelNode topSelparentPair List RelNode parentOforiginalProjRel topSelparentPair getKey HiveProject originalProjRel HiveProject topSelparentPair getValue List RexNode rootChildExps originalProjRel getChildExps rootChildExps
topSelparentPair getKey topSelparentPair getKey HiveSortLimit obRel HiveSortLimit topSelparentPair getKey Project obChild Project topSelparentPair getValue obChild getRowType resultSchema RelDataType rt obChild getRowType SuppressWarnings Set Integer collationInputRefs HashSet RelCollations ordinals obRel getCollation ImmutableMap Builder Integer RexNode inputRefToCallMapBldr ImmutableMap builder i resultSchema i rt i collationInputRefs i RexNode obyExpr obChild getChildExps get i obyExpr RexCall LOG debug obyExpr obyExpr adjustOBSchema RexCall obyExpr obChild resultSchema
Project obChild Project topSelparentPair getValue obChild getRowType resultSchema RelDataType rt obChild getRowType SuppressWarnings Set Integer collationInputRefs HashSet RelCollations ordinals obRel getCollation ImmutableMap Builder Integer RexNode inputRefToCallMapBldr ImmutableMap builder i resultSchema i rt i collationInputRefs i RexNode obyExpr obChild getChildExps get i obyExpr RexCall LOG debug obyExpr obyExpr adjustOBSchema RexCall obyExpr obChild resultSchema LOG debug obyExpr inputRefToCallMapBldr put i obyExpr ImmutableMap Integer RexNode inputRefToCallMap inputRefToCallMapBldr build
OpAttr filterRel OpAttr inputOpAf hiveOpConverter dispatch filterRel getInput
tableAlias tableAlias tableAlias tableName tableName tableAlias SemanticException tableAlias SemanticException ReduceSinkOperator rsOp genReduceSink input tableAlias keys tag partitionCols order nullOrder numReducers acidOperation hiveConf Map String ExprNodeDesc descriptors buildBacktrackFromReduceSink keepColNames rsOp getConf getOutputKeyColumnNames rsOp getConf getOutputValueColumnNames rsOp getValueIndex input SelectDesc selectDesc SelectDesc ArrayList ExprNodeDesc descriptors values ArrayList String descriptors keySet ArrayList ColumnInfo cinfoLst createColInfosSubset input keepColNames SelectOperator selectOp SelectOperator OperatorFactory getAndMakeChild selectDesc RowSchema cinfoLst rsOp selectOp setColumnExprMap descriptors
String error StrictChecks checkCartesian hiveConf error SemanticException error ReduceSinkDesc rsDesc order rsDesc PlanUtils getReduceSinkDesc reduceKeys reduceValues outputColumnNames tag reduceKeys size numReducers acidOperation NullOrdering defaultNullOrder hiveConf rsDesc PlanUtils getReduceSinkDesc reduceKeys reduceValues outputColumnNames tag partitionCols order nullOrder NullOrdering defaultNullOrder hiveConf numReducers acidOperation ReduceSinkOperator rsOp ReduceSinkOperator OperatorFactory getAndMakeChild rsDesc RowSchema outputColumns input List String keyColNames rsDesc getOutputKeyColumnNames i i keyColNames size i colExprMap put Utilities ReduceField KEY keyColNames get i reduceKeys get i List String valColNames rsDesc getOutputValueColumnNames i i valColNames size i colExprMap put Utilities ReduceField VALUE valColNames get i reduceValues get i
OpAttr projectRel OpAttr inputOpAf hiveOpConverter dispatch projectRel getInput
Map String ExprNodeDesc colExprMap HashMap String ExprNodeDesc pos pos projectRel getChildExps pos ExprNodeConverter converter ExprNodeConverter inputOpAf tabAlias projectRel getRowType getFieldNames get pos projectRel getInput getRowType projectRel getRowType inputOpAf vcolsInCalcite projectRel getCluster getTypeFactory ExprNodeDesc exprCol projectRel getChildExps get pos accept converter colExprMap put exprNames get pos exprCol exprCols add exprCol converter wfs converter windowingSpec addWindowFunction wfs windowingSpec windowingSpec inputOpAf genPTF inputOpAf windowingSpec SelectDesc sd SelectDesc exprCols exprNames Pair ArrayList ColumnInfo Set Integer colInfoVColPair createColInfos projectRel getChildExps exprCols exprNames inputOpAf SelectOperator selOp SelectOperator OperatorFactory getAndMakeChild sd RowSchema colInfoVColPair getKey inputOpAf inputs get selOp setColumnExprMap colExprMap
OpAttr sortRel OpAttr inputOpAf hiveOpConverter dispatch sortRel getInput
OpAttr sortRel OpAttr inputOpAf hiveOpConverter dispatch sortRel getInput LOG LOG debug sortRel getId sortRel getRelTypeName sortRel getRowType sortRel
colInfo posToPartColInfo get index vcolsInCalcite add index colInfo posToNonPartColInfo get index colInfos add colInfo index neededColumnIDs add index neededColumnNames add colName TableScanDesc tsd TableScanDesc tableAlias virtualCols ht getHiveTableMD tsd setPartColumns partColNames tsd setNeededColumnIDs neededColumnIDs tsd setNeededColumns neededColumnNames TableScanOperator ts TableScanOperator OperatorFactory get hiveOpConverter getSemanticAnalyzer getOpContext tsd RowSchema colInfos hiveOpConverter get tableAlias tableAlias tableAlias hiveOpConverter getUniqueCounter
LOG LOG debug unionRel getId unionRel getRelTypeName unionRel getRowType UnionDesc unionDesc UnionDesc unionDesc setNumInputs inputs length String tableAlias hiveOpConverter getHiveDerivedTableAlias ArrayList ColumnInfo cinfoLst createColInfos inputs inputs get tableAlias Operator children Operator inputs length i i children length i i children i inputs i inputs get Operator op inputs i inputs get children i genInputSelectForUnion op cinfoLst Operator OperatorDesc unionOp OperatorFactory getAndMakeChild hiveOpConverter getSemanticAnalyzer getOpContext unionDesc RowSchema cinfoLst children LOG
i i inputs i inputs i hiveOpConverter dispatch joinRel getInput i children add inputs i inputs get baseSrc i inputs i tabAlias tag tag children size tag ReduceSinkOperator reduceSinkOp ReduceSinkOperator children get tag reduceSinkOp getConf setTag tag Set Integer newVcolsInCalcite HashSet Integer newVcolsInCalcite addAll inputs vcolsInCalcite joinRel joinRel joinRel joinRel shift inputs inputs get getSchema getSignature size i i inputs i newVcolsInCalcite addAll HiveCalciteUtil shiftVColsSet inputs i vcolsInCalcite shift shift inputs i inputs get getSchema getSignature size
FileSystem fs table getPath getFileSystem pCtx getConf resultCs fs getContentSummary p LOG warn table getCompleteName joinOp getName joinOp getIdentifier resultCs isAbleToGuess size resultCs getLength aliasTotalKnownInputSize size Long es aliasToSize get alias es es Long valueOf es size aliasToSize put alias es
es size aliasToSize put alias es posToAliases put pos aliases LOG info joinOp getName joinOp getIdentifier JoinDesc joinDesc joinOp getConf Byte order joinDesc getTagOrder numAliases order length Set Integer bigTableCandidates MapJoinProcessor getBigTableCandidates joinDesc getConds bigTableCandidates ThresholdOfSmallTblSizeSum HiveConf getLongVar pCtx getConf HiveConf ConfVars HIVESMALLTABLESFILESIZE numAliases bigTableCandidates
nd Operator OperatorDesc op Operator OperatorDesc nd
OperatorDesc op OperatorDesc conf op getConf conf
op pctx Long runTimeNumRows pctx getContext getExplainConfig getOpIdToRuntimeNumRows get op getOperatorId op op runTimeNumRows
origWrk wrk wrk MergeJoinWork wrk getMainWork wrk ReduceWork ReduceWork rWork ReduceWork wrk Operator OperatorDesc reducer ReduceWork wrk getReducer reducer reducer noOuterJoin JoinDesc reducer getConf isNoOuterJoin Map Integer ExtractReduceSinkInfo Info rsInfo TreeMap Integer ExtractReduceSinkInfo Info Map Integer e rWork rsInfo putAll getReducerInfo tezWork rWork getName e getValue rWork getName reducer rsInfo noOuterJoin List BaseWork parents tezWork getParents origWrk wrk origWrk BaseWork p parents TezEdgeProperty prop tezWork getEdgeProperty p origWrk wrk origWrk
conf String nodes HiveConf getTrimmedVar conf HiveConf ConfVars LLAP_DAEMON_SERVICE_HOSTS String userName HiveConf getVar conf ConfVars LLAP_ZK_REGISTRY_USER LlapRegistryService currentUser
ret validateExprNodeDescNoComplex desc getKeys ret hasKeys desc getKeys size ProcessingMode processingMode VectorGroupByDesc groupByDescModeToVectorProcessingMode desc getMode hasKeys desc isGroupingSetsPresent processingMode ProcessingMode processingMode ProcessingMode setOperatorIssue isGroupingSetsPresent desc getListGroupingSets desc getListGroupingSets isEmpty desc desc getMode isGroupingSetsPresent hasKeys vectorGroupByDesc setProcessingMode processingMode vectorGroupByDesc setIsVectorizationComplexTypesEnabled isVectorizationComplexTypesEnabled vectorGroupByDesc setIsVectorizationGroupByComplexTypesEnabled isVectorizationGroupByComplexTypesEnabled
desc Byte order desc getTagOrder posBigTable desc getPosBigTable Byte posSingleVectorMapJoinSmallTable order posBigTable order order smallTableIndices smallTableIndicesSize desc getValueIndices desc getValueIndices get posSingleVectorMapJoinSmallTable smallTableIndices desc getValueIndices get posSingleVectorMapJoinSmallTable
desc Byte order desc getTagOrder posBigTable desc getPosBigTable Byte posSingleVectorMapJoinSmallTable order posBigTable order order smallTableIndices smallTableIndicesSize desc getValueIndices desc getValueIndices get posSingleVectorMapJoinSmallTable smallTableIndices desc getValueIndices get posSingleVectorMapJoinSmallTable LOG info Arrays toString smallTableIndices smallTableIndicesSize smallTableIndices length smallTableIndices LOG info smallTableIndicesSize List Integer smallTableRetainList desc getRetainList get posSingleVectorMapJoinSmallTable
hashTableImplementationType HashTableImplementationType FAST hashTableImplementationType HashTableImplementationType OPTIMIZED joinType desc getConds getType isInnerBigOnly joinType desc isInnerBigOnly hashTableKeyType HashTableKeyType MULTI_KEY posBigTable desc getPosBigTable Map Byte List ExprNodeDesc keyExprs desc getKeys List ExprNodeDesc bigTableKeyExprs keyExprs get posBigTable bigTableKeyExprs TypeInfo typeInfo bigTableKeyExprs get getTypeInfo
vectorMapJoinVariation VectorMapJoinVariation INNER hashTableKind HashTableKind HASH_MAP vectorMapJoinVariation VectorMapJoinVariation INNER_BIG_ONLY hashTableKind HashTableKind HASH_MULTISET vectorMapJoinVariation VectorMapJoinVariation hashTableKind HashTableKind HASH_MAP vectorMapJoinVariation VectorMapJoinVariation hashTableKind HashTableKind HASH_MAP vectorMapJoinVariation VectorMapJoinVariation hashTableKind HashTableKind HASH_SET
opClass VectorReduceSinkEmptyKeyOperator opClass opClass opClass opClass VectorReduceSinkEmptyKeyOperator
reduceSinkKeyType opClass opClass opClass reduceSinkKeyType vectorDesc vectorDesc vectorDesc opClass VectorReduceSinkEmptyKeyOperator opClass VectorReduceSinkObjectHashOperator vectorDesc setReduceSinkKeyType reduceSinkKeyType vectorDesc setVectorReduceSinkInfo vectorReduceSinkInfo
List String partColumnNames ArrayList List PrimitiveTypeInfo partColumnTypeInfos ArrayList fs partColumnNames add fs getName partColumnTypeInfos add TypeInfoFactory getPrimitiveTypeInfo fs getType ExprNodeGenericFuncDesc expr deserializeExpr exprBytes ExprNodeDescUtils replaceEqualDefaultPartition expr defaultPartitionName ex LOG error ex MetaException ex getMessage startTime System nanoTime len partitionNames size result PartitionPruner prunePartitionNames partColumnNames partColumnTypeInfos expr defaultPartitionName partitionNames timeMs System nanoTime startTime
partColumnNames add fs getName partColumnTypeInfos add TypeInfoFactory getPrimitiveTypeInfo fs getType ExprNodeGenericFuncDesc expr deserializeExpr exprBytes ExprNodeDescUtils replaceEqualDefaultPartition expr defaultPartitionName ex LOG error ex MetaException ex getMessage startTime System nanoTime len partitionNames size result PartitionPruner prunePartitionNames partColumnNames partColumnTypeInfos expr defaultPartitionName partitionNames timeMs System nanoTime startTime LOG debug len timeMs result ex
prunerExpr String error StrictChecks checkNoPartitionFilter conf error SemanticException error alias tab getTableName prunerExpr getAllPartsFromCacheOrServer tab key prunedPartitionsMap Set String partColsUsedInFilter LinkedHashSet String prunerExpr removeNonPartCols prunerExpr extractPartColNames tab partColsUsedInFilter ExprNodeDesc compactExpr compactExpr prunerExpr clone String oldFilter prunerExpr getExprString compactExpr compactExpr compactExpr PrunedPartitionList tab key compactExpr getExprString Collections emptySet Collections emptyList getAllPartsFromCacheOrServer tab key prunedPartitionsMap String compactExprString compactExpr getExprString
convertedValues add Object o ObjectInspectorConverters getConverter PrimitiveObjectInspectorFactory javaStringObjectInspector PrimitiveObjectInspectorFactory getPrimitiveJavaObjectInspector typeInfo convert partitionValue convertedValues add o Boolean isNeeded Boolean PartExprEvalUtils evaluateExprOnPart handle convertedValues isUnknown isNeeded isUnknown isNeeded partIter remove isUnknown LOG LOG debug partName partIter remove hasUnknownPartitions isUnknown
nd procContext OptimizeSparkProcContext context OptimizeSparkProcContext procContext ReduceSinkOperator sink ReduceSinkOperator nd ReduceSinkDesc desc sink getConf Set ReduceSinkOperator parentSinks maxReducers context getConf getIntVar HiveConf ConfVars MAXREDUCERS constantReducers context getConf getIntVar HiveConf ConfVars HADOOPNUMREDUCERS parentSinks OperatorUtils findOperatorsUpstream sink ReduceSinkOperator parentSinks remove sink context parentSinks
Set ReduceSinkOperator parentSinks maxReducers context getConf getIntVar HiveConf ConfVars MAXREDUCERS constantReducers context getConf getIntVar HiveConf ConfVars HADOOPNUMREDUCERS parentSinks OperatorUtils findOperatorsUpstream sink ReduceSinkOperator parentSinks remove sink context getVisitedReduceSinks parentSinks LOG debug sink context getVisitedReduceSinks sink LOG debug sink getName context getVisitedReduceSinks add sink sink context getConf constantReducers
context getVisitedReduceSinks sink LOG debug sink getName context getVisitedReduceSinks add sink sink context getConf constantReducers LOG info sink constantReducers desc setNumReducers constantReducers FileSinkOperator fso GenSparkUtils getChildOperator sink FileSinkOperator fso String bucketCount fso getConf getTableInfo getProperties getProperty hive_metastoreConstants BUCKET_COUNT numBuckets bucketCount Integer parseInt bucketCount numBuckets
LOG info sink constantReducers desc setNumReducers constantReducers FileSinkOperator fso GenSparkUtils getChildOperator sink FileSinkOperator fso String bucketCount fso getConf getTableInfo getProperties getProperty hive_metastoreConstants BUCKET_COUNT numBuckets bucketCount Integer parseInt bucketCount numBuckets LOG info sink numBuckets desc setNumReducers numBuckets numberOfBytes sink
numberOfBytes sibling sibling getStatistics numberOfBytes StatsUtils safeAdd numberOfBytes sibling getStatistics getDataSize LOG LOG debug sibling sibling getStatistics LOG warn sibling sibling Set TableScanOperator sources OperatorUtils findOperatorsUpstream sibling TableScanOperator TableScanOperator sources getStatistics
LOG warn sibling sibling sink Set TableScanOperator sources OperatorUtils findOperatorsUpstream sibling TableScanOperator TableScanOperator source sources source getStatistics numberOfBytes StatsUtils safeAdd numberOfBytes source getStatistics getDataSize LOG LOG debug source source getStatistics LOG warn source LOG debug sink numberOfBytes bytesPerReducer context getConf getLongVar HiveConf ConfVars BYTESPERREDUCER numReducers Utilities estimateReducers numberOfBytes bytesPerReducer maxReducers
sibling sink Set TableScanOperator sources OperatorUtils findOperatorsUpstream sibling TableScanOperator TableScanOperator source sources source getStatistics numberOfBytes StatsUtils safeAdd numberOfBytes source getStatistics getDataSize LOG LOG debug source source getStatistics LOG warn source LOG debug sink numberOfBytes bytesPerReducer context getConf getLongVar HiveConf ConfVars BYTESPERREDUCER numReducers Utilities estimateReducers numberOfBytes bytesPerReducer maxReducers getSparkMemoryAndCores context
LOG LOG debug source source getStatistics LOG warn source LOG debug sink numberOfBytes bytesPerReducer context getConf getLongVar HiveConf ConfVars BYTESPERREDUCER numReducers Utilities estimateReducers numberOfBytes bytesPerReducer maxReducers getSparkMemoryAndCores context sparkMemoryAndCores sparkMemoryAndCores sparkMemoryAndCores getRight sparkMemoryAndCores bytesPerReducer LOG warn numReducers Math max numReducers sparkMemoryAndCores getRight numReducers Math min numReducers maxReducers LOG info sink numReducers desc setNumReducers numReducers
LOG info joinOp mapJoinInfo getMapJoinConversionInfo joinOp context mapJoinConversionPos mapJoinInfo mapJoinConversionPos numBuckets List List String bucketColNames LOG info MapJoinOperator mapJoinOp convertJoinMapJoin joinOp context mapJoinConversionPos mapJoinOp getConf getKeyTblDesc getProperties setProperty serdeConstants SERIALIZATION_LIB BinarySortableSerDe getName LOG info numBuckets convertJoinBucketMapJoin joinOp mapJoinOp context mapJoinConversionPos numBuckets
joinOp context Set Integer bigTableCandidateSet MapJoinProcessor getBigTableCandidates joinOp getConf getConds maxSize context getConf getLongVar HiveConf ConfVars HIVECONVERTJOINNOCONDITIONALTASKTHRESHOLD bigTablePosition Statistics bigInputStat totalSize pos bigTableFound useTsStats context getConf getBoolean HiveConf ConfVars SPARK_USE_TS_STATS_FOR_MAPJOIN varname useTsStats
joinOp context Set Integer bigTableCandidateSet MapJoinProcessor getBigTableCandidates joinOp getConf getConds maxSize context getConf getLongVar HiveConf ConfVars HIVECONVERTJOINNOCONDITIONALTASKTHRESHOLD bigTablePosition Statistics bigInputStat totalSize pos bigTableFound useTsStats context getConf getBoolean HiveConf ConfVars SPARK_USE_TS_STATS_FOR_MAPJOIN varname useTsStats LOG debug joinOp joinOp bigTablePosition bigTableCandidateSet pos
Statistics bigInputStat totalSize pos bigTableFound useTsStats context getConf getBoolean HiveConf ConfVars SPARK_USE_TS_STATS_FOR_MAPJOIN varname useTsStats LOG debug joinOp parentOp joinOp parentOp bigTablePosition pos parentOp LOG debug parentOp pos bigTablePosition pos bigTableFound bigInputStat Statistics Long MAX_VALUE Long MAX_VALUE
context mapJoinParentMap mapJoinOp List Operator parents ArrayList Operator mapJoinOp getParentOperators context mapJoinParentMap put mapJoinOp parents List BaseWork mapJoinWork mapJoinWork context mapJoinWorkMap get mapJoinOp workMapSize context childToWorkMap get parentRS size Preconditions checkArgument workMapSize workMapSize BaseWork parentWork context childToWorkMap get parentRS get pos context mapJoinParentMap get mapJoinOp indexOf parentRS pos SemanticException LOG debug mapJoinOp pos parentWork getName mapJoinOp getConf getParentToInput put pos parentWork getName SparkEdgeProperty edgeProp SparkEdgeProperty SparkEdgeProperty SHUFFLE_NONE mapJoinWork
parallelism interReduction hashAgg inputSize containsGroupingSet gop getConf isGroupingSetsPresent sizeOfGroupingSet containsGroupingSet gop getConf getListGroupingSets size gop getConf gop getConf gop getConf interReduction TableScanOperator top OperatorUtils findSingleOperatorUpstream gop TableScanOperator top inputSize parentStats getDataSize maxSplitSize HiveConf getLongVar conf HiveConf ConfVars BYTESPERREDUCER inputSize top getConf getStatistics getDataSize parallelism Math ceil inputSize maxSplitSize
containsGroupingSet gop getConf isGroupingSetsPresent sizeOfGroupingSet containsGroupingSet gop getConf getListGroupingSets size gop getConf gop getConf gop getConf interReduction TableScanOperator top OperatorUtils findSingleOperatorUpstream gop TableScanOperator top inputSize parentStats getDataSize maxSplitSize HiveConf getLongVar conf HiveConf ConfVars BYTESPERREDUCER inputSize top getConf getStatistics getDataSize parallelism Math ceil inputSize maxSplitSize LOG LOG debug gop toString inputSize maxSplitSize parallelism containsGroupingSet sizeOfGroupingSet parentStats hashAgg checkMapSideAggregation gop colStats conf
inputSize top getConf getStatistics getDataSize parallelism Math ceil inputSize maxSplitSize LOG LOG debug gop toString inputSize maxSplitSize parallelism containsGroupingSet sizeOfGroupingSet parentStats hashAgg checkMapSideAggregation gop colStats conf LOG LOG debug gop toString hashAgg stats parentStats clone stats setColumnStats colStats parentNumRows stats getNumRows ndvProduct StatsUtils computeNDVGroupingColumns colStats parentStats ndvProduct ndvProduct parentNumRows
LOG LOG debug gop toString inputSize maxSplitSize parallelism containsGroupingSet sizeOfGroupingSet parentStats hashAgg checkMapSideAggregation gop colStats conf LOG LOG debug gop toString hashAgg stats parentStats clone stats setColumnStats colStats parentNumRows stats getNumRows ndvProduct StatsUtils computeNDVGroupingColumns colStats parentStats ndvProduct ndvProduct parentNumRows LOG LOG debug gop toString ndvProduct
LOG debug gop toString hashAgg stats parentStats clone stats setColumnStats colStats parentNumRows stats getNumRows ndvProduct StatsUtils computeNDVGroupingColumns colStats parentStats ndvProduct ndvProduct parentNumRows LOG LOG debug gop toString ndvProduct hashAgg cardinality Math min StatsUtils safeMult parentNumRows sizeOfGroupingSet StatsUtils safeMult StatsUtils safeMult ndvProduct parallelism sizeOfGroupingSet LOG LOG debug gop toString cardinality
ndvProduct StatsUtils computeNDVGroupingColumns colStats parentStats ndvProduct ndvProduct parentNumRows LOG LOG debug gop toString ndvProduct cardinality Math min StatsUtils safeMult parentNumRows sizeOfGroupingSet StatsUtils safeMult StatsUtils safeMult ndvProduct parallelism sizeOfGroupingSet LOG LOG debug gop toString cardinality cardinality Math min parentNumRows StatsUtils safeMult ndvProduct parallelism orgParentNumRows StatsUtils safeMult getParentNumRows gop gop getConf getKeys conf parallelism cardinality Math min cardinality orgParentNumRows
LOG debug gop toString ndvProduct cardinality Math min StatsUtils safeMult parentNumRows sizeOfGroupingSet StatsUtils safeMult StatsUtils safeMult ndvProduct parallelism sizeOfGroupingSet LOG LOG debug gop toString cardinality cardinality Math min parentNumRows StatsUtils safeMult ndvProduct parallelism orgParentNumRows StatsUtils safeMult getParentNumRows gop gop getConf getKeys conf parallelism cardinality Math min cardinality orgParentNumRows LOG LOG debug gop toString cardinality
cardinality Math min parentNumRows StatsUtils safeMult ndvProduct parallelism orgParentNumRows StatsUtils safeMult getParentNumRows gop gop getConf getKeys conf parallelism cardinality Math min cardinality orgParentNumRows LOG LOG debug gop toString cardinality cardinality StatsUtils safeMult parentNumRows sizeOfGroupingSet LOG LOG debug gop toString cardinality cardinality Math min parentNumRows getParentNumRows gop gop getConf getKeys conf LOG LOG debug gop toString cardinality
containsGroupingSet cardinality StatsUtils safeMult parentNumRows sizeOfGroupingSet LOG LOG debug gop toString cardinality cardinality Math min parentNumRows getParentNumRows gop gop getConf getKeys conf LOG LOG debug gop toString cardinality GroupByOperator mGop OperatorUtils findMapSideGb gop mGop containsGroupingSet mGop getConf isGroupingSetsPresent containsGroupingSet sizeOfGroupingSet mGop getConf getListGroupingSets size
cardinality Math min parentNumRows getParentNumRows gop gop getConf getKeys conf LOG LOG debug gop toString cardinality GroupByOperator mGop OperatorUtils findMapSideGb gop mGop containsGroupingSet mGop getConf isGroupingSetsPresent containsGroupingSet sizeOfGroupingSet mGop getConf getListGroupingSets size cardinality Math min parentNumRows StatsUtils safeMult ndvProduct sizeOfGroupingSet LOG LOG debug gop toString cardinality cardinality Math min parentNumRows ndvProduct GroupByOperator gOpStats mGop
GroupByOperator mGop OperatorUtils findMapSideGb gop mGop containsGroupingSet mGop getConf isGroupingSetsPresent containsGroupingSet sizeOfGroupingSet mGop getConf getListGroupingSets size cardinality Math min parentNumRows StatsUtils safeMult ndvProduct sizeOfGroupingSet LOG LOG debug gop toString cardinality cardinality Math min parentNumRows ndvProduct GroupByOperator gOpStats mGop gOpStats gOpStats gop orgParentNumRows getParentNumRows gOpStats gOpStats getConf getKeys conf
GroupByOperator mGop OperatorUtils findMapSideGb gop mGop containsGroupingSet mGop getConf isGroupingSetsPresent containsGroupingSet sizeOfGroupingSet mGop getConf getListGroupingSets size cardinality Math min parentNumRows StatsUtils safeMult ndvProduct sizeOfGroupingSet LOG LOG debug gop toString cardinality cardinality Math min parentNumRows ndvProduct GroupByOperator gOpStats mGop gOpStats gOpStats gop orgParentNumRows getParentNumRows gOpStats gOpStats getConf getKeys conf cardinality Math min orgParentNumRows cardinality
StatsUtils updateStats stats cardinality gop parentStats stats parentStats clone parentNumRows stats getNumRows cardinality StatsUtils safeMult parentNumRows sizeOfGroupingSet LOG LOG debug gop toString cardinality cardinality parentNumRows LOG LOG debug gop toString cardinality
outColStats add cs stats setColumnStats outColStats joinRowCount leftUnmatchedRows rightUnmatchedRows inferredRowCount joinRowCount inferredRowCount innerJoinRowCount computeRowCountAssumingInnerJoin rowCounts denom jop jop getConf getConds JoinCondDesc joinCond jop getConf getConds joinCond leftUnmatchedRows calculateUnmatchedRowsForOuter conf rowCountParents get joinKeys get joinStats get distinctUnmatched joinCond rightUnmatchedRows calculateUnmatchedRowsForOuter conf rowCountParents get joinKeys get joinStats get distinctUnmatched
Statistics ps op getStatistics statsState Statistics inferColumnStatsState statsState ps getBasicStatsState rowCount ps getNumRows dataSize ps getDataSize newCrossRowCount StatsUtils safeMult crossRowCount rowCount newCrossDataSize StatsUtils safeAdd StatsUtils safeMult crossDataSize rowCount StatsUtils safeMult dataSize crossRowCount crossRowCount newCrossRowCount crossDataSize newCrossDataSize rowCount maxRowCount maxRowCount rowCount maxDataSize dataSize newDataSize cartesianProduct jop getParentOperators get ReduceSinkOperator ReduceSinkOperator rsOp ReduceSinkOperator jop getParentOperators get
LOG debug jop toString newNumRows Integer pkPos parentsWithPK keySet iterator next ColStatistics csPK parentsWithPK values iterator next Map Integer ColStatistics csFKs getForeignKeyCandidates parents csPK csFKs parents newNumRows getCardinality parents pkPos csPK csFKs jop LOG List String parentIds Lists newArrayList Integer i parentsWithPK keySet parentIds add parents get i toString LOG debug jop toString parentIds parentIds clear Integer i csFKs keySet parentIds add parents get i toString
AnnotateStatsProcCtx aspCtx AnnotateStatsProcCtx procCtx LimitOperator lop LimitOperator nd Operator OperatorDesc parent lop getParentOperators get Statistics parentStats parent getStatistics limit limit lop getConf getLimit parentStats Statistics stats parentStats clone List ColStatistics colStats StatsUtils getColStatisticsUpdatingTableAlias parentStats lop getSchema stats setColumnStats colStats limit parentStats StatsUtils updateStats stats limit lop stats applyRuntimeStats aspCtx getParseContext getContext stats lop lop setStatistics stats
List ColStatistics colStats StatsUtils getColStatisticsUpdatingTableAlias parentStats lop getSchema stats setColumnStats colStats limit parentStats StatsUtils updateStats stats limit lop stats applyRuntimeStats aspCtx getParseContext getContext stats lop lop setStatistics stats LOG LOG debug lop toString stats extendedToString parentStats limit StatsUtils getMaxIfOverflow limit Statistics wcStats parentStats scaleToRowCount limit wcStats applyRuntimeStats aspCtx getParseContext getContext wcStats lop lop setStatistics wcStats LOG
cs cs setColumnName prefixedKey colStats add cs String val String prefixedVal Utilities ReduceField VALUE toString val ExprNodeDesc end colExprMap get prefixedVal end ColStatistics cs StatsUtils getColStatisticsFromExpression conf parentStats end cs cs setColumnName prefixedVal colStats add cs outStats setColumnStats colStats outStats applyRuntimeStats aspCtx getParseContext getContext outStats rop rop setStatistics outStats
parentStats Statistics st parentStats clone udtfFactor HiveConf getFloatVar aspCtx getConf HiveConf ConfVars HIVE_STATS_UDTF_FACTOR numRows parentStats getNumRows udtfFactor dataSize StatsUtils safeMult parentStats getDataSize udtfFactor st setNumRows numRows st setDataSize dataSize List ColStatistics colStatsList st getColumnStats colStatsList ColStatistics colStats colStatsList colStats setNumFalses colStats getNumFalses udtfFactor colStats setNumTrues colStats getNumTrues udtfFactor colStats setNumNulls colStats getNumNulls udtfFactor st setColumnStats colStatsList
HiveConf hconf aspCtx getConf conf Statistics stats conf getStatistics stats op op parent op Statistics parentStats parent getStatistics stats stats parentStats clone stats addBasicStats parentStats stats updateColumnStatsState parentStats getColumnStatsState List ColStatistics colStats StatsUtils getColStatisticsFromExprMap hconf parentStats op getColumnExprMap op getSchema stats addToColumnStats colStats
topNKey Operator OperatorDesc parent topNKey getParentOperators get
topNKey fkJoinInputIndex TopNKeyDesc topNKeyDesc topNKey getConf CommonJoinOperator JoinDesc join CommonJoinOperator JoinDesc topNKey getParentOperators get List Operator OperatorDesc joinInputs join getParentOperators ReduceSinkOperator fkJoinInput ReduceSinkOperator joinInputs get fkJoinInputIndex
TopNKeyOperator topNKey fkJoinInputIndex TopNKeyDesc topNKeyDesc topNKey getConf CommonJoinOperator JoinDesc join CommonJoinOperator JoinDesc topNKey getParentOperators get List Operator OperatorDesc joinInputs join getParentOperators ReduceSinkOperator fkJoinInput ReduceSinkOperator joinInputs get fkJoinInputIndex LOG debug topNKey getName join getName CommonKeyPrefix commonKeyPrefix CommonKeyPrefix map mapUntilColumnEquals topNKeyDesc getKeyColumns join getColumnExprMap topNKeyDesc getColumnSortOrder topNKeyDesc getNullOrder fkJoinInput getConf getKeyCols fkJoinInput getConf getColumnExprMap fkJoinInput getConf getOrder fkJoinInput getConf getNullOrder commonKeyPrefix commonKeyPrefix topNKeyDesc LOG debug topNKey getName join getName fkJoinInput getName TopNKeyDesc newTopNKeyDesc topNKeyDesc combine commonKeyPrefix pushdown TopNKeyOperator copyDown fkJoinInput newTopNKeyDesc topNKeyDesc getKeyColumns commonKeyPrefix
TopNKeyOperator topNKey TopNKeyOperator parent TopNKeyOperator topNKey getParentOperators get parent topNKey
TopNKeyOperator parent TopNKeyOperator topNKey getParentOperators get parent topNKey getConf LOG debug topNKey getName parent getName parent removeChildAndAdoptItsChildren topNKey TopNKeyDesc topNKeyDesc topNKey getConf TopNKeyDesc parentTopNKeyDesc parent getConf CommonKeyPrefix commonKeyPrefix CommonKeyPrefix map topNKeyDesc getKeyColumns topNKeyDesc getColumnSortOrder topNKeyDesc getNullOrder parentTopNKeyDesc getKeyColumns parentTopNKeyDesc getColumnSortOrder parentTopNKeyDesc getNullOrder topNKeyDesc parentTopNKeyDesc topNKeyDesc getKeyColumns commonKeyPrefix pushdownThroughParent topNKey topNKey get LOG debug parent getName topNKey getName topNKey getParentOperators get removeChildAndAdoptItsChildren topNKey parentTopNKeyDesc getKeyColumns commonKeyPrefix
TopNKeyDesc topNKeyDesc topNKey getConf TopNKeyDesc parentTopNKeyDesc parent getConf CommonKeyPrefix commonKeyPrefix CommonKeyPrefix map topNKeyDesc getKeyColumns topNKeyDesc getColumnSortOrder topNKeyDesc getNullOrder parentTopNKeyDesc getKeyColumns parentTopNKeyDesc getColumnSortOrder parentTopNKeyDesc getNullOrder topNKeyDesc parentTopNKeyDesc topNKeyDesc getKeyColumns commonKeyPrefix pushdownThroughParent topNKey topNKey get LOG debug parent getName topNKey getName topNKey getParentOperators get removeChildAndAdoptItsChildren topNKey parentTopNKeyDesc getKeyColumns commonKeyPrefix LOG debug topNKey getName parent getParentOperators get removeChildAndAdoptItsChildren parent topNKeyDesc getKeyColumns commonKeyPrefix parentTopNKeyDesc getKeyColumns commonKeyPrefix topNKeyDesc parentTopNKeyDesc
TopNKeyDesc parentTopNKeyDesc parent getConf CommonKeyPrefix commonKeyPrefix CommonKeyPrefix map topNKeyDesc getKeyColumns topNKeyDesc getColumnSortOrder topNKeyDesc getNullOrder parentTopNKeyDesc getKeyColumns parentTopNKeyDesc getColumnSortOrder parentTopNKeyDesc getNullOrder topNKeyDesc getTopN parentTopNKeyDesc getTopN topNKeyDesc getKeyColumns commonKeyPrefix pushdownThroughParent topNKey topNKey get LOG debug parent getName topNKey getName topNKey getParentOperators get removeChildAndAdoptItsChildren topNKey parentTopNKeyDesc getKeyColumns commonKeyPrefix LOG debug topNKey getName parent getParentOperators get removeChildAndAdoptItsChildren parent topNKeyDesc getKeyColumns commonKeyPrefix parentTopNKeyDesc getKeyColumns commonKeyPrefix topNKeyDesc getTopN parentTopNKeyDesc getTopN LOG debug topNKey getName parent getName topNKeyDesc getTopN parentTopNKeyDesc getTopN topNKey getParentOperators get removeChildAndAdoptItsChildren topNKey
isSupportedType qb getIsQuery qb isCTAS qb isMaterializedView cboCtx type PreCboCtx Type INSERT cboCtx type PreCboCtx Type MULTI_INSERT noBadTokens HiveCalciteUtil validateASTForUnsupportedTokens ast result isSupportedRoot isSupportedType noBadTokens String msg result isSupportedRoot msg isSupportedType msg noBadTokens msg msg msg msg msg substring msg length
msg msg msg msg msg msg substring msg length needToLogMessage STATIC_LOG info msg Pair of msg msg CalcitePlanner canHandleQbForCbo queryProperties conf needToLogMessage msg Pair of msg msg msg substring msg length needToLogMessage
analyzer initCtx ctx analyzer init analyzer aliasToCTEs putAll aliasToCTEs HiveOperation operation queryState getHiveOperation analyzer analyzeInternal createTable queryState setCommandType operation Table table analyzer tableDesc toTable conf Path location table getDataLocation location getFileSystem conf mkdirs location e HiveException e table setMaterializedTable
RelNode optimizedOptiqPlan RelNode modifiedOptimizedOptiqPlan PlanModifierForReturnPath convertOpTree optimizedOptiqPlan resultSchema getQB getTableDesc
URI HiveConf conf String dcPath testMode conf getBoolVar HiveConf ConfVars HIVETESTMODE conf getBoolVar HiveConf ConfVars HIVEEXIMTESTMODE URI uri Path dcPath toUri FileSystem fs FileSystem get uri conf String scheme fs getScheme String authority uri getAuthority String path uri getPath
config setLocks config setAst config setDebug i ctx setExplainConfig config ctx setExplainPlan ASTNode input ASTNode ast getChild config String query ctx getTokenRewriteStream toString input getTokenStartIndex input getTokenStopIndex LOG info query conf unset ValidTxnList VALID_TXNS_KEY
SemiJoinBranchInfo sjInfo procCtx parseContext getRsToSemiJoinBranchInfo get rs List BaseWork rsWorkList procCtx childToWorkMap get rs sjInfo rsWorkList rsWorkList StringBuilder sb StringBuilder BaseWork curWork rsWorkList sb sb append sb append curWork getName SemanticException rs sb toString TableScanOperator ts sjInfo getTsOp LOG debug rs ts BaseWork parentWork rsWorkList get BaseWork childWork procCtx rootToWorkMap get ts
op defaultTinyBufferSize op GroupByOperator GroupByOperator groupByOperator GroupByOperator op groupByOperator groupByOperator result defaultTinyBufferSize Math ceil groupByOperator getStatistics getDataSize defaultTinyBufferSize
String dbname rv getTable getDbName overrideDBName overrideDBName dbname overrideDBName ImportTableDesc tblDesc org apache hadoop hive metastore api Table tblObj rv getTable tblDesc getBaseCreateTableDescFromTable dbname tblObj e HiveException e inReplicationScope replicationSpec replicationSpec tblDesc setReplicationSpec replicationSpec inReplicationScope tblDesc setReplWriteId writeId tblDesc setOwnerName tblObj getOwner
String tblDesc partition conf Map String String partitionSpec EximUtil makePartSpec tblDesc getPartCols partition getValues StorageDescriptor sd partition getSd String location tblDesc location ReplExternalTables externalTableLocation conf partition getSd getLocation
srcs srcs SemanticException ASTErrorUtils getMsg ErrorMsg INVALID_PATH getMsg fromTree fromURI oneSrc srcs oneSrc reparseAndSuperAnalyze table fromURI AcidUtils validateAcidFiles table srcs fileSystem List String bucketCols table getBucketCols bucketCols bucketCols bucketArray table getNumBuckets Arrays fill bucketArray numBuckets table getNumBuckets oneSrc srcs String bucketName oneSrc getPath getName String bucketIdStr Utilities getBucketFileNameFromPathSubString bucketName
colList addAll parts tempTableObj setFields colList tempTableObj setPartCols ArrayList StringBuilder rewrittenQueryStr StringBuilder rewrittenQueryStr append rewrittenQueryStr append getFullTableNameForSQL ASTNode tableTree getChild addPartitionColsToInsert table getPartCols inpPartSpec rewrittenQueryStr rewrittenQueryStr append rewrittenQueryStr append tempTblName HiveConf setVar conf HiveConf ConfVars DYNAMICPARTITIONINGMODE Context rewrittenCtx rewrittenCtx Context conf ctx addSubContext rewrittenCtx
List ExecDriver mrtasks Utilities getMRTasks rootTasks hasNonLocalJob ExecDriver mrtask mrtasks ContentSummary inputSummary Utilities getInputSummary ctx mrtask getWork getMapWork p numReducers getNumberOfReducers mrtask getWork conf estimatedInput globalLimitCtx globalLimitCtx sizePerRow HiveConf getLongVar conf HiveConf ConfVars HIVELIMITMAXROWSIZE estimatedInput globalLimitCtx getGlobalOffset globalLimitCtx getGlobalLimit sizePerRow minSplitSize HiveConf getLongVar conf HiveConf ConfVars MAPREDMINSPLITSIZE estimatedNumMap inputSummary getLength minSplitSize estimatedInput estimatedInput estimatedNumMap
Configuration conf handler getConf Warehouse wh Warehouse conf Path tblPath Path tbl getSd getLocation fs wh getFs tblPath Date now Date SimpleDateFormat sdf SimpleDateFormat String dateString sdf format now String exportPathString MetastoreConf getVar conf MetastoreConf ConfVars METADATA_EXPORT_LOCATION moveMetadataToTrash MetastoreConf getBoolVar conf MetastoreConf ConfVars MOVE_EXPORTED_METADATA_TO_TRASH Path exportPath exportPathString exportPathString exportPath fs getHomeDirectory exportPath Path exportPathString Path metaPath Path exportPath name dateString
child String String String colAlias child getText colAlias
msg LOG info msg qbp getAlias alias QBExpr qbexpr getSubqForAlias alias
print msg LOG info msg qbp getAlias alias QBExpr qbexpr getSubqForAlias alias LOG info msg alias qbexpr print msg
print msg LOG info msg qb qb print msg
LOG debug
oldReplPolicyTree oldReplScope ReplScope childCount oldReplPolicyTree getChildCount assert childCount oldReplScope setDbName oldReplPolicyTree getChild getText
oldReplPolicyTree oldReplScope ReplScope childCount oldReplPolicyTree getChildCount assert childCount oldReplScope setDbName oldReplPolicyTree getChild getText LOG info oldReplScope getDbName oldReplScope getDbName getDbName
ast numChildren ast getChildCount isMetaDataOnly String dbNameOrPattern PlanUtils stripQuotes ast getChild getText
config conf set config getKey config getValue isMetaDataOnly HiveConf getBoolVar conf REPL_DUMP_METADATA_ONLY childIdx dbName db Database database db getDatabase dbName database isMetaDataOnly database
isMetaDataOnly HiveConf getBoolVar conf REPL_DUMP_METADATA_ONLY SemanticException childIdx dbName db dbNameOrPattern Database database db getDatabase dbName database isMetaDataOnly database LOG error dbNameOrPattern SemanticException ErrorMsg REPL_DATABASE_IS_NOT_SOURCE_OF_REPLICATION getMsg database
assert sourceDbNameOrPattern Path loadPath getCurrentLoadPath Warehouse wh Warehouse conf Path filePath wh getWhRoot filePath conf conf setBoolVar REPL_ENABLE_MOVE_OPTIMIZATION LOG info filePath toString Exception e SemanticException e getMessage e conf sourceDbNameOrPattern conf conf Exception ErrorMsg REPL_FAILED_WITH_NON_RECOVERABLE_ERROR getMsg loadPath DumpMetaData dmd DumpMetaData loadPath conf
Warehouse wh Warehouse conf Path filePath wh getWhRoot filePath conf conf setBoolVar REPL_ENABLE_MOVE_OPTIMIZATION LOG info filePath toString Exception e SemanticException e getMessage e conf conf conf Exception ErrorMsg REPL_FAILED_WITH_NON_RECOVERABLE_ERROR getMsg loadPath DumpMetaData dmd DumpMetaData loadPath conf evDump dmd LOG debug loadPath
ast initReplStatus ast String dbNameOrPattern replScope getDbName String replLastId getReplStatus dbNameOrPattern prepareReturnValues Collections singletonList replLastId setFetchTask createFetchTask
schema LOG debug schema
Table getTable db throwException SemanticException TableName tableName tableName tableName Table mTable mTable db getTable tableName getDb tableName getTable throwException e LOG error tableName getNotEmptyDbTable e getMessage SemanticException ErrorMsg INVALID_TABLE getMsg tableName getNotEmptyDbTable e e
Context rewrittenCtx rewrittenCtx Context conf rewrittenCtx setHDFSCleanup ctx addSubContext rewrittenCtx SemanticException ErrorMsg UPDATEDELETE_IO_ERROR getMsg rewrittenCtx setExplainConfig ctx getExplainConfig rewrittenCtx setExplainPlan ctx isExplainPlan rewrittenCtx setStatsSource ctx getStatsSource rewrittenCtx setPlanMapper ctx getPlanMapper rewrittenCtx setIsUpdateDeleteMerge rewrittenCtx setCmd rewrittenQueryStr toString ASTNode rewrittenTree
ast ScheduledQueryMaintenanceWork work ScheduledQueryMaintenanceRequestType type translateAstType ast getToken getType ScheduledQuery parsedSchq interpretAstNode ast ScheduledQuery schq fillScheduledQuery type parsedSchq checkAuthorization type schq
ast String scheduleName ast getChild getText String clusterNamespace conf getVar ConfVars HIVE_SCHEDULED_QUERIES_NAMESPACE
analyzer initCtx ctx analyzer init analyzer aliasToCTEs putAll aliasToCTEs HiveOperation operation queryState getHiveOperation analyzer analyzeInternal createTable queryState setCommandType operation Table table analyzer tableDesc toTable conf Path location table getDataLocation location getFileSystem conf mkdirs location e HiveException e table setMaterializedTable
ast ParseDriver pd ParseDriver String queryHintStr ast getText
List ExprNodeDesc args ArrayList ExprNodeDesc args add joinKeys i ExprNodeDesc nextExpr ExprNodeGenericFuncDesc newInstance FunctionRegistry getFunctionInfo getGenericUDF args filterPred filterPred nextExpr ExprNodeDescUtils mergePredicates filterPred nextExpr filterPred input OpParseContext inputCtx opParseCtx get input RowResolver inputRR inputCtx getRowResolver input FilterOperator FilterOperator f FilterOperator input List ExprNodeDesc preds ArrayList ExprNodeDesc preds add f getConf getPredicate preds add filterPred
Operator genSelectPlan dest qb Operator input Operator inputForSelectStar ASTNode selExprList qb getParseInfo getSelForClause dest Operator op genSelectPlan dest selExprList qb input inputForSelectStar
unparseTranslator addIdentifierTranslation ASTNode udtfExpr getChild genExprNodeDescRegex ASTNode udtfExpr getChild colList inputRR starRR pos out_rwsch qb getAliases selExprList SemanticException generateErrorMessage ASTNode selExprList getChild ErrorMsg UDTF_MULTIPLE_EXPR getMsg ASTNode selExpr ASTNode selExprList getChild posn i i selExpr i ASTNode selExprChild ASTNode selExpr getChild i selExprChild unescapeIdentifier selExprChild getText unparseTranslator addIdentifierTranslation selExprChild selExprChild udtfTableAlias unescapeIdentifier selExprChild getChild getText
unparseTranslator addIdentifierTranslation ASTNode udtfExpr getChild genExprNodeDescRegex ASTNode udtfExpr getChild colList inputRR starRR pos out_rwsch qb getAliases selExprList SemanticException generateErrorMessage ASTNode selExprList getChild ErrorMsg UDTF_MULTIPLE_EXPR getMsg ASTNode selExpr ASTNode selExprList getChild posn i i selExpr i ASTNode selExprChild ASTNode selExpr getChild i selExprChild unescapeIdentifier selExprChild getText unparseTranslator addIdentifierTranslation selExprChild selExprChild udtfTableAlias unescapeIdentifier selExprChild getChild getText
expr expr getChild inputRR unescapeIdentifier expr getChild getChild getText toLowerCase inputRR unescapeIdentifier expr getChild getText pos genExprNodeDescRegex unescapeIdentifier expr getChild getText unescapeIdentifier expr getChild getChild getText toLowerCase expr colList inputRR starRR pos out_rwsch qb getAliases TypeCheckCtx tcCtx TypeCheckCtx inputRR isCBOExecuted tcCtx setAllowStatefulFunctions tcCtx setAllowDistinctFunctions isCBOExecuted qb getParseInfo expr rewriteGroupingFunctionAST getGroupByForClause qb getParseInfo dest expr cubeRollupGrpSetPresent ExprNodeDesc exp genExprNodeDesc expr inputRR tcCtx String recommended recommendName exp colAlias recommended recommended out_rwsch recommended colAlias recommended colList add exp ColumnInfo colInfo ColumnInfo getColumnInternalName pos exp getWritableObjectInspector tabAlias colInfo setSkewedCol exp ExprNodeColumnDesc ExprNodeColumnDesc exp isSkewedCol
newColList add targetCol2Projection get f ColumnInfo ci targetCol2ColumnInfo get f ci setInternalName getColumnInternalName colListPos newOutputRR put ci getTabAlias ci getInternalName ci assert colNameToDefaultVal ExprNodeDesc exp colNameToDefaultVal f String defaultValue colNameToDefaultVal get f ParseDriver parseDriver ParseDriver ASTNode defValAst parseDriver parseExpression defaultValue exp ExprNodeTypeCheck genExprNode defValAst TypeCheckCtx get defValAst e SemanticException defaultValue e getMessage
dest_tab getSortCols dest_tab getSortCols sortCols getSortCols dest qb dest_tab table_desc input sortOrders getSortOrders dest_tab SemanticException ErrorMsg TBL_SORTED_NOT_BUCKETED getErrorCodedMsg dest_tab getCompleteName HiveConf conf HiveConf ConfVars dest dest sortCols ArrayList expr sortCols add expr clone sortOrders ArrayList sortCols sortOrders add DirectionUtils ASCENDING_CODE Operation acidOp AcidUtils isFullAcidTable dest_tab getAcidType table_desc getOutputFileFormatClass dest AcidUtils isInsertOnlyTable dest_tab Operation NOT_ACID maxReducers conf getIntVar HiveConf ConfVars MAXREDUCERS
Operator Operator input offset limit RowResolver inputRR opParseCtx get input getRowResolver LimitDesc limitDesc LimitDesc offset limit globalLimitCtx setLastReduceLimitDesc limitDesc Operator limitMap putOpInsertMap OperatorFactory getAndMakeChild limitDesc RowSchema inputRR getColumnInfos input inputRR
ASTNode node ASTNode hint ASTNode node hint getChild hint getChild result result HashMap Tree args hint getChild args String text args getChild getText text result curIdx curIdx args curIdx parseSingleSemiJoinHint args curIdx result
ASTNode selExprList qbp getSelForClause dest selExprList selExprList selExprList getChild ASTNode node ASTNode selExprList getChild getChild node curr genSelectPlan dest qb curr curr RowResolver rr opParseCtx get curr getRowResolver qbp setSelExprForClause dest genSelectDIAST rr curr genGroupByPlanMapAggrNoSkew dest qb curr curr genGroupByPlanMapAggr2MR dest qb curr curr genGroupByPlan2MR dest qb curr
ExprNodeDesc numeratorExpr ExprNodeConstantDesc TypeInfoFactory intTypeInfo Integer valueOf ts getNumerator ExprNodeDesc denominatorExpr ExprNodeConstantDesc TypeInfoFactory intTypeInfo Integer valueOf ts getDenominator ExprNodeDesc intMaxExpr ExprNodeConstantDesc TypeInfoFactory intTypeInfo Integer valueOf Integer MAX_VALUE List ExprNodeDesc args ArrayList ExprNodeDesc planExpr args add planExpr col ColumnInfo ci rwsch get alias col args add ExprNodeColumnDesc ci expr ts args add genExprNodeDesc expr rwsch ExprNodeDesc equalsExpr ExprNodeDesc hashfnExpr ExprNodeGenericFuncDesc TypeInfoFactory intTypeInfo bucketingVersion GenericUDFMurmurHash GenericUDFHash args
ExprNodeDesc intMaxExpr ExprNodeConstantDesc TypeInfoFactory intTypeInfo Integer valueOf Integer MAX_VALUE List ExprNodeDesc args ArrayList ExprNodeDesc planExpr args add planExpr col ColumnInfo ci rwsch get alias col args add ExprNodeColumnDesc ci expr args add genExprNodeDesc expr rwsch ExprNodeDesc equalsExpr ExprNodeDesc hashfnExpr ExprNodeGenericFuncDesc TypeInfoFactory intTypeInfo bucketingVersion GenericUDFMurmurHash GenericUDFHash args LOG info hashfnExpr ExprNodeDesc andExpr ExprNodeTypeCheck getExprNodeDefaultExprProcessor getFuncExprNodeDesc hashfnExpr intMaxExpr
planExpr args add planExpr col ColumnInfo ci rwsch get alias col args add ExprNodeColumnDesc ci expr args add genExprNodeDesc expr rwsch ExprNodeDesc equalsExpr ExprNodeDesc hashfnExpr ExprNodeGenericFuncDesc TypeInfoFactory intTypeInfo bucketingVersion GenericUDFMurmurHash GenericUDFHash args LOG info hashfnExpr ExprNodeDesc andExpr ExprNodeTypeCheck getExprNodeDefaultExprProcessor getFuncExprNodeDesc hashfnExpr intMaxExpr LOG info andExpr ExprNodeDesc modExpr ExprNodeTypeCheck getExprNodeDefaultExprProcessor getFuncExprNodeDesc andExpr denominatorExpr
col ColumnInfo ci rwsch get alias col args add ExprNodeColumnDesc ci expr args add genExprNodeDesc expr rwsch ExprNodeDesc equalsExpr ExprNodeDesc hashfnExpr ExprNodeGenericFuncDesc TypeInfoFactory intTypeInfo bucketingVersion GenericUDFMurmurHash GenericUDFHash args LOG info hashfnExpr ExprNodeDesc andExpr ExprNodeTypeCheck getExprNodeDefaultExprProcessor getFuncExprNodeDesc hashfnExpr intMaxExpr LOG info andExpr ExprNodeDesc modExpr ExprNodeTypeCheck getExprNodeDefaultExprProcessor getFuncExprNodeDesc andExpr denominatorExpr LOG info modExpr LOG info numeratorExpr
FilterDesc filterDesc FilterDesc samplePredicate filterDesc setGenerated op OperatorFactory getAndMakeChild filterDesc RowSchema rwsch getColumnInfos top testMode conf getBoolVar ConfVars HIVETESTMODE testMode String tabName tab getTableName String unSampleTblList conf getVar ConfVars HIVETESTMODENOSAMPLE String unSampleTbls unSampleTblList split unsample String unSampleTbls tabName unsample unsample numBuckets tab getNumBuckets
aliasToOpInfo put ptfAlias lastPTFOp genLateralViewPlans aliasToOpInfo qb qb getParseInfo getJoinExpr ASTNode joinExpr qb getParseInfo getJoinExpr joinExpr QBJoinTree joinTree genUniqueJoinTree qb joinExpr aliasToOpInfo qb setQbJoinTree joinTree QBJoinTree joinTree genJoinTree qb joinExpr aliasToOpInfo qb setQbJoinTree joinTree Set String dests qb getParseInfo getClauseNames dests joinTree String dest dests iterator next ASTNode whereClause qb getParseInfo getWhrForClause dest whereClause
aliasIndex index ASTNode tableTree ASTNode astNode getChild String tabIdName getUnescapedName tableTree String alias aliasIndex alias unescapeIdentifier astNode getChild aliasIndex getText alias getUnescapedUnqualifiedTableName tableTree tabIdName Table table table getTableObjectByName tabIdName SemanticException
transactionalInQuery wasAcidChecked checkAcidTxnManager tbl wasAcidChecked WriteEntity writeEntity WriteEntity Type type writeEntity getType type WriteEntity Type type WriteEntity Type String conflictingArchive Partition usedp writeEntity getPartition Table tbl usedp getTable tbl transactionalInQuery wasAcidChecked checkAcidTxnManager tbl
bs bs hasAmt hasAmt ASTNode amtNode ASTNode node getChild amtNode bs setAmt BoundarySpec UNBOUNDED_AMOUNT amt Integer parseInt amtNode getText amt SemanticException amt amt
LOG info LOG info LOG info QueryResultsCache incrementMetric MetricsConstant QC_INVALID_FOR_CACHING LOG info getInvalidResultCacheReason QueryResultsCache incrementMetric MetricsConstant QC_INVALID_FOR_CACHING List Table nonTransactionalTables getNonTransactionalTables
sb append HiveUtils unparseIdentifier colName conf sb StringBuilder sb append maskAndFilterInfo maskAndFilterInfo Iterator VirtualColumn vcs VirtualColumn getRegistry conf iterator vcs VirtualColumn vc vcs next sb append vc getName sb append sb append HiveUtils unparseIdentifier privObject getDbname conf sb append sb append HiveUtils unparseIdentifier privObject getObjectName conf sb append maskAndFilterInfo additionalTabInfo String filter privObject getRowFilterExpression
procCtx Set Set connectTerminalOps procCtx parseContext cycleFree cycleFree cycleFree Set Set Operator components getComponents procCtx Set Operator components LOG LOG debug Operator
SemanticGraphWalker ogw GenTezWorkWalker disp procCtx ogw startWalking topNodes procCtx w w setReservedMemoryMB conf getLongVar ConfVars HIVECONVERTJOINNOCONDITIONALTASKTHRESHOLD indexForTezUnion w procCtx GenTezUtils removeUnionOperators procCtx w indexForTezUnion fileSink procCtx GenTezUtils processFileSink procCtx fileSink pCtx getRsToRuntimeValuesInfoMap size rs pCtx getRsToRuntimeValuesInfoMap GenTezUtils processDynamicSemiJoinPushDownOperator procCtx pCtx getRsToRuntimeValuesInfoMap get rs rs LOG debug procCtx eventOperatorSet size procCtx eventOperatorSet
parent parent TableScanOperator tsOps add TableScanOperator parent parent parent getParentOperators get ParseContext pctx procCtx parseContext Set ReduceSinkOperator rsSet HashSet pctx getRsToSemiJoinBranchInfo keySet TableScanOperator ts tsOps ReduceSinkOperator rs rsSet SemiJoinBranchInfo sjInfo pctx getRsToSemiJoinBranchInfo get rs sjInfo ts sjInfo sjInfo SemanticException rs ts
procCtx Map SemanticRule SemanticNodeProcessor opRules LinkedHashMap opRules put RuleRegExp GroupByOperator getOperatorName ReduceSinkOperator getOperatorName GroupByOperator getOperatorName ReduceSinkOperator getOperatorName SemiJoinRemovalProc opRules put RuleRegExp AppMasterEventOperator getOperatorName DynamicPruningRemovalRedundantProc SemiJoinRemovalContext ctx SemiJoinRemovalContext procCtx parseContext SemanticDispatcher disp DefaultRuleDispatcher opRules ctx List Node topNodes ArrayList Node topNodes addAll procCtx parseContext getTopOps values SemanticGraphWalker ogw PreOrderOnceWalker disp ogw startWalking topNodes Map ctx
topOps addAll procCtx parseContext getTopOps values Set Operator unionOps HashSet Map ReduceSinkOperator TableScanOperator sjToRemove HashMap Operator parent topOps Deque Operator deque LinkedList deque add parent deque Operator op deque pollLast op unionOps op unionOps add op removeSemiJoinEdges op procCtx sjToRemove deque addAll op getChildOperators sjToRemove Map ReduceSinkOperator TableScanOperator sjToRemove
Map TableScanOperator List MapJoinOperator probeDecodeMJoins HashMap Operator parent Deque Operator deque LinkedList deque add parent deque Operator op deque pollLast op op MapJoinOperator op TableScanOperator parent probeDecodeMJoins deque addAll op getChildOperators TableScanOperator
op op TableScanOperator procCtx parseContext deque addAll op getChildOperators procCtx TableScanOperator semiEntry LOG LOG debug OperatorUtils getOpNamePretty semiEntry getKey OperatorUtils getOpNamePretty semiEntry getValue GenTezUtils removeBranch semiEntry getKey GenTezUtils removeSemiJoinOperator procCtx parseContext semiEntry getKey semiEntry getValue procCtx TableScanOperator TableScanOperator ProbeDecodeContext tsCntx
semiJoinKeyIsPK StatsUtils inferForeignKey selColStat tsColStat semiJoinKeyIsPK selColSourceNdv keyDomainCardinality selColSourceNdv selColSourceNdv keyDomainCardinality selColSourceNdv tsColStat getCountDistint StatsUtils selColStat StatsUtils tsColStat range ColStatistics Range combinedRange StatsUtils combineRange selColStat getRange tsColStat getRange combinedRange range StatsUtils getRangeDelta combinedRange range StatsUtils getRangeDelta selColStat getRange StatsUtils getRangeDelta tsColStat getRange keyDomainCardinality Math min keyDomainCardinality range
sel selExpr filStats tsExpr netBenefit benefit getBloomFilterBenefit sel selExpr filStats tsExpr benefit filStats cost getBloomFilterCost sel cost filDataSize filStats getNumRows netBenefit Math max benefit cost filDataSize
SortedSet ReduceSinkOperator semiJoinRsOps TreeSet rsOpComp semiJoinRsOps addAll map keySet ListMultimap FilterOperator SemijoinOperatorInfo globalReductionFactorMap ArrayListMultimap create semiJoinRsOps Map FilterOperator SemijoinOperatorInfo reductionFactorMap HashMap SortedSet ReduceSinkOperator semiJoinRsOpsNewIter TreeSet rsOpComp ReduceSinkOperator rs semiJoinRsOps SemiJoinBranchInfo sjInfo map get rs sjInfo sjInfo SelectOperator sel OperatorUtils ancestor rs SelectOperator TableScanOperator ts sjInfo getTsOp RuntimeValuesInfo rti procCtx parseContext getRsToRuntimeValuesInfoMap get rs List ExprNodeDesc targetColumns rti getTargetColumns List ExprNodeDesc sourceColumns sel getConf getColList subList targetColumns size
adjustedStatsMap put filterOperator filterStats reductionFactor computeBloomFilterNetBenefit sel sourceColumns filterStats targetColumns reductionFactor semijoinRsToRemove add rs filterStats ImmutableSet Builder String colNames ImmutableSet builder tsExpr targetColumns tsExpr ExprNodeFieldDesc LOG debug tsExpr ExprNodeFieldDesc tsExpr getDesc colNames add ExprNodeDescUtils getColumnExpr tsExpr getColumn SemijoinOperatorInfo prevResult reductionFactorMap get filterOperator prevResult prevResult reductionFactor reductionFactor
semijoinRsToRemove add rs filterStats ImmutableSet Builder String colNames ImmutableSet builder tsExpr tsExpr ExprNodeFieldDesc LOG debug tsExpr ExprNodeFieldDesc tsExpr getDesc colNames add ExprNodeDescUtils getColumnExpr tsExpr getColumn SemijoinOperatorInfo prevResult reductionFactorMap get filterOperator prevResult prevResult reductionFactor reductionFactor reductionFactorMap put filterOperator SemijoinOperatorInfo rs filterOperator filterStats colNames build reductionFactor semiJoinRsOpsNewIter add prevResult rsOperator LOG
colNames add ExprNodeDescUtils getColumnExpr tsExpr getColumn SemijoinOperatorInfo prevResult reductionFactorMap get filterOperator prevResult prevResult reductionFactor reductionFactor reductionFactorMap put filterOperator SemijoinOperatorInfo rs filterOperator filterStats colNames build reductionFactor semiJoinRsOpsNewIter add prevResult rsOperator LOG LOG debug OperatorUtils getOpNamePretty prevResult rsOperator semiJoinRsOpsNewIter add rs LOG LOG debug OperatorUtils getOpNamePretty rs reductionFactorMap put filterOperator SemijoinOperatorInfo rs filterOperator filterStats colNames build reductionFactor SemijoinOperatorInfo reductionFactorMap
LOG LOG debug OperatorUtils getOpNamePretty prevResult rsOperator semiJoinRsOpsNewIter add rs LOG LOG debug OperatorUtils getOpNamePretty rs reductionFactorMap put filterOperator SemijoinOperatorInfo rs filterOperator filterStats colNames build reductionFactor SemijoinOperatorInfo roi reductionFactorMap newNumRows roi reductionFactor roi filterStats getNumRows LOG LOG debug roi filterOperator roi filterStats LOG debug newNumRows roi filterStats getNumRows StatsUtils updateStats roi filterStats newNumRows roi filterOperator roi colNames LOG
nDVs colStatisticsSJ getCountDistint nDVs RuntimeValuesInfo rti procCtx parseContext getRsToRuntimeValuesInfoMap get rs ExprNodeDesc tsExpr rti getTargetColumns get FilterOperator fil FilterOperator ts getChildOperators get Statistics filStats fil getStatistics filStats String colName ExprNodeDescUtils extractColName tsExpr ColStatistics colStatisticsTarget filStats getColumnStatisticsFromColName colName colStatisticsTarget nDVsOfTS colStatisticsTarget getCountDistint nDVsOfTSFactored nDVsOfTS procCtx conf getFloatVar ConfVars TEZ_DYNAMIC_SEMIJOIN_REDUCTION_FOR_DPP_FACTOR
RuntimeValuesInfo rti procCtx parseContext getRsToRuntimeValuesInfoMap get rs ExprNodeDesc tsExpr rti getTargetColumns get FilterOperator fil FilterOperator ts getChildOperators get Statistics filStats fil getStatistics filStats String colName ExprNodeDescUtils extractColName tsExpr ColStatistics colStatisticsTarget filStats getColumnStatisticsFromColName colName colStatisticsTarget nDVsOfTS colStatisticsTarget getCountDistint nDVsOfTSFactored nDVsOfTS procCtx conf getFloatVar ConfVars TEZ_DYNAMIC_SEMIJOIN_REDUCTION_FOR_DPP_FACTOR nDVsOfTSFactored nDVs LOG LOG debug nDVs nDVsOfTS nDVsOfTSFactored rs sjInfo getTsOp
useRegularCopy regularCopy sourceFs srcFiles useRegularCopy srcFiles clear srcFiles add ReplChangeManager FileInfo sourceFs origSrcPtah doCopyRetry sourceFs srcFiles destRoot proxyUser useRegularCopy overwrite Map FileSystem Map Path List ReplChangeManager FileInfo map fsToFileMap srcFiles destRoot Map FileSystem Map Path List ReplChangeManager FileInfo entry map Map Path List ReplChangeManager FileInfo destMap entry getValue Map Path List ReplChangeManager FileInfo destMapEntry destMap Path destination destMapEntry getKey List ReplChangeManager FileInfo fileInfoList destMapEntry getValue sourceFs fileInfoList get getSourcePath getFileSystem hiveConf destination destination hiveConf
sourceFs List ReplChangeManager FileInfo srcFileList Path destination proxyUser useRegularCopy overwrite repeat isCopyError List Path pathList Lists transform srcFileList ReplChangeManager FileInfo getEffectivePath pathList repeat repeat pathList getFilesToRetry sourceFs srcFileList destination isCopyError pathList LOG info repeat pathList isCopyError doCopyOnce sourceFs pathList destination useRegularCopy proxyUser overwrite isCopyError
repeat pathList getFilesToRetry sourceFs srcFileList destination isCopyError pathList LOG info repeat pathList isCopyError doCopyOnce sourceFs pathList destination useRegularCopy proxyUser overwrite isCopyError e LOG info e repeat e sleepTime FileUtils getSleepTime repeat
LOG info repeat pathList isCopyError doCopyOnce sourceFs pathList destination useRegularCopy proxyUser overwrite isCopyError e LOG info e repeat e sleepTime FileUtils getSleepTime repeat LOG info sleepTime repeat Thread sleep sleepTime
LOG info e repeat e sleepTime FileUtils getSleepTime repeat LOG info sleepTime repeat Thread sleep sleepTime timerEx LOG info timerEx getMessage proxyUser FileSystem closeAllForUGI Utils getUGI FileSystem closeAllForUGI proxyUser sourceFs pathList get getFileSystem hiveConf
srcFile Path srcPath srcFile getEffectivePath destinationFs destination srcFile destinationFs delete destination srcFile setIsUseSourcePath srcFile setCopyDone srcFile srcFile setIsUseSourcePath srcPath srcFile getEffectivePath srcPath
Path srcPath srcFile getEffectivePath destinationFs destination srcFile destinationFs delete destination srcFile setIsUseSourcePath srcFile setCopyDone srcFile srcFile setIsUseSourcePath srcPath srcFile getEffectivePath srcPath LOG error srcFile getSourcePath HiveFatalException ErrorMsg REPL_FILE_MISSING_FROM_SRC_AND_CM_PATH getMsg
size numberOfFiles result size maxCopyFileSize numberOfFiles maxNumberOfFiles result
size numberOfFiles result size maxCopyFileSize numberOfFiles maxNumberOfFiles result LOG info size maxCopyFileSize
queue put partition e RuntimeException e producer shutdown ThreadFactory namingThreadFactory ThreadFactoryBuilder setNameFormat build ExecutorService consumer Executors newFixedThreadPool nThreads namingThreadFactory producer queue Partition partition queue poll TimeUnit SECONDS partition LOG debug partition getName consumer String partitionName partition getName String threadName Thread currentThread getName
producer shutdown ThreadFactory namingThreadFactory ThreadFactoryBuilder setNameFormat build ExecutorService consumer Executors newFixedThreadPool nThreads namingThreadFactory producer queue Partition partition queue poll TimeUnit SECONDS partition LOG debug partition getName consumer String partitionName partition getName String threadName Thread currentThread getName LOG debug threadName partitionName List Path dataPathList Utils getDataPathList partition getDataLocation forReplicationSpec hiveConf
add String partitionName partition getName String threadName Thread currentThread getName LOG debug threadName partitionName List Path dataPathList Utils getDataPathList partition getDataLocation forReplicationSpec hiveConf Path rootDataDumpDir isExportTask paths partitionMetadataExportDir partitionName paths partitionDataExportDir partitionName FileOperations dataPathList rootDataDumpDir distCpDoAsUser hiveConf mmCtx export isExportTask dataCopyAtLoad Path dataDumpDir Path paths dataExportRootDir partitionName LOG debug threadName partitionName isExportTask dataCopyAtLoad fileList add DataCopyPath forReplicationSpec partition getDataLocation dataDumpDir convertToString e RuntimeException e getMessage e
hiveDb String dbName String uniqueKey Database database hiveDb getDatabase dbName database Map String String params database getParameters params params uniqueKey params remove uniqueKey database setParameters params hiveDb alterDatabase dbName database
withinContext oldName oldTableInBootstrapList withinContext removeFromListOfTablesForBootstrap oldName withinContext
oldTableInBootstrapList withinContext removeFromListOfTablesForBootstrap oldName withinContext newName oldTableInBootstrapList scenario Scenario DROP LOG info oldName newName oldTableInBootstrapList withinContext addToListOfTablesForBootstrap newName LOG info withinContext newName
Set String bootstrapTableList ReplScope oldReplScope bootstrapTableList oldReplScope withinContext before getTableName LOG debug before getTableName bootstrapTableList withinContext getTablesForBootstrap oldReplScope withinContext oldReplScope withinContext bootstrapTableList oldReplScope withinContext withinContext before
bootstrapTableList withinContext getTablesForBootstrap oldReplScope withinContext oldReplScope withinContext bootstrapTableList oldReplScope withinContext withinContext before after LOG info after getTableName String oldName before getTableName String newName after getTableName needDump withinContext oldReplScope needDump handleRenameForReplacePolicy withinContext oldName newName withinContext
String payload eventMessageAsJSON withinContext replicatingAcidEvents withinContext LOG debug replicatingAcidEvents withinContext LOG debug replicatingAcidEvents List WriteEventInfo writeEventInfoList replicatingAcidEvents writeEventInfoList getAllWriteEventInfo withinContext numEntry writeEventInfoList writeEventInfoList size numEntry eventMessage addWriteEventInfo writeEventInfoList
LOG info fromEventId eventMessageAsJSON
Path exportToFile Path exportRootDataDir EximUtil FILES_NAME
MetaData rv EximUtil readMetaData metadataPath getFileSystem context hiveConf metadataPath tableType rv getTable getTableType alterTableMessage context tableType alterTableMessage getTableObjAfter getTableType writeId alterTableMessage getWriteId msg context tableType msg getTableObj getTableType writeId msg getWriteId isExternalTable tableType TableType EXTERNAL_TABLE equals Enum valueOf TableType tableType Tuple isExternalTable writeId
ReduceWork root Preconditions checkArgument root getParentOperators isEmpty ReduceWork reduceWork ReduceWork sequenceNumber
MapWork root Preconditions checkArgument root getParentOperators isEmpty MapWork mapWork MapWork sequenceNumber
context pruningSink SparkPartitionPruningSinkDesc desc pruningSink getConf Path outputBase getDPPOutputPath context parseContext getContext String sourceId pruningSink getUniqueId desc setPath Path outputBase sourceId SparkPartitionPruningSinkDesc targetInfo desc TableScanOperator ts targetInfo tableScan MapWork targetWork MapWork context rootToWorkMap get ts Preconditions checkNotNull targetWork ts targetWork targetWork setTmpPathForPartitionPruning outputBase
nd procContext GenSparkProcContext context GenSparkProcContext procContext Preconditions checkArgument context Preconditions checkArgument context currentTask Preconditions checkArgument context currentRootOperator SuppressWarnings Operator OperatorDesc operator Operator OperatorDesc nd Operator root context currentRootOperator
nd procContext GenSparkProcContext context GenSparkProcContext procContext Preconditions checkArgument context Preconditions checkArgument context currentTask Preconditions checkArgument context currentRootOperator SuppressWarnings Operator OperatorDesc operator Operator OperatorDesc nd Operator root context currentRootOperator LOG debug root
workItems add work context childToWorkMap put operator workItems context childToWorkMap get operator add work context mj context LOG debug mj context mapJoinWorkMap mj List BaseWork workItems LinkedList BaseWork workItems add work context mapJoinWorkMap put mj workItems context mapJoinWorkMap get mj add work context linkOpWithWorkMap mj Map BaseWork SparkEdgeProperty linkWorkMap context linkOpWithWorkMap get mj
LOG debug r ReduceSinkOperator OperatorFactory getAndMakeChild r getCompilationOpContext ReduceSinkDesc r getConf clone r getParentOperators r getConf setOutputName work getName context currentMapJoinOperators clear root Preconditions checkArgument work ReduceWork work getClass getName ReduceWork reduceWork ReduceWork work parent root getParentOperators Preconditions checkArgument parent ReduceSinkOperator parent getClass getName ReduceSinkOperator rsOp ReduceSinkOperator parent SparkEdgeProperty edgeProp GenSparkUtils getEdgeProperty context conf rsOp reduceWork rsOp getConf setOutputName reduceWork getName GenMapRedUtils setKeyAndValueDesc reduceWork rsOp context leafOpToFollowingWorkInfo put rsOp Pair of edgeProp reduceWork LOG debug parent root
procCtx cycleFree cycleFree cycleFree Set Set Operator components getComponents procCtx Set Operator components LOG LOG debug Operator
ObjectOutputStream out FSDataOutputStream fsout fsout fs create path numOfRepl out ObjectOutputStream BufferedOutputStream fsout out writeInt conf getTargetInfos size info conf getTargetInfos out writeUTF info columnName buffer writeTo out e fs delete path LOG warn e
Mode udafMode SemanticAnalyzer groupByDescModeToUDAFMode GroupByDesc Mode COMPLETE isDistinct List ObjectInspector aggParameterOIs ArrayList aggParameter aggParameterOIs add createObjectInspector aggParameter aggregateName FunctionRegistry aggregateName FunctionRegistry GenericUDAFEvaluator genericUDAFEvaluator FunctionRegistry getGenericWindowingEvaluator aggregateName aggParameterOIs isDistinct isAllColumns GenericUDAFInfo udaf SemanticAnalyzer getGenericUDAFInfo2 genericUDAFEvaluator udafMode aggParameterOIs returnType ListTypeInfo udaf returnType getListElementTypeInfo GenericUDAFEvaluator genericUDAFEvaluator SemanticAnalyzer getGenericUDAFEvaluator2 aggregateName aggParameterOIs isDistinct isAllColumns assert genericUDAFEvaluator GenericUDAFInfo udaf SemanticAnalyzer getGenericUDAFInfo2 genericUDAFEvaluator udafMode aggParameterOIs FunctionRegistry aggregateName returnType ListTypeInfo udaf returnType getListElementTypeInfo
threshold HiveConf getLongVar conf HiveConf ConfVars HIVESMALLTABLESFILESIZE Long bigTableSize Long smallTablesSize Map Entry Task Set String nextTask Map Entry Task Set String entry Set String aliases entry getValue sumOfOthers Utilities sumOfExcept aliasToKnownSize participants aliases sumOfOthers sumOfOthers threshold aliasSize Utilities sumOf aliasToKnownSize aliases bigTableSize aliasSize bigTableSize nextTask entry bigTableSize aliasSize smallTablesSize sumOfOthers nextTask
Map String String jobProperties LinkedHashMap String String Map String String jobSecrets LinkedHashMap String String storageHandler configureInputJobProperties tableDesc jobProperties e LOG info e storageHandler configureTableJobProperties tableDesc jobProperties storageHandler configureInputJobCredentials tableDesc jobSecrets e LOG info storageHandler configureOutputJobProperties tableDesc jobProperties
List OpTreeSignature sig e getAll OpTreeSignature List RelTreeSignature rSig e getAll RelTreeSignature stat size sig size StringBuffer sb StringBuffer sb append String format stat size sig size s stat sb append s sb append OpTreeSignature s sig sb append s sb append LOG debug sb toString stat size sig size e getAll size
HiveStorageHandler storageHandler tbl getStorageHandler storageHandler HiveStoragePredicateHandler tableScanDesc setFilterExpr originalPredicate originalPredicate HiveStoragePredicateHandler predicateHandler HiveStoragePredicateHandler storageHandler JobConf jobConf JobConf owi getParseContext getConf Utilities setColumnNameList jobConf tableScanOp Utilities setColumnTypeList jobConf tableScanOp Utilities copyTableJobPropertiesToConf Utilities getTableDesc tbl jobConf e SemanticException e Deserializer deserializer tbl getDeserializer HiveStoragePredicateHandler DecomposedPredicate decomposed predicateHandler decomposePredicate jobConf deserializer originalPredicate decomposed
tableScanDesc setFilterExpr originalPredicate originalPredicate HiveStoragePredicateHandler predicateHandler HiveStoragePredicateHandler storageHandler JobConf jobConf JobConf owi getParseContext getConf Utilities setColumnNameList jobConf tableScanOp Utilities setColumnTypeList jobConf tableScanOp Utilities copyTableJobPropertiesToConf Utilities getTableDesc tbl jobConf e SemanticException e Deserializer deserializer tbl getDeserializer HiveStoragePredicateHandler DecomposedPredicate decomposed predicateHandler decomposePredicate jobConf deserializer originalPredicate decomposed LOG LOG debug originalPredicate getExprString
purge args hasOption String hs2Host ss hs2Host ss getHiveServer2Host purge List String fullCommand Lists newArrayList fullCommand addAll Arrays asList params CommandProcessorResponse authErrResp CommandUtil authorizeCommandAndServiceObject ss HiveOperationType LLAP_CACHE_PURGE fullCommand hs2Host authErrResp authErrResp LlapRegistryService llapRegistryService LlapRegistryService getClient ss getConf llapCachePurge ss llapRegistryService CommandProcessorResponse getSchema
hs2Host ss getHiveServer2Host hasInfo args hasOption hasInfo List String fullCommand Lists newArrayList fullCommand addAll Arrays asList params CommandProcessorResponse authErrResp CommandUtil authorizeCommandAndServiceObject ss HiveOperationType LLAP_CLUSTER_INFO fullCommand hs2Host authErrResp authErrResp LlapRegistryService llapRegistryService LlapRegistryService getClient ss getConf String appId llapRegistryService getApplicationId llapRegistryService getApplicationId toString instance llapRegistryService ss out println Joiner on join appId instance getWorkerIdentity instance getHost instance getRpcPort instance getResource getMemory instance getResource getVirtualCores CommandProcessorResponse getSchema
oldPlanMapper newPlanMapper ret p shouldReExecute p shouldReExecute executionIndex oldPlanMapper newPlanMapper
shouldReExecute ex ret p shouldReExecute p shouldReExecute executionIndex ex
oldPlanMapper newPlanMapper planDidChange planEquals oldPlanMapper newPlanMapper
interval HiveConf getTimeVar hiveConf ConfVars HIVE_PRIVILEGE_SYNCHRONIZER_INTERVAL TimeUnit SECONDS policyProvider LOG info policyProvider getClass getName String authorizer policyProvider getClass getSimpleName interval TimeUnit SECONDS LOG info numDb numTbl String dbName hiveClient numDb HiveObjectRef dbToRefresh getObjToRefresh HiveObjectType DATABASE dbName PrivilegeBag grantDatabaseBag PrivilegeBag addGrantPrivilegesToBag policyProvider grantDatabaseBag HiveObjectType DATABASE dbName authorizer hiveClient refresh_privileges dbToRefresh authorizer grantDatabaseBag
LOG info policyProvider getClass getName String authorizer policyProvider getClass getSimpleName LOG info numDb numTbl String dbName hiveClient numDb HiveObjectRef dbToRefresh getObjToRefresh HiveObjectType DATABASE dbName PrivilegeBag grantDatabaseBag PrivilegeBag addGrantPrivilegesToBag policyProvider grantDatabaseBag HiveObjectType DATABASE dbName authorizer hiveClient refresh_privileges dbToRefresh authorizer grantDatabaseBag LOG debug dbName String hiveClient dbName numTbl
LOG debug dbName tblName HiveObjectRef tableToRefresh getObjToRefresh HiveObjectType TABLE dbName tblName PrivilegeBag grantTableBag PrivilegeBag addGrantPrivilegesToBag policyProvider grantTableBag HiveObjectType TABLE dbName tblName authorizer hiveClient refresh_privileges tableToRefresh authorizer grantTableBag HiveObjectRef tableOfColumnsToRefresh getObjToRefresh HiveObjectType COLUMN dbName tblName PrivilegeBag grantColumnBag PrivilegeBag Table tbl tbl hiveClient getTable dbName tblName fs tbl addGrantPrivilegesToBag policyProvider grantColumnBag HiveObjectType COLUMN dbName tblName fs getName authorizer fs tbl addGrantPrivilegesToBag policyProvider grantColumnBag HiveObjectType COLUMN dbName tblName fs getName authorizer hiveClient refresh_privileges tableOfColumnsToRefresh authorizer grantColumnBag
addGrantPrivilegesToBag policyProvider grantTableBag HiveObjectType TABLE dbName tblName authorizer hiveClient refresh_privileges tableToRefresh authorizer grantTableBag HiveObjectRef tableOfColumnsToRefresh getObjToRefresh HiveObjectType COLUMN dbName tblName PrivilegeBag grantColumnBag PrivilegeBag Table tbl tbl hiveClient getTable dbName tblName fs tbl addGrantPrivilegesToBag policyProvider grantColumnBag HiveObjectType COLUMN dbName tblName fs getName authorizer fs tbl addGrantPrivilegesToBag policyProvider grantColumnBag HiveObjectType COLUMN dbName tblName fs getName authorizer hiveClient refresh_privileges tableOfColumnsToRefresh authorizer grantColumnBag e LOG debug tblName e getMessage LOG info policyProvider getClass getName numDb numTbl
preEventContext preEventContext preEventContext preEventContext preEventContext preEventContext getCurrentUser MetaException getErrorMessage preEventContext getCurrentUser
List HivePrivilegeObject LOG LOG debug List HivePrivilegeObject ret ArrayList PreAddPartitionEvent event PreAddPartitionEvent preEventContext Table table event getTable ret add getHivePrivilegeObject table List Partition partitions event getPartitions partitions Partition partition partitions String uri getSdLocation partition getSd uri ret add getHivePrivilegeObjectDfsUri uri COMMAND_STR buildCommandString COMMAND_STR table LOG
List HivePrivilegeObject LOG debug List HivePrivilegeObject ret ArrayList PreReadDatabaseEvent preReadDatabaseEvent PreReadDatabaseEvent preEventContext Database database preReadDatabaseEvent getDatabase database ret add getHivePrivilegeObject database COMMAND_STR buildCommandString COMMAND_STR database
List HivePrivilegeObject LOG debug List HivePrivilegeObject ret ArrayList PreReadTableEvent preReadTableEvent PreReadTableEvent preEventContext String dbName preReadTableEvent getTable getDbName Table table preReadTableEvent getTable ret add HivePrivilegeObject HivePrivilegeObjectType DATABASE dbName HivePrivilegeObject HivePrivObjectActionType OTHER table getOwner table getOwnerType ret add getHivePrivilegeObject table
RequiredPrivileges filePath conf RequiredPrivileges availPrivs RequiredPrivileges FileSystem fs fs FileSystem get filePath toUri conf FileStatus fileMatches fs globStatus filePath fileMatches fileMatches
RequiredPrivileges availPrivs RequiredPrivileges FileSystem fs fs FileSystem get filePath toUri conf FileStatus fileMatches fs globStatus filePath fileMatches fileMatches LOG debug filePath toString addPrivilegesFromFS userName availPrivs fs fileMatches FileStatus fileStatus FileUtils getFileStatusOrNull fs filePath pickParent fileStatus pickParent fileStatus FileUtils getPathOrParentThatExists fs filePath getParent Path path fileStatus getPath pickParent
fs FileSystem get filePath toUri conf FileStatus fileMatches fs globStatus filePath fileMatches fileMatches LOG debug filePath toString addPrivilegesFromFS userName availPrivs fs fileMatches FileStatus fileStatus FileUtils getFileStatusOrNull fs filePath pickParent fileStatus pickParent fileStatus FileUtils getPathOrParentThatExists fs filePath getParent Path path fileStatus getPath pickParent LOG debug path toString filePath toString addPrivilegesFromFS userName availPrivs fs fileStatus
Set SQLPrivTypeGrant Set SQLPrivTypeGrant privs HashSet SQLPrivTypeGrant
hiveOpType inputHObjs outputHObjs context String msg hiveOpType authenticator getUserName inputHObjs outputHObjs context
listObjs context String msg listObjs authenticator getUserName context
String sessionId getSessionId String logPrefix getConf getLogIdVar sessionId String currThreadName Thread currentThread getName currThreadName logPrefix String newThreadName logPrefix currThreadName
String sessionId getSessionId String logPrefix getConf getLogIdVar sessionId String currThreadName Thread currentThread getName currThreadName logPrefix String names currThreadName split logPrefix
authenticator HiveUtils getAuthenticator sessionConf HiveConf ConfVars HIVE_AUTHENTICATOR_MANAGER authenticator setSessionState String clsStr HiveConf getVar sessionConf HiveConf ConfVars HIVE_AUTHORIZATION_MANAGER authorizer HiveUtils getAuthorizeProviderManager sessionConf clsStr authenticator authorizer HiveAuthorizerFactory authorizerFactory HiveUtils getAuthorizerFactory sessionConf HiveConf ConfVars HIVE_AUTHORIZATION_MANAGER HiveAuthzSessionContext Builder authzContextBuilder HiveAuthzSessionContext Builder authzContextBuilder setClientType isHiveServerQuery CLIENT_TYPE HIVESERVER2 CLIENT_TYPE HIVECLI authzContextBuilder setSessionString getSessionId authorizerV2 authorizerFactory createHiveAuthorizer HiveMetastoreClientFactoryImpl sessionConf authenticator authzContextBuilder build setAuthorizerV2Config createTableGrants CreateTableAutomaticGrant create sessionConf
cleanupItem cleanupItem close err LOG error cleanupItem toString err registry clear txnMgr txnMgr closeTxnManager JavaUtils closeClassLoadersTo sessionConf getClassLoader parentLoader File resourceDir File getConf getVar HiveConf ConfVars DOWNLOADED_RESOURCES_DIR LOG debug resourceDir resourceDir FileUtils deleteDirectory resourceDir
registry clear txnMgr txnMgr closeTxnManager JavaUtils closeClassLoadersTo sessionConf getClassLoader parentLoader File resourceDir File getConf getVar HiveConf ConfVars DOWNLOADED_RESOURCES_DIR LOG debug resourceDir resourceDir FileUtils deleteDirectory resourceDir e LOG info resourceDir e detachSession
String tableFullName table getFullyQualifiedName FooterStatCollector statsCollection statsCollection LOG debug statsCollection partish getSimpleName List FooterStatCollector validColectors Lists newArrayList FooterStatCollector statsCollection statsCollection validColectors add statsCollection EnvironmentContext environmentContext EnvironmentContext environmentContext putToProperties StatsSetupConst DO_NOT_UPDATE_STATS StatsSetupConst TRUE ImmutableListMultimap String FooterStatCollector collectorsByTable Multimaps index validColectors FooterStatCollector SIMPLE_NAME_FUNCTION
FooterStatCollector statsCollection statsCollection LOG debug statsCollection partish getSimpleName List FooterStatCollector validColectors Lists newArrayList FooterStatCollector statsCollection statsCollection validColectors add statsCollection EnvironmentContext environmentContext EnvironmentContext environmentContext putToProperties StatsSetupConst DO_NOT_UPDATE_STATS StatsSetupConst TRUE ImmutableListMultimap String FooterStatCollector collectorsByTable Multimaps index validColectors FooterStatCollector SIMPLE_NAME_FUNCTION LOG debug collectorsByTable keySet collectorsByTable keySet LOG warn tableFullName
List FooterStatCollector validColectors Lists newArrayList FooterStatCollector statsCollection statsCollection validColectors add statsCollection EnvironmentContext environmentContext EnvironmentContext environmentContext putToProperties StatsSetupConst DO_NOT_UPDATE_STATS StatsSetupConst TRUE ImmutableListMultimap String FooterStatCollector collectorsByTable Multimaps index validColectors FooterStatCollector SIMPLE_NAME_FUNCTION LOG debug collectorsByTable keySet collectorsByTable keySet size LOG warn tableFullName assert collectorsByTable keySet size LOG debug tableFullName String partName collectorsByTable keySet ImmutableList FooterStatCollector values collectorsByTable get partName values
EnvironmentContext environmentContext EnvironmentContext environmentContext putToProperties StatsSetupConst DO_NOT_UPDATE_STATS StatsSetupConst TRUE ImmutableListMultimap String FooterStatCollector collectorsByTable Multimaps index validColectors FooterStatCollector SIMPLE_NAME_FUNCTION LOG debug collectorsByTable keySet collectorsByTable keySet size LOG warn tableFullName assert collectorsByTable keySet size LOG debug tableFullName String partName collectorsByTable keySet ImmutableList FooterStatCollector values collectorsByTable get partName values RuntimeException values get result Table db alterTable tableFullName Table values get result environmentContext LOG debug tableFullName
ImmutableListMultimap String FooterStatCollector collectorsByTable Multimaps index validColectors FooterStatCollector SIMPLE_NAME_FUNCTION LOG debug collectorsByTable keySet collectorsByTable keySet size LOG warn tableFullName assert collectorsByTable keySet size LOG debug tableFullName String partName collectorsByTable keySet ImmutableList FooterStatCollector values collectorsByTable get partName values RuntimeException values get result Table db alterTable tableFullName Table values get result environmentContext LOG debug tableFullName values get result
console printError ErrorMsg STATS_SKIPPING_BY_ERROR getErrorCodedMsg e toString List Partition partitions getPartitionsList db String tableFullName table getDbName table getTableName List Partish partishes ArrayList partitions Partish p partishes add p Partish PTable table BasicStatsProcessor basicStatsProcessor BasicStatsProcessor p work conf followedColStats basicStatsProcessor collectFileStatus wh conf Table res Table basicStatsProcessor process statsAggregator res db alterTable tableFullName res environmentContext conf console printInfo tableFullName toString p getPartParameters
LOG info tableFullName toString p getPartParameters List Partition updates ArrayList Partition ExecutorService pool buildBasicStatsExecutor List Future Void futures Lists newLinkedList List BasicStatsProcessor processors Lists newLinkedList Partition partn Partish p BasicStatsProcessor bsp BasicStatsProcessor p Partish PPart table partn work conf followedColStats processors add bsp futures add pool Void Void bsp collectFileStatus wh conf
ExecutorService poolSize conf getInt ConfVars HIVE_MOVE_FILES_THREAD_COUNT varname poolSize Math max poolSize ExecutorService pool Executors newFixedThreadPool poolSize ThreadFactoryBuilder setDaemon setNameFormat build
StructObjectInspector soi StructObjectInspector packedRow oi List StructField fields soi getAllStructFieldRefs List Object values soi getStructFieldsDataAsList packedRow o pos i i colName i String columnName colName get i String columnType colType get i PrimitiveTypeInfo typeInfo PrimitiveTypeInfo TypeInfoUtils getTypeInfoFromTypeString columnType List ColumnStatsField columnStatsFields ColumnStatsType getColumnStats typeInfo ColumnStatisticsObj statObj ColumnStatisticsObjTranslator readHiveColumnStatistics columnName columnType columnStatsFields pos fields values statsObjs add statObj e HiveException e
String vertexName baseWork getName LOG debug vertexName TezCounters counters tezTask getTezCounters counters String groupName HiveConf getVar conf HiveConf ConfVars HIVECOUNTERGROUP Operator op baseWork String operatorId op getOperatorId OperatorStats operatorStats String counterName Operator Counter RECORDS_OUT_OPERATOR toString operatorId TezCounter tezCounter counters getGroup groupName findCounter counterName tezCounter operatorStats operatorStats OperatorStats operatorId operatorStats setOutputRecords tezCounter getValue operatorStats
t LOG error t stopWorkers RuntimeException t LOG debug fullTableNames hadUpdates fullTableName fullTableNames List AnalyzeWork commands processOneTable fullTableName hadUpdates hadUpdates commands commands AnalyzeWork req commands markAnalyzeInProgress req workQueue put req
fullTableName isAnalyzeTableInProgress fullTableName String cat fullTableName getCat db fullTableName getDb tbl fullTableName getTable Table table rs getTable cat db tbl
fullTableName isAnalyzeTableInProgress fullTableName String cat fullTableName getCat db fullTableName getDb tbl fullTableName getTable Table table rs getTable cat db tbl LOG debug table String skipParam table getParameters get SKIP_STATS_AUTOUPDATE_PROPERTY equalsIgnoreCase skipParam String replTrgtParam table getParameters get ReplConst REPL_TARGET_TABLE_PROPERTY replTrgtParam replTrgtParam
String cat fullTableName getCat db fullTableName getDb tbl fullTableName getTable Table table rs getTable cat db tbl LOG debug table String skipParam table getParameters get SKIP_STATS_AUTOUPDATE_PROPERTY equalsIgnoreCase skipParam String replTrgtParam table getParameters get ReplConst REPL_TARGET_TABLE_PROPERTY replTrgtParam replTrgtParam LOG debug table String writeIdString isTxn AcidUtils isTransactionalTable table isTxn areTxnStatsEnabled ValidReaderWriteIdList writeIds getWriteIds fullTableName writeIds
LOG error fullTableName writeIdString writeIds writeToString List String allCols ArrayList table getSd getColsSize fs table getSd allCols add fs getName Collections sort allCols table Map String String params table getParameters List String colsToUpdate writeId isTxn table getWriteId colsToUpdate getExistingNonPartTableStatsToUpdate fullTableName cat db tbl params writeId allCols writeIdString colsToUpdate getAnyStatsToUpdate db tbl allCols params writeId writeIdString
fs table allCols add fs getName Collections sort allCols table Map String String params table getParameters List String colsToUpdate writeId isTxn table getWriteId isExistingOnly colsToUpdate getExistingNonPartTableStatsToUpdate fullTableName cat db tbl params writeId allCols writeIdString colsToUpdate getAnyStatsToUpdate db tbl allCols params writeId writeIdString LOG debug colsToUpdate isExistingOnly allCols params colsToUpdate colsToUpdate Lists newArrayList AnalyzeWork fullTableName allCols size colsToUpdate size colsToUpdate
currentBatch rs getPartitionsByNames cat db tbl currentNames e LOG error fullTableName e currentBatch nextIxInBatch currentIxInBatch nextIxInBatch Partition part currentBatch get currentIxInBatch String partName Warehouse makePartName t getPartitionKeys part getValues LOG debug currentIxInBatch partName Map String String params part getParameters String skipParam params get SKIP_STATS_AUTOUPDATE_PROPERTY fullTableName partName skipParam addPreviousPartitions t partNames currentBatchStart currentBatch currentIxInBatch colsToUpdateForAll partsToAnalyze
AnalyzeWork req req workQueue take req workQueue poll req String cmd cmd req buildCommand LOG debug cmd req SessionState start ss DriverUtils runOnDriver conf user ss cmd
List String partitionCols getPartitionColumns schema neededColumns referencedColumns List ColStatistics columnStats ArrayList List String neededColsToRetrieve extractColumnStates table neededColumns colStatsCache columnStats List String partitionColsToRetrieve extractColumnStates table partitionCols colStatsCache columnStats List String partNames ArrayList partList getNotDeniedPartns size part partList getNotDeniedPartns partNames add part getName AggrStats aggrStats neededColsToRetrieve partNames aggrStats Hive get getAggrColStatsFor table getDbName table getTableName neededColsToRetrieve partNames statsRetrieved aggrStats aggrStats getColStats aggrStats getColStatsSize neededColumns neededColsToRetrieve statsRetrieved estimateStatsForMissingCols neededColsToRetrieve columnStats table conf nr schema addPartitionColumnStats conf partitionColsToRetrieve schema table partList columnStats
AggrStats aggrStats neededColsToRetrieve partNames aggrStats Hive get getAggrColStatsFor table getDbName table getTableName neededColsToRetrieve partNames statsRetrieved aggrStats aggrStats getColStats aggrStats getColStatsSize neededColumns neededColsToRetrieve statsRetrieved estimateStatsForMissingCols neededColsToRetrieve columnStats table conf nr schema addPartitionColumnStats conf partitionColsToRetrieve schema table partList columnStats stats addToDataSize getDataSizeFromColumnStats nr columnStats stats updateColumnStatsState deriveStatType columnStats referencedColumns stats addToColumnStats columnStats statsRetrieved columnStats addAll convertColStats aggrStats getColStats table getTableName colStatsAvailable neededColumns size partitionCols size partitionColsToRetrieve size columnStats size colStatsAvailable
Long conf parts LOG info parts size ArrayList Future Long futures ArrayList threads Math max conf getIntVar ConfVars METASTORE_FS_HANDLER_THREADS_COUNT ExecutorService pool Executors newFixedThreadPool threads ThreadFactoryBuilder setDaemon setNameFormat build ArrayList Long sizes ArrayList parts size part parts Path path part getDataLocation futures pool Long Long
colStatsToRetrieve neededColumns String dbName table getDbName String tabName table getTableName dbName tabName stats colStatsToRetrieve List ColumnStatisticsObj colStat Hive get getTableColumnStatistics dbName tabName colStatsToRetrieve stats convertColStats colStat tabName e LOG error e colStatsCache String col neededColumns ColStatistics cs colStatsCache getColStats get col
tmpDir Path statsDir Path tmpDir
context tmpDir context Path statsDir Path tmpDir LOG debug statsDir statsDir getFileSystem context getHiveConf mkdirs statsDir
LOG info TxnStore MutexAPI LockHandle handle startedAt handle txnHandler getMutexAPI acquireLock TxnStore MUTEX_KEY Cleaner name startedAt System currentTimeMillis minOpenTxnId txnHandler findMinOpenTxnIdForCleaner
LOG info TxnStore MutexAPI LockHandle handle startedAt handle txnHandler getMutexAPI acquireLock TxnStore MUTEX_KEY Cleaner name startedAt System currentTimeMillis minOpenTxnId txnHandler findMinOpenTxnIdForCleaner LOG info minOpenTxnId List CompletableFuture cleanerList ArrayList compactionInfo txnHandler cleanerList add CompletableFuture runAsync CompactorUtil ThrowingRunnable unchecked clean compactionInfo minOpenTxnId cleanerExecutor CompletableFuture allOf cleanerList toArray CompletableFuture join
List CompletableFuture cleanerList ArrayList compactionInfo cleanerList add CompletableFuture runAsync CompactorUtil ThrowingRunnable unchecked clean compactionInfo minOpenTxnId cleanerExecutor CompletableFuture allOf cleanerList toArray CompletableFuture join t LOG error StringUtils stringifyException t handle handle releaseLocks elapsedTime System currentTimeMillis startedAt elapsedTime cleanerCheckInterval stop get Thread sleep cleanerCheckInterval elapsedTime LOG debug stop get
location writeIdList Path locPath Path location AcidUtils Directory dir AcidUtils getAcidState locPath getFileSystem conf locPath conf writeIdList Ref from List Path obsoleteDirs dir getObsolete obsoleteDirs addAll dir getAbortedDirectories List Path filesToDelete ArrayList obsoleteDirs size StringBuilder extraDebugInfo StringBuilder Path stat obsoleteDirs filesToDelete add stat extraDebugInfo append stat getName append stat locPath
StringBuilder extraDebugInfo StringBuilder stat filesToDelete add stat extraDebugInfo append stat getName append stat LOG info idWatermark ci stat extraDebugInfo setCharAt extraDebugInfo length LOG info idWatermark ci filesToDelete size location extraDebugInfo toString filesToDelete size LOG warn location FileSystem fs filesToDelete get getFileSystem conf Database db getMSForConf conf getDatabase getDefaultCatalog conf ci dbname Table table getMSForConf conf getTable getDefaultCatalog conf ci dbname ci tableName filesToDelete
JobConf conf jobName JobConf job JobConf conf job setJobName jobName job setOutputKeyClass NullWritable job setOutputValueClass NullWritable job setJarByClass CompactorMR
jobSubId jobSubId jobSubId JobConf jobMinorCompact createBaseJobConf conf jobName jobSubId t sd writeIds ci launchCompactionJob jobMinorCompact CompactionType MINOR parsedDeltas subList jobSubId maxDeltasToHandle jobSubId maxDeltasToHandle maxDeltasToHandle conf msc ci id jobName dir AcidUtils getAcidState Path sd getLocation conf writeIds Ref from StringableList dirsToSearch StringableList Path baseDir ci baseDir dir getBaseDirectory baseDir List HdfsFileStatusWithId originalFiles dir getOriginalFiles originalFiles originalFiles HdfsFileStatusWithId stat originalFiles Path path stat getFileStatus getPath dirsToSearch add path LOG debug path
baseDir job set BASE_DIR baseDir toString job set DELTA_DIRS deltaDirs toString job set DIRS_TO_SEARCH dirsToSearch toString job setLong MIN_TXN minTxn job setLong MAX_TXN maxTxn job setBoolean MRJobConfig REDUCE_SPECULATIVE job setBoolean MRJobConfig MAP_SPECULATIVE ArrayList Path dirs ArrayList baseDir dirs add baseDir dirs addAll deltaDirs dirs addAll dirsToSearch TokenCache obtainTokensForNamenodes job getCredentials dirs toArray Path job mrJob job
job setLong MIN_TXN minTxn job setLong MAX_TXN maxTxn job setBoolean MRJobConfig REDUCE_SPECULATIVE job setBoolean MRJobConfig MAP_SPECULATIVE ArrayList Path dirs ArrayList baseDir dirs add baseDir dirs addAll deltaDirs dirs addAll dirsToSearch TokenCache obtainTokensForNamenodes job getCredentials dirs toArray Path job mrJob job LOG info compactionType job getJobName job getQueueName curDirNumber obsoleteDirNumber minTxn maxTxn JobClient jc
T T Class T classType String classname IOException T t Class c JavaUtils loadClass classname Object o c newInstance classType o t T o String s classname classType getName LOG error s IOException s e LOG error StringUtils stringifyException e IOException e e
Class c JavaUtils loadClass classname Object o c newInstance classType o t T o String s classname classType getName LOG error s IOException s e LOG error StringUtils stringifyException e IOException e e LOG error StringUtils stringifyException e IOException e e
location LOG debug Path p Path location FileSystem fs p getFileSystem conf FileStatus stat fs getFileStatus p
stat getOwner LOG debug List String wrapper ArrayList UserGroupInformation ugi UserGroupInformation createProxyUser t getOwner UserGroupInformation getLoginUser ugi FileSystem proxyFs p getFileSystem conf FileStatus stat proxyFs getFileStatus p wrapper add stat getOwner FileSystem closeAllForUGI ugi
LOG debug List String wrapper ArrayList UserGroupInformation ugi UserGroupInformation createProxyUser t getOwner UserGroupInformation getLoginUser ugi FileSystem proxyFs p getFileSystem conf FileStatus stat proxyFs getFileStatus p wrapper add stat getOwner FileSystem closeAllForUGI ugi exception LOG error ugi exception
UserGroupInformation ugi UserGroupInformation createProxyUser t getOwner UserGroupInformation getLoginUser ugi FileSystem proxyFs p getFileSystem conf FileStatus stat proxyFs getFileStatus p wrapper add stat getOwner FileSystem closeAllForUGI ugi exception LOG error ugi exception wrapper LOG debug wrapper get wrapper get
tbl isCompactDisabled ReplUtils isFirstIncPending tbl getParameters isCompactDisabled
abortedThreshold HiveConf getIntVar conf HiveConf ConfVars HIVE_COMPACTOR_ABORTEDTXN_THRESHOLD abortedTimeThreshold HiveConf getTimeVar conf HiveConf ConfVars HIVE_COMPACTOR_ABORTEDTXN_TIME_THRESHOLD TimeUnit MILLISECONDS metricsEnabled MetastoreConf getBoolVar conf MetastoreConf ConfVars METRICS_ENABLED startedAt TxnStore MutexAPI LockHandle handle handle txnHandler getMutexAPI acquireLock TxnStore MUTEX_KEY Initiator name startedAt System currentTimeMillis compactionInterval prevStart prevStart startedAt prevStart prevStart startedAt ShowCompactResponse currentCompactions txnHandler showCompact ShowCompactRequest metricsEnabled updateCompactionMetrics currentCompactions Set CompactionInfo potentials txnHandler findPotentialCompactions abortedThreshold abortedTimeThreshold compactionInterval stream filter ci isEligibleForCompaction ci currentCompactions collect Collectors toSet
ShowCompactResponse currentCompactions txnHandler showCompact ShowCompactRequest updateCompactionMetrics currentCompactions Set CompactionInfo potentials txnHandler findPotentialCompactions abortedThreshold abortedTimeThreshold compactionInterval stream filter ci isEligibleForCompaction ci currentCompactions collect Collectors toSet LOG debug potentials size Map String String tblNameOwners HashMap List CompletableFuture compactionList ArrayList potentials ValidTxnList validTxnList TxnCommonUtils createValidReadTxnList txnHandler getOpenTxns conf set ValidTxnList VALID_TXNS_KEY validTxnList writeToString CompactionInfo ci potentials Table t resolveTable ci Partition p resolvePartition ci p ci
LOG debug potentials size Map String String tblNameOwners HashMap List CompletableFuture compactionList ArrayList potentials ValidTxnList validTxnList TxnCommonUtils createValidReadTxnList txnHandler getOpenTxns conf set ValidTxnList VALID_TXNS_KEY validTxnList writeToString ci potentials Table t resolveTable ci Partition p resolvePartition ci p ci LOG info ci getFullPartitionName String runAs resolveUserToRunAs tblNameOwners t p compactionList add CompletableFuture runAsync CompactorUtil ThrowingRunnable unchecked scheduleCompactionIfRequired ci t p runAs compactionExecutor
ci Table t resolveTable ci Partition p resolvePartition ci p ci LOG info ci getFullPartitionName String runAs resolveUserToRunAs tblNameOwners t p compactionList add CompletableFuture runAsync CompactorUtil ThrowingRunnable unchecked scheduleCompactionIfRequired ci t p runAs compactionExecutor t LOG error ci t ci errorMessage t getMessage txnHandler markFailed ci CompletableFuture allOf compactionList toArray CompletableFuture join recoverFailedCompactions
compactionList add CompletableFuture runAsync CompactorUtil ThrowingRunnable unchecked scheduleCompactionIfRequired ci t p runAs compactionExecutor t LOG error ci t ci errorMessage t getMessage txnHandler markFailed ci CompletableFuture allOf compactionList toArray CompletableFuture join recoverFailedCompactions t LOG error StringUtils stringifyException t handle handle releaseLocks elapsedTime System currentTimeMillis startedAt elapsedTime checkInterval Thread sleep checkInterval elapsedTime
CompactionType MINOR runAs determineCompactionType ci writeIds sd tblproperties LOG info runAs ci getFullPartitionName UserGroupInformation ugi UserGroupInformation createProxyUser runAs UserGroupInformation getLoginUser CompactionType compactionType compactionType ugi CompactionType CompactionType determineCompactionType ci writeIds sd tblproperties FileSystem closeAllForUGI ugi
writeIds sd noBase Path location Path sd getLocation FileSystem fs location getFileSystem conf AcidUtils Directory dir AcidUtils getAcidState fs location conf writeIds Ref from Path base dir getBaseDirectory baseSize FileStatus stat base stat fs getFileStatus base stat
deltaPctThreshold deltaPctProp HiveConf getFloatVar conf HiveConf ConfVars HIVE_COMPACTOR_DELTA_PCT_THRESHOLD Float parseFloat deltaPctProp bigEnough deltaSize baseSize deltaPctThreshold multiBase dir getObsolete stream filter path path getName startsWith AcidUtils BASE_PREFIX findAny isPresent initiateMajor bigEnough deltaSize multiBase StringBuilder msg StringBuilder msg append deltaSize msg append msg append baseSize msg append msg append multiBase msg append msg append deltaSize msg append msg append deltaPctThreshold
msg append deltaSize msg append msg append deltaPctThreshold msg append append HiveConf ConfVars HIVE_COMPACTOR_DELTA_PCT_THRESHOLD varname append msg append bigEnough msg append initiateMajor msg append msg append LOG debug msg toString initiateMajor CompactionType MAJOR String deltaNumProp tblproperties get COMPACTORTHRESHOLD_PREFIX HiveConf ConfVars HIVE_COMPACTOR_DELTA_NUM_THRESHOLD deltaNumThreshold deltaNumProp HiveConf getIntVar conf HiveConf ConfVars HIVE_COMPACTOR_DELTA_NUM_THRESHOLD Integer parseInt deltaNumProp enough deltas size deltaNumThreshold enough
ci runAs type CompactionRequest rqst CompactionRequest ci dbname ci tableName type ci partName rqst setPartitionname ci partName rqst setRunas runAs
ci LOG info ci getFullPartitionName ci
t LOG info tableName t hive_metastoreConstants TABLE_NO_AUTO_COMPACT t ci txnHandler ci LOG warn ci getFullPartitionName MetastoreConf ConfVars COMPACTOR_INITIATOR_FAILED_THRESHOLD ci errorMessage MetastoreConf ConfVars COMPACTOR_INITIATOR_FAILED_THRESHOLD txnHandler markFailed ci e LOG error e ci errorMessage e getMessage
dbName Database database getMSForConf conf getDatabase getDefaultCatalog conf dbName isReplCompactDisabled ReplUtils isFirstIncPending database getParameters isReplCompactDisabled
HiveConf conf String compactionInfo String String String Util disableLlapCaching conf conf setBoolVar HiveConf ConfVars HIVE_SERVER2_ENABLE_DOAS String user compactionInfo runAs SessionState sessionState DriverUtils setUpSessionState conf user compactorTxnId CompactorMR CompactorMap getCompactorTxnId conf String
String user compactionInfo runAs SessionState sessionState DriverUtils setUpSessionState conf user compactorTxnId CompactorMR CompactorMap getCompactorTxnId conf String query LOG info compactionInfo isMajorCompaction query DriverUtils runOnDriver conf user sessionState query ex Throwable cause ex cause cause cause cause getCause cause IOException ex String query
DriverUtils runOnDriver conf user sessionState query ex Throwable cause ex cause cause cause cause getCause cause IOException ex query LOG info compactionInfo isMajorCompaction query compactionInfo isMajorCompaction conf set conf set DriverUtils runOnDriver conf user sessionState query writeIds compactorTxnId commitCompaction storageDescriptor getLocation tmpTableName conf writeIds compactorTxnId
IOException ex query LOG info compactionInfo isMajorCompaction query compactionInfo isMajorCompaction conf set conf set DriverUtils runOnDriver conf user sessionState query writeIds compactorTxnId commitCompaction storageDescriptor getLocation tmpTableName conf writeIds compactorTxnId e LOG error compactionInfo isMajorCompaction e removeResultDirs resultDirs conf IOException e
query LOG info compactionInfo isMajorCompaction query compactionInfo isMajorCompaction conf set conf set DriverUtils runOnDriver conf user sessionState query writeIds compactorTxnId commitCompaction storageDescriptor getLocation tmpTableName conf writeIds compactorTxnId e LOG error compactionInfo isMajorCompaction e removeResultDirs resultDirs conf IOException e query LOG info compactionInfo isMajorCompaction query
query LOG info compactionInfo isMajorCompaction query compactionInfo isMajorCompaction conf set conf set DriverUtils runOnDriver conf user sessionState query writeIds compactorTxnId commitCompaction storageDescriptor getLocation tmpTableName conf writeIds compactorTxnId e LOG error compactionInfo isMajorCompaction e removeResultDirs resultDirs conf IOException e query LOG info compactionInfo isMajorCompaction query
timeout conf getTimeVar HiveConf ConfVars HIVE_COMPACTOR_WORKER_TIMEOUT TimeUnit MILLISECONDS launchedJob ExecutorService executor getTimeoutHandlingExecutor Future Boolean singleRun executor submit findNextCompactionAndExecute computeStats launchedJob singleRun get timeout TimeUnit MILLISECONDS te LOG info te singleRun cancel executor shutdownNow executor getTimeoutHandlingExecutor launchedJob
dir numObsoleteDirs dir getObsolete size needsJustCleaning numObsoleteDirs needsJustCleaning
msc msc HiveMetaStoreUtils getHiveMetastoreClient conf e LOG error e ci CompactionInfo optionalCompactionInfoStructToInfo msc findNextCompact workerName LOG debug ci ci checkInterrupt Table t1 t1 resolveTable ci t1
checkInterrupt Table t1 t1 resolveTable ci t1 LOG info ci getFullTableName msc markCleaned CompactionInfo compactionInfoToStruct ci msc markCleaned CompactionInfo compactionInfoToStruct ci checkInterrupt Table t t1 String fullTableName TxnUtils getFullTableName t getDbName t getTableName Partition p
msc markCleaned CompactionInfo compactionInfoToStruct ci checkInterrupt Table t t1 String fullTableName TxnUtils getFullTableName t getDbName t getTableName Partition p p resolvePartition ci p ci LOG info ci getFullPartitionName msc markCleaned CompactionInfo compactionInfoToStruct ci msc markCleaned CompactionInfo compactionInfoToStruct ci
ci runAs ci runAs findUserToRunAs sd getLocation t checkInterrupt compactorTxnId msc openTxn ci runAs TxnType COMPACTION heartbeater CompactionHeartbeater compactorTxnId fullTableName conf heartbeater start ValidTxnList validTxnList msc getValidTxns compactorTxnId ValidCompactorWriteIdList tblValidWriteIds TxnUtils createValidCompactWriteIdList msc getValidWriteIds Collections singletonList fullTableName validTxnList writeToString get LOG debug tblValidWriteIds writeToString conf set ValidTxnList VALID_TXNS_KEY validTxnList writeToString ci highestWriteId tblValidWriteIds getHighWatermark msc updateCompactorState CompactionInfo compactionInfoToStruct ci compactorTxnId checkInterrupt StringBuilder jobName StringBuilder workerName
jobName append ci getFullPartitionName AcidUtils Directory dir AcidUtils getAcidState Path sd getLocation conf tblValidWriteIds Ref from ci dir sd dir sd msc markCompacted CompactionInfo compactionInfoToStruct ci msc markCleaned CompactionInfo compactionInfoToStruct ci checkInterrupt LOG info ci type toString ci getFullPartitionName JavaUtils txnIdToString compactorTxnId computeStats StatsUpdater su computeStats StatsUpdater init ci msc findColumnsWithStats CompactionInfo compactionInfoToStruct ci conf runJobAsSelf ci runAs ci runAs t getOwner CompactorMR mr CompactorMR runJobAsSelf ci runAs mr run conf jobName toString t p sd tblValidWriteIds ci su msc dir
ci dir sd dir sd msc markCompacted CompactionInfo compactionInfoToStruct ci msc markCleaned CompactionInfo compactionInfoToStruct ci checkInterrupt LOG info ci type toString ci getFullPartitionName JavaUtils txnIdToString compactorTxnId computeStats StatsUpdater su computeStats StatsUpdater init ci msc findColumnsWithStats CompactionInfo compactionInfoToStruct ci conf runJobAsSelf ci runAs ci runAs t getOwner CompactorMR mr CompactorMR runJobAsSelf ci runAs mr run conf jobName toString t p sd tblValidWriteIds ci su msc dir UserGroupInformation ugi UserGroupInformation createProxyUser ci runAs UserGroupInformation getLoginUser
msc markCleaned CompactionInfo compactionInfoToStruct ci checkInterrupt LOG info ci type toString ci getFullPartitionName JavaUtils txnIdToString compactorTxnId computeStats StatsUpdater su computeStats StatsUpdater init ci msc findColumnsWithStats CompactionInfo compactionInfoToStruct ci conf runJobAsSelf ci runAs ci runAs t getOwner CompactorMR mr CompactorMR runJobAsSelf ci runAs mr run conf jobName toString t p sd tblValidWriteIds ci su msc dir UserGroupInformation ugi UserGroupInformation createProxyUser ci runAs UserGroupInformation getLoginUser Partition fp p CompactionInfo fci ci ugi
checkInterrupt LOG info ci type toString ci getFullPartitionName JavaUtils txnIdToString compactorTxnId computeStats StatsUpdater su computeStats StatsUpdater init ci msc findColumnsWithStats CompactionInfo compactionInfoToStruct ci conf runJobAsSelf ci runAs ci runAs t getOwner CompactorMR mr CompactorMR runJobAsSelf ci runAs mr run conf jobName toString t p sd tblValidWriteIds ci su msc dir UserGroupInformation ugi UserGroupInformation createProxyUser ci runAs UserGroupInformation getLoginUser Partition fp p CompactionInfo fci ci ugi run mr run conf jobName toString t fp sd tblValidWriteIds fci su msc dir
LOG info ci type toString ci getFullPartitionName JavaUtils txnIdToString compactorTxnId computeStats StatsUpdater su computeStats StatsUpdater init ci msc findColumnsWithStats CompactionInfo compactionInfoToStruct ci conf runJobAsSelf ci runAs ci runAs t getOwner CompactorMR mr CompactorMR runJobAsSelf ci runAs mr run conf jobName toString t p sd tblValidWriteIds ci su msc dir UserGroupInformation ugi UserGroupInformation createProxyUser ci runAs UserGroupInformation getLoginUser Partition fp p CompactionInfo fci ci ugi run mr run conf jobName toString t fp sd tblValidWriteIds fci su msc dir
UserGroupInformation ugi UserGroupInformation createProxyUser ci runAs UserGroupInformation getLoginUser Partition fp p CompactionInfo fci ci ugi run mr run conf jobName toString t fp sd tblValidWriteIds fci su msc dir FileSystem closeAllForUGI ugi exception LOG error ugi ci getFullPartitionName exception heartbeater cancel LOG info ci type toString ci getFullPartitionName JavaUtils txnIdToString compactorTxnId
arguments String query stringOI getPrimitiveJavaObject arguments
IOException ConfVars LLAP_HS2_ENABLE_COORDINATOR varname HiveConf setVar wxConf HiveConf ConfVars HIVEQUERYID extClientAppId toString Vertex wx utils createVertex wxConf mapWork scratchDir work DagUtils createTezLrMap appJarLr String vertexName wx getName dag addVertex wx utils addCredentials mapWork dag Preconditions checkState HiveConf getBoolVar wxConf ConfVars HIVE_TEZ_GENERATE_CONSISTENT_SPLITS Preconditions checkState HiveConf getBoolVar wxConf ConfVars LLAP_CLIENT_CONSISTENT_SPLITS HiveSplitGenerator splitGenerator HiveSplitGenerator wxConf mapWork generateSingleSplit inputArgNumSplits List Event eventList splitGenerator initialize numGroupedSplitsGenerated eventList size InputSplit result InputSplit numGroupedSplitsGenerated InputConfigureVertexTasksEvent configureEvent InputConfigureVertexTasksEvent eventList get List TaskLocationHint hints configureEvent getLocationHint getTaskLocationHints Preconditions checkState hints size numGroupedSplitsGenerated
paths i partnames i PARTNAME QUERY_WITH_KEY paths i paths i substring partnames i PARTNAME NULLNAME pathParsed String urlStr StringObjectInspector inputOIs getPrimitiveJavaObject o urlStr forward nullCols String ret url URL urlStr i i i ret evaluate url i
e System err println e getLocalizedMessage printAndExit tool line HelpFormatter formatter HelpFormatter formatter printHelp tool cmdLineOptions line outputDir line getOptionValue line execute LOG info execute outputDir String hiveVer HiveVersionInfo getShortVersion
String HiveConf conf hiveConf hiveConf HiveConf isAcidEnabled isAcidEnabled conf IMetaStoreClient hms getHMS conf LOG debug List String databases hms getAllDatabases
String scriptLocation HiveConf conf hiveConf hiveConf HiveConf isAcidEnabled isAcidEnabled conf IMetaStoreClient hms getHMS conf LOG debug List String databases hms getAllDatabases LOG debug databases size List String convertToAcid ArrayList List String convertToMM ArrayList Hive db db Hive get conf PrintWriter pw makeRenameFileScript scriptLocation String dbName databases List String tables hms getAllTables dbName
IMetaStoreClient hms getHMS conf LOG debug List String databases hms getAllDatabases LOG debug databases size List String convertToAcid ArrayList List String convertToMM ArrayList Hive db db Hive get conf PrintWriter pw makeRenameFileScript scriptLocation String dbName databases List String tables hms getAllTables dbName LOG debug tables size dbName String tableName tables Table t hms getTable dbName tableName
FileSystem fs FileSystem get conf RemoteIteratorWithFilter iter RemoteIteratorWithFilter fs listFiles p RemoteIteratorWithFilter HIDDEN_FILES_FULL_PATH_FILTER ArrayList iter LocatedFileStatus lfs iter next lfs String msg Warehouse getQualifiedName t lfs getPath LOG error msg IllegalStateException msg AcidUtils BucketMetaData bmd AcidUtils BucketMetaData parse lfs getPath bmd String msg Warehouse getQualifiedName t lfs getPath
iter LocatedFileStatus lfs iter next lfs String msg Warehouse getQualifiedName t lfs getPath LOG error msg IllegalStateException msg AcidUtils BucketMetaData bmd AcidUtils BucketMetaData parse lfs getPath bmd bucketId String msg Warehouse getQualifiedName t lfs getPath LOG error msg IllegalArgumentException msg bmd bucketId String msg Warehouse getQualifiedName t lfs getPath bmd bucketId
bmd bucketId String msg Warehouse getQualifiedName t lfs getPath LOG error msg IllegalArgumentException msg bmd bucketId String msg Warehouse getQualifiedName t lfs getPath bmd bucketId LOG error msg IllegalArgumentException msg bmd copyNumber deltaToFileMap computeIfAbsent bmd copyNumber makeList add lfs getPath deltaToFileMap println pw Warehouse getQualifiedName t Path ent deltaToFileMap Path deltaDir Path p AcidUtils deltaSubdir ent getKey ent getKey
LOG error msg IllegalArgumentException msg bmd copyNumber deltaToFileMap computeIfAbsent bmd copyNumber makeList add lfs getPath deltaToFileMap println pw Warehouse getQualifiedName t Path ent deltaToFileMap Path deltaDir Path p AcidUtils deltaSubdir ent getKey ent getKey deltaDir String msg deltaDir LOG error msg IllegalStateException msg makeDirectoryCommand deltaDir pw Path ent
println pw Warehouse getQualifiedName t Path ent Path deltaDir Path p AcidUtils deltaSubdir ent getKey ent getKey deltaDir String msg deltaDir LOG error msg IllegalStateException msg makeDirectoryCommand deltaDir pw Path file ent Path newFile Path deltaDir stripCopySuffix file getName LOG debug file newFile newFile String msg Warehouse getQualifiedName t newFile
IllegalStateException msg makeRenameCommand file newFile pw println pw Warehouse getQualifiedName t List RenamePair renames ArrayList FileSystem fs FileSystem get conf RemoteIteratorWithFilter iter RemoteIteratorWithFilter fs listFiles p RemoteIteratorWithFilter HIDDEN_FILES_FULL_PATH_FILTER numBadFileNames numCopyNFiles fileId numBytesInPartition getDataSize p conf numBuckets guessNumBuckets numBytesInPartition iter LocatedFileStatus lfs iter next
iter LocatedFileStatus lfs iter next lfs AcidUtils BucketMetaData bmd AcidUtils BucketMetaData parse lfs getPath bmd numBadFileNames bmd numCopyNFiles writeId fileId numBuckets Path deltaDir Path p AcidUtils deltaSubdir writeId writeId deltaDir String msg deltaDir LOG error msg
String String fileName System currentTimeMillis
Thread sleep LOG debug RecordWriter NullWritable Text writer format getRecordWriter job Text text Text LOG debug i i i text set i writer write NullWritable get text writer close InputStream in socket getInputStream LlapBaseRecordReader reader LlapBaseRecordReader in Text job LOG debug reader handleEvent ReaderEvent doneEvent count reader NullWritable get text
Connection conn2 tHndlr getDbConn Connection TRANSACTION_SERIALIZABLE Thread Thread updateTxns conn1 updateLocks conn1 Thread sleep conn1 commit LOG debug e tHndlr checkRetryable conn1 e
Thread Thread updateTxns conn1 updateLocks conn1 Thread sleep conn1 commit LOG debug e tHndlr checkRetryable conn1 e LOG debug e getSQLState e getClass getName e getMessage
sawDeadlock set conn1 rollback e RuntimeException e Thread Thread updateLocks conn2 updateTxns conn2 Thread sleep conn2 commit LOG debug e
conn1 rollback e RuntimeException e Thread Thread updateLocks conn2 updateTxns conn2 Thread sleep conn2 commit LOG debug e
valuesEven runStatementOnDriver TableExtended MMTBLPART makeValuesClause valuesOdd runStatementOnDriver TableExtended MMTBLPART makeValuesClause valuesEven String pStrings i i pStrings length i status fs listStatus Path TEST_WAREHOUSE_DIR TableExtended MMTBLPART toString toLowerCase pStrings i FileUtils STAGING_DIR_PATH_FILTER Assert assertEquals status length Assert assertTrue status getPath getName matches newValsOdd newValsEven runStatementOnDriver TableExtended NONACIDPART makeValuesClause newValsOdd runStatementOnDriver TableExtended NONACIDPART makeValuesClause newValsEven List String rs String s TableExtended MMTBLPART TableExtended NONACIDPART TableExtended NONACIDPART rs runStatementOnDriver s
Exception String testName Exception getStackTrace getMethodName MapRedTask mrtask MapRedTask TaskQueue taskQueue TaskQueue mrtask setWork mr mrtask initialize queryState taskQueue exitVal mrtask execute exitVal
sessionManagerHS2 SparkSessionManagerImpl getInstance sessionManagerHS2 shutdown HiveConf hiveConf getHiveConf sessionManagerHS2 setup hiveConf List Thread threadList ArrayList Thread i i i Thread t Thread SessionThread SessionState get i t start threadList add t Thread t threadList t join String msg
moved newLoc String newNode partLoc get locs splitIx splitIx splits length splitIx String splitLocations lp getLocations splits splitIx assertEquals splitLocations length String splitLocation splitLocations locs splitLocation lastLocations splitIx moved newNode splitLocation newLoc lastLocations splitIx splitLocation locs String msgTail locs String movedMsg moved newMsg newLoc
LOC_COUNT_TO SPLIT_COUNT MAX_MISS_COUNT LOC_COUNT_FROM MAX_MISS_COUNT FileSplit splits createSplits SPLIT_COUNT AtomicInteger errorCount AtomicInteger cvErrorCount locs LOC_COUNT_FROM locs LOC_COUNT_TO locs aboveAvgCount sum cvs MAX_MISS_COUNT missCount missCount MAX_MISS_COUNT missCount cv cvs missCount testHashDistribution locs missCount splits errorCount sum cv missCount cv sum missCount aboveAvgCount aboveAvgCount
partLocs state getAndIncrement missCount hitCounts locs splitIx splitIx splits splitIx state set index HostAffinitySplitLocationProvider determineLocation partLocs splits splitIx getPath toString splits splitIx getStart hitCounts index SummaryStatistics ss SummaryStatistics hitCount hitCounts ss addValue hitCount avg ss getSum ss getN stdev ss getStandardDeviation cv stdev avg allowedMin avg stdev allowedMax avg stdev allowedMin ss allowedMax ss cv
container putRow key value dataSize dataSize Statistics stat Statistics keyCount dataSize Long realObjectSize getObjectSize container Long executionEstimate container getEstimatedMemorySize Long compilerEstimate ConvertJoinMapJoin cjm ConvertJoinMapJoin cjm hashTableLoadFactor compilerEstimate cjm stat compilerEstimate cjm stat LOG info stat
dataSize dataSize Statistics stat Statistics keyCount dataSize Long realObjectSize getObjectSize container Long executionEstimate container getEstimatedMemorySize Long compilerEstimate ConvertJoinMapJoin cjm ConvertJoinMapJoin cjm hashTableLoadFactor compilerEstimate cjm stat compilerEstimate cjm stat LOG info stat LOG info realObjectSize
dataSize Statistics stat Statistics keyCount dataSize Long realObjectSize getObjectSize container Long executionEstimate container getEstimatedMemorySize Long compilerEstimate ConvertJoinMapJoin cjm ConvertJoinMapJoin cjm hashTableLoadFactor compilerEstimate cjm stat compilerEstimate cjm stat LOG info stat LOG info realObjectSize LOG info executionEstimate
t LOG debug t getName t join
RCFile Writer writer RCFile Writer fs conf file DefaultCodec BytesRefArrayWritable bytes BytesRefArrayWritable record length recCount Random rand Random recCount i i record length i record i String valueOf rand nextInt getBytes StandardCharsets UTF_8 i i record length i BytesRefWritable cu BytesRefWritable record i record i length bytes set i cu writer append bytes bytes clear writer close RandomAccessFile raf RandomAccessFile file toUri getPath corruptOffset raf length
System err println usage System exit i i args i args i args i count Integer parseInt args i file Path args i file System err println usage System exit LOG info count LOG info create
Object row serDe deserialize cols StructObjectInspector oi StructObjectInspector serDe getObjectInspector List StructField fieldRefs oi getAllStructFieldRefs assertEquals fieldRefs size i i fieldRefs size i Object fieldData oi getStructFieldData row fieldRefs get i Object standardWritableData ObjectInspectorUtils copyToStandardObject fieldData fieldRefs get i getFieldObjectInspector ObjectInspectorCopyOption WRITABLE assertEquals i standardWritableData expectedFieldsData i assertEquals BytesRefArrayWritable serDe getSerializedClass BytesRefArrayWritable serializedText BytesRefArrayWritable serDe serialize row oi assertEquals s serializedText actualRead reader close assertEquals count actualRead actualRead count cost System currentTimeMillis start
reader getCurrentRow cols cols resetValid Object row serDe deserialize cols StructObjectInspector oi StructObjectInspector serDe getObjectInspector List StructField fieldRefs oi getAllStructFieldRefs assertEquals fieldRefs size i Object fieldData oi getStructFieldData row fieldRefs get i Object standardWritableData ObjectInspectorUtils copyToStandardObject fieldData fieldRefs get i getFieldObjectInspector ObjectInspectorCopyOption WRITABLE assertEquals i standardWritableData expectedPartitalFieldsData i assertEquals BytesRefArrayWritable serDe getSerializedClass BytesRefArrayWritable serializedBytes BytesRefArrayWritable serDe serialize row oi assertEquals patialS serializedBytes reader close cost System currentTimeMillis start
Path dir1_file2 Path dataDir1 writeTextFile dir1_file2 Path dir2_file1 Path dataDir2 writeTextFile dir2_file1 Path dir2_file2 Path dataDir2 writeTextFile dir2_file2 symbolLinkedFileSize fs getFileStatus dir2_file2 getLen writeSymlinkFile Path symlinkDir Path dataDir1 Path dataDir2 SymlinkTextInputFormat inputFormat SymlinkTextInputFormat ContentSummary cs inputFormat getContentSummary symlinkDir job assertEquals symbolLinkedFileSize cs getLength assertEquals cs getFileCount assertEquals cs getDirectoryCount FileInputFormat setInputPaths job symlinkDir InputSplit splits inputFormat getSplits job
fileSystem mkdirs symlinkDir FileInputFormat setInputPaths job symlinkDir SymlinkTextInputFormat inputFormat SymlinkTextInputFormat ContentSummary cs inputFormat getContentSummary symlinkDir job assertEquals cs getLength assertEquals cs getFileCount assertEquals cs getDirectoryCount InputSplit splits inputFormat getSplits job
writer close fileLength fs getFileStatus testFilePath getLen Reader orcReader OrcFile createReader fs testFilePath List StripeInformation stripes orcReader getStripes StripeInformation lastStripe stripes get stripes size lastStripeOffset lastStripe getOffset lastStripeLength lastStripe getLength RecordIdentifier keyIndex OrcRecordUpdater parseKeyIndex orcReader Assert assertEquals stripes size keyIndex length Assert assertEquals RecordIdentifier keyIndex Assert assertEquals RecordIdentifier keyIndex conf set ValidTxnList VALID_TXNS_KEY conf set IOConstants SCHEMA_EVOLUTION_COLUMNS conf set IOConstants SCHEMA_EVOLUTION_COLUMNS_TYPES conf set ColumnProjectionUtils READ_ALL_COLUMNS
assertEquals getValue event assertEquals merger next id event assertEquals OrcRecordUpdater INSERT_OPERATION OrcRecordUpdater getOperation event assertEquals ReaderKey BUCKET_PROPERTY id assertEquals getValue event assertEquals merger next id event assertEquals OrcRecordUpdater INSERT_OPERATION OrcRecordUpdater getOperation event assertEquals ReaderKey BUCKET_PROPERTY id assertEquals getValue event assertEquals merger next id event merger close ValidWriteIdList writeIds ValidReaderWriteIdList baseReader OrcFile createReader basePath OrcFile readerOptions conf merger OrcRawRecordMerger conf baseReader BUCKET writeIds Reader Options Path deleteDeltaDir OrcRawRecordMerger Options isCompacting assertEquals merger getMinKey
String metastoreType System getProperty SYS_PROP_METASTORE_DB System getProperty SYS_PROP_METASTORE_DB toLowerCase rule getDatabaseRule metastoreType setVerbose conf setVar HiveConf ConfVars METASTOREDBTYPE metastoreType toUpperCase MetastoreConf setVar conf MetastoreConf ConfVars CONNECT_URL_KEY rule getJdbcUrl MetastoreConf setVar conf MetastoreConf ConfVars CONNECTION_DRIVER rule getJdbcDriver MetastoreConf setVar conf MetastoreConf ConfVars CONNECTION_USER_NAME rule getHiveUser MetastoreConf setVar conf MetastoreConf ConfVars PWD rule getHivePassword MetastoreConf setBoolVar conf MetastoreConf ConfVars AUTO_CREATE_ALL
Files createDirectory parent deleteLogFiles parent fileName Logger logger LogManager getLogger LineageLogger org apache logging log4j core Logger coreLogger org apache logging log4j core Logger logger LoggerConfig loggerConfig coreLogger get Map String Appender appenders loggerConfig getAppenders assertNotNull appenders get NUM_LOGS logger debug logger info String errorString NUM_LOGS TimeUnit MILLISECONDS sleep
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
ReturnInfo rc parseAndAnalyze
File dist dist File reloadFolder getAbsolutePath File separator reloadClazzFileName Files copy File HiveTestUtils getFileFromClasspath clazzDistFileName dist ss loadReloadableAuxJars Assert assertEquals getReloadedClazzVersion ss getConf getClassLoader e LOG error e Assert fail e getMessage FileUtils deleteQuietly dist ss close ioException Assert fail ioException getMessage
ss SessionState get LOG info dist File reloadFolder getAbsolutePath File separator reloadClazzFileName Files copy File HiveTestUtils getFileFromClasspath clazzDistFileName dist ss loadReloadableAuxJars Assert assertEquals getReloadedClazzVersion ss getConf getClassLoader LOG info FileUtils deleteQuietly dist Files copy File HiveTestUtils getFileFromClasspath clazzV2FileName dist ss loadReloadableAuxJars Assert assertEquals getReloadedClazzVersion ss getConf getClassLoader FileUtils deleteQuietly dist ss loadReloadableAuxJars
FileUtils deleteQuietly dist Files copy File HiveTestUtils getFileFromClasspath clazzV2FileName dist ss loadReloadableAuxJars Assert assertEquals getReloadedClazzVersion ss getConf getClassLoader FileUtils deleteQuietly dist ss loadReloadableAuxJars e LOG error e Assert fail e getMessage FileUtils deleteQuietly dist ss close ioException Assert fail ioException getMessage
startDirection startAmount endDirection endAmount BoundaryDef startBoundary BoundaryDef startDirection startAmount BoundaryDef endBoundary BoundaryDef endDirection endAmount AtomicInteger readCounter AtomicInteger expectedBoundaryStarts TEST_PARTITION size expectedBoundaryEnds TEST_PARTITION size expectedReadCountWithoutCache LOG info Thread currentThread getStackTrace getMethodName
PTFPartition ptfPartition mocks getLeft ValueBoundaryScanner scanner mocks getRight i i TEST_PARTITION i scanner handleCache i ptfPartition start scanner computeStart i ptfPartition end scanner computeEnd i ptfPartition expectedBoundaryStarts i start expectedBoundaryEnds i end assertEquals expectedBoundaryStarts i start assertEquals expectedBoundaryEnds i end Integer col0 ofNullable TEST_PARTITION get i get map v v get orElse Integer col1 ofNullable TEST_PARTITION get i get map v v get orElse Integer col2 ofNullable TEST_PARTITION get i get map v v get orElse
tickTimeToUse tickTime tickTimeToUse TICK_TIME i currentClientPort clientPortList get i tentativePort selectClientPort tentativePort currentClientPort tentativePort ZooKeeperServer server ZooKeeperServer dir dir tickTimeToUse server setMinSessionTimeout configuration getInt server setMaxSessionTimeout configuration getInt ServerCnxnFactory standaloneServerFactory standaloneServerFactory createServerCnxnFactory currentClientPort
activeZKServerIndex ServerCnxnFactory standaloneServerFactory standaloneServerFactoryList get activeZKServerIndex clientPort clientPortList get activeZKServerIndex standaloneServerFactory shutdown clientPort IOException zooKeeperServers get activeZKServerIndex getZKDatabase close standaloneServerFactoryList remove activeZKServerIndex clientPortList remove activeZKServerIndex zooKeeperServers remove activeZKServerIndex LOG info clientPort standaloneServerFactoryList clientPort clientPortList get activeZKServerIndex
BufferedReader reader OutputStream outstream sock getOutputStream outstream write getBytes outstream flush Reader isr InputStreamReader sock getInputStream reader BufferedReader isr String line reader readLine line line sock close reader reader close
tbl LOG debug tbl entrySet String columnNameProperty tbl getProperty serdeConstants LIST_COLUMNS String columnNameDelimiter tbl getProperty serdeConstants COLUMN_NAME_DELIMITER String valueOf SerDeUtils COMMA columnNames columnNameProperty isEmpty Collections emptyList Arrays asList columnNameProperty split columnNameDelimiter String columnTypeProperty tbl getProperty serdeConstants LIST_COLUMN_TYPES List TypeInfo columnTypes columnTypeProperty isEmpty Collections emptyList TypeInfoUtils getTypeInfosFromTypeString columnTypeProperty
tbl LOG debug tbl entrySet String columnNameProperty tbl getProperty serdeConstants LIST_COLUMNS String columnNameDelimiter tbl getProperty serdeConstants COLUMN_NAME_DELIMITER String valueOf SerDeUtils COMMA columnNames columnNameProperty isEmpty Collections emptyList Arrays asList columnNameProperty split columnNameDelimiter String columnTypeProperty tbl getProperty serdeConstants LIST_COLUMN_TYPES List TypeInfo columnTypes columnTypeProperty isEmpty Collections emptyList TypeInfoUtils getTypeInfosFromTypeString columnTypeProperty LOG debug columnNameProperty columnNames
tsParser TimestampParser HiveStringUtils splitAndUnEscape parserFormats tsParser TimestampParser String binaryEncodingStr tbl getProperty BINARY_FORMAT binaryEncoding BinaryEncoding valueOf binaryEncodingStr toUpperCase jsonReader HiveJsonReader soi tsParser jsonWriter HiveJsonWriter binaryEncoding columnNames jsonReader setBinaryEncoding binaryEncoding jsonReader enable HiveJsonReader Feature COL_INDEX_PARSING jsonReader enable HiveJsonReader Feature PRIMITIVE_TO_WRITABLE String ignoreExtras tbl getProperty IGNORE_EXTRA ignoreExtras jsonReader enable HiveJsonReader Feature IGNORE_UKNOWN_FIELDS LOG debug jsonReader
nullString getByteValue altNull defaultNullString String columnProperty tbl getProperty String serdeName tbl getProperty serdeConstants SERIALIZATION_LIB columnsetSerDe serdeName serdeName columnsetSerDe String columnNameDelimiter tbl containsKey serdeConstants COLUMN_NAME_DELIMITER tbl getProperty serdeConstants COLUMN_NAME_DELIMITER String valueOf SerDeUtils COMMA columnProperty columnProperty columnsetSerDe cachedObjectInspector ObjectInspectorFactory getReflectionObjectInspector ColumnSet ObjectInspectorFactory ObjectInspectorOptions JAVA columnNames Arrays asList columnProperty split columnNameDelimiter cachedObjectInspector MetadataListStructObjectInspector getInstance columnNames String lastColumnTakesRestString tbl getProperty serdeConstants SERIALIZATION_LAST_COLUMN_TAKES_REST lastColumnTakesRest lastColumnTakesRestString lastColumnTakesRestString equalsIgnoreCase splitLimit lastColumnTakesRest columnNames columnNames size
csv newReader CharArrayReader rowText toString toCharArray separatorChar quoteChar escapeChar String read csv readNext i i i read i read row set i read i row set i row e SerDeException e csv csv close e
row clear AvroGenericRecordWritable recordWritable AvroGenericRecordWritable writable GenericRecord r recordWritable getRecord Schema fileSchema recordWritable getFileSchema writerTimezone recordWritable getWriterTimezone writerProleptic recordWritable getWriterProleptic UID recordReaderId recordWritable getRecordReaderID recordReaderId SchemaReEncoder reEncoder reEncoderCache recordReaderId reEncoder reEncoderCache get recordReaderId r getSchema readerSchema reEncoder SchemaReEncoder r getSchema readerSchema reEncoderCache put recordReaderId reEncoder
LOG debug f getFieldName data getClass data LazyStruct LazyStruct row LazyStruct data Object rowField row getField fieldID rowField LazyStruct LOG rowField LOG debug rowField getClass deserializeStruct rowField f getFieldName rowField LazyMap LazyMap lazyMap LazyMap rowField Object Object entry lazyMap getMap Object _key entry getKey Object _value entry getValue _value LazyStruct lazyMap getMap put _key deserializeStruct _value f getFieldName
Object rowField row getField fieldID rowField LOG rowField LOG debug rowField getClass deserializeStruct rowField f getFieldName rowField LazyMap LazyMap lazyMap LazyMap rowField Object Object entry lazyMap getMap Object _key entry getKey Object _value entry getValue _value lazyMap getMap put _key deserializeStruct _value f getFieldName LOG LOG debug f getFieldName lazyMap
IllegalArgumentException fieldName Schema ws Schema rs offset AvroGenericRecordWritable avroWritable AvroGenericRecordWritable offset schemaRetriever getOffset data length offset IllegalArgumentException offset data length rs schemaRetriever retrieveReaderSchema data rs IllegalStateException fieldName ws schemaRetriever retrieveWriterSchema data ws IllegalStateException fieldName
Schema ws Schema rs offset AvroGenericRecordWritable avroWritable AvroGenericRecordWritable offset schemaRetriever getOffset data length offset IllegalArgumentException offset data length rs schemaRetriever retrieveReaderSchema data rs IllegalStateException fieldName ws schemaRetriever retrieveWriterSchema data ws IllegalStateException fieldName
columnNames columnTypes String columnNameProperty properties getProperty serdeConstants LIST_COLUMNS String columnTypeProperty properties getProperty serdeConstants LIST_COLUMN_TYPES String columnCommentProperty properties getProperty LIST_COLUMN_COMMENTS String columnNameDelimiter properties containsKey serdeConstants COLUMN_NAME_DELIMITER properties getProperty serdeConstants COLUMN_NAME_DELIMITER String valueOf SerDeUtils COMMA gotColTypesFromColProps properties columnNameProperty columnNameProperty columnTypeProperty columnTypeProperty schema determineSchemaOrReturnErrorSchema configuration properties gotColTypesFromColProps columnNames StringInternUtils internStringsInList Arrays asList columnNameProperty split columnNameDelimiter columnTypes TypeInfoUtils getTypeInfosFromTypeString columnTypeProperty schema getSchemaFromCols properties columnNames columnTypes columnCommentProperty properties setProperty AvroSerdeUtils AvroTableProperties SCHEMA_LITERAL getPropName schema toString
o objInspector JsonNode rootNode walkObjectGraph objInspector o rootStructFieldNames
bytes start length String String byteData Text decode bytes getData start length
fieldId fieldId fieldByteEnd i fieldId i i startPosition i fieldByteEnd fieldByteBegin fieldByteEnd fieldByteEnd fieldByteEnd fieldByteEnd fieldByteEnd fieldByteEnd extraFieldWarned fieldByteEnd extraFieldWarned LOG warn
bytes bytesStart bytesLength String String byteData Text decode bytes bytesStart bytesLength
String columnNameProperty tbl getProperty serdeConstants LIST_COLUMNS String columnNameDelimiter tbl containsKey serdeConstants COLUMN_NAME_DELIMITER tbl getProperty serdeConstants COLUMN_NAME_DELIMITER String valueOf SerDeUtils COMMA String columnTypeProperty tbl getProperty serdeConstants LIST_COLUMN_TYPES columnNameProperty columnNames ArrayList String columnNames Arrays asList columnNameProperty split columnNameDelimiter columnTypeProperty columnTypes ArrayList TypeInfo columnTypes TypeInfoUtils getTypeInfosFromTypeString columnTypeProperty assert columnNames size columnTypes size rowTypeInfo TypeInfoFactory getStructTypeInfo columnNames columnTypes cachedObjectInspector LazyBinaryUtils getLazyBinaryObjectInspectorFromTypeInfo rowTypeInfo cachedLazyBinaryStruct LazyBinaryStruct LazyBinaryFactory createLazyBinaryObject cachedObjectInspector
LazyBinaryUnionObjectInspector uoi LazyBinaryUnionObjectInspector oi unionByteEnd start length byteArr bytes getData tagEnd start tag byteArr start field LazyBinaryFactory createLazyBinaryObject uoi getObjectInspectors get tag LazyBinaryUtils checkObjectByteInfo uoi getObjectInspectors get tag byteArr tagEnd recordInfo vInt fieldStart tagEnd recordInfo elementOffset fieldLength recordInfo elementSize extraFieldWarned fieldStart fieldLength unionByteEnd extraFieldWarned LOG warn missingFieldWarned fieldStart fieldLength unionByteEnd missingFieldWarned
conf MAX_BUFFERED_ROWS HiveConf getIntVar conf HiveConf ConfVars HIVE_SERVER2_THRIFT_RESULTSET_DEFAULT_FETCH_SIZE
typeInfos add STRING typeInfos add CHAR typeInfos add VARCHAR typeInfos add BINARY typeInfos add BYTE typeInfos add SHORT typeInfos add INT typeInfos add LONG typeInfos add FLOAT typeInfos add DOUBLE typeInfos add BOOLEAN typeInfos add DECIMAL typeInfos add DATE typeInfos add VOID structTypeInfo setAllStructFieldTypeInfos typeInfos
File dir File JDBC_JAR_DIR FileFilter fileFilter WildcardFileFilter JDBC_JAR_PATTERN File files dir listFiles fileFilter files files length handleError files response sendError HttpServletResponse SC_NOT_FOUND File file files LOG info file getAbsolutePath file out response buffer length length buffer out write buffer length
String clusterName HiveConf getVar getConfFromContext HiveConf ConfVars LLAP_DAEMON_SERVICE_HOSTS response setContentType HttpConstants CONTENT_TYPE_JSON response setHeader HttpConstants ACCESS_CONTROL_ALLOW_METHODS HttpConstants METHOD_GET response setHeader HttpConstants ACCESS_CONTROL_ALLOW_ORIGIN HttpConstants WILDCARD response setHeader HttpConstants CACHE_CONTROL writer response getWriter clusterName clusterName clusterName trim clusterName clusterName writer print writer print clusterName clusterName clusterName substring
String String tokenStr Map String String map splitCookieToken tokenStr map
Map String String String tokenStr Map String String map HashMap String String StringTokenizer st StringTokenizer tokenStr COOKIE_ATTR_SEPARATOR st String part st nextToken separator part indexOf COOKIE_KEY_VALUE_SEPARATOR separator
List NamingEnumeration SearchResult searchResults ArrayList
HiveConf conf String principal String password Hashtable String Object env Hashtable String Object String ldapUrl conf getVar HiveConf ConfVars HIVE_SERVER2_PLAIN_LDAP_URL env put Context INITIAL_CONTEXT_FACTORY env put Context PROVIDER_URL ldapUrl env put Context SECURITY_AUTHENTICATION env put Context SECURITY_CREDENTIALS password env put Context SECURITY_PRINCIPAL principal
setHiveConf hiveConf sessionManager SessionManager hiveServer2 allowSessionsInitial defaultFetchRows hiveConf getIntVar ConfVars HIVE_SERVER2_THRIFT_RESULTSET_DEFAULT_FETCH_SIZE addService sessionManager HiveAuthFactory loginFromKeytab hiveConf serviceUGI Utils getUGI e ServiceException e e ServiceException e String principal hiveConf getVar ConfVars HIVE_SERVER2_SPNEGO_PRINCIPAL String keyTabFile hiveConf getVar ConfVars HIVE_SERVER2_SPNEGO_KEYTAB principal keyTabFile
SessionHandle openSession protocol username password configuration SessionHandle sessionHandle sessionManager openSession protocol username password configuration
SessionHandle protocol username password configuration delegationToken SessionHandle sessionHandle sessionManager openSession protocol username password configuration delegationToken
SessionHandle openSession protocol username password ipAddress configuration SessionHandle sessionHandle sessionManager openSession protocol username password ipAddress configuration
SessionHandle protocol username password ipAddress configuration delegationToken SessionHandle sessionHandle sessionManager openSession protocol username password ipAddress configuration delegationToken
SessionHandle openSession username password configuration SessionHandle sessionHandle sessionManager openSession SERVER_VERSION username password configuration
sessionHandle username password configuration sessionManager createSession sessionHandle SERVER_VERSION username password configuration
SessionHandle username password configuration delegationToken SessionHandle sessionHandle sessionManager openSession SERVER_VERSION username password configuration delegationToken
closeSession sessionHandle sessionManager closeSession sessionHandle
GetInfoValue getInfo sessionHandle getInfoType GetInfoValue infoValue sessionManager getSession sessionHandle getInfo getInfoType
OperationHandle executeStatement sessionHandle statement confOverlay HiveSession session sessionManager getSession sessionHandle session getSessionState updateProgressMonitor OperationHandle opHandle session executeStatement statement confOverlay
OperationHandle executeStatement sessionHandle statement confOverlay queryTimeout HiveSession session sessionManager getSession sessionHandle session getSessionState updateProgressMonitor OperationHandle opHandle session executeStatement statement confOverlay queryTimeout
OperationHandle executeStatementAsync sessionHandle statement confOverlay HiveSession session sessionManager getSession sessionHandle session getSessionState updateProgressMonitor OperationHandle opHandle session executeStatementAsync statement confOverlay
OperationHandle executeStatementAsync sessionHandle statement confOverlay queryTimeout HiveSession session sessionManager getSession sessionHandle session getSessionState updateProgressMonitor OperationHandle opHandle session executeStatementAsync statement confOverlay queryTimeout
OperationHandle getTypeInfo sessionHandle OperationHandle opHandle sessionManager getSession sessionHandle getTypeInfo
OperationHandle getCatalogs sessionHandle OperationHandle opHandle sessionManager getSession sessionHandle getCatalogs
OperationHandle getSchemas sessionHandle catalogName schemaName OperationHandle opHandle sessionManager getSession sessionHandle getSchemas catalogName schemaName
OperationHandle getTables sessionHandle catalogName schemaName tableName tableTypes OperationHandle opHandle sessionManager getSession sessionHandle getTables catalogName schemaName tableName tableTypes
OperationHandle getTableTypes sessionHandle OperationHandle opHandle sessionManager getSession sessionHandle getTableTypes
OperationHandle getColumns sessionHandle catalogName schemaName tableName columnName OperationHandle opHandle sessionManager getSession sessionHandle getColumns catalogName schemaName tableName columnName
OperationHandle getFunctions sessionHandle catalogName schemaName functionName OperationHandle opHandle sessionManager getSession sessionHandle getFunctions catalogName schemaName functionName
OperationHandle getPrimaryKeys sessionHandle catalog schema table OperationHandle opHandle sessionManager getSession sessionHandle getPrimaryKeys catalog schema table
OperationHandle getCrossReference sessionHandle primaryCatalog primarySchema primaryTable foreignCatalog foreignSchema foreignTable OperationHandle opHandle sessionManager getSession sessionHandle getCrossReference primaryCatalog primarySchema primaryTable foreignCatalog foreignSchema foreignTable
HiveConf conf operation getParentSession getHiveConf operation maxTimeout HiveConf getTimeVar conf HiveConf ConfVars HIVE_SERVER2_LONG_POLLING_TIMEOUT TimeUnit MILLISECONDS elapsed System currentTimeMillis operation getBeginTime timeout Math min maxTimeout elapsed TimeUnit SECONDS toMillis operation getBackgroundHandle get timeout TimeUnit MILLISECONDS e LOG trace opHandle e LOG trace opHandle e e LOG warn opHandle e e OperationStatus opStatus operation getStatus
cancelOperation opHandle sessionManager getOperationManager getOperation opHandle getParentSession cancelOperation opHandle
closeOperation opHandle sessionManager getOperationManager getOperation opHandle getParentSession closeOperation opHandle
TableSchema getResultSetMetadata opHandle TableSchema tableSchema sessionManager getOperationManager getOperation opHandle getParentSession getResultSetMetadata opHandle
RowSet fetchResults opHandle orientation maxRows fetchType RowSet rowSet sessionManager getOperationManager getOperation opHandle getParentSession fetchResults opHandle orientation maxRows fetchType
String getDelegationToken sessionHandle authFactory String owner String renewer String delegationToken sessionManager getSession sessionHandle getDelegationToken authFactory owner renewer
cancelDelegationToken sessionHandle authFactory tokenStr sessionManager getSession sessionHandle cancelDelegationToken authFactory tokenStr
renewDelegationToken sessionHandle authFactory tokenStr sessionManager getSession sessionHandle renewDelegationToken authFactory tokenStr
String getQueryId opHandle Operation operation sessionManager getOperationManager getOperation OperationHandle opHandle String queryId operation getQueryId
maxBatchSize SessionState get getConf getIntVar ConfVars METASTORE_BATCH_RETRIEVE_MAX String List String dbTabs String dbName dbTabs getKey List String tableNames dbTabs getValue table metastoreClient dbName tableNames maxBatchSize TableSchema schema TableSchema metastoreClient getSchema dbName table getTableName List SQLPrimaryKey primaryKeys metastoreClient getPrimaryKeys PrimaryKeysRequest dbName table getTableName Set String pkColNames HashSet SQLPrimaryKey key primaryKeys pkColNames add key getColumn_name toLowerCase column schema column getName Object rowData Object table getDbName table getTableName column getName column getType toJavaSQLType column getTypeName column getTypeDescriptor getColumnSize column getTypeDescriptor getDecimalDigits column getType getNumPrecRadix pkColNames contains column getName toLowerCase DatabaseMetaData columnNoNulls DatabaseMetaData columnNullable column getComment column getOrdinalPosition pkColNames contains column getName toLowerCase rowSet addRow rowData
e setState OperationState ERROR HiveSQLException e List HivePrivilegeObject privObjs HivePrivilegeObjectUtils getHivePrivDbObjects matchingDbs String cmdStr catalogName schemaName authorizeMetaGets HiveOperationType GET_FUNCTIONS privObjs cmdStr catalogName catalogName schemaName schemaName Set String functionNames FunctionRegistry getFunctionNames CLIServiceUtils patternToRegex functionName String functionName functionNames FunctionInfo functionInfo FunctionRegistry getFunctionInfo functionName Object rowData Object functionInfo getDisplayName functionInfo isGenericUDTF DatabaseMetaData functionReturnsTable DatabaseMetaData functionNoTable functionInfo getClass getCanonicalName rowSet addRow rowData String debugMessage getDebugMessage RESULT_SET_SCHEMA
IMetaStoreClient metastoreClient getParentSession getMetaStoreClient String schemaPattern convertSchemaPattern schemaName List String matchingDbs metastoreClient getDatabases schemaPattern List HivePrivilegeObject privObjs HivePrivilegeObjectUtils getHivePrivDbObjects matchingDbs String cmdStr catalogName schemaName authorizeMetaGets HiveOperationType GET_TABLES privObjs cmdStr String tablePattern convertIdentifierPattern tableName String metastoreClient getDatabases schemaPattern tableMeta metastoreClient tablePattern String tableType tableTypeMapping mapToClientType tableMeta getTableType rowSet addRow Object DEFAULT_HIVE_CATALOG tableMeta getDbName tableMeta getTableName tableType tableMeta getComments String debugMessage getDebugMessage RESULT_SET_SCHEMA
setState OperationState RUNNING String command getStatement trim String tokens statement split String commandArgs command substring tokens length trim CommandProcessorResponse response commandProcessor run commandArgs Schema schema response getSchema schema setHasResultSet resultSchema TableSchema schema setHasResultSet resultSchema TableSchema response
ShimLoader getHadoopShims setHadoopQueryContext queryState getQueryId createOperationLog LogUtils registerLoggingContext queryState getConf
Operation operationHandle Operation operation handleToOperation get operationHandle operation operation
operationHandle String opKey operationHandle getHandleIdentifier toString QueryInfo display liveQueryInfos remove opKey display
opHandle Operation operation getOperation opHandle OperationState opState operation getStatus getState opState
queryState setState OperationState RUNNING driver DriverFactory newDriver queryState queryInfo timeoutExecutor Executors newSingleThreadScheduledExecutor timeoutExecutor String queryId queryState getQueryId
OperationState opState getStatus getState opState
state setState state state state Future backgroundHandle getBackgroundHandle backgroundHandle success backgroundHandle cancel String queryId queryState getQueryId success
String queryId queryId queryState getQueryId
FetchTask fetchTask driver getFetchTask isBlobBased fetchTask fetchTask maxRows isBlobBased RowSet rowSet RowSetFactory create getResultSetSchema getProtocolVersion isBlobBased fetchStarted driver resetFetch fetchStarted capacity Math toIntExact maxRows convey ensureCapacity capacity driver setMaxRows capacity driver convey convey capacity
serde serde LazySimpleSerDe Schema mResultSchema driver getSchema List FieldSchema fieldSchemas mResultSchema getFieldSchemas Properties props Properties fieldSchemas String names fieldSchemas stream map i i getName collect Collectors joining String types fieldSchemas stream map i i getType collect Collectors joining
serde serde LazySimpleSerDe Schema mResultSchema driver getSchema List FieldSchema fieldSchemas mResultSchema getFieldSchemas Properties props Properties fieldSchemas String names fieldSchemas stream map i i getName collect Collectors joining String types fieldSchemas stream map i i getType collect Collectors joining log debug names
sessionManager sessionState setHiveServer2Host sessionManager getHiveServer2HostName e HiveSQLException e KillQueryZookeeperManager killQueryZookeeperManager sessionManager killQueryZookeeperManager sessionManager getKillQueryZookeeperManager sessionState setKillQuery KillQueryImpl operationManager killQueryZookeeperManager SessionState start sessionState sessionState loadAuxJars sessionState loadReloadableAuxJars e String msg e
acquire
FileUtils forceDelete sessionLogDir
String value String oldName sessionState getHiveVariables put value oldName oldName value
hiveConf ConfVars initOperationLogRootDir createBackgroundOperationPool addService operationManager hiveConf ConfVars hiveConf ConfVars hiveConf ConfVars killQueryZookeeperManager KillQueryZookeeperManager operationManager hiveServer2 addService killQueryZookeeperManager initSessionImplClassName Metrics metrics MetricsFactory getInstance metrics registerOpenSesssionMetrics metrics registerActiveSesssionMetrics metrics userLimit hiveConf getIntVar ConfVars HIVE_SERVER2_LIMIT_CONNECTIONS_PER_USER ipAddressLimit hiveConf getIntVar ConfVars HIVE_SERVER2_LIMIT_CONNECTIONS_PER_IPADDRESS userIpAddressLimit hiveConf getIntVar ConfVars HIVE_SERVER2_LIMIT_CONNECTIONS_PER_USER_IPADDRESS
poolSize hiveConf getIntVar ConfVars HIVE_SERVER2_ASYNC_EXEC_THREADS
poolSize hiveConf getIntVar ConfVars HIVE_SERVER2_ASYNC_EXEC_THREADS LOG info poolSize poolQueueSize hiveConf getIntVar ConfVars HIVE_SERVER2_ASYNC_EXEC_WAIT_QUEUE_SIZE
poolSize hiveConf getIntVar ConfVars HIVE_SERVER2_ASYNC_EXEC_THREADS LOG info poolSize poolQueueSize hiveConf getIntVar ConfVars HIVE_SERVER2_ASYNC_EXEC_WAIT_QUEUE_SIZE LOG info poolQueueSize keepAliveTime HiveConf getTimeVar hiveConf ConfVars HIVE_SERVER2_ASYNC_EXEC_KEEPALIVE_TIME TimeUnit SECONDS
t LOG warn t session HiveSQLException e getMessage e session setOperationLogSessionDir operationLogRootDir executeSessionHooks session e LOG warn e session close t LOG warn t session
transport close String host conf getVar HiveConf ConfVars HIVE_SERVER2_THRIFT_BIND_HOST port conf getIntVar HiveConf ConfVars HIVE_SERVER2_THRIFT_PORT LOG info host port transport TSocket host port TSocket transport setTimeout conf getTimeVar HiveConf ConfVars SERVER_READ_SOCKET_TIMEOUT TimeUnit SECONDS TSocket transport getSocket setKeepAlive conf getBoolVar HiveConf ConfVars SERVER_TCP_KEEP_ALIVE e LOG error conf getBoolVar HiveConf ConfVars SERVER_TCP_KEEP_ALIVE e String userName conf getVar HiveConf ConfVars HIVE_SERVER2_THRIFT_CLIENT_USER String passwd conf getVar HiveConf ConfVars HIVE_SERVER2_THRIFT_CLIENT_PASSWORD transport PlainSaslHelper getPlainTransport userName passwd transport e
metrics incrementCounter MetricsConstant OPEN_CONNECTIONS metrics incrementCounter MetricsConstant CUMULATIVE_CONNECTION_COUNT e LOG warn e ThriftCLIServerContext serverContext Metrics metrics MetricsFactory getInstance metrics metrics decrementCounter MetricsConstant OPEN_CONNECTIONS e LOG warn e ThriftCLIServerContext context ThriftCLIServerContext serverContext SessionHandle sessionHandle context getSessionHandle
LOG info req getClient_protocol TOpenSessionResp resp TOpenSessionResp String userName userName getUserName req SessionHandle sessionHandle getSessionHandle req resp userName fetchSize hiveConf getIntVar HiveConf ConfVars HIVE_SERVER2_THRIFT_RESULTSET_DEFAULT_FETCH_SIZE resp setSessionHandle sessionHandle toTSessionHandle resp setConfiguration Collections singletonMap HiveConf ConfVars HIVE_SERVER2_THRIFT_RESULTSET_DEFAULT_FETCH_SIZE varname Integer toString fetchSize resp setStatus OK_STATUS ThriftCLIServerContext context ThriftCLIServerContext currentServerContext get context context setSessionHandle sessionHandle LOG info userName
SessionHandle sh e req sb sh SessionHandle req getSessionHandle sb StringBuilder append sh append sb append sb append e getKey append append e getValue e getKey cliService setApplicationName sh e getValue ex LOG warn ex resp TSetClientInfoResp HiveSQLException toTStatus ex sb
String String String String String String proxyUser proxyUser SessionManager getProxyUserName
String proxyUser proxyUser SessionManager getProxyUserName LOG debug proxyUser proxyUser sessionConf sessionConf HiveAuthConstants HS2_PROXY_USER String proxyUserFromThriftBody sessionConf get HiveAuthConstants HS2_PROXY_USER LOG debug proxyUserFromThriftBody proxyUser proxyUserFromThriftBody proxyUser realUser hiveConf HiveSQLException HiveAuthConstants hiveConf proxyUser HiveAuthFactory verifyProxyAccess realUser proxyUser ipAddress hiveConf
openConnection connection closeConnection connection useSsl hiveConf getBoolVar ConfVars HIVE_SERVER2_USE_SSL String schemeName useSsl useSsl String keyStorePath hiveConf getVar ConfVars HIVE_SERVER2_SSL_KEYSTORE_PATH trim String keyStorePassword ShimLoader getHadoopShims getPassword hiveConf HiveConf ConfVars HIVE_SERVER2_SSL_KEYSTORE_PASSWORD varname keyStorePath IllegalArgumentException ConfVars HIVE_SERVER2_SSL_KEYSTORE_PATH varname SslContextFactory sslContextFactory SslContextFactory String excludedProtocols hiveConf getVar ConfVars HIVE_SSL_PROTOCOL_BLACKLIST split
connection closeConnection connection useSsl hiveConf getBoolVar ConfVars HIVE_SERVER2_USE_SSL String schemeName useSsl useSsl String keyStorePath hiveConf getVar ConfVars HIVE_SERVER2_SSL_KEYSTORE_PATH trim String keyStorePassword ShimLoader getHadoopShims getPassword hiveConf HiveConf ConfVars HIVE_SERVER2_SSL_KEYSTORE_PASSWORD varname keyStorePath IllegalArgumentException ConfVars HIVE_SERVER2_SSL_KEYSTORE_PATH varname SslContextFactory sslContextFactory SslContextFactory String excludedProtocols hiveConf getVar ConfVars HIVE_SSL_PROTOCOL_BLACKLIST split LOG info Arrays toString excludedProtocols
continueProcessing Utils doXsrfFilter request response continueProcessing LOG warn clientIpAddress request getRemoteAddr LOG debug clientIpAddress clientUserName validateCookie request requireNewCookie clientUserName requireNewCookie LOG info SessionManager setIpAddress clientIpAddress String forwarded_for request getHeader X_FORWARDED_FOR forwarded_for
clientUserName validateCookie request requireNewCookie clientUserName requireNewCookie LOG info SessionManager setIpAddress clientIpAddress String forwarded_for request getHeader X_FORWARDED_FOR forwarded_for LOG debug X_FORWARDED_FOR forwarded_for List String forwardedAddresses Arrays asList forwarded_for split SessionManager setForwardedAddresses forwardedAddresses SessionManager setForwardedAddresses Collections emptyList clientUserName String trustedDomain HiveConf getVar hiveConf ConfVars HIVE_SERVER2_TRUSTED_DOMAIN trim useXff HiveConf getBoolVar hiveConf ConfVars HIVE_SERVER2_TRUSTED_DOMAIN_USE_XFF_HEADER
LOG info SessionManager setIpAddress clientIpAddress String forwarded_for request getHeader X_FORWARDED_FOR forwarded_for LOG debug X_FORWARDED_FOR forwarded_for List String forwardedAddresses Arrays asList forwarded_for split SessionManager setForwardedAddresses forwardedAddresses SessionManager setForwardedAddresses Collections emptyList String trustedDomain HiveConf getVar hiveConf ConfVars HIVE_SERVER2_TRUSTED_DOMAIN trim useXff HiveConf getBoolVar hiveConf ConfVars HIVE_SERVER2_TRUSTED_DOMAIN_USE_XFF_HEADER useXff trustedDomain SessionManager getForwardedAddresses SessionManager getForwardedAddresses clientIpAddress SessionManager getForwardedAddresses get LOG info clientIpAddress
clientUserName String trustedDomain HiveConf getVar hiveConf ConfVars HIVE_SERVER2_TRUSTED_DOMAIN trim useXff HiveConf getBoolVar hiveConf ConfVars HIVE_SERVER2_TRUSTED_DOMAIN_USE_XFF_HEADER useXff trustedDomain SessionManager getForwardedAddresses SessionManager getForwardedAddresses clientIpAddress SessionManager getForwardedAddresses get LOG info clientIpAddress String remoteHostName InetAddress getByName clientIpAddress getCanonicalHostName trustedDomain remoteHostName trustedDomain LOG info remoteHostName trustedDomain clientUserName doPasswdAuth request HiveAuthConstants AuthTypes NOSASL getAuthName String delegationToken request getHeader HIVE_DELEGATION_TOKEN_HEADER delegationToken delegationToken clientUserName doTokenAuth request
authType String delegationToken request getHeader HIVE_DELEGATION_TOKEN_HEADER delegationToken delegationToken clientUserName doTokenAuth request clientUserName doKerberosAuth request clientUserName doPasswdAuth request authType assert clientUserName LOG debug clientUserName SessionManager setUserName clientUserName String doAsQueryParam getDoAsQueryParam request getQueryString doAsQueryParam SessionManager setProxyUserName doAsQueryParam
assert clientUserName LOG debug clientUserName SessionManager setUserName clientUserName String doAsQueryParam getDoAsQueryParam request getQueryString doAsQueryParam SessionManager setProxyUserName doAsQueryParam String cookieToken HttpAuthUtils createCookieToken clientUserName Cookie hs2Cookie createCookie signer signCookie cookieToken response setHeader getHttpOnlyCookieHeader hs2Cookie response addCookie hs2Cookie LOG info clientUserName doPost request response
currValue currCookie getValue currValue signer verifyAndExtract currValue e LOG LOG debug e currValue currValue String userName HttpAuthUtils getUserNameFromCookieToken currValue userName LOG warn currValue LOG
request Cookie cookies request getCookies cookies
srv String endpointName String instanceUri srv get INSTANCE_URI_CONFIG String tokens instanceUri split String hostname tokens port Integer parseInt tokens Endpoint urlEndpoint RegistryTypeUtils ipcEndpoint endpointName InetSocketAddress hostname port srv addInternalEndpoint urlEndpoint
HS2ActivePassiveHARegistry conf String namespace HiveConf getVar conf HiveConf ConfVars HIVE_SERVER2_ACTIVE_PASSIVE_HA_REGISTRY_NAMESPACE Preconditions checkArgument StringUtils isBlank namespace HiveConf ConfVars HIVE_SERVER2_ACTIVE_PASSIVE_HA_REGISTRY_NAMESPACE varname String nsKey ZkRegistryBase getRootNamespace conf namespace HS2ActivePassiveHARegistry registry hs2Registries get nsKey registry registry HS2ActivePassiveHARegistry create conf registry start hs2Registries put nsKey registry
hiveConf LOG info String runWorkerIn MetastoreConf getVar hiveConf MetastoreConf ConfVars HIVE_METASTORE_RUNWORKER_IN
hiveConf LOG info String runWorkerIn MetastoreConf getVar hiveConf MetastoreConf ConfVars HIVE_METASTORE_RUNWORKER_IN LOG info runWorkerIn numWorkers MetastoreConf getIntVar hiveConf MetastoreConf ConfVars COMPACTOR_WORKER_THREADS
publishConfigs hiveConf getBoolVar HiveConf ConfVars HIVE_SERVER2_ZOOKEEPER_PUBLISH_CONFIGS String instanceURI getServerInstanceURI String znodeData publishConfigs addConfsToPublish hiveConf confsToPublish getServerInstanceURI znodeData Joiner on withKeyValueSeparator join confsToPublish znodeData instanceURI zooKeeperHelper hiveConf getZKConfig String znodePathPrefix instanceURI HiveVersionInfo getVersion zooKeeperHelper addServerInstanceToZooKeeper znodePathPrefix znodeData zooKeeperAclProvider DeRegisterWatcher zooKeeperHelper e LOG error e ServiceException e
znodeData Joiner on withKeyValueSeparator join confsToPublish znodeData instanceURI zooKeeperHelper hiveConf getZKConfig String znodePathPrefix instanceURI HiveVersionInfo getVersion zooKeeperHelper addServerInstanceToZooKeeper znodePathPrefix znodeData zooKeeperAclProvider DeRegisterWatcher zooKeeperHelper e LOG error e ServiceException e startPrivilegeSynchronizer hiveConf e LOG error e ServiceException e
znodeData instanceURI zooKeeperHelper hiveConf getZKConfig String znodePathPrefix instanceURI HiveVersionInfo getVersion zooKeeperHelper addServerInstanceToZooKeeper znodePathPrefix znodeData zooKeeperAclProvider DeRegisterWatcher zooKeeperHelper e LOG error e ServiceException e startPrivilegeSynchronizer hiveConf e LOG error e ServiceException e
e LOG error e ServiceException e startPrivilegeSynchronizer hiveConf e LOG error e ServiceException e webServer webServer start LOG info webServer getPort e LOG error e ServiceException e
scheduledQueryService close e LOG error e MetricSink getInstance tearDown hs2HARegistry hs2HARegistry stop shutdownExecutor leaderActionsExecutorService LOG info hs2HARegistry webServer webServer stop LOG info e
MetricSink getInstance tearDown hs2HARegistry hs2HARegistry stop shutdownExecutor leaderActionsExecutorService LOG info hs2HARegistry webServer webServer stop LOG info e LOG error e MetricsFactory getInstance MetricsFactory close
LOG info hs2HARegistry webServer webServer stop LOG info e LOG error e MetricsFactory MetricsFactory close e LOG error e getClass getName e getMessage e
PolicyProviderContainer policyContainer PolicyProviderContainer HiveAuthorizer authorizer SessionState get getAuthorizerV2 authorizer policyContainer addAuthorizer authorizer getVar hiveConf ConfVars getVar hiveConf ConfVars getVar hiveConf ConfVars List HiveMetastoreAuthorizationProvider providers HiveUtils getMetaStoreAuthorizeProviderManagers hiveConf HiveConf ConfVars HIVE_METASTORE_AUTHORIZATION_MANAGER SessionState get getAuthenticator HiveMetastoreAuthorizationProvider provider providers provider policyContainer addAuthorizationProvider provider policyContainer setUpZooKeeperAuth hiveConf zKClientForPrivSync hiveConf getZKConfig startZookeeperClient zooKeeperAclProvider String rootNamespace hiveConf getVar HiveConf ConfVars HIVE_SERVER2_ZOOKEEPER_NAMESPACE String path ZooKeeperHiveHelper ZOOKEEPER_PATH_SEPARATOR rootNamespace ZooKeeperHiveHelper ZOOKEEPER_PATH_SEPARATOR LeaderLatch privilegeSynchronizerLatch LeaderLatch zKClientForPrivSync path
server init hiveConf server start JvmPauseMonitor pauseMonitor JvmPauseMonitor hiveConf pauseMonitor start t LOG warn t hiveConf SparkSessionManagerImpl getInstance setup hiveConf server server stop t
String args HiveConf setLoadHiveServer2Config ServerOptionsProcessor oproc ServerOptionsProcessor ServerOptionsProcessorResponse oprocResponse oproc parse args String initLog4jMessage LogUtils initHiveLog4j
GetApplicationsRequest gar GetApplicationsRequest newInstance gar setScope ApplicationsRequestScope OWN gar setApplicationTags Collections singleton tag ApplicationClientProtocol proxy ClientRMProxy createRMProxy conf ApplicationClientProtocol GetApplicationsResponse apps proxy getApplications gar List ApplicationReport appsList apps getApplicationList ApplicationReport appReport appsList childYarnJobs add appReport getApplicationId appReport childYarnJobs add appReport getApplicationId childYarnJobs LOG info
queryIdOrTag errMsg errMsg StringUtils defaultString errMsg KillQueriesOperation KILL_QUERY_MESSAGE TagOrId tagOrId TagOrId UNKNOWN Set Operation operationsToKill HashSet operationManager getOperationByQueryId queryIdOrTag operationsToKill add operationManager getOperationByQueryId queryIdOrTag tagOrId TagOrId ID
errMsg StringUtils defaultString errMsg KillQueriesOperation KILL_QUERY_MESSAGE TagOrId tagOrId TagOrId UNKNOWN Set Operation operationsToKill HashSet operationManager getOperationByQueryId queryIdOrTag operationsToKill add operationManager getOperationByQueryId queryIdOrTag tagOrId TagOrId ID LOG debug queryIdOrTag operationsToKill addAll operationManager getOperationsByQueryTag queryIdOrTag operationsToKill tagOrId TagOrId TAG LOG debug queryIdOrTag operationsToKill killOperations queryIdOrTag errMsg conf tagOrId operationsToKill doAs doAsAdmin
operationManager getOperationByQueryId queryIdOrTag operationsToKill add operationManager getOperationByQueryId queryIdOrTag tagOrId TagOrId ID LOG debug queryIdOrTag operationsToKill addAll operationManager getOperationsByQueryTag queryIdOrTag operationsToKill tagOrId TagOrId TAG LOG debug queryIdOrTag operationsToKill killOperations queryIdOrTag errMsg conf tagOrId operationsToKill doAs doAsAdmin LOG debug queryIdOrTag conf
LOG debug queryIdOrTag operationsToKill addAll operationManager getOperationsByQueryTag queryIdOrTag operationsToKill tagOrId TagOrId TAG LOG debug queryIdOrTag operationsToKill killOperations queryIdOrTag errMsg conf tagOrId operationsToKill doAs doAsAdmin LOG debug queryIdOrTag killQueryZookeeperManager conf LOG debug queryIdOrTag killQueryZookeeperManager killQuery queryIdOrTag SessionState get getAuthenticator getUserName isAdmin
killChildYarnJobs conf queryTag doAs doAsAdmin HiveSQLException numCanceled doAs doAsAdmin numCanceled numCanceled HiveSQLException killChildYarnJobs conf queryIdOrTag doAs doAsAdmin HiveSQLException
KillQueryZookeeperBarrier barrier KillQueryZookeeperBarrier zooKeeperClient zkNameSpace ZKPaths getNodeFromPath pathChildrenCacheEvent getData getPath Optional KillQueryZookeeperData data barrier getKillQueryData data KillQueryZookeeperData killQuery data get LOG debug killQuery getQueryId getServerHost killQuery localKillQueryImpl killQuery getQueryId LOG info killQuery getQueryId barrier confirmProgress getServerHost localKillQueryImpl killLocalQuery killQuery getQueryId conf killQuery getDoAs killQuery isDoAsAdmin barrier confirmDone getServerHost
KillQueryZookeeperData killQuery data get LOG debug killQuery getQueryId getServerHost killQuery localKillQueryImpl killQuery getQueryId LOG info killQuery getQueryId barrier confirmProgress getServerHost localKillQueryImpl killLocalQuery killQuery getQueryId conf killQuery getDoAs killQuery isDoAsAdmin barrier confirmDone getServerHost e LOG error e barrier confirmFailed getServerHost
Long threadId getId RawStore threadLocalRawStore threadRawStoreMap get threadId threadLocalRawStore
setResponseHeaders response LOG info ObjectMapper mapper ObjectMapper FailoverResponse failoverResponse FailoverResponse AtomicBoolean isLeader AtomicBoolean context getAttribute isLeader String msg LOG info msg failoverResponse setSuccess failoverResponse setMessage msg mapper writerWithDefaultPrettyPrinter writeValue response getWriter failoverResponse response setStatus HttpServletResponse SC_FORBIDDEN HiveServer2 FailoverHandlerCallback failoverHandler HiveServer2 FailoverHandlerCallback context getAttribute
failoverResponse setSuccess failoverResponse setMessage msg mapper writerWithDefaultPrettyPrinter writeValue response getWriter failoverResponse response setStatus HttpServletResponse SC_FORBIDDEN HiveServer2 FailoverHandlerCallback failoverHandler HiveServer2 FailoverHandlerCallback context getAttribute String msg LOG info msg failoverHandler failover failoverResponse setSuccess failoverResponse setMessage msg mapper writerWithDefaultPrettyPrinter writeValue response getWriter failoverResponse response setStatus HttpServletResponse SC_OK
request String opId String request getParameter ServletContext ctx getServletContext SessionManager sessionManager SessionManager ctx getAttribute OperationManager opManager sessionManager getOperationManager QueryInfo queryInfo opManager getQueryInfo opId HiveConf hiveConf opManager getHiveConf queryInfo
LOG info Set ApplicationId childJobs getYarnChildJobs tag timestamp childJobs LOG info LOG info String format childJobs size LOG info YarnClient yarnClient YarnClient createYarnClient yarnClient init conf yarnClient start ApplicationId app childJobs LOG info String format app yarnClient killApplication app
Set ApplicationId Set ApplicationId childYarnJobs HashSet ApplicationId
aclEntries ArrayList sourceStatus getAclEntries removeBaseAclEntries aclEntries aclEntries add newAclEntry AclEntryScope ACCESS AclEntryType USER sourcePerm getUserAction aclEntries add newAclEntry AclEntryScope ACCESS AclEntryType GROUP sourcePerm getGroupAction aclEntries add newAclEntry AclEntryScope ACCESS AclEntryType OTHER sourcePerm getOtherAction fsShell setConf conf group group run fsShell String group target toString aclEntries String aclEntry Joiner on join aclEntries run fsShell String aclEntry target toString
removeBaseAclEntries aclEntries aclEntries add newAclEntry AclEntryScope ACCESS AclEntryType USER sourcePerm getUserAction aclEntries add newAclEntry AclEntryScope ACCESS AclEntryType GROUP sourcePerm getGroupAction aclEntries add newAclEntry AclEntryScope ACCESS AclEntryType OTHER sourcePerm getOtherAction fsShell setConf conf group group run fsShell String group target toString aclEntries String aclEntry Joiner on join aclEntries run fsShell String aclEntry target toString LOG info target
run fsShell String aclEntry target toString e LOG info target LOG debug e e String permission Integer toString sourcePerm toShort run fsShell String permission target toString group group group fs setOwner target group aclEntries fs setAcl target aclEntries
run shell command LOG debug ArrayUtils toString command retval shell run command
Filter String filterClass Class Filter klass Class Filter Class forName filterClass Filter f klass newInstance
sparkLogDir sparkHome String osxTestOpts Strings nullToEmpty System osxTestOpts Strings nullToEmpty System getenv OSX_TEST_OPTS String driverJavaOpts Joiner on skipNulls join sparkLogDir osxTestOpts conf get DRIVER_OPTS_KEY String executorJavaOpts Joiner on skipNulls join sparkLogDir osxTestOpts conf get EXECUTOR_OPTS_KEY File properties File createTempFile properties properties IOException properties deleteOnExit Properties allProps Properties URL sparkDefaultsUrl Thread currentThread getContextClassLoader getResource sparkDefaultsUrl
List String String conf localTmpDir ClassLoader parentLoader Thread currentThread getContextClassLoader List URL curPath getCurrentClassPaths parentLoader List String localNewPaths ArrayList newPathAdded String entry URL newUrl urlFromPathString entry getKey entry getValue conf localTmpDir localNewPaths add newUrl toString newUrl curPath newUrl curPath add newUrl
path path Path remoteFile Path path Path localFile Path localTmpDir getAbsolutePath File separator remoteFile getName Long currentTS downloadedFiles get path currentTS currentTS File localFile toString currentTS timeStamp LOG info remoteFile localFile FileSystem remoteFS remoteFile getFileSystem conf remoteFS copyToLocalFile remoteFile localFile downloadedFiles put path timeStamp urlFromPathString localFile toString timeStamp conf localTmpDir url File path toURL
Void String String Callable Void runnable String cmd Joiner on join argv
pb environment put isTesting Process child pb start String threadName Thread currentThread getName List String childErrorLog Collections synchronizedList ArrayList String List String childOutLog Collections synchronizedList ArrayList String LogRedirector LogSourceCallback callback isAlive LogRedirector redirect threadName LogRedirector child getInputStream LOG childOutLog callback LogRedirector redirect threadName LogRedirector child getErrorStream LOG childErrorLog callback exitCode child waitFor exitCode childOutLog String line childOutLog Matcher m YARN_APPLICATION_ID_REGEX matcher line
LogRedirector LogSourceCallback callback isAlive LogRedirector redirect threadName LogRedirector child getInputStream LOG childOutLog callback LogRedirector redirect threadName LogRedirector child getErrorStream LOG childErrorLog callback exitCode child waitFor exitCode childOutLog line childOutLog Matcher m YARN_APPLICATION_ID_REGEX matcher line m LOG info m group rpcServer setApplicationId m group childErrorLog line childErrorLog
YarnClient yarnClient ApplicationId appId getApplicationIDFromString applicationId yarnClient YarnClient createYarnClient yarnClient init conf yarnClient start ApplicationReport appReport yarnClient getApplicationReport appId appReport appReport getYarnApplicationState YarnApplicationState ACCEPTED ex LOG error applicationId ex ex yarnClient yarnClient stop
Rpc clientId Promise Rpc promise group next newPromise LOG info applicationId applicationId ClientInfo client pendingClients get clientId client
groupName counterName SparkCounter counter getGroup groupName getCounter counterName counter
groupName counterName SparkCounter counter getGroup groupName getCounter counterName counter
T JobHandle Listener T SuppressWarnings JobHandle Listener T listener mock JobHandle Listener answerWhen listener onJobCancelled Mockito JobHandle T any answerWhen listener onJobQueued Mockito JobHandle T any answerWhen listener onJobStarted Mockito JobHandle T any answerWhen listener onJobSucceeded Mockito JobHandle T any Mockito T any answerWhen listener onSparkJobStarted Mockito JobHandle T any Mockito anyInt Mockito invocation SuppressWarnings JobHandleImpl arg JobHandleImpl invocation getArguments
invocation SuppressWarnings JobHandleImpl arg JobHandleImpl invocation getArguments
RpcServer server0 RpcServer config hiveConf assertTrue server0 getPort server0 getPort IOUtils closeQuietly server0 config put HiveConf ConfVars SPARK_RPC_SERVER_PORT varname RpcServer server1 RpcServer config hiveConf assertTrue server1 getPort server1 getPort server1 getPort IOUtils closeQuietly server1 expectedPort ServerUtils findFreePort RpcServer server2 config put HiveConf ConfVars SPARK_RPC_SERVER_PORT varname String valueOf expectedPort server2 RpcServer config hiveConf
assertNotNull server2 assertEquals server2 getPort expectedPort server2 getPort IOUtils closeQuietly server2 config put HiveConf ConfVars SPARK_RPC_SERVER_PORT varname autoClose RpcServer config hiveConf assertTrue e assertEquals HiveConf ConfVars SPARK_RPC_SERVER_PORT varname e getMessage expectedPort ServerUtils findFreePort RpcServer server3 config put HiveConf ConfVars SPARK_RPC_SERVER_PORT varname String valueOf expectedPort server3 RpcServer config hiveConf
server runPendingTasks client runPendingTasks count client Object readOutboundResult client readOutbound server writeInbound readOutboundResult count server flush LOG debug count count server Object readOutboundResult server readOutbound client writeInbound readOutboundResult count client flush
zooKeeperClient startZookeeperClient zooKeeperAclProvider String pathPrefix ZOOKEEPER_PATH_SEPARATOR rootNamespace ZOOKEEPER_PATH_SEPARATOR znodePathPrefix znodeDataUTF8 znodeData getBytes StandardCharsets UTF_8 znode PersistentNode zooKeeperClient CreateMode EPHEMERAL_SEQUENTIAL pathPrefix znodeDataUTF8 znode start znodeCreationTimeout znode znodeCreationTimeout Exception znodeCreationTimeout setDeregisteredWithZooKeeper String znodePath znode getActualPath zooKeeperClient znodePath Exception znodePathPrefix znodeData LOG info znodePath znodePathPrefix znodeData Exception
CuratorFramework zooKeeperAclProvider CuratorFramework zkClient getNewZookeeperClient zooKeeperAclProvider zkClient start zkClient create creatingParentsIfNeeded withMode CreateMode PERSISTENT forPath ZooKeeperHiveHelper ZOOKEEPER_PATH_SEPARATOR rootNamespace
fs path ByteBuffer cols fileFormatProxy getAddedColumnsToCache ByteBuffer vals cols ByteBuffer cols length ByteBuffer metadata fileFormatProxy getMetadataToCache fs path vals
isEnabled MetastoreConf getBoolVar conf ConfVars METASTORE_CLIENT_FILTER_ENABLED
MetaException isConnected TTransportException tte MetaException recentME useSSL MetastoreConf getBoolVar conf ConfVars USE_SSL useSasl MetastoreConf getBoolVar conf ConfVars USE_THRIFT_SASL String clientAuthMode MetastoreConf getVar conf ConfVars METASTORE_CLIENT_AUTH_MODE usePasswordAuth useFramedTransport MetastoreConf getBoolVar conf ConfVars USE_THRIFT_FRAMED_TRANSPORT useCompactProtocol MetastoreConf getBoolVar conf ConfVars USE_THRIFT_COMPACT_PROTOCOL clientSocketTimeout MetastoreConf getTimeVar conf ConfVars CLIENT_SOCKET_TIMEOUT TimeUnit MILLISECONDS clientAuthMode usePasswordAuth equalsIgnoreCase clientAuthMode isConnected
clientSocketTimeout MetastoreConf getTimeVar conf ConfVars CLIENT_SOCKET_TIMEOUT TimeUnit MILLISECONDS clientAuthMode usePasswordAuth equalsIgnoreCase clientAuthMode store LOG info store String trustStorePath MetastoreConf getVar conf ConfVars SSL_TRUSTSTORE_PATH trim trustStorePath IllegalArgumentException ConfVars SSL_TRUSTSTORE_PATH String trustStorePassword MetastoreConf getPassword conf MetastoreConf ConfVars SSL_TRUSTSTORE_PASSWORD transport SecurityUtils getSSLSocket store getHost store getPort clientSocketTimeout trustStorePath trustStorePassword newCount connCount incrementAndGet
HadoopThriftAuthBridge Client authBridge HadoopThriftAuthBridge getBridge createClient String tokenSig MetastoreConf getVar conf ConfVars TOKEN_SIGNATURE tokenStrForm SecurityUtils getTokenStrForm tokenSig tokenStrForm LOG debug transport authBridge createClientTransport store getHost tokenStrForm transport MetaStoreUtils getMetaStoreSaslProperties conf useSSL LOG debug String principalConfig MetastoreConf getVar conf ConfVars KERBEROS_PRINCIPAL transport authBridge createClientTransport principalConfig store getHost transport MetaStoreUtils getMetaStoreSaslProperties conf useSSL ioe LOG error ioe MetaException ioe toString
LOG debug transport authBridge createClientTransport store getHost tokenStrForm transport MetaStoreUtils getMetaStoreSaslProperties conf useSSL LOG debug String principalConfig MetastoreConf getVar conf ConfVars KERBEROS_PRINCIPAL transport authBridge createClientTransport principalConfig store getHost transport MetaStoreUtils getMetaStoreSaslProperties conf useSSL ioe LOG error ioe MetaException ioe toString transport TFramedTransport transport TProtocol protocol protocol TCompactProtocol transport
transport TFramedTransport transport TProtocol protocol protocol TCompactProtocol transport protocol TBinaryProtocol transport client ThriftHiveMetastore Client protocol transport transport open newCount connCount incrementAndGet LOG info store newCount LOG
tbl setCatName getDefaultCatalog conf HiveMetaHook hook getHook tbl hook hook preCreateTable tbl success create_table_with_environment_context tbl envContext hook hook commitCreateTable tbl success success hook hook rollbackCreateTable tbl
String catalogName String dbName deleteData getDatabase catalogName dbName e e String dbNameWithCatalog prependCatalogToDbName catalogName dbName conf List String materializedViews getTables dbName TableType MATERIALIZED_VIEW String table materializedViews dropTable dbName table deleteData List String tableNameList getAllTables dbName tableCount tableNameList size maxBatchSize MetastoreConf getIntVar conf ConfVars BATCH_RETRIEVE_MAX
Database catalogName databaseName t1 System currentTimeMillis GetDatabaseRequest request GetDatabaseRequest databaseName request setName databaseName catalogName request setCatalogName catalogName processorCapabilities request setProcessorCapabilities ArrayList Arrays asList processorCapabilities processorIdentifier request setProcessorIdentifier processorIdentifier Database d client get_database_req request deepCopy FilterUtils filterDbIfEnabled isClientFilterEnabled filterHook d diff System currentTimeMillis t1
GetTableRequest req GetTableRequest dbName tableName req setCatName catName req setCapabilities version req setGetColumnStats getColumnStats req setValidWriteIdList getValidWriteIdList TableName getDbTable dbName tableName getColumnStats req setEngine engine processorCapabilities req setProcessorCapabilities ArrayList String Arrays asList processorCapabilities processorIdentifier req setProcessorIdentifier processorIdentifier Table t client get_table_req req getTable deepCopy FilterUtils filterTableIfEnabled isClientFilterEnabled filterHook t diff System currentTimeMillis t1
req setCapabilities version validWriteIdList req setValidWriteIdList validWriteIdList req setValidWriteIdList getValidWriteIdList TableName getDbTable dbName tableName req setGetColumnStats getColumnStats getColumnStats req setEngine engine processorCapabilities req setProcessorCapabilities ArrayList String Arrays asList processorCapabilities processorIdentifier req setProcessorIdentifier processorIdentifier Table t client get_table_req req getTable deepCopy FilterUtils filterTableIfEnabled isClientFilterEnabled filterHook t diff System currentTimeMillis t1
NotificationEventResponse lastEventId maxEvents NotificationEventRequest rqst NotificationEventRequest lastEventId rqst setMaxEvents maxEvents NotificationEventResponse rsp client get_next_notification rqst LOG debug rsp rsp getEventsSize NotificationEventResponse filtered NotificationEventResponse rsp rsp nextEventId lastEventId prevEventId lastEventId rsp
NotificationEventResponse lastEventId maxEvents NotificationEventRequest rqst NotificationEventRequest lastEventId rqst setMaxEvents maxEvents NotificationEventResponse rsp client get_next_notification rqst LOG debug rsp rsp getEventsSize NotificationEventResponse filtered NotificationEventResponse rsp rsp nextEventId lastEventId prevEventId lastEventId e rsp LOG debug e getEventId e getEventId nextEventId e getEventId prevEventId
NotificationEventRequest rqst NotificationEventRequest lastEventId rqst setMaxEvents maxEvents NotificationEventResponse rsp client get_next_notification rqst LOG debug rsp rsp getEventsSize NotificationEventResponse filtered NotificationEventResponse rsp rsp nextEventId lastEventId prevEventId lastEventId e rsp LOG debug e getEventId e getEventId nextEventId e getEventId prevEventId LOG error prevEventId IllegalStateException REPL_EVENTS_WITH_DUPLICATE_ID_IN_METASTORE
mscLocalCache Configuration metaConf MetastoreConf newMetastoreConf LOG debug MAX_SIZE MetastoreConf getSizeVar metaConf MetastoreConf ConfVars MSC_CACHE_MAX_SIZE IS_CACHE_ENABLED MetastoreConf getBoolVar metaConf MetastoreConf ConfVars MSC_CACHE_ENABLED RECORD_STATS MetastoreConf getBoolVar metaConf MetastoreConf ConfVars MSC_CACHE_RECORD_STATS initSizeEstimator initCache
key val ObjectEstimator keySizeEstimator sizeEstimator get key getClass ObjectEstimator valSizeEstimator sizeEstimator get key IDENTIFIER valueClass keySize keySizeEstimator estimate key sizeEstimator valSize valSizeEstimator estimate val sizeEstimator
initSize initSize
FileSystem fs path getFileSystem conf fs path FileStatus files fs listStatus path hiddenFileFilter FileStatus file files count recycle file getPath type ifPurge String fileCheckSum checksumFor path fs Path cmPath getCMPath conf path getName fileCheckSum getCmRoot path toString now System currentTimeMillis fs setTimes path now success fs cmPath fileCheckSum checksumFor cmPath fs success type
fs setTimes path now success fs cmPath cmPath fs success LOG info path toString cmPath toString retriable fs rename path cmPath success retriable run
success retriable run e IOException org apache hadoop util StringUtils stringifyException e LOG info path toString cmPath toString success FileUtils copy fs path fs cmPath conf success fs setOwner cmPath msUser msGroup fs setXAttr cmPath ORIG_LOC_TAG path toString getBytes StandardCharsets UTF_8
String db db Map String String m db getParameters m m SOURCE_OF_REPLICATION String replPolicyId m get SOURCE_OF_REPLICATION
path FileStatus stat FileSystem fs fs getFs path stat fs getFileStatus path HdfsUtils checkFileAccess fs stat FsAction WRITE
classLoader classLoader MetastoreConf getClassLoader hiveDefaultURL classLoader getResource hiveSiteURL hiveSiteURL findConfigFile classLoader hiveSiteURL conf addResource hiveSiteURL hiveMetastoreSiteURL findConfigFile classLoader hiveMetastoreSiteURL conf addResource hiveMetastoreSiteURL metastoreSiteURL findConfigFile classLoader metastoreSiteURL conf addResource metastoreSiteURL
hiveSiteURL hiveSiteURL findConfigFile classLoader hiveSiteURL conf addResource hiveSiteURL hiveMetastoreSiteURL findConfigFile classLoader hiveMetastoreSiteURL conf addResource hiveMetastoreSiteURL metastoreSiteURL findConfigFile classLoader metastoreSiteURL conf addResource metastoreSiteURL var System getProperty var varname LOG debug var varname System getProperty var varname conf set var varname System getProperty var varname System
hiveMetastoreSiteURL findConfigFile classLoader hiveMetastoreSiteURL conf addResource hiveMetastoreSiteURL metastoreSiteURL findConfigFile classLoader metastoreSiteURL conf addResource metastoreSiteURL var System getProperty var varname LOG debug var varname System getProperty var varname conf set var varname System getProperty var varname System s s s String v System getProperty s LOG debug s v conf set s v
result result seeIfConfAtThisLocation name result result seeIfConfAtThisLocation name result result seeIfConfAtThisLocation name result URI jarUri jarUri MetastoreConf getProtectionDomain getCodeSource getLocation toURI e LOG warn e jarUri result seeIfConfAtThisLocation File jarUri getParent name result
result seeIfConfAtThisLocation name result result seeIfConfAtThisLocation name result result seeIfConfAtThisLocation name result URI jarUri jarUri MetastoreConf getProtectionDomain getCodeSource getLocation toURI e LOG warn e jarUri result seeIfConfAtThisLocation File jarUri getParent name result LOG info name
List NamingEnumeration SearchResult searchResults ArrayList
conf String principal String password Hashtable String Object env Hashtable String Object String ldapUrl MetastoreConf getVar conf MetastoreConf ConfVars METASTORE_PLAIN_LDAP_URL env put Context INITIAL_CONTEXT_FACTORY env put Context PROVIDER_URL ldapUrl env put Context SECURITY_AUTHENTICATION env put Context SECURITY_CREDENTIALS password env put Context SECURITY_PRINCIPAL principal
f LOG debug f result
fs f conf LOG debug f result LOG debug f result Trash moveToAppropriateTrash fs f conf result LOG trace f ioe LOG warn ioe getMessage result fs delete f result
srcFS src copied triedDistcp srcFS ContentSummary srcContentSummary srcFS getContentSummary src srcContentSummary srcContentSummary
srcFS src conf copied triedDistcp srcFS ContentSummary srcContentSummary srcFS getContentSummary src srcContentSummary MetastoreConf getLongVar conf ConfVars srcContentSummary getLength MetastoreConf getLongVar conf ConfVars REPL_COPYFILE_MAXSIZE LOG info srcContentSummary getLength MetastoreConf getLongVar conf ConfVars REPL_COPYFILE_MAXSIZE
fs ugi String user ugi getShortUserName String groups ugi getGroupNames groups String superGroupName fs getConf get groups superGroupName
aclEntries ArrayList sourceStatus getAclEntries removeBaseAclEntries aclEntries aclEntries add newAclEntry AclEntryScope ACCESS AclEntryType USER sourcePerm getUserAction aclEntries add newAclEntry AclEntryScope ACCESS AclEntryType GROUP sourcePerm getGroupAction aclEntries add newAclEntry AclEntryScope ACCESS AclEntryType OTHER sourcePerm getOtherAction fsShell setConf conf group group run fsShell String group target toString aclEntries String aclEntry Joiner on join aclEntries run fsShell String aclEntry target toString
removeBaseAclEntries aclEntries aclEntries add newAclEntry AclEntryScope ACCESS AclEntryType USER sourcePerm getUserAction aclEntries add newAclEntry AclEntryScope ACCESS AclEntryType GROUP sourcePerm getGroupAction aclEntries add newAclEntry AclEntryScope ACCESS AclEntryType OTHER sourcePerm getOtherAction fsShell setConf conf group group run fsShell String group target toString aclEntries String aclEntry Joiner on join aclEntries run fsShell String aclEntry target toString LOG info target
run fsShell String aclEntry target toString e LOG info target LOG debug e e String permission Integer toString sourcePerm toShort run fsShell String permission target toString group group group fs setOwner target group aclEntries fs setAcl target aclEntries
run shell command LOG debug ArrayUtils toString command retval shell run command
e String exInfo e getClass getName e getMessage
params setKeyStore keyStorePath keyStorePassWord InetSocketAddress serverAddress hiveHost hiveHost serverAddress InetSocketAddress portNum serverAddress InetSocketAddress hiveHost portNum TServerSocket thriftServerSocket TSSLTransportFactory getServerSocket portNum serverAddress getAddress params thriftServerSocket getServerSocket SSLServerSocket List String sslVersionBlacklistLocal ArrayList String sslVersion sslVersionBlacklistLocal add sslVersion trim toLowerCase SSLServerSocket sslServerSocket SSLServerSocket thriftServerSocket getServerSocket List String enabledProtocols ArrayList String sslServerSocket sslVersionBlacklistLocal toLowerCase
serverAddress InetSocketAddress hiveHost portNum TServerSocket thriftServerSocket TSSLTransportFactory getServerSocket portNum serverAddress getAddress params thriftServerSocket getServerSocket SSLServerSocket List String sslVersionBlacklistLocal ArrayList String sslVersion sslVersionBlacklistLocal add sslVersion trim toLowerCase SSLServerSocket sslServerSocket SSLServerSocket thriftServerSocket getServerSocket List String enabledProtocols ArrayList String protocol sslServerSocket sslVersionBlacklistLocal protocol toLowerCase LOG debug protocol enabledProtocols add protocol sslServerSocket setEnabledProtocols enabledProtocols toArray String
get catName dbName tblName colName Key key Key catName dbName tblName colName AggrColStatsList candidateList cacheStore get key candidateList candidateList
AggrColStats get catName dbName tblName colName partNames Key key Key catName dbName tblName colName AggrColStatsList candidateList cacheStore get key candidateList candidateList nodes LOG debug key toString AggrColStats match isLocked isLocked candidateList readLock tryLock maxReaderWaitTime TimeUnit MILLISECONDS isLocked match findBestMatch partNames candidateList nodes match candidateList updateLastAccessTime cacheHits incrementAndGet
LOG debug key toString AggrColStats match isLocked isLocked candidateList readLock tryLock maxReaderWaitTime TimeUnit MILLISECONDS isLocked match findBestMatch partNames candidateList nodes match candidateList updateLastAccessTime cacheHits incrementAndGet LOG info cacheHits longValue cacheMisses longValue getHitRatio cacheMisses incrementAndGet
listIterator listIterator node listIterator next node listIterator remove numRemovedTTL currentNodes getAndDecrement e LOG debug e candidateList writeLock unlock Thread yield evictOneNode
TTransportFactory useSSL conf LoginException TTransportFactory transportFactory TSaslServerTransport Factory serverTransportFactory LoginException serverTransportFactory saslServer createSaslServerTransportFactory MetaStoreUtils getMetaStoreSaslProperties conf useSSL transportFactory saslServer wrapTransportFactoryInClientUGI serverTransportFactory e LoginException e getMessage MetaStorePlainSaslHelper init
authTypeStr authTypeStr authTypeStr authTypeStr authTypeStr authTypeStr MetaStorePlainSaslHelper init LOG debug authTypeStr serverTransportFactory serverTransportFactory addServerDefinition authTypeStr HashMap String String MetaStorePlainSaslHelper PlainServerCallbackHandler authTypeStr conf e LoginException e LoginException authTypeStr authTypeStr authTypeStr authTypeStr authTypeStr authTypeStr LoginException
files ArrayList RemoteIterator LocatedFileStatus iter fs listFiles path iter LocatedFileStatus lfs iter next lfs isDirectory files add lfs getPath Path file files fileId fs DistributedFileSystem fileId HdfsUtils getFileId fs Path getPathWithoutSchemeAndAuthority file toString LOG error location fs getClass getCanonicalName
InvalidOperationException oldt toString oldt getSd getLocation newt getSd getLocation newt getSd getLocation oldt srcPath Path oldt getSd getLocation destPath Path newt getSd getLocation dataWasMoved String oldtRelativePath wh getDatabasePath olddb toUri relativize srcPath toUri toString tableInSpecifiedLoc oldtRelativePath equalsIgnoreCase name oldtRelativePath equalsIgnoreCase name Path SEPARATOR tableInSpecifiedLoc srcFs wh getFs srcPath Database db msdb getDatabase catName newDbName assert isReplicated HiveMetaStore HMSHandler isDbReplicationTarget db Path databasePath constructRenamedPath wh getDatabasePath db srcPath
oldt toString oldt getSd getLocation newt getSd getLocation newt getSd getLocation oldt srcPath Path oldt getSd getLocation destPath Path newt getSd getLocation dataWasMoved String oldtRelativePath wh getDatabasePath olddb toUri relativize srcPath toUri toString tableInSpecifiedLoc oldtRelativePath equalsIgnoreCase name oldtRelativePath equalsIgnoreCase name Path SEPARATOR tableInSpecifiedLoc srcFs wh getFs srcPath Database db msdb getDatabase catName newDbName assert isReplicated HiveMetaStore HMSHandler isDbReplicationTarget db Path databasePath constructRenamedPath wh getDatabasePath db srcPath destPath Path databasePath newTblName destFs wh getFs destPath
runPartitionMetadataUpdate cascade MetaStoreServerUtils areSameColumns oldt getSd getCols newt getSd getCols runPartitionMetadataUpdate cascade MetaStoreServerUtils arePrefixColumns oldt getSd getCols newt getSd getCols retainOnColRemoval MetastoreConf getBoolVar handler getConf MetastoreConf ConfVars COLSTATS_RETAIN_ON_COLUMN_REMOVAL runPartitionMetadataUpdate cascade retainOnColRemoval parts msdb getPartitions catName dbname name Partition part parts Partition oldPart Partition part List FieldSchema oldCols part getSd getCols part getSd setCols newt getSd getCols List ColumnStatistics colStats updateOrGetPartitionColumnStats msdb catName dbname name part getValues oldCols oldt part assert colStats isEmpty cascade msdb alterPartition catName dbname name part getValues part writeIdList
parts msdb getPartitions catName dbname name Partition part parts Partition oldPart Partition part List FieldSchema oldCols part getSd getCols part getSd setCols newt getSd getCols List ColumnStatistics colStats updateOrGetPartitionColumnStats msdb catName dbname name part getValues oldCols oldt part assert colStats isEmpty msdb alterPartition catName dbname name part getValues part writeIdList oldPart setParameters part getParameters msdb alterPartition catName dbname name part getValues oldPart writeIdList
String newPartLoc Path srcPath Path destPath FileSystem srcFs FileSystem destFs dataWasMoved Database db msdb openTransaction Table tbl msdb getTable DEFAULT_CATALOG_NAME dbname name tbl InvalidObjectException oldPart msdb getPartition catName dbname name part_vals
check_part msdb getPartition catName dbname name new_part getValues e check_part check_part AlreadyExistsException dbname name new_part getValues tbl db msdb getDatabase catName dbname destPath wh getPartitionPath db tbl new_part getValues destPath constructRenamedPath destPath Path new_part getSd getLocation e LOG debug e InvalidOperationException dbname e getMessage destPath
e check_part check_part AlreadyExistsException dbname name new_part getValues tbl toString db msdb getDatabase catName dbname destPath wh getPartitionPath db tbl new_part getValues destPath constructRenamedPath destPath Path new_part getSd getLocation e LOG debug e InvalidOperationException dbname e getMessage destPath newPartLoc destPath toString oldPartLoc oldPart getSd getLocation
AlreadyExistsException dbname name new_part getValues tbl toString db msdb getDatabase catName dbname destPath wh getPartitionPath db tbl new_part getValues destPath constructRenamedPath destPath Path new_part getSd getLocation e LOG debug e InvalidOperationException dbname e getMessage destPath newPartLoc destPath toString oldPartLoc oldPart getSd getLocation LOG info oldPartLoc LOG info newPartLoc
MetaException destParentPath wh renameDir srcPath destPath ReplChangeManager shouldEnableCm db tbl LOG info srcPath destPath dataWasMoved e LOG error srcPath destPath e InvalidOperationException tbl getDbName tbl getTableName new_part getValues MetaException me LOG error srcPath destPath me me new_part getSd setLocation newPartLoc new_part getSd setLocation oldPart getSd getLocation MetaStoreServerUtils oldPart new_part tbl environmentContext MetaStoreServerUtils updatePartitionStatsFast new_part tbl wh environmentContext
wh renameDir srcPath destPath ReplChangeManager shouldEnableCm db tbl LOG info srcPath destPath dataWasMoved e LOG error srcPath destPath e InvalidOperationException tbl getDbName tbl getTableName new_part getValues me LOG error srcPath destPath me me new_part getSd setLocation newPartLoc new_part getSd setLocation oldPart getSd getLocation MetaStoreServerUtils oldPart new_part tbl environmentContext MetaStoreServerUtils updatePartitionStatsFast new_part tbl wh environmentContext String newPartName Warehouse makePartName tbl getPartitionKeys new_part getValues
System err println msg item conf set String item getKey String item getValue conf set ConfVars THRIFT_URIS getHiveName String shutdownMsg HMSHandler LOG info shutdownMsg System err println shutdownMsg conf ConfVars Metrics shutdown e LOG error e getClass getName e getMessage e
String shutdownMsg HMSHandler LOG info shutdownMsg System err println shutdownMsg Metrics shutdown e LOG error e getClass getName e getMessage e zooKeeperHelper removeServerInstanceFromZooKeeper e LOG error e
conf String String leaderHost MetastoreConf getVar conf MetastoreConf ConfVars METASTORE_HOUSEKEEPING_LEADER_HOSTNAME leaderHost leaderHost
pauseMonitor start t LOG warn t startCondition await startCompactorInitiator conf startCompactorCleaner conf startRemoteOnlyTasks conf startStatsUpdater conf HiveMetaStore HMSHandler startAlwaysTaskThreads conf conf startCompactorWorkers conf
clazz String String hostname getHostname String classname clazz getSimpleName
fs partPath getFileSystem conf CheckResult PartitionResult prFromMetastore CheckResult PartitionResult prFromMetastore setPartitionName getPartitionName table partition prFromMetastore setTableName partition getTableName fs partPath result getPartitionsNotOnFs add prFromMetastore result getCorrectPartitions add prFromMetastore currentEpochSecs Instant now getEpochSecond createdTime partition getCreateTime partitionAgeSeconds currentEpochSecs createdTime partitionAgeSeconds CheckResult PartitionResult pr CheckResult PartitionResult pr setPartitionName getPartitionName table partition
String visParts folder split VISIBILITY_PREFIX visParts length visibilityId Long parseLong visParts folder visParts folder startsWith BASE_PREFIX writeId Long parseLong folder substring BASE_PREFIX length folder startsWith DELTA_PREFIX folder startsWith DELETE_DELTA_PREFIX isDeleteDelta folder startsWith DELETE_DELTA_PREFIX String rest folder substring isDeleteDelta DELETE_DELTA_PREFIX DELTA_PREFIX length String nameParts rest split writeId Long parseLong nameParts length nameParts nameParts writeId maxWriteId maxWriteId writeId visibilityId maxVisibilityId maxVisibilityId visibilityId
executor Path basePath Path result fs partColNames Queue Future Path futures LinkedList ConcurrentLinkedQueue PathDepthInfo nextLevel ConcurrentLinkedQueue nextLevel add PathDepthInfo basePath nextLevel ConcurrentLinkedQueue PathDepthInfo tempQueue ConcurrentLinkedQueue nextLevel futures add executor submit PathDepthInfoCallable nextLevel poll partColNames fs tempQueue futures Path p futures poll get p result add p nextLevel tempQueue
LOG trace queryTextDbParams params Map String String dbParams HashMap String String List Object sqlResult2 MetastoreDirectSqlUtils ensureList executeWithArray queryDbParams params queryTextDbParams sqlResult2 isEmpty Object line sqlResult2 dbParams put MetastoreDirectSqlUtils extractSqlString line MetastoreDirectSqlUtils extractSqlString line Database db Database db setName MetastoreDirectSqlUtils extractSqlString dbline db setLocationUri MetastoreDirectSqlUtils extractSqlString dbline db setDescription MetastoreDirectSqlUtils extractSqlString dbline db setOwnerName MetastoreDirectSqlUtils extractSqlString dbline String type MetastoreDirectSqlUtils extractSqlString dbline db setOwnerType type type trim isEmpty PrincipalType valueOf type db setCatalogName MetastoreDirectSqlUtils extractSqlString dbline db setCreateTime MetastoreDirectSqlUtils extractSqlInt dbline
partsFound colStatsAggrCached getNumPartsCached computePartsFound partsFound partsFoundForPartitions catName dbName tableName partNames colNames engine computePartsFound List String colNamesForDB ArrayList colNamesForDB add colName colStatsAggrFromDB columnStatisticsObjForPartitions catName dbName tableName partNames colNamesForDB engine partsFound useDensityFunctionForNDVEstimation ndvTuner enableBitVector colStatsAggrFromDB ColumnStatisticsObj colStatsAggr colStatsAggrFromDB get colStatsList add colStatsAggr aggrStatsCache add catName dbName tableName colName partsFound colStatsAggr bloomFilter partsFound partsFoundForPartitions catName dbName tableName partNames colNames engine colStatsList columnStatisticsObjForPartitions catName dbName tableName partNames colNames engine partsFound useDensityFunctionForNDVEstimation ndvTuner enableBitVector
String String String String String String queryText PARTITIONS PART_COL_STATS TBLS DBS TBLS DBS PARTITIONS TBLS PARTITIONS PART_COL_STATS PARTITIONS PART_COL_STATS DBS DBS TBLS PARTITIONS
Map Table List String List Table objects List String String processorId LOG info processorId objects size Map Table List String ret HashMap Table List String Table table objects List String generated ArrayList String List String requiredReads ArrayList List String requiredWrites ArrayList table ret put table generated Map String String params table getParameters String tableType table getTableType String tCapabilities params get OBJCAPABILITIES numBuckets table isSetSd table getSd getNumBuckets isBucketed numBuckets
generated addAll MQTLIST ret put table generated table setAccessType ret put table generated tCapabilities tCapabilities replaceAll toUpperCase List String requiredCapabilities Arrays asList tCapabilities split tableType requiredCapabilities LOG info tableType table setAccessType ACCESSTYPE_READWRITE ret put table requiredCapabilities
tCapabilities tCapabilities replaceAll toUpperCase List String requiredCapabilities Arrays asList tCapabilities split tableType requiredCapabilities LOG info tableType table setAccessType ACCESSTYPE_READWRITE ret put table requiredCapabilities Table newTable Table table requiredCapabilities StorageDescriptor newSd StorageDescriptor table getSd newSd setNumBuckets LOG debug
tCapabilities tCapabilities replaceAll toUpperCase List String requiredCapabilities Arrays asList tCapabilities split tableType requiredCapabilities LOG info tableType table setAccessType ACCESSTYPE_READWRITE ret put table requiredCapabilities Table newTable Table table requiredCapabilities StorageDescriptor newSd StorageDescriptor table getSd newSd setNumBuckets LOG debug newTable setSd newSd
LOG info table setAccessType ACCESSTYPE_READONLY List String missing diff requiredCapabilities processorCapabilities table setRequiredWriteCapabilities getWrites missing ret put table missing String txntype params get TABLE_TRANSACTIONAL_PROPERTIES List String hintList ArrayList txntype txntype LOG info processorCapabilities getWrites requiredCapabilities processorCapabilities LOG info table setAccessType ACCESSTYPE_READWRITE ret put table hintList
table setAccessType ACCESSTYPE_READONLY table setRequiredWriteCapabilities diff getWrites requiredCapabilities getWrites processorCapabilities hintList add HIVEMANAGEDINSERTWRITE hintList addAll diff getWrites requiredCapabilities processorCapabilities ret put table hintList processorCapabilities CONNECTORREAD LOG debug table setAccessType ACCESSTYPE_READONLY table setRequiredWriteCapabilities diff getWrites requiredCapabilities getWrites processorCapabilities hintList add CONNECTORREAD hintList addAll diff getWrites requiredCapabilities processorCapabilities ret put table hintList
LOG debug table setAccessType ACCESSTYPE_NONE ret put table requiredCapabilities table setRequiredWriteCapabilities diff getWrites requiredCapabilities getWrites processorCapabilities table setRequiredReadCapabilities diff getReads requiredCapabilities getReads processorCapabilities LOG info processorCapabilities getWrites requiredCapabilities processorCapabilities HIVEFULLACIDWRITE LOG info HIVEFULLACIDWRITE table setAccessType ACCESSTYPE_READWRITE hintList add HIVEFULLACIDWRITE ret put table hintList
table LOG debug objects LOG info processorId objects size List Partition ret ArrayList partBuckets Partition partition objects String tableName partition getTableName String dbName partition getDbName Map String String params table getParameters params params HashMap String tableType table getTableType String tCapabilities params get OBJCAPABILITIES partition getSd partBuckets partition getSd getNumBuckets
LOG info processorId objects size List Partition ret ArrayList partBuckets Partition partition objects String tableName partition getTableName String dbName partition getDbName Map String String params table getParameters params params HashMap String tableType table getTableType String tCapabilities params get OBJCAPABILITIES partition getSd partBuckets partition getSd getNumBuckets LOG debug partBuckets partBuckets
contains processorCapabilities contains Partition newPartition Partition partition StorageDescriptor newSd StorageDescriptor partition getSd processorCapabilities contains ACCEPTSUNMODIFIEDMETADATA newSd setNumBuckets newPartition setSd newSd LOG info ret add newPartition processorCapabilities contains Partition newPartition Partition partition StorageDescriptor newSd StorageDescriptor partition getSd
String tableType newTable getTableType String txnal String txn_properties isInsertAcid String dbName table getDbName Database db db hmsHandler get_database_core table getCatName table getDbName MetaException dbName table getTableName tableType LOG debug txnal params get TABLE_IS_TRANSACTIONAL txn_properties params get TABLE_TRANSACTIONAL_PROPERTIES isInsertAcid txn_properties txn_properties equalsIgnoreCase
MetaException dbName table getTableName TableType LOG debug txnal params get TABLE_IS_TRANSACTIONAL txn_properties params get TABLE_TRANSACTIONAL_PROPERTIES isInsertAcid txn_properties txn_properties equalsIgnoreCase txnal txnal equalsIgnoreCase isInsertAcid LOG info newTable getTableName processorId newTable setTableType TableType EXTERNAL_TABLE toString params remove TABLE_IS_TRANSACTIONAL params remove TABLE_TRANSACTIONAL_PROPERTIES params put params put EXTERNAL_TABLE_PURGE params put
processorCapabilities processorCapabilities MetaException newTable validateTablePaths table processorCapabilities LOG debug newTable MetaException diff insertOnlyWriteList processorCapabilities processorCapabilities LOG debug newTable
db LOG info processorId processorCapabilities db getName db getLocationUri db getManagedLocationUri Path locationPath Path getPathWithoutSchemeAndAuthority Path db getLocationUri Path whRootPath Path getPathWithoutSchemeAndAuthority hmsHandler getWh getWhRoot whRootPath toString locationPath toString processorCapabilities processorCapabilities processorCapabilities LOG debug db getLocationUri db setManagedLocationUri Path db getLocationUri toString Path extWhLocation hmsHandler getWh getDefaultExternalDatabasePath db getName LOG info extWhLocation toString db setLocationUri extWhLocation toString processorCapabilities processorCapabilities processorCapabilities Path mgdWhLocation hmsHandler getWh getDefaultDatabasePath db getName
Path locationPath Path getPathWithoutSchemeAndAuthority Path db getLocationUri Path whRootPath Path getPathWithoutSchemeAndAuthority hmsHandler getWh getWhRoot whRootPath toString locationPath toString LOG debug db getLocationUri db setManagedLocationUri Path db getLocationUri toString Path extWhLocation hmsHandler getWh getDefaultExternalDatabasePath db getName LOG info extWhLocation toString db setLocationUri extWhLocation toString Path mgdWhLocation hmsHandler getWh getDefaultDatabasePath db getName LOG debug mgdWhLocation toString db setManagedLocationUri mgdWhLocation toString
List String List String list1 List String list2 List String diffList ArrayList list2 list2 size list1 list1 list1 size Collections emptyList list2 containsAll list1 Collections emptyList diffList addAll list2
List String List String list1 List String list2 List String diffList ArrayList list2 list2 size list1 list1 list1 size Collections emptyList list2 containsAll list1 Collections emptyList diffList addAll list2 LOG debug Arrays toString diffList toArray Arrays toString list1 toArray diffList list1
list2 list2 size list1 list1 list1 size Collections emptyList list2 containsAll list1 Collections emptyList diffList addAll list2 LOG debug Arrays toString diffList toArray Arrays toString list1 toArray diffList list1 LOG debug Arrays toString diffList toArray diffList size list1 size Collections emptyList list1 removeAll diffList LOG debug list1 size list1 list1 removeAll diffList
tableLocation MetaException Path path hmsHandler getWh getDefaultTablePath db table getTableName table getSd setLocation path toString table tableLocation Path tablePath Path getPathWithoutSchemeAndAuthority Path tableLocation hmsHandler getWh getWhRoot toString tableLocation MetaException table getTableName tableLocation hmsHandler getWh getWhRoot Path path hmsHandler getWh getDefaultManagedTablePath db table getTableName table getSd setLocation path toString
ret
result StringBuilder sb StringBuilder sb append TABLES_NOT_IN_METASTORE append append result getTablesNotInMs append append TABLES_MISSING_ON_FILESYSTEM append append result getTablesNotOnFs append append PARTITIONS_NOT_IN_METASTORE append append result getPartitionsNotInMs append append PARTITIONS_MISSING_FROM_FILESYSTEM append append result getPartitionsNotOnFs append append EXPIRED_PARTITIONS append append result getExpiredPartitions append
FileSystem fs resFile getFileSystem getConf resultOut fs resFile firstWritten firstWritten writeMsckResult result getTablesNotInMs TABLES_NOT_IN_METASTORE resultOut firstWritten firstWritten writeMsckResult result getTablesNotOnFs TABLES_MISSING_ON_FILESYSTEM resultOut firstWritten firstWritten writeMsckResult result getPartitionsNotInMs PARTITIONS_NOT_IN_METASTORE resultOut firstWritten firstWritten writeMsckResult result getPartitionsNotOnFs PARTITIONS_MISSING_FROM_FILESYSTEM resultOut firstWritten firstWritten writeMsckResult result getExpiredPartitions String format EXPIRED_PARTITIONS_RETENTION partitionExpirySeconds resultOut firstWritten String rout firstWritten resultOut write terminator firstWritten resultOut write rout
String dbName String tableName String username getUserName txnId getMsc openTxn username String agentInfo Thread currentThread getName LockRequestBuilder requestBuilder LockRequestBuilder agentInfo requestBuilder setUser username requestBuilder setTransactionId txnId LockComponentBuilder lockCompBuilder LockComponentBuilder setDbName dbName setTableName tableName setIsTransactional setExclusive setOperationType DataOperationType NO_TXN requestBuilder addLockComponent lockCompBuilder build
List String addMsgs ArrayList currentBatchSize part currentBatchSize Path tablePath MetaStoreServerUtils getPath table tablePath Map String String partSpec Warehouse makeSpecFromName part getPartitionName Path location part getLocation tablePath partSpec Partition partition MetaStoreServerUtils createMetaPartitionObject table partSpec location partition setWriteId table getWriteId partsToAdd add partition lastBatch add part String msg String format addMsgFormat part getPartitionName addMsgs add msg
lastBatch add part dropMsgs add String format dropMsgFormat part getPartitionName currentBatchSize List Pair Integer partExprs getPartitionExpr dropParts metastoreClient dropPartitions table getCatName table getDbName table getTableName partExprs dropOptions batchWork removeAll lastBatch repairOutput addAll dropMsgs e MetastoreException e List Pair Integer getPartitionExpr List String parts List Pair Integer expr ArrayList parts size i i parts size i String partName parts get i Map String String partSpec Warehouse makeSpecFromName partName
expr String String String partExpr String expr StandardCharsets UTF_8
String colAndValue part split String key FileUtils unescapePathName colAndValue String value FileUtils unescapePathName colAndValue substring colAndValue length partValueSet add key value List String partNamesSeq ArrayList String partition partitionNames isMatch String partnames partition split String part partnames partValueSet FileUtils unescapePathName part isMatch isMatch partNamesSeq add partition partitionNames clear
LOG debug pm PersistenceManagerProvider getPersistenceManager
success
typeName success Query query openTransaction query pm newQuery MType query declareParameters query setUnique MType type MType query execute typeName trim pm retrieve type type pm deletePersistent type success commitTransaction success commitTransaction
List MTablePrivilege tabGrants listAllTableGrants catName dbName tableName tabGrants pm deletePersistentAll tabGrants List MTableColumnPrivilege tblColGrants listTableAllColumnGrants catName dbName tableName tblColGrants pm deletePersistentAll tblColGrants List MPartitionPrivilege partGrants listTableAllPartitionGrants catName dbName tableName partGrants pm deletePersistentAll partGrants List MPartitionColumnPrivilege partColGrants listTableAllPartitionColumnGrants catName dbName tableName partColGrants pm deletePersistentAll partColGrants deleteTableColumnStatistics catName dbName tableName
List String String String String committed Query query List String mViewList ArrayList openTransaction query pm newQuery List MCreationMetadata creationMetadata List MCreationMetadata query execute Iterator MCreationMetadata iter creationMetadata iterator iter MCreationMetadata p iter next Set MTable tables p getTables MTable tables
commited Query query List TableMeta metas ArrayList openTransaction StringBuilder filterBuilder StringBuilder List String parameterVals ArrayList appendSimpleCondition filterBuilder String catName parameterVals dbNames dbNames appendPatternCondition filterBuilder dbNames parameterVals tableNames tableNames appendPatternCondition filterBuilder tableNames parameterVals tableTypes tableTypes appendSimpleCondition filterBuilder tableTypes toArray String parameterVals
AttachedMTableInfo catName db table AttachedMTableInfo nmtbl AttachedMTableInfo MTable mtbl commited Query query openTransaction catName normalizeIdentifier catName db normalizeIdentifier db table normalizeIdentifier table query pm newQuery MTable query declareParameters query setUnique
PartitionValuesResponse catName dbName tableName cols applyDistinct filter ascending maxParts catName normalizeIdentifier catName dbName dbName toLowerCase trim tableName tableName toLowerCase trim filter filter PartitionValuesResponse response getDistinctValuesForPartitionsNoTxn catName dbName tableName cols applyDistinct maxParts LOG info response getPartitionValues size response PartitionValuesResponse response extractPartitionNamesByFilter catName dbName tableName filter cols ascending maxParts response getPartitionValues LOG info response getPartitionValues size response
MetaException LOG warn filter partitionNames partitions getPartitionsByFilter catName dbName tableName filter maxParts partitions partitionNames ArrayList partitions size partition partitions tbl getPartitionKeys partition getValues partitionNames add Warehouse makePartName tbl getPartitionKeys partition getValues partitionNames MetaException filter TableName getQualified catName dbName tableName partitionNames sort Collections reverseOrder PartitionValuesResponse response PartitionValuesResponse response setPartitionValues ArrayList partitionNames size
openTransaction LOG debug catName normalizeIdentifier catName dbName dbName toLowerCase tableName tableName toLowerCase MTable mtable getMTable catName dbName tableName mtable partNames Map String Object params HashMap String queryFilterString makeQueryFilterString catName dbName mtable filter params Query query pm newQuery queryFilterString maxParts query setRange maxParts LOG debug filter queryFilterString
Query query pm newQuery queryFilterString maxParts query setRange maxParts LOG debug filter queryFilterString LOG debug params String parameterDeclaration makeParameterDeclarationStringObj params query declareParameters parameterDeclaration query setOrdering query setOrdering query setResult Collection String names Collection String query executeWithMap params partNames ArrayList names LOG debug
mparts ArrayList results size Object row results MPartition mpart MPartition i Object val row MetaStoreServerUtils setNestedProperty mpart fieldNames get i val i mparts add mpart List Object results List Object query executeWithMap params mparts ArrayList results size Object row results MPartition mpart MPartition MetaStoreServerUtils setNestedProperty mpart fieldNames get row mparts add mpart
String catName String dbName String tblName String partNames Pair Query Map String String queryWithParams getPartQueryWithParams catName dbName tblName partNames Query query queryWithParams getLeft query setClass MPartition deleted query deletePersistentAll queryWithParams getRight
Query Map String String String catName String dbName String tblName String partNames Query query pm newQuery Map String String params HashMap String filterStr getJDOFilterStrForPartitionNames catName dbName tblName partNames params query setFilter filterStr
openTransaction LOG debug catName normalizeIdentifier catName dbName normalizeIdentifier dbName Map String Object params HashMap String queryFilterString makeQueryFilterString catName dbName filter params query pm newQuery MTable query declareImports query setResult query setResultClass java lang String maxTables query setRange maxTables LOG debug filter queryFilterString LOG String Object params
String errorMsg verifyStatsChangeCtx TableName getDbTable dbname name oldp getParameters newPart getParameters newPart getWriteId validWriteIds errorMsg MetaException errorMsg oldp setParameters newPart getParameters name oldp copyMSD newp getSd oldp getSd newp getCreateTime oldp getCreateTime oldp setCreateTime newp getCreateTime newp getLastAccessTime oldp getLastAccessTime oldp setLastAccessTime newp getLastAccessTime StatsSetupConst setBasicStatsState oldp getParameters StatsSetupConst FALSE validWriteIds newPart getWriteId
Ref MColumnDescriptor oldCdRef Ref Partition tmpPart List String tmpPartVals part_val_itr next writeId tmpPart setWriteId writeId oldCdRef t Partition result alterPartitionNoTxn catName dbname name tmpPartVals tmpPart queryWriteIdList oldCdRef results add result oldCdRef t oldCds add oldCdRef t MColumnDescriptor oldCd oldCds removeUnusedColumnDescriptor oldCd success commitTransaction exception e exception
String success Query query openTransaction MMetastoreDBProperties prop MMetastoreDBProperties prop setPropertykey String guid UUID randomUUID toString
String success Query query openTransaction MMetastoreDBProperties prop MMetastoreDBProperties prop setPropertykey String guid UUID randomUUID toString LOG debug guid prop setPropertyValue guid prop setDescription LocalDateTime now format DateTimeFormatter ofPattern pm makePersistent prop success commitTransaction success
String success Query query openTransaction query pm newQuery MMetastoreDBProperties query declareParameters Collection MMetastoreDBProperties names Collection MMetastoreDBProperties query execute List String uuids ArrayList MMetastoreDBProperties i names i String uuid i next getPropertyValue
Query query openTransaction query pm newQuery MMetastoreDBProperties query declareParameters Collection MMetastoreDBProperties names Collection MMetastoreDBProperties query execute List String uuids ArrayList MMetastoreDBProperties i names i String uuid i next getPropertyValue LOG debug uuid uuids add uuid success commitTransaction uuids MetaException uuids
List MRoleMap roleName principalType LOG debug Preconditions checkState currentTransaction isActive query pm MRoleMap query declareParameters List MRoleMap mRoleMemebership List MRoleMap query execute roleName principalType toString LOG debug pm retrieveAll mRoleMemebership
MetaException e getMessage grants catName objToRefresh getDbName objToRefresh getObjectName authorizer objToRefresh grants getTableAllColumnGrants catName objToRefresh getDbName objToRefresh getObjectName authorizer MetaException objToRefresh revokePrivilegeSet addAll grants grantPrivilege revokePrivilegeSet grantPrivilege revokePrivilegeSet remove grantPrivilege grantPrivilegeSet add grantPrivilege
revokePrivilegeSet addAll grants grantPrivilege revokePrivilegeSet grantPrivilege revokePrivilegeSet remove grantPrivilege grantPrivilegeSet add grantPrivilege revokePrivilegeSet LOG debug revokePrivilegeSet size PrivilegeBag remainingRevokePrivileges PrivilegeBag revokePrivilege revokePrivilegeSet remainingRevokePrivileges addToPrivileges revokePrivilege revokePrivileges remainingRevokePrivileges
List MDBPrivilege principalName principalType List MDBPrivilege mSecurityDBList LOG debug Preconditions checkState currentTransaction isActive principalName principalType query pm MDBPrivilege query declareParameters mSecurityDBList List MDBPrivilege query execute principalName principalType toString pm retrieveAll mSecurityDBList
List MDBPrivilege principalName principalType List MDBPrivilege mSecurityDBList LOG debug Preconditions checkState currentTransaction isActive principalName principalType query pm MDBPrivilege query declareParameters mSecurityDBList List MDBPrivilege query execute principalName principalType toString pm retrieveAll mSecurityDBList LOG debug mSecurityDBList Collections unmodifiableList ArrayList mSecurityDBList query pm MDBPrivilege mSecurityDBList List MDBPrivilege query execute pm retrieveAll mSecurityDBList
String queryStr query pm newQuery MTableColumnPrivilege queryStr query declareParameters mPrivs List MTableColumnPrivilege query executeWithArray tableName dbName catName authorizer String queryStr query pm newQuery MTableColumnPrivilege queryStr query declareParameters mPrivs List MTableColumnPrivilege query executeWithArray tableName dbName catName LOG debug pm retrieveAll mPrivs LOG debug success commitTransaction LOG debug mTblColPrivilegeList addAll mPrivs
dbName normalizeIdentifier dbName catName normalizeIdentifier catName Query query String args authorizer query pm newQuery MDBPrivilege query declareParameters args String dbName catName authorizer query pm newQuery MDBPrivilege query declareParameters args String dbName catName Query query List MDBPrivilege mSecurityDBList List MDBPrivilege query executeWithArray args pm retrieveAll mSecurityDBList
mStatsObj Preconditions checkState currentTransaction isActive String colName mStatsObj getColName
mStatsObj String catName mStatsObj getCatName String dbName mStatsObj getDbName String tableName mStatsObj getTableName String partName mStatsObj getPartitionName String colName mStatsObj getColName Preconditions checkState currentTransaction isActive
writeMTableColumnStatistics table mStatsObj oldStats get statsObj getColName String dbname table getDbName String name table getTableName MTable oldt getMTable catName dbname name Map String String newParams HashMap table getParameters StatsSetupConst setColumnStatsState newParams colNames isTxn TxnUtils isTransactionalTable oldt getParameters isTxn StatsSetupConst setBasicStatsState newParams StatsSetupConst FALSE String errorMsg verifyStatsChangeCtx TableName getDbTable dbname name oldt getParameters newParams writeId validWriteIds errorMsg MetaException errorMsg oldt validWriteIds
NoSuchObjectException statsObj MPartitionColumnStatistics mStatsObj StatObjectConverter convertToMPartitionColumnStatistics mPartition statsDesc statsObj colStats getEngine writeMPartitionColumnStatistics table partition mStatsObj oldStats get statsObj getColName Map String String newParams HashMap mPartition getParameters StatsSetupConst setColumnStatsState newParams colNames isTxn TxnUtils isTransactionalTable table isTxn StatsSetupConst setBasicStatsState newParams StatsSetupConst FALSE String errorMsg verifyStatsChangeCtx TableName getDbTable statsDesc getDbName statsDesc getTableName mPartition getParameters newParams writeId validWriteIds errorMsg MetaException errorMsg mPartition validWriteIds
openTransaction query pm newQuery MTableColumnStatistics query setResult Collection names Collection query execute List String engines ArrayList i names i engines add String i next String e engines ColumnStatistics cs getTableColumnStatisticsInternal catName dbName tableName colNames e cs result add cs committed commitTransaction result
openTransaction query pm newQuery MPartitionColumnStatistics query setResult Collection names Collection query execute List String engines ArrayList i names i engines add String i next String e engines List ColumnStatistics cs getPartitionColumnStatisticsInternal catName dbName tableName partNames colNames e cs result add cs committed commitTransaction result
Table table getTable catName dbName tblName isTxn TxnUtils isTransactionalTable table getParameters isTxn GetPartitionsFilterSpec fs GetPartitionsFilterSpec fs setFilterMode PartitionFilterMode BY_NAMES fs setFilters partNames GetPartitionsProjectionSpec ps GetPartitionsProjectionSpec ps setIncludeParamKeyPattern StatsSetupConst COLUMN_STATS_ACCURATE ps setFieldList Lists newArrayList List Partition parts getPartitionSpecsByFilterAndProjection table ps fs Partition part parts part part String partName Warehouse makePartName table getPartitionKeys part getValues
directSql deleteColumnStatsState getTable getId List Partition parts getPartitions catName dbName tableName Partition part parts Partition newPart Partition part StatsSetupConst clearColumnStatsState newPart getParameters alterPartition catName dbName tableName part getValues newPart writeIdList parts size e LOG error e
List String LOG debug committed Query query List String tokenIdents ArrayList openTransaction query pm newQuery MDelegationToken List MDelegationToken tokens List MDelegationToken query execute pm retrieveAll tokens committed commitTransaction MDelegationToken token tokens tokenIdents add token getTokenIdentifier tokenIdents
LOG debug committed Query query List MMasterKey keys openTransaction query pm newQuery MMasterKey keys List MMasterKey query execute pm retrieveAll keys committed commitTransaction String masterKeys String keys size i i keys size i masterKeys i keys get i getMasterKey masterKeys
MetaException get strictValidation MetastoreConf getBoolVar getConf ConfVars SCHEMA_VERIFICATION String dbSchemaVer getMetaStoreSchemaVersion IMetaStoreSchemaInfo metastoreSchemaInfo MetaStoreSchemaInfoFactory get getConf String hiveSchemaVer metastoreSchemaInfo getHiveSchemaVersion dbSchemaVer strictValidation MetaException LOG warn ConfVars SCHEMA_VERIFICATION hiveSchemaVer setMetaStoreSchemaVersion hiveSchemaVer USER HOSTNAME metastoreSchemaInfo hiveSchemaVer dbSchemaVer
String dbSchemaVer getMetaStoreSchemaVersion IMetaStoreSchemaInfo metastoreSchemaInfo MetaStoreSchemaInfoFactory get getConf String hiveSchemaVer metastoreSchemaInfo getHiveSchemaVersion dbSchemaVer MetaException LOG warn ConfVars SCHEMA_VERIFICATION hiveSchemaVer setMetaStoreSchemaVersion hiveSchemaVer USER HOSTNAME metastoreSchemaInfo hiveSchemaVer dbSchemaVer LOG debug dbSchemaVer MetaException hiveSchemaVer dbSchemaVer
MNotificationNextId mNotificationNextId needToPersistId ids mNotificationNextId MNotificationNextId needToPersistId mNotificationNextId ids iterator next needToPersistId entry setEventId mNotificationNextId getNextEventId mNotificationNextId incrementEventId needToPersistId pm makePersistent mNotificationNextId pm makePersistent translateThriftToDb entry commited commitTransaction
olderThan commited Query query openTransaction tmp System currentTimeMillis olderThan tooOld tmp Integer MAX_VALUE tmp query pm newQuery MNotificationLog query declareParameters max_events MetastoreConf getIntVar conf MetastoreConf ConfVars EVENT_CLEAN_MAX_EVENTS max_events max_events max_events Integer MAX_VALUE query setRange max_events query setOrdering List MNotificationLog toBeRemoved List query execute tooOld toBeRemoved toBeRemoved
colName colName normalizeIdentifier colName type type normalizeIdentifier type Map String String parameters HashMap StringBuilder sql StringBuilder colName sql append parameters put colName colNamespace sql append parameters put colNamespace type sql append parameters put type
timeoutSecs maxLastUpdateTime System currentTimeMillis timeoutSecs Query q pm newQuery MScheduledQuery q setFilter List MScheduledQuery results List MScheduledQuery q execute MScheduledQuery e results Integer lastUpdateTime e getActiveExecution getLastUpdateTime lastUpdateTime lastUpdateTime maxLastUpdateTime
String dbPattern MetastoreConf getVar conf MetastoreConf ConfVars PARTITION_MANAGEMENT_DATABASE_PATTERN String tablePattern MetastoreConf getVar conf MetastoreConf ConfVars PARTITION_MANAGEMENT_TABLE_PATTERN String tableTypes MetastoreConf getVar conf MetastoreConf ConfVars PARTITION_MANAGEMENT_TABLE_TYPES Set String tableTypesSet HashSet List String tableTypesList tableTypes tableTypesList Lists newArrayList String type tableTypes tableTypesSet add TableType valueOf type trim toUpperCase name LOG warn type tableTypesList Lists newArrayList tableTypesSet List TableMeta foundTableMetas msc getTableMeta catalogName dbPattern tablePattern tableTypesList
tableTypesSet add TableType valueOf type trim toUpperCase name LOG warn type tableTypesList Lists newArrayList tableTypesSet List TableMeta foundTableMetas msc getTableMeta catalogName dbPattern tablePattern tableTypesList LOG info catalogName dbPattern tablePattern foundTableMetas size TableMeta tableMeta foundTableMetas Table table msc getTable tableMeta getCatName tableMeta getDbName tableMeta getTableName table table candidateTables add table candidateTables threadPoolSize MetastoreConf getIntVar conf MetastoreConf ConfVars PARTITION_MANAGEMENT_TASK_THREAD_POOL_SIZE ExecutorService executorService Executors newFixedThreadPool Math min candidateTables size threadPoolSize ThreadFactoryBuilder setDaemon setNameFormat build
Table table msc getTable tableMeta getCatName tableMeta getDbName tableMeta getTableName table table candidateTables add table candidateTables threadPoolSize MetastoreConf getIntVar conf MetastoreConf ConfVars PARTITION_MANAGEMENT_TASK_THREAD_POOL_SIZE ExecutorService executorService Executors newFixedThreadPool Math min candidateTables size threadPoolSize ThreadFactoryBuilder setDaemon setNameFormat build CountDownLatch countDownLatch CountDownLatch candidateTables size LOG info candidateTables size setupMsckPathInvalidation Configuration msckConf Msck getMsckConf conf Table table candidateTables qualifiedTableName Warehouse getCatalogQualifiedTableName table retentionSeconds getRetentionPeriodInSeconds table LOG info qualifiedTableName retentionSeconds
LOG LOG info prop LOG info String key prop key propsFromConf key LOG key String oldVal prop getProperty key String newVal propsFromConf getProperty key key oldVal MetaStoreServerUtils anonymizeConnectionURL oldVal newVal MetaStoreServerUtils anonymizeConnectionURL newVal LOG debug key oldVal newVal
DataSource ds dsp create conf Map Object Object dsProperties HashMap dsProperties putAll prop dsProperties put PropertyNames PROPERTY_CONNECTION_FACTORY ds dsProperties put PropertyNames PROPERTY_CONNECTION_FACTORY2 ds dsProperties put ConfVars MANAGER_FACTORY_CLASS getVarname pmf JDOHelper getPersistenceManagerFactory dsProperties e LOG warn e pmf JDOHelper getPersistenceManagerFactory prop DataStoreCache dsc pmf getDataStoreCache dsc String objTypes MetastoreConf getVar conf ConfVars CACHE_PINOBJTYPES
clr clr ClassLoaderResolverImpl ClassLoaderResolverImpl clri ClassLoaderResolverImpl clr resourcesCleared clearFieldMap clri loadedClassesCleared clearFieldMap clri unloadedClassesCleared clearFieldMap clri
Properties conf Properties prop Properties correctAutoStartMechanism conf var MetastoreConf String confVal MetastoreConf getAsString conf var String varName var getVarname Object prevVal prop setProperty varName confVal MetastoreConf varName
Object prevVal prop setProperty varName confVal MetastoreConf varName LOG debug varName prevVal confVal passwordProvider passwordProvider passwordProvider MetastoreConf getPassword conf ConfVars PWD err RuntimeException err getMessage err String passwd passwordProvider get passwd prop setProperty ConfVars PWD getVarname passwd LOG Object Object prop MetastoreConf
conf String autoStartKey String autoStartIgnore String currentAutoStartVal conf get autoStartKey currentAutoStartVal
s get e myRetryLimit retriable isRetriableException e myRetryLimit retriable LOG info myRetryLimit e Thread sleep retryInterval ie LOG debug ie Thread currentThread interrupt retriable LOG warn e
baseHandler setConf getActiveConf Object object isStarted Deadline startTimer method getName object method invoke baseHandler args isStarted Deadline stopTimer Result object retryCount e e getCause e getCause caughtException e getCause e getCause e getCause getCause e getCause getCause caughtException e getCause getCause
isStarted Deadline startTimer method getName object method invoke baseHandler args isStarted Deadline stopTimer Result object retryCount e e getCause e getCause caughtException e getCause e getCause e getCause getCause e getCause getCause caughtException e getCause getCause LOG error ExceptionUtils getStackTrace e getCause
Result object retryCount e e getCause e getCause caughtException e getCause e getCause e getCause getCause e getCause getCause caughtException e getCause getCause LOG error ExceptionUtils getStackTrace e getCause e getCause LOG error ExceptionUtils getStackTrace e e e e getCause
e getCause e getCause getCause e getCause getCause caughtException e getCause getCause LOG error ExceptionUtils getStackTrace e getCause e getCause LOG error ExceptionUtils getStackTrace e e e e getCause caughtException e getCause e getCause e getCause String methodName method getName methodName methodName methodName methodName LOG error ExceptionUtils getStackTrace e getCause
LOG error ExceptionUtils getStackTrace e getCause e getCause LOG error ExceptionUtils getStackTrace e e e e getCause caughtException e getCause e getCause e getCause String methodName method getName methodName methodName methodName methodName LOG error ExceptionUtils getStackTrace e getCause e getCause e getCause e getCause getCause
e getCause LOG error ExceptionUtils getStackTrace e e e e getCause caughtException e getCause e getCause e getCause String methodName method getName methodName methodName methodName methodName LOG error ExceptionUtils getStackTrace e getCause e getCause e getCause e getCause getCause e getCause getCause e getCause getCause caughtException e getCause getCause
LOG error ExceptionUtils getStackTrace e e e e getCause caughtException e getCause e getCause e getCause String methodName method getName methodName methodName methodName methodName LOG error ExceptionUtils getStackTrace e getCause e getCause e getCause e getCause getCause e getCause getCause e getCause getCause caughtException e getCause getCause e getCause getCause
e getCause caughtException e getCause e getCause e getCause String methodName method getName methodName methodName methodName methodName LOG error ExceptionUtils getStackTrace e getCause e getCause e getCause e getCause getCause e getCause getCause e getCause getCause caughtException e getCause getCause e getCause getCause Deadline clear LOG error method getName ExceptionUtils getStackTrace e getCause e getCause
RawStore ms HiveMetaStore HMSHandler getMSForConf conf maxRetainSecs MetastoreConf getTimeVar conf MetastoreConf ConfVars RUNTIME_STATS_MAX_AGE TimeUnit SECONDS deleteCnt ms deleteRuntimeStats maxRetainSecs deleteCnt
fn process msg seqid in out iface TException te RuntimeException te clientUgi doAs pvea RuntimeException rte rte getCause TException TException rte getCause rte ie RuntimeException ie
makeAcid MetastoreConf getBoolVar conf MetastoreConf ConfVars CREATE_TABLES_AS_ACID MetastoreConf getBoolVar conf MetastoreConf ConfVars HIVE_SUPPORT_CONCURRENCY equals MetastoreConf getVar conf MetastoreConf ConfVars HIVE_TXN_MANAGER makeAcid newTable LOG info Warehouse getQualifiedName newTable newTable getTableType LOG info Warehouse getQualifiedName newTable newTable getTableType newTable LOG info Warehouse getQualifiedName newTable Map String String parameters newTable getParameters parameters parameters parameters HashMap parameters put hive_metastoreConstants TABLE_IS_TRANSACTIONAL
rqst addToEventTypeSkipList MessageBuilder CREATE_FUNCTION_EVENT rqst addToEventTypeSkipList MessageBuilder DROP_FUNCTION_EVENT rqst addToEventTypeSkipList MessageBuilder CREATE_ISCHEMA_EVENT rqst addToEventTypeSkipList MessageBuilder ALTER_ISCHEMA_EVENT rqst addToEventTypeSkipList MessageBuilder DROP_ISCHEMA_EVENT rqst addToEventTypeSkipList MessageBuilder ADD_SCHEMA_VERSION_EVENT rqst addToEventTypeSkipList MessageBuilder ALTER_SCHEMA_VERSION_EVENT rqst addToEventTypeSkipList MessageBuilder DROP_SCHEMA_VERSION_EVENT Deadline startTimer NotificationEventResponse resp rawStore getNextNotification rqst Deadline stopTimer resp resp getEvents LOG debug lastEventId List NotificationEvent eventList resp getEvents
rqst addToEventTypeSkipList MessageBuilder DROP_ISCHEMA_EVENT rqst addToEventTypeSkipList MessageBuilder ADD_SCHEMA_VERSION_EVENT rqst addToEventTypeSkipList MessageBuilder ALTER_SCHEMA_VERSION_EVENT rqst addToEventTypeSkipList MessageBuilder DROP_SCHEMA_VERSION_EVENT Deadline startTimer NotificationEventResponse resp rawStore getNextNotification rqst Deadline stopTimer resp resp getEvents LOG debug lastEventId List NotificationEvent eventList resp getEvents LOG debug eventList size NotificationEvent event eventList eventId event getEventId eventId lastEventId
Deadline startTimer NotificationEventResponse resp rawStore getNextNotification rqst Deadline stopTimer resp resp getEvents LOG debug lastEventId List NotificationEvent eventList resp getEvents LOG debug eventList size NotificationEvent event eventList eventId event getEventId eventId lastEventId LOG error lastEventId eventId RuntimeException lastEventId eventId lastEventId eventId String message event getMessage
catName catalogs add rawStore getCatalog catName sharedCache populateCatalogsInCache catalogs e LOG warn e Thread sleep sleepTime sleepTime sleepTime timerEx LOG info timerEx getMessage LOG info List Database databases ArrayList catName
LOG warn catName e sharedCache populateDatabasesInCache databases LOG info numberOfDatabasesCachedSoFar db databases String catName StringUtils normalizeIdentifier db getCatalogName String dbName StringUtils normalizeIdentifier db getName List String tblNames tblNames rawStore getAllTables catName dbName e LOG warn DatabaseName getQualified catName dbName tblsPendingPrewarm addTableNamesForPrewarming tblNames totalTablesToCache tblNames size
partCols add fs getName partVals add defaultPartitionValue String defaultPartitionName FileUtils makePartName partCols partVals partNames remove defaultPartitionName Deadline startTimer aggrStatsAllButDefaultPartition rawStore get_aggr_stats_for catName dbName tblName partNames colNames CacheUtils HIVE_ENGINE Deadline stopTimer cacheObjects setAggrStatsAllButDefaultPartition aggrStatsAllButDefaultPartition Deadline startTimer tableColStats rawStore getTableColumnStatistics catName dbName tblName colNames CacheUtils HIVE_ENGINE Deadline stopTimer cacheObjects setTableColStats tableColStats Deadline startTimer primaryKeys rawStore getPrimaryKeys catName dbName tblName
Deadline stopTimer cacheObjects setAggrStatsAllButDefaultPartition aggrStatsAllButDefaultPartition Deadline startTimer tableColStats rawStore getTableColumnStatistics catName dbName tblName colNames CacheUtils HIVE_ENGINE Deadline stopTimer cacheObjects setTableColStats tableColStats Deadline startTimer primaryKeys rawStore getPrimaryKeys catName dbName tblName Deadline stopTimer cacheObjects setPrimaryKeys primaryKeys Deadline startTimer foreignKeys rawStore getForeignKeys catName dbName tblName Deadline stopTimer cacheObjects setForeignKeys foreignKeys
Deadline startTimer tableColStats rawStore getTableColumnStatistics catName dbName tblName colNames CacheUtils HIVE_ENGINE Deadline stopTimer cacheObjects setTableColStats tableColStats Deadline startTimer primaryKeys rawStore getPrimaryKeys catName dbName tblName Deadline stopTimer cacheObjects setPrimaryKeys primaryKeys Deadline startTimer foreignKeys rawStore getForeignKeys catName dbName tblName Deadline stopTimer cacheObjects setForeignKeys foreignKeys Deadline startTimer uniqueConstraints rawStore getUniqueConstraints catName dbName tblName
catName dbName tblName Table table sharedCache getTableFromCache catName dbName tblName table isTxn TxnUtils isTransactionalTable table getParameters isTxn validWriteIds StatsSetupConst setBasicStatsState newParams StatsSetupConst FALSE String errorMsg ObjectStore verifyStatsChangeCtx TableName getDbTable dbName tblName table getParameters newParams writeId validWriteIds errorMsg MetaException errorMsg ObjectStore newParams table validWriteIds StatsSetupConst setBasicStatsState newParams StatsSetupConst FALSE
rawStore get_aggr_stats_for catName dbName tblName partNames colNames engine writeIdList List String allPartNames rawStore listPartitionNames catName dbName tblName StatsType type StatsType PARTIAL partNames size allPartNames size colStats sharedCache getAggrStatsFromCache catName dbName tblName colNames StatsType ALL colStats AggrStats colStats partNames size type StatsType ALL partNames size allPartNames size String defaultPartitionName MetastoreConf getVar getConf ConfVars DEFAULTPARTITIONNAME partNames defaultPartitionName colStats sharedCache getAggrStatsFromCache catName dbName tblName colNames StatsType ALLBUTDEFAULT colStats AggrStats colStats partNames size
List String allPartNames rawStore listPartitionNames catName dbName tblName StatsType type StatsType PARTIAL partNames size allPartNames size colStats sharedCache getAggrStatsFromCache catName dbName tblName colNames StatsType ALL colStats AggrStats colStats partNames size type StatsType ALL partNames size allPartNames size String defaultPartitionName MetastoreConf getVar getConf ConfVars DEFAULTPARTITIONNAME partNames defaultPartitionName colStats sharedCache getAggrStatsFromCache catName dbName tblName colNames StatsType ALLBUTDEFAULT colStats AggrStats colStats partNames size type StatsType ALLBUTDEFAULT LOG debug tblName partNames colNames
String partName List String partValue partNameToVals partName SharedCache ColumStatsWithWriteId colStatsWriteId sharedCache getPartitionColStatsFromCache catName dbName tblName partValue colName writeIdList colStatsWriteId colStatsWriteId getColumnStatisticsObj ColumnStatisticsObj colStatsForPart colStatsWriteId getColumnStatisticsObj partNameToWriteId partNameToWriteId put partValue colStatsWriteId getWriteId ColStatsObjWithSourceInfo colStatsWithPartInfo ColStatsObjWithSourceInfo colStatsForPart catName dbName tblName partName colStatsWithPartInfoList add colStatsWithPartInfo colStatsAggregator colStatsAggregator ColumnStatsAggregatorFactory getColumnStatsAggregator colStatsForPart getStatsData getSetField useDensityFunctionForNDVEstimation ndvTuner partsFoundForColumn
colStatsWriteId getColumnStatisticsObj ColumnStatisticsObj colStatsForPart colStatsWriteId getColumnStatisticsObj partNameToWriteId partNameToWriteId put partValue colStatsWriteId getWriteId ColStatsObjWithSourceInfo colStatsWithPartInfo ColStatsObjWithSourceInfo colStatsForPart catName dbName tblName partName colStatsWithPartInfoList add colStatsWithPartInfo colStatsAggregator colStatsAggregator ColumnStatsAggregatorFactory getColumnStatsAggregator colStatsForPart getStatsData getSetField useDensityFunctionForNDVEstimation ndvTuner partsFoundForColumn LOG debug dbName tblName partName colName colStatsWithPartInfoList colStatsMap put colStatsAggregator colStatsWithPartInfoList partsFoundForColumn partsFound partsFound partsFoundForColumn
String catName String dbName String tblName String str TableName getQualified catName dbName tblName
String catName String dbName String tblName String str TableName getQualified catName dbName tblName pattern LOG debug str pattern Matcher matcher pattern matcher str matcher
String catName String dbName String tblName String str TableName getQualified catName dbName tblName
String catName String dbName String tblName String str TableName getQualified catName dbName tblName pattern LOG debug str pattern Matcher matcher pattern matcher str matcher
Class clazz TableWrapper Field fields clazz getDeclaredFields size Field field fields field getType field getType field setAccessible Object val field get ObjectEstimator oe getMemorySizeEstimator field getType oe size oe estimate val sizeEstimators
Partition partVals Partition part tableLock readLock lock PartitionWrapper wrapper partitionCache get CacheUtils buildPartitionCacheKey partVals wrapper
mn MemberName PRIMARY_KEY_CACHE constraintClass SQLPrimaryKey foreignKeyCache name constraint foreignKeyCache remove name mn MemberName FOREIGN_KEY_CACHE constraintClass SQLForeignKey notNullConstraintCache name constraint notNullConstraintCache remove name mn MemberName NOTNULL_CONSTRAINT_CACHE constraintClass SQLNotNullConstraint uniqueConstraintCache name constraint uniqueConstraintCache remove name mn MemberName UNIQUE_CONSTRAINT_CACHE constraintClass SQLUniqueConstraint constraint
partVals tableLock writeLock lock PartitionWrapper partitionWrapper partitionCache get CacheUtils buildPartitionCacheKey partVals partitionWrapper
tableLock readLock lock Table tbl getTable String partName ColumnStatisticsDesc csd ColumnStatisticsDesc tbl getDbName tbl getTableName csd setCatName tbl getCatName csd setPartName partName csd setLastAnalyzed List ColumnStatisticsObj statObject ArrayList List String partVal Warehouse getPartValuesFromPartName partName String colName ColumnStatisticsObj statisticsObj partitionColStatsCache get CacheUtils buildPartitonColStatsCacheKey partVal colName statisticsObj statObject add statisticsObj
LOG info colName partVal ColumnStatistics columnStatistics ColumnStatistics csd statObject columnStatistics setEngine CacheUtils HIVE_ENGINE columnStatistics setIsStatsCompliant columnStatistics setIsStatsCompliant PartitionWrapper wrapper partitionCache get CacheUtils buildPartitionCacheKey partVal wrapper columnStatistics setIsStatsCompliant Partition partition wrapper getPartition
LOG debug getTable getTableName List String partVal partVal Warehouse makeValsFromName cs getStatsDesc getPartName List ColumnStatisticsObj colStatsObjs cs getStatsObj ColumnStatisticsObj colStatObj colStatsObjs LOG debug getTable getTableName String key CacheUtils buildPartitonColStatsCacheKey partVal colStatObj getColName newPartitionColStatsCache put key colStatObj deepCopy statsSize getObjectSize ColumnStatisticsObj colStatObj
sharedCache Map List String Map String List ColumnStatisticsObj newAggrColStatsCache HashMap String List ColumnStatisticsObj tableLock writeLock lock statsSize List String partValuesWriteIdSet List String partValues partValuesWriteIdSet getKey Partition partition getPartition partValues sharedCache partition
catName dbName tblName cacheLock writeLock lock TableWrapper tblWrapper tableCache getIfPresent CacheUtils buildTableKey catName dbName tblName tblWrapper
catName dbName tblName cacheLock readLock lock TableWrapper tblWrapper tableCache getIfPresent CacheUtils buildTableKey catName dbName tblName tblWrapper
CacheStats cs tableCache stats
ndvEstimator ndvEstimator NumDistinctValueEstimatorFactory getEmptyNumDistinctValueEstimator ndvEstimator LOG debug colName ndvEstimator ColumnStatisticsData columnStatisticsData ColumnStatisticsData StringColumnStatsDataInspector aggregateData csp ColumnStatisticsObj cso csp getColStatsObj StringColumnStatsDataInspector newData stringInspectorFromStats cso ndvEstimator ndvEstimator mergeEstimators newData getNdvEstimator aggregateData aggregateData newData deepCopy aggregateData setMaxColLen Math max aggregateData getMaxColLen newData getMaxColLen
RawStore ms HiveMetaStore HMSHandler getMSForConf conf deleteCnt ms cleanupEvents deleteCnt
Method clazz MessageEncoder clazz Method methodInstance clazz getMethod MessageEncoder methodInstance modifiers methodInstance getModifiers modifiers modifiers methodInstance NoSuchMethodException clazz getCanonicalName NoSuchMethodException MessageEncoder getCanonicalName NoSuchMethodException e String message clazz getCanonicalName LOG error message e IllegalArgumentException message e String message clazz getCanonicalName MessageEncoder getCanonicalName
messageFormat Method methodInstance registry get messageFormat methodInstance
json jsonWriter writeValueAsString registry e LOG error e Path tmpFile tmpFile Files createTempFile metricsDir FILE_ATTRS e LOG error e e LOG error e e
Path tmpFile tmpFile Files createTempFile metricsDir FILE_ATTRS e LOG error e e LOG error e e LOG error e bw Files tmpFile bw write json
e LOG error e e LOG error e e LOG error e bw tmpFile bw write json e LOG error tmpFile e
LOG error e e LOG error e e LOG error e bw tmpFile bw write json e LOG error tmpFile e
e LOG error e bw Files tmpFile bw write json e LOG error tmpFile e Files move tmpFile path StandardCopyOption ATOMIC_MOVE e LOG error tmpFile path LOG error e
method startTime System currentTimeMillis startTimes put method Long valueOf startTime
Long startTime startTimes get method endTime System currentTimeMillis endTimes put method Long valueOf endTime duration startTime endTime startTime longValue StringBuilder sb StringBuilder append method startTime sb append append startTime sb append append endTime startTime sb append append duration sb append append callerName additionalInfo sb append append additionalInfo sb append
nDeletedTokens List DelegationTokenIdentifier allDelegationTokenIDs getAllDelegationTokenIDs DelegationTokenIdentifier allDelegationTokenIDs nDeletedTokens
DelegationTokenIdentifier DelegationTokenIdentifier token DelegationTokenIdentifier id getTokenIdentifier token
DelegationKey key keySeq tokenStore addMasterKey encodeWritable key DelegationKey keyWithSeq DelegationKey keySeq key getExpiryDate key getKey String keyStr encodeWritable keyWithSeq tokenStore updateMasterKey keySeq keyStr decodeWritable key keyStr
String path acl CuratorFramework zk getSession String node zk create creatingParentsIfNeeded withMode CreateMode PERSISTENT withACL acl forPath path
String String txnLockTable txnLockTable txnLockTable txnLockTable String
objectStore setConf MetastoreConf newMetastoreConf MetaToolTask task cl task MetaToolTaskListFSRoot cl task MetaToolTaskExecuteJDOQLQuery cl task MetaToolTaskUpdateLocation IllegalArgumentException task setObjectStore objectStore task setCommandLine cl task execute
logAndPrintToStdout url logAndPrintToStdout driver logAndPrintToStdout userName logAndPrintToStdout password userName userName HiveMetaException Class forName driver Connection conn DriverManager getConnection url userName password schema conn setSchema schema conn e HiveMetaException e e
CommandBuilder builder CommandBuilder conf url driver userName passWord sqlScriptFile setVerbose verbose SqlLine sqlLine SqlLine ByteArrayOutputStream outputForLog verbose OutputStream out LOG out outputForLog ByteArrayOutputStream out NullOutputStream sqlLine setOutputStream PrintStream out System setProperty LOG info builder buildToLog SqlLine Status status sqlLine begin builder buildToRun LOG outputForLog LOG debug
Object updateLocation location schemaTool quote location Object updateDescription description schemaTool quote description String update String format schemaTool quote UPDATE_CATALOG_STMT updateLocation updateDescription catName LOG debug update count stmt executeUpdate update count HiveMetaException catName conn commit success e HiveMetaException e success conn rollback
conn setAutoCommit stmt conn stmt catNum getNextCatalogId stmt addCatalog conn stmt catNum success e HiveMetaException e success conn rollback e
String query String format schemaTool quote CATALOG_EXISTS_QUERY catName
String query schemaTool quote NEXT_CATALOG_ID_QUERY
catNum String update String format schemaTool quote ADD_CATALOG_STMT catNum catName description location
stmt conn initTime System currentTimeMillis String conflicts String format schemaTool quote DB_CONFLICTS_STMT fromCatalog toCatalog System out println LOG info conflicts ResultSet rs stmt executeQuery conflicts cleanMerge rs cleanMerge System out println rs getString rs getString rs getString cleanMerge System out println System exit conn setAutoCommit String insert String format schemaTool quote ADD_AUTOPURGE_TO_TABLE fromCatalog
rs cleanMerge System out println rs getString rs getString rs getString cleanMerge System out println System exit conn setAutoCommit String insert String format schemaTool quote ADD_AUTOPURGE_TO_TABLE fromCatalog System out println fromCatalog LOG debug insert prevTime System currentTimeMillis count stmt executeUpdate insert curTime System currentTimeMillis System out println count curTime prevTime insert String format schemaTool quote ADD_AUTOPURGE_TO_TABLE fromCatalog
count stmt executeUpdate insert curTime System currentTimeMillis System out println count curTime prevTime String update String format schemaTool quote CONVERT_TABLE_TO_EXTERNAL fromCatalog System out println fromCatalog LOG debug update prevTime curTime count stmt executeUpdate update curTime System currentTimeMillis System out println count curTime prevTime String merge String format schemaTool quote MERGE_CATALOG_STMT toCatalog fromCatalog System out println fromCatalog LOG debug merge prevTime curTime count stmt executeUpdate merge
count LOG info count fromCatalog toCatalog conn rollback success conn commit System out println curTime initTime success e HiveMetaException e success System out println
String tableName String catColName String dbColName String fromCatName String toCatName String dbName String update String format schemaTool quote UPDATE_CATALOG_NAME_STMT tableName catColName toCatName catColName fromCatName dbColName dbName
stmt oldDbId getDbId stmt fromDb fromCat newDbId getDbId stmt toDb toCat String update String format schemaTool quote UPDATE_TABLE_ID_STMT newDbId oldDbId tableName
String db String catalog String query String format schemaTool quote DB_ID_QUERY db catalog
String tableName String tableColumnName String fromCat String toCat String fromDb String toDb String hiveTblName String update String format schemaTool quote UPDATE_DB_NAME_STMT tableName toCat toDb fromCat fromDb tableColumnName hiveTblName
Connection hmsConn schemaTool getConnectionToMetastore LOG debug version List String dbTables ArrayList ResultSet rs String schema schema hmsConn getSchema LOG debug DatabaseMetaData metadata conn getMetaData rs metadata getTables schema String rs String table rs getString
dbTables add table toLowerCase LOG debug table e HiveMetaException e getMessage e rs rs close e HiveMetaException e List String schemaTables ArrayList List String subScripts ArrayList String baseDir File schemaTool getMetaStoreSchemaInfo getMetaStoreScriptDir getParent String schemaFile File schemaTool getMetaStoreSchemaInfo getMetaStoreScriptDir schemaTool getMetaStoreSchemaInfo generateInitFileName version getPath
rs rs close e HiveMetaException e List String schemaTables ArrayList List String subScripts ArrayList String baseDir File schemaTool getMetaStoreSchemaInfo getMetaStoreScriptDir getParent String schemaFile File schemaTool getMetaStoreSchemaInfo getMetaStoreScriptDir schemaTool getMetaStoreSchemaInfo generateInitFileName version getPath LOG debug schemaFile subScripts addAll findCreateTable schemaFile schemaTables subScripts schemaFile baseDir schemaTool getDbType subScripts remove
String subScript sp getScriptName line LOG debug subScript subs add subScript line line replaceAll line line replaceAll line line replaceAll line line replaceAll line line replaceAll line line replaceAll Matcher matcher regexp matcher line matcher String table matcher group table table replaceAll
TxnStore MutexAPI LockHandle handle handle txnHandler getMutexAPI acquireLock TxnStore MUTEX_KEY HouseKeeper name LOG info start System currentTimeMillis cleanTheHouse
task start System currentTimeMillis Functions run task
start System currentTimeMillis isAliveCounter txnHandler countOpenTxns now System currentTimeMillis now
TxnStore MutexAPI LockHandle handle handle txnHandler getMutexAPI acquireLock TxnStore MUTEX_KEY TxnCleaner name start System currentTimeMillis txnHandler cleanEmptyAbortedAndCommittedTxns
Set CompactionInfo checkInterval Connection dbConn Set CompactionInfo response HashSet Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s checkInterval quoteChar ATTEMPTED_STATE quoteChar FAILED_STATE isWithinCheckInterval checkInterval
dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s checkInterval quoteChar ATTEMPTED_STATE quoteChar FAILED_STATE isWithinCheckInterval checkInterval LOG debug s rs stmt executeQuery s rs CompactionInfo info CompactionInfo info dbname rs getString info tableName rs getString info partName rs getString response add info rs close checkAbortedTimeThreshold abortedTimeThreshold String sCheckAborted TxnStatus ABORTED checkAbortedTimeThreshold abortedThreshold
checkAbortedTimeThreshold abortedTimeThreshold String sCheckAborted TxnStatus ABORTED checkAbortedTimeThreshold abortedThreshold LOG debug sCheckAborted rs stmt executeQuery sCheckAborted systemTime System currentTimeMillis rs pastTimeThreshold checkAbortedTimeThreshold rs getLong abortedTimeThreshold systemTime numAbortedTxns rs getInt numAbortedTxns abortedThreshold pastTimeThreshold CompactionInfo info CompactionInfo info dbname rs getString info tableName rs getString info partName rs getString info tooManyAborts numAbortedTxns abortedThreshold info hasOldAbort pastTimeThreshold
String Connection dbConn Statement stmt Statement updStmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s INITIATED_STATE
rs LOG debug dbConn rollback updStmt dbConn createStatement CompactionInfo info CompactionInfo info id rs getLong info dbname rs getString info tableName rs getString info partName rs getString info type dbCompactionType2ThriftType rs getString charAt info properties rs getString now getDbTime dbConn s workerId now WORKING_STATE info id INITIATED_STATE
CompactionInfo info CompactionInfo info id rs getLong info dbname rs getString info tableName rs getString info partName rs getString info type dbCompactionType2ThriftType rs getString charAt info properties rs getString now getDbTime dbConn s workerId now WORKING_STATE info id INITIATED_STATE LOG debug s updCount updStmt executeUpdate s updCount dbConn commit info
info dbname rs getString info tableName rs getString info partName rs getString info type dbCompactionType2ThriftType rs getString charAt info properties rs getString now getDbTime dbConn s workerId now WORKING_STATE info id INITIATED_STATE LOG debug s updCount updStmt executeUpdate s updCount dbConn commit info updCount LOG debug info
info Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s READY_FOR_CLEANING info id
info Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s READY_FOR_CLEANING info id LOG debug s updCnt stmt executeUpdate s updCnt
Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s READY_FOR_CLEANING info id LOG debug s updCnt stmt executeUpdate s updCnt LOG error READY_FOR_CLEANING info updCnt LOG debug dbConn rollback LOG debug dbConn commit
List CompactionInfo Connection dbConn List CompactionInfo rc ArrayList Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s READY_FOR_CLEANING
rs CompactionInfo info CompactionInfo info id rs getLong info dbname rs getString info tableName rs getString info partName rs getString rs getString info info rs getString info runAs rs getString info highestWriteId rs getLong
rs getString info info rs getString info runAs rs getString info highestWriteId rs getLong LOG LOG debug info toString rc add info LOG debug dbConn rollback rc
Connection dbConn PreparedStatement pStmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED pStmt dbConn prepareStatement pStmt setLong info id rs pStmt executeQuery rs info CompactionInfo loadFullFromCompactionQueue rs IllegalStateException info id close rs String s pStmt dbConn prepareStatement s
dbConn getDbConn Connection TRANSACTION_READ_COMMITTED pStmt dbConn prepareStatement pStmt setLong info id rs pStmt executeQuery rs info CompactionInfo loadFullFromCompactionQueue rs IllegalStateException info id close rs String s pStmt dbConn prepareStatement s pStmt setLong info id LOG debug s updCount pStmt executeUpdate
IllegalStateException info id close rs String s pStmt dbConn prepareStatement s pStmt setLong info id LOG debug s updCount pStmt executeUpdate updCount LOG error info updCount LOG debug dbConn rollback s pStmt dbConn prepareStatement s info state SUCCEEDED_STATE
info state SUCCEEDED_STATE enqueueTime getDbTime dbConn CompactionInfo insertIntoCompletedCompactions pStmt info enqueueTime LOG debug s enqueueTime updCount pStmt executeUpdate s info s info s pStmt dbConn prepareStatement s paramCount pStmt setString paramCount info dbname pStmt setString paramCount info tableName info
LOG debug s enqueueTime updCount pStmt executeUpdate s info partName s info highestWriteId s pStmt dbConn prepareStatement s paramCount pStmt setString paramCount info dbname pStmt setString paramCount info tableName info partName pStmt setString paramCount info partName info highestWriteId pStmt setLong paramCount info highestWriteId
pStmt setString paramCount info tableName info partName pStmt setString paramCount info partName info highestWriteId pStmt setLong paramCount info highestWriteId LOG debug s updCount pStmt LOG error LOG debug updCount s TxnStatus ABORTED info highestWriteId s info partName s pStmt dbConn prepareStatement s paramCount pStmt setString paramCount info dbname
Connection dbConn Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s TxnStatus ABORTED TxnStatus OPEN
MetaException Connection dbConn Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s TxnStatus ABORTED TxnStatus OPEN LOG debug s rs stmt executeQuery s rs MetaException minUncommitedTxnid rs getLong s minUncommitedTxnid
Connection dbConn Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s TxnStatus ABORTED TxnStatus OPEN LOG debug s rs stmt executeQuery s rs MetaException minUncommitedTxnid rs getLong s minUncommitedTxnid LOG debug s rc stmt executeUpdate s
dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s TxnStatus ABORTED TxnStatus OPEN LOG debug s rs stmt executeQuery s rs MetaException minUncommitedTxnid rs getLong s minUncommitedTxnid LOG debug s rc stmt executeUpdate s LOG info rc minUncommitedTxnid LOG debug dbConn commit
LOG info Connection dbConn Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement lowWaterMark getOpenTxnTimeoutLowBoundaryTxnId dbConn String s TxnStatus ABORTED TxnStatus COMMITTED lowWaterMark
String s TxnStatus ABORTED TxnStatus COMMITTED lowWaterMark LOG debug s rs stmt executeQuery s List Long txnids ArrayList rs next txnids add rs getLong close rs txnids Collections sort txnids List String queries ArrayList StringBuilder prefix StringBuilder StringBuilder suffix StringBuilder prefix append TxnUtils buildQueryWithINClause conf queries prefix suffix txnids String queries
rs stmt executeQuery s List Long txnids ArrayList rs next txnids add rs getLong close rs txnids Collections sort txnids List String queries ArrayList StringBuilder prefix StringBuilder StringBuilder suffix StringBuilder prefix append TxnUtils buildQueryWithINClause conf queries prefix suffix txnids String query queries LOG debug query rc stmt executeUpdate query
Collections sort txnids List String queries ArrayList StringBuilder prefix StringBuilder StringBuilder suffix StringBuilder prefix append TxnUtils buildQueryWithINClause conf queries prefix suffix txnids String query queries LOG debug query rc stmt executeUpdate query LOG debug rc LOG info txnids LOG debug dbConn commit
String hostname Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s INITIATED_STATE WORKING_STATE hostname
String hostname Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s INITIATED_STATE WORKING_STATE hostname LOG debug s updated stmt executeUpdate s
timeout Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED latestValidStart getDbTime dbConn timeout stmt dbConn createStatement String s INITIATED_STATE WORKING_STATE latestValidStart
timeout Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED latestValidStart getDbTime dbConn timeout stmt dbConn createStatement String s INITIATED_STATE WORKING_STATE latestValidStart LOG debug s updated stmt executeUpdate s
timeout Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED latestValidStart getDbTime dbConn timeout stmt dbConn createStatement String s INITIATED_STATE WORKING_STATE latestValidStart LOG debug s updated stmt executeUpdate s LOG info updated INITIATED_RESPONSE latestValidStart LOG debug dbConn commit
ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED String quote getIdentifierQuoteString dbConn StringBuilder bldr StringBuilder bldr append append quote append append quote append append quote append ci partName append quote append append quote append append quote append append append quote append append quote append ci partName bldr append append quote append append quote append String s bldr toString pStmt dbConn prepareStatement s pStmt setString ci dbname pStmt setString ci tableName ci partName pStmt setString ci partName
StringBuilder bldr StringBuilder bldr append append quote append append quote append append quote append ci partName append quote append append quote append append quote append append append quote append append quote append ci partName bldr append append quote append append quote append String s bldr toString pStmt dbConn prepareStatement s pStmt setString ci dbname pStmt setString ci tableName ci partName pStmt setString ci partName LOG debug s rs pStmt executeQuery List String columns ArrayList rs columns add rs getString
ci Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String sqlText ci highestWriteId quoteString ci runAs ci id
ci compactionTxnId Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String sqlText ci highestWriteId quoteString ci runAs ci id LOG LOG debug sqlText updCount stmt executeUpdate sqlText updCount IllegalStateException ci sqlText ci partName compactionTxnId quoteString ci dbname quoteString ci tableName ci partName quoteString ci partName ci highestWriteId OperationType COMPACT LOG
checkForDeletion deleteSet ci rc close rs deleteSet size List String queries ArrayList StringBuilder prefix StringBuilder StringBuilder suffix StringBuilder prefix append List String questions ArrayList deleteSet size i i deleteSet size i questions add List Integer counts TxnUtils buildQueryWithINClauseStrings conf queries prefix suffix questions totalCount i i queries size i String query queries get i
pStmt setString ci dbname pStmt setString ci tableName ci partName pStmt setString ci partName rs pStmt executeQuery numFailed numTotal failedThreshold MetastoreConf getIntVar conf ConfVars COMPACTOR_INITIATOR_FAILED_THRESHOLD rs numTotal failedThreshold rs numFailed numFailed numFailed failedThreshold
rs pStmt executeQuery numFailed numTotal failedThreshold MetastoreConf getIntVar conf ConfVars COMPACTOR_INITIATOR_FAILED_THRESHOLD rs numTotal failedThreshold rs numFailed numFailed numFailed failedThreshold e LOG error e getMessage LOG debug rollbackDBConn dbConn checkRetryable dbConn e ci
Connection dbConn Statement stmt PreparedStatement pStmt ResultSet rs String errorMessage ci errorMessage dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement pStmt dbConn prepareStatement pStmt setLong ci id rs pStmt executeQuery rs ci CompactionInfo loadFullFromCompactionQueue rs String s pStmt dbConn prepareStatement s
rs ci CompactionInfo loadFullFromCompactionQueue rs String s pStmt dbConn prepareStatement s pStmt setLong ci id LOG debug s updCnt pStmt executeUpdate ci id IllegalStateException ci id ci id ci id generateCompactionQueueId stmt ci state ATTEMPTED_STATE ci type ci type CompactionType MINOR
ci start getDbTime dbConn LOG debug ci id ci state FAILED_STATE close rs stmt closeStmt pStmt pStmt dbConn prepareStatement errorMessage ci errorMessage errorMessage CompactionInfo insertIntoCompletedCompactions pStmt ci getDbTime dbConn updCount pStmt executeUpdate LOG debug updCount LOG debug closeStmt pStmt dbConn commit
String hadoopJobId id Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s quoteString hadoopJobId id
Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s quoteString hadoopJobId id LOG debug s hadoopJobId id updateCount stmt executeUpdate s LOG debug closeStmt stmt dbConn commit e LOG warn hadoopJobId id e getMessage LOG debug rollbackDBConn dbConn checkRetryable dbConn e hadoopJobId id
Connection dbConn Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String query TxnStatus OPEN
LOG debug query rs stmt executeQuery query rs MetaException numOpenTxns rs getLong numOpenTxns query TxnStatus OPEN quoteChar READY_FOR_CLEANING query LOG debug query rs stmt executeQuery query rs MetaException rs getLong
conf LOG info Connection conn Statement stmt conn getConnection conf String s conn getMetaData getDatabaseProductName DatabaseProduct dbProduct DatabaseProduct determineDatabaseProduct s stmt conn createStatement stmt String schemaRootPath getSchemaRootPath IMetaStoreSchemaInfo metaStoreSchemaInfo MetaStoreSchemaInfoFactory get conf schemaRootPath DatabaseProduct getHiveSchemaPostfix dbProduct String initFile metaStoreSchemaInfo generateInitFileName metaStoreSchemaInfo initFile
DatabaseProduct dbProduct DatabaseProduct determineDatabaseProduct s stmt conn createStatement stmt String schemaRootPath getSchemaRootPath IMetaStoreSchemaInfo metaStoreSchemaInfo MetaStoreSchemaInfoFactory get conf schemaRootPath DatabaseProduct getHiveSchemaPostfix dbProduct String initFile metaStoreSchemaInfo generateInitFileName is metaStoreSchemaInfo initFile LOG info initFile MetastoreConf getVar conf ConfVars CONNECT_URL_KEY importSQL stmt is conn conn rollback
success truncateTable conn stmt success truncateTable conn stmt success truncateTable conn stmt success truncateTable conn stmt success truncateTable conn stmt success truncateTable conn stmt success truncateTable conn stmt success truncateTable conn stmt success truncateTable conn stmt success truncateTable conn stmt resetTxnSequence conn stmt stmt executeUpdate stmt executeUpdate
queryCounter StringBuilder sb StringBuilder sb append
String queryCounter StringBuilder sb StringBuilder sb append String query LOG debug query queryCounter sb append query append queryCounter sb append String batch sb toString
sb append String query LOG debug query queryCounter sb append query append queryCounter sb append String batch sb toString LOG debug batch stmt execute batch sb setLength sb append queryCounter sb append String batch sb toString
List Integer List List Integer affectedRowsByQuery ArrayList queryCounter
List Integer stmt List List Integer affectedRowsByQuery ArrayList queryCounter query LOG debug query queryCounter stmt addBatch query queryCounter
conf conf conf connPool Connection dbConn maxPoolSize MetastoreConf getIntVar conf ConfVars CONNECTION_POOLING_MAX_CONNECTIONS getConnectionTimeoutMs connPool setupJdbcConnectionPool conf maxPoolSize getConnectionTimeoutMs connPoolMutex setupJdbcConnectionPool conf maxPoolSize MUTEX_KEY values length getConnectionTimeoutMs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED determineDatabaseProduct dbConn sqlGenerator SQLGenerator dbProduct conf e String msg e getMessage
LOG error msg RuntimeException e closeDbConn dbConn numOpenTxns Metrics getOrCreateGauge MetricsConstants NUM_OPEN_TXNS timeout MetastoreConf getTimeVar conf ConfVars TXN_TIMEOUT TimeUnit MILLISECONDS retryInterval MetastoreConf getTimeVar conf ConfVars HMS_HANDLER_INTERVAL TimeUnit MILLISECONDS retryLimit MetastoreConf getIntVar conf ConfVars HMS_HANDLER_ATTEMPTS deadlockRetryInterval retryInterval maxOpenTxns MetastoreConf getIntVar conf ConfVars MAX_OPEN_TXNS maxBatchSize MetastoreConf getIntVar conf ConfVars JDBC_MAX_BATCH_SIZE openTxnTimeOutMillis MetastoreConf getTimeVar conf ConfVars TXN_OPENTXN_TIMEOUT TimeUnit MILLISECONDS transactionalListeners MetaStoreServerUtils getMetaStoreListeners TransactionalMetaStoreEventListener conf MetastoreConf getVar conf ConfVars TRANSACTIONAL_EVENT_LISTENERS e
infoFields Connection dbConn Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement List OpenTxn txnInfos ArrayList String txnsQuery String format infoFields OpenTxn OPEN_TXNS_INFO_QUERY OpenTxn OPEN_TXNS_QUERY TxnDbUtil getEpochFn dbProduct
stmt dbConn createStatement List OpenTxn txnInfos ArrayList String txnsQuery String format infoFields OpenTxn OPEN_TXNS_INFO_QUERY OpenTxn OPEN_TXNS_QUERY TxnDbUtil getEpochFn dbProduct LOG debug txnsQuery rs stmt executeQuery txnsQuery hwm openTxnLowBoundary rs txnId rs getLong age rs getLong hwm txnId age openTxnLowBoundary txnId openTxnLowBoundary txnInfos add OpenTxn openTxnLowBoundary TxnStatus OPEN TxnType DEFAULT
LOG debug JavaUtils txnIdToString openTxnLowBoundary openTxnLowBoundary openTxnLowBoundary txnId TxnStatus state TxnStatus fromString rs getString state TxnStatus OpenTxn txnInfo OpenTxn txnId state TxnType findByValue rs getInt txnInfo setUser rs getString txnInfo setHost rs getString txnInfo setStartedTime rs getLong txnInfo setLastHeartBeatTime rs getLong txnInfos add txnInfo dbConn rollback
numTxns rqst getNum_txns numTxns MetaException numTxns Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement acquireTxnLock stmt StopWatch generateTransactionWatch StopWatch generateTransactionWatch start List Long txnIds openTxns dbConn rqst LOG debug dbConn commit
maxTxnId String s TxnDbUtil getEpochFn dbProduct openTxnTimeOutMillis
String s
List Long String replPolicy List Long sourceTxnIdList PreparedStatement pst ResultSet rs List String inQueries ArrayList StringBuilder prefix StringBuilder StringBuilder suffix StringBuilder List Long targetTxnIdList ArrayList prefix append suffix append TxnUtils buildQueryWithINClause conf inQueries prefix suffix sourceTxnIdList List String params Arrays asList replPolicy String inQueries
replPolicy sourceTxnId Connection dbConn lockInternal dbConn getDbConn Connection TRANSACTION_READ_COMMITTED List Long targetTxnIds getTargetTxnIdList replPolicy Collections singletonList sourceTxnId dbConn targetTxnIds
sourceTxnId String String s sourceTxnId s
rqst List Long txnIds rqst getTxn_ids Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement List String queries ArrayList StringBuilder prefix StringBuilder append TxnStatus OPEN append append TxnType READ_ONLY getValue append TxnUtils buildQueryWithINClause conf queries prefix StringBuilder txnIds Map Long TxnType nonReadOnlyTxns HashMap String queries
txnid String writeConflictQuery sqlGenerator addLimitClause txnid txnid OperationType UPDATE OperationType DELETE OperationType UPDATE OperationType DELETE
txnid isUpdateDelete String s isUpdateDelete txnid OperationType COMPACT
txnid isUpdateDelete String s isUpdateDelete txnid OperationType COMPACT LOG debug s s
List Long abortedWriteIds getAbortedWriteIds validWriteIdList numAbortedWrites abortedWriteIds size Connection dbConn Statement stmt PreparedStatement pStmt List PreparedStatement insertPreparedStmts ResultSet rs List String params Arrays asList dbName tblName lockInternal dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String sql pStmt sqlGenerator prepareStmtWithParameters dbConn sql params
Connection dbConn Statement stmt PreparedStatement pStmt List PreparedStatement insertPreparedStmts ResultSet rs List String params Arrays asList dbName tblName lockInternal dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String sql pStmt sqlGenerator prepareStmtWithParameters dbConn sql params LOG debug sql replaceAll quoteString dbName quoteString tblName rs pStmt executeQuery rs
rs pStmt executeQuery rs LOG info validWriteIdList dbName tblName rollbackDBConn dbConn numAbortedWrites List Long txnIds openTxns dbConn OpenTxnRequest numAbortedWrites rqst getUser rqst getHostName assert numAbortedWrites txnIds size List String rows ArrayList List List String paramsList ArrayList i txn txnIds writeId abortedWriteIds get i rows add txn writeId paramsList add params
List List String paramsList ArrayList i txn txnIds writeId abortedWriteIds get i rows add txn writeId paramsList add params LOG info writeId txn insertPreparedStmts sqlGenerator createInsertValuesPreparedStmt dbConn rows paramsList pst insertPreparedStmts pst execute numAborts abortTxns dbConn txnIds assert numAborts numAbortedWrites nextWriteId validWriteIdList getHighWatermark sql Long toString nextWriteId closeStmt pStmt
txn txnIds writeId abortedWriteIds get i rows add txn writeId paramsList add params LOG info writeId txn insertPreparedStmts sqlGenerator createInsertValuesPreparedStmt dbConn rows paramsList pst insertPreparedStmts pst execute numAborts abortTxns dbConn txnIds assert numAborts numAbortedWrites nextWriteId validWriteIdList getHighWatermark sql Long toString nextWriteId closeStmt pStmt pStmt sqlGenerator prepareStmtWithParameters dbConn sql params LOG debug sql replaceAll quoteString dbName quoteString tblName
dbConn String fullTableName validTxnList PreparedStatement pst ResultSet rs String names TxnUtils getDbTableName fullTableName assert names length List String params Arrays asList names names writeIdHwm List Long invalidWriteIdList ArrayList minOpenWriteId Long MAX_VALUE BitSet abortedBits BitSet txnHwm validTxnList getHighWatermark String s Long toString txnHwm pst sqlGenerator prepareStmtWithParameters dbConn s params
writeIdHwm List Long invalidWriteIdList ArrayList minOpenWriteId Long MAX_VALUE BitSet abortedBits BitSet txnHwm validTxnList getHighWatermark String s Long toString txnHwm pst sqlGenerator prepareStmtWithParameters dbConn s params LOG debug s replaceAll quoteString names quoteString names rs pst executeQuery rs writeIdHwm rs getLong writeIdHwm s closeStmt pst pst sqlGenerator prepareStmtWithParameters dbConn s params
rs pst executeQuery rs writeIdHwm rs getLong writeIdHwm s closeStmt pst pst sqlGenerator prepareStmtWithParameters dbConn s params LOG debug s replaceAll quoteString names quoteString names rs pst executeQuery rs writeIdHwm rs getLong foundValidUncompactedWrite s Long toString writeIdHwm closeStmt pst pst sqlGenerator prepareStmtWithParameters dbConn s params
List TxnToWriteId txnToWriteIds ArrayList List TxnToWriteId srcTxnToWriteIds lockInternal dbConn getDbConn Connection TRANSACTION_READ_COMMITTED rqst srcTxnToWriteIds rqst getSrcTxnToWriteIdList List Long srcTxnIds ArrayList assert rqst isSetSrcTxnToWriteIdList assert rqst isSetTxnIds assert srcTxnToWriteIds isEmpty TxnToWriteId txnToWriteId srcTxnToWriteIds srcTxnIds add txnToWriteId getTxnId txnIds getTargetTxnIdList rqst getReplPolicy srcTxnIds dbConn srcTxnIds txnIds
txnToWriteId srcTxnIds add txnToWriteId getTxnId txnIds getTargetTxnIdList rqst getReplPolicy srcTxnIds dbConn srcTxnIds txnIds LOG info srcTxnIds toString rqst getReplPolicy AllocateTableWriteIdsResponse txnToWriteIds assert rqst isSetSrcTxnToWriteIdList assert rqst isSetTxnIds txnIds rqst getTxnIds txnIds Collections sort txnIds stmt dbConn txnIds stmt String errorMsg TableName getDbTable dbName tblName getAbortedAndReadOnlyTxns txnIds stmt getCommittedTxns txnIds stmt
txnIds rqst getTxnIds txnIds Collections sort txnIds stmt txnIds stmt String errorMsg TableName getDbTable dbName tblName getAbortedAndReadOnlyTxns txnIds stmt getCommittedTxns txnIds stmt LOG error errorMsg IllegalStateException TableName getDbTable dbName tblName List String queries ArrayList StringBuilder prefix StringBuilder StringBuilder suffix StringBuilder prefix append append TxnUtils buildQueryWithINClause conf queries prefix suffix txnIds allocatedTxnsCount writeId
String errorMsg TableName getDbTable dbName tblName getAbortedAndReadOnlyTxns txnIds stmt getCommittedTxns txnIds stmt LOG error errorMsg IllegalStateException TableName getDbTable dbName tblName List String queries ArrayList StringBuilder prefix StringBuilder StringBuilder suffix StringBuilder prefix append append TxnUtils buildQueryWithINClause conf queries prefix suffix txnIds allocatedTxnsCount writeId List String params Arrays asList dbName tblName String query queries pStmt sqlGenerator prepareStmtWithParameters dbConn query params LOG debug query replaceAll quoteString dbName quoteString tblName rs pStmt executeQuery
query pStmt sqlGenerator prepareStmtWithParameters dbConn query params LOG debug query replaceAll quoteString dbName quoteString tblName rs pStmt executeQuery rs txnId rs getLong writeId rs getLong txnToWriteIds add TxnToWriteId txnId writeId allocatedTxnsCount LOG info writeId txnId closeStmt pStmt numOfWriteIds txnIds size assert allocatedTxnsCount numOfWriteIds allocatedTxnsCount allocatedTxnsCount numOfWriteIds AllocateTableWriteIdsResponse txnToWriteIds
txnToWriteIds add TxnToWriteId txnId writeId allocatedTxnsCount LOG info writeId txnId closeStmt pStmt numOfWriteIds txnIds size assert allocatedTxnsCount numOfWriteIds allocatedTxnsCount allocatedTxnsCount numOfWriteIds AllocateTableWriteIdsResponse txnToWriteIds srcWriteId assert srcTxnToWriteIds srcWriteId srcTxnToWriteIds get getWriteId String s sqlGenerator addForUpdateClause closeStmt pStmt pStmt sqlGenerator prepareStmtWithParameters dbConn s params
numOfWriteIds AllocateTableWriteIdsResponse txnToWriteIds srcWriteId assert srcTxnToWriteIds srcWriteId srcTxnToWriteIds get getWriteId String s sqlGenerator addForUpdateClause closeStmt pStmt pStmt sqlGenerator prepareStmtWithParameters dbConn s params LOG debug s replaceAll quoteString dbName quoteString tblName rs pStmt executeQuery rs writeId srcWriteId srcWriteId s writeId numOfWriteIds closeStmt pStmt
srcWriteId srcTxnToWriteIds get getWriteId String s sqlGenerator addForUpdateClause closeStmt pStmt pStmt sqlGenerator prepareStmtWithParameters dbConn s params LOG debug s replaceAll quoteString dbName quoteString tblName rs pStmt executeQuery rs writeId srcWriteId srcWriteId s writeId numOfWriteIds closeStmt pStmt pStmt sqlGenerator prepareStmtWithParameters dbConn s params LOG debug s replaceAll quoteString dbName quoteString tblName pStmt execute nextWriteId rs getLong
closeStmt pStmt pStmt sqlGenerator prepareStmtWithParameters dbConn s params LOG debug s replaceAll quoteString dbName quoteString tblName pStmt execute nextWriteId rs getLong writeId srcWriteId srcWriteId nextWriteId s writeId numOfWriteIds closeStmt pStmt pStmt sqlGenerator prepareStmtWithParameters dbConn s params LOG debug s replaceAll quoteString dbName quoteString tblName pStmt executeUpdate srcWriteId srcWriteId nextWriteId s closeStmt pStmt
nextWriteId rs getLong writeId srcWriteId srcWriteId nextWriteId s writeId numOfWriteIds closeStmt pStmt pStmt sqlGenerator prepareStmtWithParameters dbConn s params LOG debug s replaceAll quoteString dbName quoteString tblName pStmt executeUpdate srcWriteId srcWriteId nextWriteId s closeStmt pStmt pStmt sqlGenerator prepareStmtWithParameters dbConn s params LOG debug s replaceAll quoteString dbName quoteString tblName pStmt executeUpdate dbConn
LOG debug s replaceAll quoteString dbName quoteString tblName pStmt executeUpdate s closeStmt pStmt pStmt sqlGenerator prepareStmtWithParameters dbConn s params LOG debug s replaceAll quoteString dbName quoteString tblName pStmt executeUpdate pstmt dbConn txnId pstmt setLong txnId pstmt setString dbName pstmt setString tblName pstmt setLong writeId pstmt addBatch
rqst String dbName rqst getDbName String tableName rqst getTableName Connection dbConn PreparedStatement pStmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED pStmt sqlGenerator prepareStmtWithParameters dbConn SELECT_NWI_NEXT_FROM_NEXT_WRITE_ID Arrays asList dbName tableName
String tableName rqst getTableName Connection dbConn PreparedStatement pStmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED pStmt sqlGenerator prepareStmtWithParameters dbConn SELECT_NWI_NEXT_FROM_NEXT_WRITE_ID Arrays asList dbName tableName LOG debug SELECT_NWI_NEXT_FROM_NEXT_WRITE_ID replaceAll quoteString dbName quoteString tableName rs pStmt executeQuery maxWriteId rs maxWriteId rs getLong MaxAllocatedTableWriteIdResponse maxWriteId
rqst Connection dbConn PreparedStatement pst dbConn getDbConn Connection TRANSACTION_READ_COMMITTED String s Long toString rqst getSeedWriteId pst sqlGenerator prepareStmtWithParameters dbConn s Arrays asList rqst getDbName rqst getTableName
Connection dbConn Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement minOpenTxn rs stmt executeQuery TxnStatus OPEN rs IllegalStateException minOpenTxn rs getLong rs minOpenTxn Long MAX_VALUE lowWaterMark getOpenTxnTimeoutLowBoundaryTxnId dbConn commitHighWaterMark Long min minOpenTxn lowWaterMark
ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement minOpenTxn rs stmt executeQuery TxnStatus OPEN rs IllegalStateException minOpenTxn rs getLong rs minOpenTxn Long MAX_VALUE lowWaterMark getOpenTxnTimeoutLowBoundaryTxnId dbConn commitHighWaterMark Long min minOpenTxn lowWaterMark LOG debug minOpenTxn lowWaterMark delCnt stmt executeUpdate commitHighWaterMark
currentTblValidWriteIdsList add getValidWriteIdsForTable dbConn fullTableName currentValidTxnList ValidTxnWriteIdList currentValidReaderWriteIdList TxnCommonUtils createValidTxnWriteIdList currentValidTxnList getHighWatermark currentTblValidWriteIdsList List String params ArrayList StringBuilder query StringBuilder query append i String fullyQualifiedName ValidWriteIdList tblValidWriteIdList validReaderWriteIdList getTableValidWriteIdList fullyQualifiedName tblValidWriteIdList LOG warn fullyQualifiedName ValidWriteIdList currentTblValidWriteIdList currentValidReaderWriteIdList getTableValidWriteIdList fullyQualifiedName currentTblValidWriteIdList LOG warn fullyQualifiedName
LOG debug JavaUtils txnIdToString txnId TableName getDbTable dbName tableName TxnStore MutexAPI LockHandle handle Connection dbConn PreparedStatement pst ResultSet rs lockInternal handle getMutexAPI acquireLock MUTEX_KEY MaterializationRebuild name dbConn getDbConn Connection TRANSACTION_READ_COMMITTED List String params Arrays asList dbName tableName String selectQ pst sqlGenerator prepareStmtWithParameters dbConn selectQ params LOG debug selectQ replaceAll quoteString dbName quoteString tableName rs pst executeQuery rs
ResultSet rs lockInternal handle getMutexAPI acquireLock MUTEX_KEY MaterializationRebuild name dbConn getDbConn Connection TRANSACTION_READ_COMMITTED List String params Arrays asList dbName tableName String selectQ pst sqlGenerator prepareStmtWithParameters dbConn selectQ params LOG debug selectQ replaceAll quoteString dbName quoteString tableName rs pst executeQuery rs LOG info dbName tableName LockResponse txnId LockState NOT_ACQUIRED String insertQ txnId Instant now toEpochMilli closeStmt pst
String dbName String tableName txnId Connection dbConn PreparedStatement pst lockInternal dbConn getDbConn Connection TRANSACTION_READ_COMMITTED String s Instant now toEpochMilli txnId pst sqlGenerator prepareStmtWithParameters dbConn s Arrays asList dbName tableName
String dbName String tableName txnId Connection dbConn PreparedStatement pst lockInternal dbConn getDbConn Connection TRANSACTION_READ_COMMITTED String s Instant now toEpochMilli txnId pst sqlGenerator prepareStmtWithParameters dbConn s Arrays asList dbName tableName LOG debug s replaceAll quoteString dbName quoteString tableName rc pst executeUpdate rc LOG debug dbConn rollback
timeout cnt List Long txnIds ArrayList timeoutTime Instant now toEpochMilli timeout Connection dbConn Statement stmt ResultSet rs lockInternal dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String selectQ
lockInternal dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String selectQ LOG debug selectQ rs stmt executeQuery selectQ rs lastHeartbeat rs getLong lastHeartbeat txnId rs getLong txnId txnId txnIds add txnId txnIds String deleteQ StringUtils join txnIds
txnid rqst getTxnid stmt dbConn createStatement txnid TxnRecord txnRecord lockTransactionRecord stmt txnid TxnStatus OPEN txnRecord ensureValidTxn dbConn txnid stmt shouldNeverHappen txnid insertTxnComponents txnid rqst dbConn tempExtLockId insertHiveLocksWithTemporaryExtLockId txnid dbConn rqst extLockId getNextLockIdForUpdate dbConn stmt incrementLockIdAndUpdateHiveLocks stmt extLockId tempExtLockId dbConn commit success ConnectionLockIdPair dbConn extLockId
tempExtLockId insertHiveLocksWithTemporaryExtLockId txnid dbConn rqst extLockId getNextLockIdForUpdate dbConn stmt incrementLockIdAndUpdateHiveLocks stmt extLockId tempExtLockId dbConn commit success ConnectionLockIdPair dbConn extLockId e LOG error rqst getMessage e rollbackDBConn dbConn checkRetryable dbConn e rqst MetaException StringUtils stringifyException e closeStmt stmt success closeDbConn dbConn
String s sqlGenerator addForUpdateClause
extLockId tempId String incrCmd String format INCREMENT_NEXT_LOCK_ID_QUERY extLockId String updateLocksCmd String format UPDATE_HIVE_LOCKS_EXT_ID_QUERY extLockId tempId
txnid lc String dbName normalizeCase lc getDbname String tblName normalizeCase lc getTablename String partName normalizeCase lc getPartitionname Optional Long writeId getWriteId writeIdCache dbName tblName txnid dbConn pstmt setLong txnid pstmt setString dbName pstmt setString tblName pstmt setString partName pstmt setString OperationType fromDataOperationType lc getOperationType getSqlConst pstmt setObject writeId orElse pstmt addBatch insertCounter insertCounter
String dbName normalizeCase lc getDbname String tblName normalizeCase lc getTablename String partName normalizeCase lc getPartitionname Optional Long writeId getWriteId writeIdCache dbName tblName txnid dbConn pstmt setLong txnid pstmt setString dbName pstmt setString tblName pstmt setString partName pstmt setString OperationType fromDataOperationType lc getOperationType getSqlConst pstmt setObject writeId orElse pstmt addBatch insertCounter insertCounter maxBatchSize LOG debug TXN_COMPONENTS_INSERT_QUERY maxBatchSize pstmt executeBatch
txnid dbName tblName tblName pstmt pstmt setString dbName pstmt setString tblName pstmt setLong txnid
intLockId String lockType LockTypeUtil getEncodingAsStr lc getType pstmt setLong tempExtLockId pstmt setLong intLockId pstmt setLong txnid pstmt setString normalizeCase lc getDbname pstmt setString normalizeCase lc getTablename pstmt setString normalizeCase lc getPartitionname pstmt setString Character toString LOCK_WAITING pstmt setString lockType pstmt setString rqst getUser pstmt setString rqst getHostname pstmt setString rqst getAgentInfo pstmt addBatch intLockId
pstmt setLong tempExtLockId pstmt setLong intLockId pstmt setLong txnid pstmt setString normalizeCase lc getDbname pstmt setString normalizeCase lc getTablename pstmt setString normalizeCase lc getPartitionname pstmt setString Character toString LOCK_WAITING pstmt setString lockType pstmt setString rqst getUser pstmt setString rqst getHostname pstmt setString rqst getAgentInfo pstmt addBatch intLockId maxBatchSize LOG debug insertLocksQuery maxBatchSize pstmt executeBatch
lockInternal dbConn dbConn getDbConn Connection TRANSACTION_READ_COMMITTED checkLock dbConn extLockId txnId zeroWaitReadEnabled e LOG error extLockId txnId getMessage e rollbackDBConn dbConn checkRetryable dbConn e extLockId txnId MetaException StringUtils stringifyException e unlockInternal closeDbConn dbConn e
LockInfo lockInfo getLockFromLockId dbConn extLockId orElseThrow NoSuchLockException JavaUtils lockIdToString extLockId lockInfo txnId heartbeatTxn dbConn lockInfo txnId heartbeatLock dbConn extLockId checkLock dbConn extLockId lockInfo txnId e LOG error rqst getMessage e rollbackDBConn dbConn checkRetryable dbConn e rqst MetaException JavaUtils lockIdToString extLockId StringUtils stringifyException e closeDbConn dbConn unlockInternal e
rqst Connection dbConn Statement stmt extLockId rqst getLockid dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s extLockId LOCK_WAITING
rqst Connection dbConn Statement stmt extLockId rqst getLockid dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s extLockId LOCK_WAITING LOG debug s rc stmt executeUpdate s rc
Connection dbConn Statement stmt extLockId rqst getLockid dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s extLockId LOCK_WAITING LOG debug s rc stmt executeUpdate s rc LOG info extLockId dbConn rollback Optional LockInfo optLockInfo getLockFromLockId dbConn extLockId optLockInfo
dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s extLockId LOCK_WAITING LOG debug s rc stmt executeUpdate s rc LOG info extLockId dbConn rollback Optional LockInfo optLockInfo getLockFromLockId dbConn extLockId optLockInfo LOG info LOCK_WAITING JavaUtils lockIdToString rqst getLockid LockInfo lockInfo optLockInfo get lockInfo String msg lockInfo
rc stmt executeUpdate s rc LOG info extLockId dbConn rollback Optional LockInfo optLockInfo getLockFromLockId dbConn extLockId optLockInfo LOG info LOCK_WAITING JavaUtils lockIdToString rqst getLockid LockInfo lockInfo optLockInfo get lockInfo String msg lockInfo LOG error msg TxnOpenException msg String msg lockInfo
optLockInfo LOG info LOCK_WAITING JavaUtils lockIdToString rqst getLockid LockInfo lockInfo optLockInfo get lockInfo String msg lockInfo LOG error msg TxnOpenException msg String msg lockInfo LOG error msg MetaException msg LOG debug extLockId dbConn commit
params add dbName tableName tableName filter filter append filter append params add tableName partName partName filter filter append filter append params add partName String whereClause filter toString whereClause s s whereClause pst sqlGenerator prepareStmtWithParameters dbConn s params
Set Long nosuch HashSet Set Long aborted HashSet rsp setNosuch nosuch rsp setAborted aborted dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement List String queries ArrayList numTxnsToHeartbeat rqst getMax rqst getMin List Long txnIds ArrayList numTxnsToHeartbeat txn rqst getMin txn rqst getMax txn txnIds add txn TxnUtils buildQueryWithINClause conf queries StringBuilder TxnDbUtil getEpochFn dbProduct TxnStatus OPEN StringBuilder txnIds updateCnt String queries
String s sqlGenerator addForUpdateClause
String dbName String tblName writeId Connection dbConn PreparedStatement pst dbConn getDbConn Connection TRANSACTION_READ_COMMITTED String query writeId pst sqlGenerator prepareStmtWithParameters dbConn query Arrays asList dbName tblName
lockInternal handle getMutexAPI acquireLock MUTEX_KEY CompactionScheduler name dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement id generateCompactionQueueId stmt List String params ArrayList StringBuilder sb StringBuilder append append quoteChar INITIATED_STATE append append quoteChar WORKING_STATE append append append params add rqst getDbname params add rqst getTablename rqst getPartitionname sb append sb append params add rqst getPartitionname pst sqlGenerator prepareStmtWithParameters dbConn sb toString params
List String params ArrayList StringBuilder sb StringBuilder append append quoteChar INITIATED_STATE append append quoteChar WORKING_STATE append append append params add rqst getDbname params add rqst getTablename rqst getPartitionname sb append sb append params add rqst getPartitionname pst sqlGenerator prepareStmtWithParameters dbConn sb toString params LOG debug sb toString ResultSet rs pst executeQuery rs enqueuedId rs getLong String state compactorStateToResponse rs getString charAt
ShowCompactResponse ShowCompactResponse response ShowCompactResponse ArrayList Connection dbConn Statement stmt dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s
OperationType ot OperationType UPDATE rqst ot OperationType fromDataOperationType rqst getOperationType Long writeId rqst getWriteid pstmt insertCounter partName rqst pstmt setLong rqst getTxnid pstmt setString normalizeCase rqst getDbname pstmt setString normalizeCase rqst getTablename pstmt setString partName pstmt setString ot getSqlConst pstmt setObject writeId pstmt addBatch insertCounter
Long writeId rqst getWriteid pstmt TXN_COMPONENTS_INSERT_QUERY insertCounter partName rqst pstmt setLong rqst getTxnid pstmt setString normalizeCase rqst getDbname pstmt setString normalizeCase rqst getTablename pstmt setString partName pstmt setString ot getSqlConst pstmt setObject writeId pstmt addBatch insertCounter insertCounter maxBatchSize LOG debug TXN_COMPONENTS_INSERT_QUERY maxBatchSize pstmt executeBatch
String defaultCatalog getDefaultCatalog conf Connection dbConn Statement stmt String dbName String tblName dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement List String queries ArrayList StringBuilder buff StringBuilder dbName db getName defaultCatalog db
queries add buff toString buff setLength buff append buff append dbName toLowerCase buff append queries add buff toString buff setLength buff append buff append dbName toLowerCase buff append queries add buff toString dbName table getDbName tblName table getTableName
Connection dbConn Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s
e deadlockCnt ALLOWED_REPEATED_DEADLOCKS waitInterval deadlockRetryInterval deadlockCnt LOG warn caller waitInterval ALLOWED_REPEATED_DEADLOCKS deadlockCnt Thread sleep waitInterval sendRetrySignal LOG error caller e sendRetrySignal waitForRetry caller e getMessage e sendRetrySignal waitForRetry caller e getMessage
conn Statement stmt stmt conn createStatement String s s s s String
s s s String msg LOG error msg MetaException msg LOG debug s ResultSet rs stmt executeQuery s rs next MetaException rs getTimestamp getTime e String msg e getMessage
String String String condition condition condition condition condition String
determineDatabaseProduct conn dbProduct String s conn getMetaData getDatabaseProductName dbProduct DatabaseProduct determineDatabaseProduct s dbProduct DatabaseProduct String msg s
String msg JavaUtils txnIdToString writeSet get txnId JavaUtils txnIdToString rs getLong rs getLong resourceName LOG info msg dbConn writeSet get txnId IllegalStateException msg dbConn commit TxnAbortedException msg close rs stmt String queryStr extLockId extLockId String whereStr LockTypeUtil sharedRead LockTypeUtil exclusive LockTypeUtil exclusive LockTypeUtil sharedRead LockTypeUtil sharedWrite LockTypeUtil exclWrite LockTypeUtil exclusive LockTypeUtil exclWrite LockTypeUtil sharedRead List String subQuery ArrayList String subCond whereStr subQuery add sqlGenerator addLimitClause queryStr subCond String query String join subQuery stmt dbConn createStatement LOG debug query
String query String join subQuery stmt dbConn createStatement LOG debug query rs stmt executeQuery query rs LockInfo blockedBy LockInfo rs intLockId rs getLong lockChar rs getString charAt LOG debug JavaUtils lockIdToString extLockId intLockId JavaUtils txnIdToString txnId blockedBy txnId LockType lockType LockTypeUtil getLockTypeFromEncoding lockChar orElseThrow MetaException lockChar lockType LockType String cleanupQuery extLockId LOG debug cleanupQuery stmt executeUpdate cleanupQuery
txnid String s txnid
txnid String s txnid LOG debug s s s sqlGenerator addLimitClause txnid
List txnIds List String queries ArrayList StringBuilder prefix StringBuilder prefix append TxnStatus OPEN TxnType READ_ONLY getValue TxnUtils buildQueryWithINClause conf queries prefix StringBuilder txnIds count String queries
String List txnIds List String queries ArrayList StringBuilder prefix StringBuilder prefix append TxnUtils buildQueryWithINClause conf queries prefix StringBuilder txnIds StringBuilder txnInfo StringBuilder String queries
String List txnIds List String queries ArrayList StringBuilder prefix StringBuilder prefix append TxnUtils buildQueryWithINClause conf queries prefix StringBuilder txnIds StringBuilder txnInfo StringBuilder String queries
txnid String s txnid
extLockId pstmt pstmt setLong extLockId
List LockInfo extLockId pstmt List LockInfo locks ArrayList pstmt setLong extLockId
Set Long timedOutLockIds TreeSet pstmt pstmt setLong timeout
timedOutLockIds add rs getLong dbConn commit timedOutLockIds LOG debug List String queries ArrayList StringBuilder prefix StringBuilder StringBuilder suffix StringBuilder prefix append prefix append TxnDbUtil getEpochFn dbProduct append append timeout prefix append TxnUtils buildQueryWithINClause conf queries prefix suffix timedOutLockIds dbConn deletedLocks String queries
timedOutLockIds LOG debug List String queries ArrayList StringBuilder prefix StringBuilder StringBuilder suffix StringBuilder prefix append prefix append TxnDbUtil getEpochFn dbProduct append append timeout prefix append TxnUtils buildQueryWithINClause conf queries prefix suffix timedOutLockIds stmt deletedLocks String query queries LOG debug query deletedLocks stmt executeUpdate query
Connection dbConn Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED timeOutLocks dbConn stmt dbConn createStatement String s TxnStatus OPEN TxnDbUtil getEpochFn dbProduct timeout TxnType REPL_CREATED getValue s sqlGenerator addLimitClause TIMED_OUT_TXN_ABORT_BATCH_SIZE s
List Long currentBatch ArrayList TIMED_OUT_TXN_ABORT_BATCH_SIZE timedOutTxns add currentBatch currentBatch size TIMED_OUT_TXN_ABORT_BATCH_SIZE currentBatch ArrayList TIMED_OUT_TXN_ABORT_BATCH_SIZE timedOutTxns add currentBatch currentBatch add rs getLong rs next dbConn commit close rs stmt numTxnsAborted List Long batchToAbort timedOutTxns dbConn batchToAbort batchToAbort size dbConn commit numTxnsAborted batchToAbort size
currentBatch ArrayList TIMED_OUT_TXN_ABORT_BATCH_SIZE timedOutTxns add currentBatch currentBatch add rs getLong rs next dbConn commit close rs stmt numTxnsAborted batchToAbort timedOutTxns dbConn batchToAbort batchToAbort size dbConn commit numTxnsAborted batchToAbort size Collections sort batchToAbort LOG info batchToAbort toString dbConn rollback
Connection dbConn Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s TxnStatus OPEN
Connection dbConn Statement stmt ResultSet rs dbConn getDbConn Connection TRANSACTION_READ_COMMITTED stmt dbConn createStatement String s TxnStatus OPEN LOG debug s rs stmt executeQuery s rs LOG error Long numOpen rs getLong numOpen
String key Connection dbConn Statement stmt ResultSet rs String sqlStmt sqlGenerator addForUpdateClause quoteString key lockInternal dbConn getDbConn Connection TRANSACTION_READ_COMMITTED connPoolMutex stmt dbConn createStatement
stmt executeUpdate quoteString key dbConn commit ex ex RuntimeException quoteString key getMessage ex ex dbConn rollback rs stmt executeQuery sqlStmt rs IllegalStateException quoteString key Semaphore derbySemaphore derbyKey2Lock putIfAbsent key Semaphore derbySemaphore derbyKey2Lock get key derbySemaphore acquire
stmt shared String sqlStmt sqlGenerator createTxnLockStatement shared stmt execute sqlStmt
List ColumnStatisticsObj List colStatsMap List List ColumnStatisticsObj aggrColStatObjs ArrayList ColumnStatisticsObj numProcessors Runtime getRuntime availableProcessors ExecutorService pool Executors newFixedThreadPool Math min colStatsMap size numProcessors ThreadFactoryBuilder setDaemon setNameFormat build List Future ColumnStatisticsObj futures Lists newLinkedList
List ColumnStatisticsObj aggrColStatObjs ArrayList ColumnStatisticsObj numProcessors Runtime getRuntime availableProcessors ExecutorService pool Executors newFixedThreadPool Math min colStatsMap size numProcessors ThreadFactoryBuilder setDaemon setNameFormat build List Future ColumnStatisticsObj futures Lists newLinkedList LOG debug Math min colStatsMap size numProcessors start System currentTimeMillis ColumnStatsAggregator List ColStatsObjWithSourceInfo entry colStatsMap futures pool ColumnStatisticsObj ColumnStatisticsObj List ColStatsObjWithSourceInfo colStatWithSourceInfo entry getValue ColumnStatsAggregator aggregator entry getKey ColumnStatisticsObj statsObj aggregator aggregate colStatWithSourceInfo partNames areAllPartsFound statsObj
ColumnStatsAggregator aggregator entry getKey ColumnStatisticsObj statsObj aggregator aggregate colStatWithSourceInfo partNames areAllPartsFound statsObj e LOG debug e getMessage e pool shutdown ColumnStatisticsObj future future get aggrColStatObjs add future get e
Map String String params tbl getParameters updateStats params params StatsSetupConst DO_NOT_UPDATE_STATS updateStats Boolean valueOf params get StatsSetupConst DO_NOT_UPDATE_STATS params remove StatsSetupConst DO_NOT_UPDATE_STATS updateStats tbl params params List FileStatus fileStatus wh getFileStatusesForUnpartitionedTable db tbl params params HashMap tbl setParameters params LOG info tbl getTableName populateQuickStats fileStatus params
String Path Path partitionPath String String String String result Path currPath partitionPath
LOG debug tablePath partCols currPath tablePath currPath String parts currPath getName split parts parts LOG warn currPath getName result String partitionName parts toLowerCase String partitionValue parts partCols partitionName result result partitionName getNormalisedPartitionValue partitionValue partitionColToTypeMap get partitionName result partitionName getNormalisedPartitionValue partitionValue partitionColToTypeMap get partitionName Path SEPARATOR result currPath currPath getParent
isConnected TTransportException tte useSSL MetastoreConf getBoolVar conf ConfVars USE_SSL useSasl MetastoreConf getBoolVar conf ConfVars USE_THRIFT_SASL useFramedTransport MetastoreConf getBoolVar conf ConfVars USE_THRIFT_FRAMED_TRANSPORT useCompactProtocol MetastoreConf getBoolVar conf ConfVars USE_THRIFT_COMPACT_PROTOCOL clientSocketTimeout MetastoreConf getTimeVar conf ConfVars CLIENT_SOCKET_TIMEOUT TimeUnit MILLISECONDS isConnected
TProtocol protocol protocol TCompactProtocol transport protocol TBinaryProtocol transport client ThriftHiveMetastore Client protocol transport transport open LOG info connCount incrementAndGet isConnected e tte e LOG LOG warn e
Table tbl request getTable HiveMetaHook hook getHook tbl hook hook preCreateTable tbl success client create_table_req request hook hook commitCreateTable tbl success success hook hook rollbackCreateTable tbl
NotificationEventResponse lastEventId maxEvents NotificationEventRequest rqst NotificationEventRequest lastEventId rqst setMaxEvents maxEvents NotificationEventResponse rsp client get_next_notification rqst
NotificationEventResponse lastEventId maxEvents NotificationEventRequest rqst NotificationEventRequest lastEventId rqst setMaxEvents maxEvents NotificationEventResponse rsp client get_next_notification rqst LOG debug rsp getEventsSize NotificationEventResponse filtered NotificationEventResponse rsp rsp nextEventId lastEventId rsp nextEventId
jdbcUrl TMP_DIR File separator MetaStoreServerUtils JUNIT_DATABASE_PREFIX metaStorePort MetastoreConf setVar conf ConfVars CONNECT_URL_KEY jdbcUrl MetastoreConf conf ConfVars MetastoreConf setVar conf ConfVars THRIFT_URIS metaStorePort Configuration txnInitConf Configuration conf TxnDbUtil setConfValues txnInitConf TxnDbUtil prepDb txnInitConf MetaStoreTestUtils startMetaStore metaStorePort bridge conf withHouseKeepingThreads waitForHouseKeepers Warehouse wh Warehouse conf wh wh getWhRoot FileSystem fs wh getWhRoot getFileSystem conf fs mkdirs wh getWhRoot fs setPermission wh getWhRoot FsPermission FsAction ALL FsAction ALL FsAction ALL LOG info warehouseDir
String uri msHost msHost uri msHost uri InetAddress getLocalHost getHostName uri uri port retries List String serverUris zkHelper getServerUris serverUris uri Exception uri serverUris Exception retries
isFailed
conf set MetaStoreTestUtils setConfForStandloneMode conf MetastoreConf setLongVar conf ConfVars BATCH_RETRIEVE_MAX MetastoreConf setLongVar conf ConfVars LIMIT_PARTITION_REQUEST port MetaStoreTestUtils startMetaStoreWithRetry HadoopThriftAuthBridge getBridge conf
Partition retp client add_partition part assertNotNull part retp Partition retp2 client add_partition part2 assertNotNull part2 retp2 Partition retp3 client add_partition part3 assertNotNull part3 retp3 Partition retp4 client add_partition part4 assertNotNull part4 retp4 Partition part_get client getPartition dbName tblName part getValues adjust client part dbName tblName isThriftClient adjust client part2 dbName tblName isThriftClient adjust client part3 dbName tblName isThriftClient assertTrue part equals part_get List String vals6 makeVals Partition part6 makePartitionObject dbName tblName vals6 tbl
Table tbl client getTable GetPartitionsRequest request GetPartitionsRequest GetPartitionsProjectionSpec projectSpec GetPartitionsProjectionSpec projectSpec setFieldList Arrays asList projectSpec setExcludeParamKeyPattern GetPartitionsFilterSpec filter GetPartitionsFilterSpec request setDbName request setTblName request setFilterSpec filter request setProjectionSpec projectSpec GetPartitionsResponse response response client getPartitionsWithSpecs request ex ex printStackTrace
List String expectedDates ArrayList nDates i i nDates i expectedDates add datePrefix i Assert assertArrayEquals expectedDates toArray locationToDateMap get toArray Assert assertArrayEquals expectedDates toArray locationToDateMap get toArray partitionSpecProxy hmsc listPartitionSpecsByFilter dbName tableName locationToDateMap get clear locationToDateMap get clear iterator partitionSpecProxy getPartitionIterator iterator Partition partition iterator next locationToDateMap get partition getValues get add partition getValues get Assert assertEquals locationToDateMap get size Assert assertArrayEquals expectedDates toArray locationToDateMap get toArray
StorageDescriptor targetTableSd StorageDescriptor targetTable getSd targetTableSd setLocation targetTableSd getLocation replace tableName targetTableName hmsc createTable targetTable PartitionSpecProxy partitionsForAddition hmsc listPartitionSpecsByFilter dbName tableName partitionsForAddition setTableName targetTableName partitionsForAddition setRootLocation targetTableSd getLocation Assert assertEquals partitionsForAddition size hmsc add_partitions_pspec partitionsForAddition PartitionSpecProxy clonedPartitions hmsc listPartitionSpecs dbName targetTableName Assert assertEquals partitionsForAddition size clonedPartitions size PartitionSpecProxy PartitionIterator sourceIterator partitionsForAddition getPartitionIterator targetIterator clonedPartitions getPartitionIterator targetIterator Partition sourcePartition sourceIterator next targetPartition targetIterator next Assert assertEquals sourcePartition getValues targetPartition getValues Assert assertEquals sourcePartition getSd getLocation targetPartition getSd getLocation
String catName createTestCatalog catName Database db1 Database DB1 Database db2 Database DB2 db1 setCatalogName catName db2 setCatalogName catName objectStore createDatabase db1 objectStore createDatabase db2 List String databases objectStore getAllDatabases catName
RuntimeException TestObjectStoreInitRetry debugTrace TestObjectStoreInitRetry TestObjectStoreInitRetry decrementInjectConnectFailure RuntimeException re JDOCanRetryException
MetastoreConf setTimeVar conf ConfVars HMS_HANDLER_INTERVAL TimeUnit SECONDS MetastoreConf setVar conf ConfVars CONNECTION_DRIVER FakeDerby getName MetastoreConf setBoolVar conf ConfVars TRY_DIRECT_SQL String jdbcUrl MetastoreConf getVar conf ConfVars CONNECT_URL_KEY jdbcUrl jdbcUrl replace MetastoreConf setVar conf ConfVars CONNECT_URL_KEY jdbcUrl MetaStoreTestUtils setConfForStandloneMode conf FakeDerby fd FakeDerby ObjectStore objStore ObjectStore Exception savE setInjectConnectFailure objStore setConf conf Assert fail Exception
String catName String dbName String tblName expr String defaultPartitionName maxParts List Partition result List Partition ormParts LinkedList sqlResult getPartitionsByExprInternal catName dbName tblName expr defaultPartitionName maxParts result ormResult getPartitionsByExprInternal catName dbName tblName expr defaultPartitionName maxParts ormParts sqlResult ormResult String msg sqlResult ormResult
cmd secondsToWait ProcessResults results runCmd cmd secondsToWait
cmd secondsToWait ProcessResults results runCmd cmd secondsToWait LOG info results stdout
location Path dir Paths get location dir
data howMany HMSClient client data getClient String dbName data dbName String tableName data tableName BenchmarkUtils createPartitionedTable client dbName tableName addManyPartitions client dbName tableName Collections singletonList howMany
data howMany HMSClient client data getClient String dbName data dbName String tableName data tableName BenchmarkUtils createPartitionedTable client dbName tableName addManyPartitions client dbName tableName Collections singletonList howMany
r File f File confDir r f f
conf useSSL MetastoreConf getBoolVar conf MetastoreConf ConfVars USE_SSL useSasl MetastoreConf getBoolVar conf MetastoreConf ConfVars USE_THRIFT_SASL useFramedTransport MetastoreConf getBoolVar conf MetastoreConf ConfVars USE_THRIFT_FRAMED_TRANSPORT useCompactProtocol MetastoreConf getBoolVar conf MetastoreConf ConfVars USE_THRIFT_COMPACT_PROTOCOL clientSocketTimeout MetastoreConf getTimeVar conf MetastoreConf ConfVars CLIENT_SOCKET_TIMEOUT TimeUnit MILLISECONDS
transport TFramedTransport transport TProtocol protocol protocol TCompactProtocol transport protocol TBinaryProtocol transport client ThriftHiveMetastore Client protocol transport transport open LOG info UserGroupInformation ugi SecurityUtils getUGI client set_ugi ugi getUserName Arrays asList ugi getGroupNames
host host System getenv ENV_SERVER host host System getProperty PROP_HOST host host DEFAULT_HOST host host trim portString portString portString host portString System getenv ENV_PORT portString portString System getProperty PROP_PORT Integer port Constants HMS_DEFAULT_PORT portString port Integer parseInt portString HostAndPort hp HostAndPort fromString host withDefaultPort port
ref prev next String error prev next stringifyDiskRanges ref
e StreamingException location e e StreamingException location e inputColumns table getSd getCols stream map FieldSchema getName collect Collectors toList inputTypes table getSd getCols stream map FieldSchema getType collect Collectors toList partitionColumns table getPartitionKeys stream map FieldSchema getName collect Collectors toList inputColumns addAll partitionColumns inputTypes addAll table getPartitionKeys stream map FieldSchema getType collect Collectors toList fullyQualifiedTableName Warehouse getQualifiedName table getDbName table getTableName String outFormatName table getSd getOutputFormat acidOutputFormat AcidOutputFormat ReflectionUtils newInstance JavaUtils loadClass outFormatName conf e
autoFlush conf getBoolVar HiveConf ConfVars HIVE_STREAMING_AUTO_FLUSH_ENABLED memoryUsageThreshold conf getFloatVar HiveConf ConfVars HIVE_HEAP_MEMORY_MONITOR_USAGE_THRESHOLD ingestSizeThreshold conf getSizeVar HiveConf ConfVars HIVE_STREAMING_AUTO_FLUSH_CHECK_INTERVAL_SIZE
heapMemoryMonitor close haveError String partition LOG logStats String entry partition entry getKey LOG LOG debug partition updater entry updater updater close haveError
lowMemoryCanary lowMemoryCanary ingestSizeThreshold LOG LOG debug LlapUtil humanReadableByteCount ingestSizeThreshold flush conn getConnectionStats incrementAutoFlushCount lowMemoryCanary set ingestSizeThreshold MemoryMXBean mxBean ManagementFactory getMemoryMXBean MemoryUsage heapUsage mxBean getHeapMemoryUsage memUsedFraction heapUsage getUsed heapUsage getMax memUsedFraction LOG
partitionValues destLocation Path table getSd getLocation PartitionInfo partitionInfo conn createPartitionIfNotExists partitionValues updatedPartitions add partitionInfo getName destLocation Path partitionInfo getPartitionLocation partitionPaths put key destLocation updaters computeIfAbsent key k initializeBuckets recordUpdater updaters get key get bucketId e StreamingIOFailure partitionValues conn e recordUpdater recordUpdater createRecordUpdater partitionValues destLocation bucketId curBatchMinWriteId curBatchMaxWriteId e
PartitionInfo String partitionValues String partLocation String partName exists Map String String partSpec Warehouse makeSpecFromValues tableObject getPartitionKeys partitionValues Path location Path tableObject getDataLocation Warehouse makePartPath partSpec location Path Utilities getQualifiedPath conf location partLocation location toString partName Warehouse makePartName tableObject getPartitionKeys partitionValues Partition partition org apache hadoop hive ql metadata Partition createMetaPartitionObject tableObject partSpec location getMSC PartitionInfo partName partLocation getMSC add_partition partition
InvalidTable tableObject Table getMSC getTable database table e LOG warn toConnectionInfoString e InvalidTable database table e tableObject LOG error InvalidTable database table tableObject tableObject setPartitionedTable setPartitionedTable String errMsg toString
currentTransactionBatch currentTransactionBatch createNewTransactionBatch
runDDL driver runDDL driver runDDL driver bucketCount tableLoc runDDL driver tableLoc3 runDDL driver bucketCount tableLoc2 String records String StrictDelimitedInputWriter wr StrictDelimitedInputWriter newBuilder withFieldDelimiter build HiveStreamingConnection connection HiveStreamingConnection newBuilder withDatabase withTable withAgentInfo Thread currentThread getName withRecordWriter wr withHiveConf conf connect connection beginTransaction String record records connection write record getBytes connection commitTransaction connection close ArrayList String res1 queryTable driver String res1
String records String StrictDelimitedInputWriter wr StrictDelimitedInputWriter newBuilder withFieldDelimiter build HiveStreamingConnection connection HiveStreamingConnection newBuilder withDatabase withTable withAgentInfo Thread currentThread getName withRecordWriter wr withHiveConf conf connect connection beginTransaction String record records connection write record getBytes connection commitTransaction connection close ArrayList String res1 queryTable driver String re res1 LOG error re driver run runDDL driver ArrayList String res2 queryTable driver String res2
connection write record getBytes connection commitTransaction connection close ArrayList String res1 queryTable driver String re res1 System out println re assertTrue re endsWith re endsWith driver run ArrayList String res queryTable driver assertEquals records length res size runDDL driver res queryTable driver assertEquals records length res size ArrayList String res2 queryTable driver String res2
TestStartResponse startRequest result LOG info startRequest toString TestStartResponse startResponse doStartTest startRequest result
File outputFile testExecution getOutputFile outputFile logsRequest getOffset outputFile length TestLogResponse Status illegalArgument RandomAccessFile fileHandle fileHandle RandomAccessFile outputFile offset logsRequest getOffset fileHandle seek offset readLength offset fileHandle length readLength Math min fileHandle length offset logsRequest getLength buffer readLength fileHandle readFully buffer offset readLength TestLogResponse Status ok offset String buffer Charsets UTF_8
test mTestQueue poll TimeUnit MINUTES terminateExecutionContext test terminateExecutionContext test setStatus Status inProgress test setDequeueTime System currentTimeMillis mExecutionContext mExecutionContext createExceutionContext test setExecutionStartTime System currentTimeMillis TestStartRequest startRequest test getStartRequest String profile startRequest getProfile File profileConfFile File mExecutionContextConfiguration getProfileDirectory String format profile
Context ctx builder build TestConfiguration testConfiguration TestConfiguration withContext ctx logger testConfiguration setPatch startRequest getPatchURL testConfiguration setJiraName startRequest getJiraName testConfiguration setClearLibraryCache startRequest isClearLibraryCache LocalCommandFactory localCommandFactory LocalCommandFactory logger PTest ptest mPTestBuilder build testConfiguration mExecutionContext test getStartRequest getTestHandle logDir localCommandFactory SSHCommandExecutor logger RSyncCommandExecutor logger mExecutionContextConfiguration getMaxRsyncThreads localCommandFactory logger result ptest run result test setStatus Status ok test setStatus Status failed result logStream flush mExecutionContext replaceBadHosts
Set Host goodHosts Sets newHashSet
goodHosts add hostExecutor getHost start System currentTimeMillis hostExecutors size expectedNumHosts System currentTimeMillis start RuntimeException hostExecutors size expectedNumHosts logger warn hostExecutors size expectedNumHosts TimeUnit MINUTES sleep executionContext replaceBadHosts host executionContext goodHosts host HostExecutor hostExecutor hostExecutorBuilder build host initalizeHost hostExecutor hostExecutor executionContext addBadHost hostExecutor getHost
batch parallelWorkQueue poll mNumPollSeconds TimeUnit SECONDS mShutdown mLogger warn mHost getName batch numParallelBatchesProcessed sw reset start batch failedTestResults failedTestResults add batch sw stop mLogger info Object batch getName getHost toShortString sw elapsed TimeUnit MILLISECONDS mShutdown parallelWorkQueue isEmpty
drone batch failedTestResults failedTestResults add batch sw stop mLogger info Object batch getName getHost toShortString sw elapsed TimeUnit MILLISECONDS mShutdown parallelWorkQueue isEmpty ex mDrones remove drone mLogger error ex batch Preconditions checkState parallelWorkQueue add batch batch mShutdown mLogger warn mHost getName
String scriptName batch getName File script File mLocalScratchDirectory scriptName Map String String templateVariables Maps newHashMap mTemplateDefaults templateVariables put drone getInstanceName templateVariables put batch getName templateVariables put batch getTestArguments templateVariables put drone getLocalDirectory templateVariables put drone getLocalLogDirectory Preconditions checkArgument StringUtils isNotBlank batch getTestModuleRelativeDir templateVariables put batch getTestModuleRelativeDir String command Templates getTemplateResult script getName templateVariables Templates writeTemplateResult script templateVariables copyToDroneFromLocal drone script getAbsolutePath scriptName script delete Stopwatch sw Stopwatch createStarted
List ListenableFuture RemoteCommandResult call List Drone drones Lists newArrayList mDrones List ListenableFuture RemoteCommandResult results Lists newArrayList String resolvedLocalLocation Files simplifyPath Templates getTemplateResult localFile mTemplateDefaults String remoteStagingLocation Drone drone mDrones Preconditions checkState remoteStagingLocation Map String String templateVariables Maps newHashMap mTemplateDefaults templateVariables put drone getInstanceName templateVariables put drone getLocalDirectory String resolvedRemoteLocation Files simplifyPath Templates getTemplateResult remoteFile templateVariables RSyncResult result RSyncCommand mRSyncCommandExecutor drone getPrivateKey drone getUser drone getHost drone getInstance resolvedLocalLocation resolvedRemoteLocation RSyncCommand Type FROM_LOCAL call result remoteStagingLocation resolvedRemoteLocation drones remove drone
String remoteStagingLocation drone mDrones Preconditions checkState remoteStagingLocation Map String String templateVariables Maps newHashMap mTemplateDefaults templateVariables put drone getInstanceName templateVariables put drone getLocalDirectory String resolvedRemoteLocation Files simplifyPath Templates getTemplateResult remoteFile templateVariables RSyncResult result RSyncCommand mRSyncCommandExecutor drone getPrivateKey drone getUser drone getHost drone getInstance resolvedLocalLocation resolvedRemoteLocation RSyncCommand Type FROM_LOCAL call result remoteStagingLocation resolvedRemoteLocation drones remove drone mLogger info resolvedLocalLocation remoteStagingLocation mDrones remove drone
SSHResult String cmd reportErrors SSHResult SSHResult call drone mDrones Map String String templateVariables Maps newHashMap mTemplateDefaults templateVariables put drone getInstanceName templateVariables put drone getLocalDirectory String command Templates getTemplateResult cmd templateVariables SSHResult result SSHCommand mSSHCommandExecutor drone getPrivateKey drone getUser drone getHost drone getInstance command reportErrors call reportErrors result mDrones remove drone
List ListenableFuture RemoteCommandResult List String cmd List ListenableFuture RemoteCommandResult result Lists newArrayList drone result RemoteCommandResult RemoteCommandResult call Map String String templateVariables Maps newHashMap mTemplateDefaults templateVariables put drone getInstanceName templateVariables put drone getLocalDirectory String command Templates getTemplateResult cmd templateVariables SSHResult result SSHCommand mSSHCommandExecutor drone getPrivateKey drone getUser drone getHost drone getInstance command call result mDrones remove drone
httpClient getCredentialsProvider setCredentials AuthScope apiURL getHost apiURL getPort AuthScope ANY_REALM UsernamePasswordCredentials mUser mPassword BasicHttpContext localcontext BasicHttpContext localcontext setAttribute BasicScheme httpClient addRequestInterceptor PreemptiveAuth HttpPost request HttpPost url ObjectMapper mapper ObjectMapper StringEntity params StringEntity mapper writeValueAsString Body comments request addHeader request setEntity params HttpResponse httpResponse httpClient execute request localcontext StatusLine statusLine httpResponse getStatusLine statusLine getStatusCode RuntimeException statusLine getStatusCode statusLine getReasonPhrase mLogger info httpResponse
name name attributes getValue name failedOrErrored name name executedTests add name failedOrErrored failedTests add name
process exitCode exitCode process waitFor stopwatch stopwatch stop elapsedTimeInMs stopwatch elapsed TimeUnit MILLISECONDS
Map String ProfileLogs profiles Maps newHashMap File logDir String name logDir getName name String profile name substring name lastIndexOf ProfileLogs logs profiles get profile logs logs ProfileLogs profile profiles put profile logs logs dirs add logDir String profile profiles ProfileLogs logs profiles get profile logs dirs File oldest logs getOldest
String name logDir getName name String profile name substring name lastIndexOf ProfileLogs logs profiles get profile logs logs ProfileLogs profile profiles put profile logs logs dirs add logDir String profile profiles ProfileLogs logs profiles get profile logs dirs File oldest logs getOldest LOG info oldest logs dirs FileUtils deleteQuietly oldest
result error List String messages Lists newArrayList Map String Long elapsedTimes Maps newTreeMap mLogger info mConfiguration
result error List String messages Lists newArrayList Map String Long elapsedTimes Maps newTreeMap mLogger info mConfiguration mLogger info mConfiguration getContext phase String msg phase getClass getName
messages add msg start System currentTimeMillis phase execute elapsedTime TimeUnit MINUTES convert System currentTimeMillis start TimeUnit MILLISECONDS Map String Long perfMetrics phase getPerfMetrics perfMetrics mLogger info phase getClass getSimpleName String Long perfEntry perfMetrics elapsedTimes put phase getClass getSimpleName perfEntry getKey TimeUnit MINUTES convert perfEntry getValue TimeUnit MILLISECONDS elapsedTimes put phase getClass getSimpleName elapsedTime mFailedTests TestsFailedException mFailedTests size
execLocally mPatchFile File smartApplyPatch File mScratchDir PrintWriter writer PrintWriter smartApplyPatch writer write Templates readResource writer IOException smartApplyPatch writer close execLocally mPatchFile getPath start elapsedTime start System currentTimeMillis File sourcePrepScript File mScratchDir
PrintWriter writer PrintWriter smartApplyPatch writer write Templates readResource writer IOException smartApplyPatch writer close execLocally mPatchFile getPath start elapsedTime start System currentTimeMillis File sourcePrepScript File mScratchDir logger info sourcePrepScript Templates writeTemplateResult sourcePrepScript getTemplateDefaults execLocally sourcePrepScript getPath
IOException smartApplyPatch writer close execLocally mPatchFile getPath start elapsedTime start System currentTimeMillis File sourcePrepScript File mScratchDir logger info sourcePrepScript Templates writeTemplateResult sourcePrepScript getTemplateDefaults execLocally sourcePrepScript getPath logger debug sourcePrepScript sourcePrepScript delete execHostsIgnoreErrors execHostsIgnoreErrors elapsedTime TimeUnit MINUTES convert System currentTimeMillis start TimeUnit MILLISECONDS
mPatchURL patchUrlWasSeen patchUrls asMap containsKey mPatchURL patchUrlWasSeen patchUrls put mPatchURL Exception mPatchURL mPatchFile logger info mPatchFile getAbsolutePath FileReader fr fr FileReader mPatchFile BufferedReader br BufferedReader fr String line line br line
File yetusExecScript File yetusBuildScratchDir YETUS_EXEC_SCRIPT Map String String templateVars HashMap templateVars putAll getTemplateDefaults templateVars put mWorkingDir getAbsolutePath templateVars put conf getJiraName templateVars put mPatchFile getAbsolutePath templateVars put conf getJiraUrl templateVars put conf getJiraUser templateVars put conf getJiraPassword templateVars put mOutputDir getAbsolutePath templateVars put buildUrl templateVars put YETUS_LOG_FILE templateVars put YETUS_OUTPUT_FOLDER templateVars put mLogFile getAbsolutePath templateVars put yetusBuildScratchDir getAbsolutePath
templateVars put mOutputDir getAbsolutePath templateVars put buildUrl templateVars put YETUS_LOG_FILE templateVars put YETUS_OUTPUT_FOLDER templateVars put mLogFile getAbsolutePath templateVars put yetusBuildScratchDir getAbsolutePath logger info yetusExecScript Templates writeTemplateResult YETUS_EXEC_VM yetusExecScript templateVars Process proc ProcessBuilder command yetusExecScript getPath start exitCode proc waitFor exitCode logger info e logger error e
templateVars put buildUrl templateVars put YETUS_LOG_FILE templateVars put YETUS_OUTPUT_FOLDER templateVars put mLogFile getAbsolutePath templateVars put yetusBuildScratchDir getAbsolutePath logger info yetusExecScript Templates writeTemplateResult YETUS_EXEC_VM yetusExecScript templateVars Process proc ProcessBuilder command yetusExecScript getPath start exitCode proc waitFor exitCode logger info e logger error e
Properties properties Properties String path sourceDirectory File separator propFiles get propFile FileInputStream fis fis FileInputStream path properties load fis e logger warn e IllegalArgumentException path fis fis close e propertyMap put propFile properties
Set String String Set String toRemove HashSet String Set String toAdd HashSet String String pattern Pattern r Pattern compile pattern String test Matcher m r matcher test m toRemove add test
RootConfig rootConfig getRootConfig unitRootContext
RootConfig rootConfig getRootConfig unitRootContext logger info rootConfig Map String ModuleConfig moduleConfigs extractModuleConfigs
TestBatch List TestBatch testBatches LinkedList
Map String ModuleConfig Collection String modules extractConfiguredModules Map String ModuleConfig result HashMap String moduleName modules Context moduleContext Context unitModuleContext getSubProperties Joiner on join moduleName ModuleConfig moduleConfig getModuleConfig moduleContext moduleName DEFAULT_PROP_BATCH_SIZE_NOT_SPECIFIED
String srcDirString sourceDirectory getCanonicalPath List TestDir unitTestsDirs Lists newArrayList String propDirectoriies unitRootContext getString PROP_DIRECTORIES DEFAULT_PROP_DIRECTORIES Iterable String propDirectoriesIterable VALUE_SPLITTER split propDirectoriies String unitTestDir propDirectoriesIterable File unitTestParent File sourceDirectory unitTestDir unitTestParent String absUnitTestDir unitTestParent getCanonicalPath Preconditions checkState absUnitTestDir startsWith srcDirString absUnitTestDir srcDirString String modulePath absUnitTestDir substring srcDirString length modulePath stripEndAndStart modulePath Preconditions checkState modulePath startsWith String format modulePath modulePath modulePath PREFIX_TOP_LEVEL String moduleName getModuleNameFromPathPrefix modulePath
List TestDir unitTestsDirs Lists newArrayList String propDirectoriies unitRootContext getString PROP_DIRECTORIES DEFAULT_PROP_DIRECTORIES Iterable String propDirectoriesIterable VALUE_SPLITTER split propDirectoriies String unitTestDir propDirectoriesIterable File unitTestParent File sourceDirectory unitTestDir unitTestParent String absUnitTestDir unitTestParent getCanonicalPath Preconditions checkState absUnitTestDir startsWith srcDirString absUnitTestDir srcDirString String modulePath absUnitTestDir substring srcDirString length modulePath stripEndAndStart modulePath Preconditions checkState modulePath startsWith String format modulePath modulePath modulePath PREFIX_TOP_LEVEL String moduleName getModuleNameFromPathPrefix modulePath logger info modulePath absUnitTestDir moduleName
LinkedHashMap String LinkedHashSet TestInfo rootConfig String LinkedHashMap String LinkedHashSet TestInfo result LinkedHashMap classFile String String className classFile getName className className String testName className replaceAll String pathPrefix getPathPrefix classFile rootConfig subDirForPrefix String moduleName getModuleNameFromPathPrefix pathPrefix
LinkedHashMap String LinkedHashSet TestInfo rootConfig String ModuleConfig moduleConfigs LinkedHashMap String LinkedHashSet TestInfo result LinkedHashMap unitTestDir classFile unitTestDir path String String className classFile getName className className String testName className replaceAll String pathPrefix getPathPrefix classFile rootConfig subDirForPrefix String moduleName getModuleNameFromPathPrefix pathPrefix logger debug unitTestDir path className pathPrefix moduleName ModuleConfig moduleConfig moduleConfigs get moduleName moduleConfig moduleConfig FAKE_MODULE_CONFIG TestInfo testInfo checkAndGetTestInfo moduleName pathPrefix testName rootConfig moduleConfig testInfo
rejectReason moduleConfig contains testName rejectReason containsInclude rootConfig include isEmpty moduleConfig include isEmpty containsInclude rootConfig include contains testName moduleConfig include contains testName rejectReason contains testName rejectReason testInfo TestInfo moduleName moduleRelDir testName rootConfig skipBatching contains testName moduleConfig skipBatching contains testName rootConfig isolate contains testName moduleConfig isolate contains testName testInfo
String host mHostLog seek host mHostLog hosts add host trim hosts terminate hosts mHostLog seek mHostLog setLength TimeUnit MINUTES sleep performBackgroundWork
result addAll mCloudComputeService createNodes Math min mMaxHostsPerCreateRequest numRequired Set String newAddresses HashSet String node result newAddresses addAll node getPublicAddresses mTerminatedHosts String newAddress newAddresses mTerminatedHosts remove newAddress e error LOG warn e terminateInternal e getNodeErrors keySet result addAll e getSuccessfulNodes result verifyHosts result node result
mTerminatedHosts newAddress mTerminatedHosts remove newAddress e error LOG warn e terminateInternal e getNodeErrors keySet result addAll e getSuccessfulNodes result verifyHosts result node result mLiveHosts put publicIpOrHostname node System currentTimeMillis LOG info result size numRequired numHosts result size numRequired sleepTime mRetrySleepInterval
Set NodeMetadata Set NodeMetadata hosts Set NodeMetadata result Collections synchronizedSet HashSet NodeMetadata hosts persistHostnamesToLog hosts ExecutorService executorService Executors newFixedThreadPool Math min hosts size NodeMetadata node hosts executorService String ip publicIpOrHostname node SSHCommand command SSHCommand mSSHCommandExecutor mPrivateKey mUser ip mSSHCommandExecutor execute command command command
LOG info node mLiveHosts remove publicIpOrHostname node TimeUnit SECONDS sleep mRetrySleepInterval Thread currentThread interrupt String ip publicIpOrHostname node LOG info ip mTerminatedHosts ip mTerminatedHosts put ip System currentTimeMillis mCloudComputeService destroyNode node getId
List Method udfMethods ArrayList Method leastConversionCost Integer MAX_VALUE Method m List TypeInfo argumentsAccepted TypeInfoUtils getParameterTypeInfos m argumentsPassed size argumentsAccepted match argumentsAccepted size argumentsPassed size conversionCost i i argumentsPassed size match i cost matchCost argumentsPassed get i argumentsAccepted get i exact cost match conversionCost cost
args Options cmdLineOptions createCommandLineOptions CommandLineParser parser GnuParser CommandLine line line parser parse cmdLineOptions args e System err println e getLocalizedMessage printAndExit cmdLineOptions line HelpFormatter formatter HelpFormatter formatter printHelp cmdLineOptions RunOptions runOptions RunOptions fromCommandLine line
CommandLine line line parser parse cmdLineOptions args e System err println e getLocalizedMessage printAndExit cmdLineOptions line HelpFormatter formatter HelpFormatter formatter printHelp cmdLineOptions RunOptions runOptions RunOptions fromCommandLine line LOG info runOptions toString String hiveVer HiveVersionInfo getShortVersion
tableRegexOption setArgs tableRegexOption setArgName cmdLineOptions addOption tableRegexOption Option tableTypeOption Option String format Arrays stream TableType values map Enum name collect Collectors joining tableTypeOption setLongOpt tableTypeOption setArgs tableTypeOption setArgName cmdLineOptions addOption tableTypeOption Option tablePoolSizeOption Option tablePoolSizeOption setLongOpt tablePoolSizeOption setArgs tablePoolSizeOption setArgName cmdLineOptions addOption tablePoolSizeOption cmdLineOptions
compactTablesState databases stream map dbName processDatabase dbName processTablePool runOptions reduce CompactTablesState merge orElse CompactTablesState empty e e exceptionMsg HiveConf ConfVars HIVE_METASTORE_AUTHORIZATION_AUTH_READS varname HiveException exceptionMsg e makeCompactionScript compactTablesState runOptions getOutputDir runOptions compactTablesState getMetaInfo getCompactionIds size LOG debug compactTablesState getMetaInfo getCompactionIds size ShowCompactResponse resp hms showCompactions e resp String state e getState removed state removed compactTablesState getMetaInfo getCompactionIds e
String dbName runOptions IMetaStoreClient hms metaStoreClient get List String tables runOptions tables hms getTables dbName runOptions getTableRegex
dbName tableName IMetaStoreClient hms metaStoreClient get CompactionMetaInfo compactionMetaInfo CompactionMetaInfo Table t hms getTable dbName tableName
t p db String partName p Warehouse makePartName t getPartitionKeys p getValues CompactionResponse resp db compact2 t getDbName t getTableName partName CompactionType MAJOR resp
